!function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=191)}([function(t,e,n){"use strict";e.__esModule=!0,e.default=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(109),r=function(t){return t&&t.__esModule?t:{default:t}}(i);e.default=r.default},function(t,e){var n=t.exports={version:"2.6.0"};"number"==typeof __e&&(__e=n)},function(t,e,n){t.exports={default:n(128),__esModule:!0}},function(t,e,n){"use strict";e.__esModule=!0;var i=n(13),r=function(t){return t&&t.__esModule?t:{default:t}}(i);e.default=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}()},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=n(32),o=i(r),a=n(21),s=i(a),l=n(14),u=i(l);e.default=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":(0,u.default)(e)));t.prototype=(0,s.default)(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(o.default?(0,o.default)(t,e):t.__proto__=e)}},function(t,e,n){"use strict";e.__esModule=!0;var i=n(14),r=function(t){return t&&t.__esModule?t:{default:t}}(i);e.default=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":(0,r.default)(e))&&"function"!=typeof e?t:e}},function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e,n){var i=n(7),r=n(2),o=n(25),a=n(18),s=n(17),l=function(t,e,n){var u,c,h,d=t&l.F,p=t&l.G,f=t&l.S,m=t&l.P,v=t&l.B,g=t&l.W,y=p?r:r[e]||(r[e]={}),b=y.prototype,_=p?i:f?i[e]:(i[e]||{}).prototype;p&&(n=e);for(u in n)(c=!d&&_&&void 0!==_[u])&&s(y,u)||(h=c?_[u]:n[u],y[u]=p&&"function"!=typeof _[u]?n[u]:v&&c?o(h,i):g&&_[u]==h?function(t){var e=function(e,n,i){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,i)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(h):m&&"function"==typeof h?o(Function.call,h):h,m&&((y.virtual||(y.virtual={}))[u]=h,t&l.R&&b&&!b[u]&&a(b,u,h)))};l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,t.exports=l},function(t,e,n){var i=n(49)("wks"),r=n(38),o=n(7).Symbol,a="function"==typeof o;(t.exports=function(t){return i[t]||(i[t]=a&&o[t]||(a?o:r)("Symbol."+t))}).store=i},function(t,e,n){var i=n(12);t.exports=function(t){if(!i(t))throw TypeError(t+" is not an object!");return t}},function(t,e,n){t.exports=!n(20)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,n){t.exports={default:n(124),__esModule:!0}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=n(23),o=i(r),a=n(22),s=i(a),l="function"==typeof s.default&&"symbol"==typeof o.default?function(t){return typeof t}:function(t){return t&&"function"==typeof s.default&&t.constructor===s.default&&t!==s.default.prototype?"symbol":typeof t};e.default="function"==typeof s.default&&"symbol"===l(o.default)?function(t){return void 0===t?"undefined":l(t)}:function(t){return t&&"function"==typeof s.default&&t.constructor===s.default&&t!==s.default.prototype?"symbol":void 0===t?"undefined":l(t)}},function(t,e,n){var i=n(10),r=n(58),o=n(51),a=Object.defineProperty;e.f=n(11)?Object.defineProperty:function(t,e,n){if(i(t),e=o(e,!0),i(n),r)try{return a(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=i(r),a=n(91),s=i(a),l=function t(){(0,o.default)(this,t),this.isSamsungBrowser=s.default.samsungBrowser,this.browser=s.default,this.isIOS=s.default.ios,this.isiPad=/iPad/.test(navigator.userAgent)&&!window.MSStream,this.isMSIE=s.default.msie,this.isMobile=s.default.mobile,this.isDesktop=!s.default.mobile&&!s.default.tablet,this.isTablet=s.default.tablet,this.isAndroid=s.default.android};e.default=new l},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){var i=n(15),r=n(35);t.exports=n(11)?function(t,e,n){return i.f(t,e,r(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var i=n(59),r=n(41);t.exports=function(t){return i(r(t))}},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,n){t.exports={default:n(122),__esModule:!0}},function(t,e,n){t.exports={default:n(132),__esModule:!0}},function(t,e,n){t.exports={default:n(133),__esModule:!0}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e,n){var i=n(33);t.exports=function(t,e,n){if(i(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)}}return function(){return t.apply(e,arguments)}}},function(t,e){t.exports={}},function(t,e){t.exports=!0},function(t,e,n){var i=n(66),r=n(43);t.exports=Object.keys||function(t){return i(t,r)}},function(t,e,n){var i=n(8),r=n(2),o=n(20);t.exports=function(t,e){var n=(r.Object||{})[t]||Object[t],a={};a[t]=e(n),i(i.S+i.F*o(function(){n(1)}),"Object",a)}},function(t,e,n){t.exports={default:n(118),__esModule:!0}},function(t,e,n){t.exports={default:n(129),__esModule:!0}},function(t,e,n){t.exports={default:n(130),__esModule:!0}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,n){var i=n(15).f,r=n(17),o=n(9)("toStringTag");t.exports=function(t,e,n){t&&!r(t=n?t:t.prototype,o)&&i(t,o,{configurable:!0,value:e})}},function(t,e,n){var i=n(41);t.exports=function(t){return Object(i(t))}},function(t,e){var n=0,i=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+i).toString(36))}},function(t,e,n){t.exports={default:n(126),__esModule:!0}},function(t,e,n){t.exports={default:n(127),__esModule:!0}},function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e,n){var i=n(12),r=n(7).document,o=i(r)&&i(r.createElement);t.exports=function(t){return o?r.createElement(t):{}}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,n){"use strict";function i(t){var e,n;this.promise=new t(function(t,i){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=i}),this.resolve=r(e),this.reject=r(n)}var r=n(33);t.exports.f=function(t){return new i(t)}},function(t,e,n){var i=n(10),r=n(62),o=n(43),a=n(48)("IE_PROTO"),s=function(){},l=function(){var t,e=n(42)("iframe"),i=o.length;for(e.style.display="none",n(57).appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),l=t.F;i--;)delete l.prototype[o[i]];return l()};t.exports=Object.create||function(t,e){var n;return null!==t?(s.prototype=i(t),n=new s,s.prototype=null,n[a]=t):n=l(),void 0===e?n:r(n,e)}},function(t,e,n){var i=n(34),r=n(35),o=n(19),a=n(51),s=n(17),l=n(58),u=Object.getOwnPropertyDescriptor;e.f=n(11)?u:function(t,e){if(t=o(t),e=a(e,!0),l)try{return u(t,e)}catch(t){}if(s(t,e))return r(!i.f.call(t,e),t[e])}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){var i=n(49)("keys"),r=n(38);t.exports=function(t){return i[t]||(i[t]=r(t))}},function(t,e,n){var i=n(2),r=n(7),o=r["__core-js_shared__"]||(r["__core-js_shared__"]={});(t.exports=function(t,e){return o[t]||(o[t]=void 0!==e?e:{})})("versions",[]).push({version:i.version,mode:n(27)?"pure":"global",copyright:"Â© 2018 Denis Pushkarev (zloirock.ru)"})},function(t,e){var n=Math.ceil,i=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?i:n)(t)}},function(t,e,n){var i=n(12);t.exports=function(t,e){if(!i(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!i(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")}},function(t,e,n){var i=n(7),r=n(2),o=n(27),a=n(53),s=n(15).f;t.exports=function(t){var e=r.Symbol||(r.Symbol=o?{}:i.Symbol||{});"_"==t.charAt(0)||t in e||s(e,t,{value:a.f(t)})}},function(t,e,n){e.f=n(9)},function(t,e,n){t.exports={default:n(121),__esModule:!0}},function(t,e,n){t.exports={default:n(123),__esModule:!0}},function(t,e,n){var i=n(24),r=n(9)("toStringTag"),o="Arguments"==i(function(){return arguments}()),a=function(t,e){try{return t[e]}catch(t){}};t.exports=function(t){var e,n,s;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=a(e=Object(t),r))?n:o?i(e):"Object"==(s=i(e))&&"function"==typeof e.callee?"Arguments":s}},function(t,e,n){var i=n(7).document;t.exports=i&&i.documentElement},function(t,e,n){t.exports=!n(11)&&!n(20)(function(){return 7!=Object.defineProperty(n(42)("div"),"a",{get:function(){return 7}}).a})},function(t,e,n){var i=n(24);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==i(t)?t.split(""):Object(t)}},function(t,e,n){"use strict";var i=n(27),r=n(8),o=n(69),a=n(18),s=n(26),l=n(143),u=n(36),c=n(65),h=n(9)("iterator"),d=!([].keys&&"next"in[].keys()),p=function(){return this};t.exports=function(t,e,n,f,m,v,g){l(n,e,f);var y,b,_,w=function(t){if(!d&&t in S)return S[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},T=e+" Iterator",x="values"==m,E=!1,S=t.prototype,A=S[h]||S["@@iterator"]||m&&S[m],C=A||w(m),k=m?x?w("entries"):C:void 0,M="Array"==e?S.entries||A:A;if(M&&(_=c(M.call(new t)))!==Object.prototype&&_.next&&(u(_,T,!0),i||"function"==typeof _[h]||a(_,h,p)),x&&A&&"values"!==A.name&&(E=!0,C=function(){return A.call(this)}),i&&!g||!d&&!E&&S[h]||a(S,h,C),s[e]=C,s[T]=p,m)if(y={values:x?C:w("values"),keys:v?C:w("keys"),entries:k},g)for(b in y)b in S||o(S,b,y[b]);else r(r.P+r.F*(d||E),e,y);return y}},function(t,e,n){var i=n(38)("meta"),r=n(12),o=n(17),a=n(15).f,s=0,l=Object.isExtensible||function(){return!0},u=!n(20)(function(){return l(Object.preventExtensions({}))}),c=function(t){a(t,i,{value:{i:"O"+ ++s,w:{}}})},h=function(t,e){if(!r(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,i)){if(!l(t))return"F";if(!e)return"E";c(t)}return t[i].i},d=function(t,e){if(!o(t,i)){if(!l(t))return!0;if(!e)return!1;c(t)}return t[i].w},p=function(t){return u&&f.NEED&&l(t)&&!o(t,i)&&c(t),t},f=t.exports={KEY:i,NEED:!1,fastKey:h,getWeak:d,onFreeze:p}},function(t,e,n){var i=n(15),r=n(10),o=n(28);t.exports=n(11)?Object.defineProperties:function(t,e){r(t);for(var n,a=o(e),s=a.length,l=0;s>l;)i.f(t,n=a[l++],e[n]);return t}},function(t,e,n){var i=n(19),r=n(64).f,o={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],s=function(t){try{return r(t)}catch(t){return a.slice()}};t.exports.f=function(t){return a&&"[object Window]"==o.call(t)?s(t):r(i(t))}},function(t,e,n){var i=n(66),r=n(43).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,r)}},function(t,e,n){var i=n(17),r=n(37),o=n(48)("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=r(t),i(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},function(t,e,n){var i=n(17),r=n(19),o=n(136)(!1),a=n(48)("IE_PROTO");t.exports=function(t,e){var n,s=r(t),l=0,u=[];for(n in s)n!=a&&i(s,n)&&u.push(n);for(;e.length>l;)i(s,n=e[l++])&&(~o(u,n)||u.push(n));return u}},function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},function(t,e,n){var i=n(10),r=n(12),o=n(44);t.exports=function(t,e){if(i(t),r(e)&&e.constructor===t)return e;var n=o.f(t);return(0,n.resolve)(e),n.promise}},function(t,e,n){t.exports=n(18)},function(t,e,n){var i=n(10),r=n(33),o=n(9)("species");t.exports=function(t,e){var n,a=i(t).constructor;return void 0===a||void 0==(n=i(a)[o])?e:r(n)}},function(t,e,n){var i,r,o,a=n(25),s=n(139),l=n(57),u=n(42),c=n(7),h=c.process,d=c.setImmediate,p=c.clearImmediate,f=c.MessageChannel,m=c.Dispatch,v=0,g={},y=function(){var t=+this;if(g.hasOwnProperty(t)){var e=g[t];delete g[t],e()}},b=function(t){y.call(t.data)};d&&p||(d=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return g[++v]=function(){s("function"==typeof t?t:Function(t),e)},i(v),v},p=function(t){delete g[t]},"process"==n(24)(h)?i=function(t){h.nextTick(a(y,t,1))}:m&&m.now?i=function(t){m.now(a(y,t,1))}:f?(r=new f,o=r.port2,r.port1.onmessage=b,i=a(o.postMessage,o,1)):c.addEventListener&&"function"==typeof postMessage&&!c.importScripts?(i=function(t){c.postMessage(t+"","*")},c.addEventListener("message",b,!1)):i="onreadystatechange"in u("script")?function(t){l.appendChild(u("script")).onreadystatechange=function(){l.removeChild(this),y.call(t)}}:function(t){setTimeout(a(y,t,1),0)}),t.exports={set:d,clear:p}},function(t,e,n){var i=n(50),r=Math.min;t.exports=function(t){return t>0?r(i(t),9007199254740991):0}},function(t,e){},function(t,e,n){"use strict";var i=n(152)(!0);n(60)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=i(e,n),this._i+=t.length,{value:t,done:!1})})},function(t,e,n){n(156);for(var i=n(7),r=n(18),o=n(26),a=n(9)("toStringTag"),s="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),l=0;l<s.length;l++){var u=s[l],c=i[u],h=c&&c.prototype;h&&!h[a]&&r(h,a,u),o[u]=o.Array}},function(t,e){!function(){"use strict";var e="undefined"!=typeof window&&void 0!==window.document?window.document:{},n=void 0!==t&&t.exports,i="undefined"!=typeof Element&&"ALLOW_KEYBOARD_INPUT"in Element,r=function(){for(var t,n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],i=0,r=n.length,o={};i<r;i++)if((t=n[i])&&t[1]in e){for(i=0;i<t.length;i++)o[n[0][i]]=t[i];return o}return!1}(),o={change:r.fullscreenchange,error:r.fullscreenerror},a={request:function(t){var n=r.requestFullscreen;t=t||e.documentElement,/ Version\/5\.1(?:\.\d+)? Safari\//.test(navigator.userAgent)?t[n]():t[n](i?Element.ALLOW_KEYBOARD_INPUT:{})},exit:function(){e[r.exitFullscreen]()},toggle:function(t){this.isFullscreen?this.exit():this.request(t)},onchange:function(t){this.on("change",t)},onerror:function(t){this.on("error",t)},on:function(t,n){var i=o[t];i&&e.addEventListener(i,n,!1)},off:function(t,n){var i=o[t];i&&e.removeEventListener(i,n,!1)},raw:r};if(!r)return void(n?t.exports=!1:window.screenfull=!1);Object.defineProperties(a,{isFullscreen:{get:function(){return Boolean(e[r.fullscreenElement])}},element:{enumerable:!0,get:function(){return e[r.fullscreenElement]}},enabled:{enumerable:!0,get:function(){return Boolean(e[r.fullscreenEnabled])}}}),n?t.exports=a:window.screenfull=a}()},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=i(r),a=n(4),s=i(a),l=n(1),u=i(l),c=n(83),h=i(c),d=n(84),p=i(d),f=n(80),m=i(f),v=n(81),g=i(v),y=n(85),b=i(y),_=n(82),w=(i(_),n(86)),T=i(w),x=function(){function t(e,n,i){(0,o.default)(this,t);var r=this,a=u.default.dom.$("video",n);r.settings=new b.default(a,i,n),r.prepare=new p.default(a,r.settings,n,r),a.dataset.source&&(a.src=a.dataset.source),r.prepare.isThereAnyPrePlayingPlugins()?r.initPrePlayingPlugins(a,r.settings,n):r.initPlayer(a,r.settings,n)}return(0,s.default)(t,[{key:"initPrePlayingPlugins",value:function(t,e,n){this.prepare.isThereErrorPluginConfig()&&(this.errorPages=new g.default(t,e,n)),this.prepare.isThereCountdownPluginConfig()&&(this.countDown=new m.default(t,e,n))}},{key:"initPlayer",value:function(t,e,n){var i=T.default.getRandomId();u.default.dom.setAttribute(t,"id",i),this.player=(0,u.default)(i,e.videojs).ready(function(){this.container_=n,window.pla=this,new h.default(this,e,n)})}}]),t}();e.default=x},function(t,e){},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=i(r),a=n(4),s=i(a),l=n(1),u=(i(l),function(){function t(e,n,i){(0,o.default)(this,t),this.initPlugin();var r=null,a=e.dataset.publishAt;if(e.dataset.countdown&&e.dataset.countdown>0)r=e.dataset.countdown,a=(new Date).getTime()+1e3*parseInt(e.dataset.countdown);else{var s=new moment(a);s=new moment(s.valueOf()-126e5-60*s.zone()*1e3),a=new Date(s.toISOString()),r=a.valueOf()-(new moment).valueOf()}if(r>0){var l=function(t){var e=t.match(f),n={};return h.forEach(function(t,i){e&&e[i]&&(n[t]=e[i])}),n},u=function(t,e){var n=[];return h.forEach(function(i){t[i]!==e[i]&&n.push(i)}),n};n&&n.title.enabled&&$(i).append($('<span class="video-js--video-title">'+n.title.text+"</span>")),$(i).addClass("vjs-player--countdown-mode");var c=$('<div class="vjs-countdown"><div  class="vjs-countdown--plot-area"></div><div class="vjs-countdown--message"></div></div>');$(i).append(c),c.find(".vjs-countdown--message").text("ØªØ§ Ù¾Ø®Ø´ Ø§ÛÙ ÙÛØ¯ÛÙ...");var h=["ÙÙØªÙ","Ø±ÙØ²","Ø³Ø§Ø¹Øª","Ø¯ÙÛÙÙ","Ø«Ø§ÙÛÙ"],d="00:00:00:00:00",p="00:00:00:00:00",f=/([0-9]{2})/gi,m=$(".vjs-countdown--plot-area"),v=l(d);return h.forEach(function(t){var e={curr:v[t],next:v[t],label:t},n='<div class="vjs-countdown--time '+e.label+'">\n                      <span class="count curr top">'+e.curr+'</span>\n                      <span class="count next top">'+e.next+'</span>\n                      <span class="count next bottom">'+e.next+'</span>\n                      <span class="count curr bottom">'+e.curr+'</span>\n                      <span class="vjs-countdown--label">'+(e.label.length<6?e.label:e.label.substr(0,3))+"</span>\n                    </div>";m.append(n)}),$(".vjs-countdown--plot-area").countdown(a,function(t){var e,n=t.strftime("%w:%d:%H:%M:%S");n!==p&&(d=p,p=n,e={curr:l(d),next:l(p)},u(e.curr,e.next).forEach(function(t){var n=".%s".replace(/%s/,t),i=m.find(n);i.removeClass("flip"),i.find(".curr").text(e.curr[t]),i.find(".next").text(e.next[t]),setTimeout(function(){i.addClass("flip")},50)}))}).on("finish.countdown",function(){n.countdown.onFinish()}),$(e).addClass("videojs-ready-show"),$(e).removeAttr("controls"),this}$(i).removeClass("vjs-player--countdown-mode"),$(i).find("vjs-countdown").remove()}return(0,s.default)(t,[{key:"initPlugin",value:function(){function t(t){if(t instanceof Date)return t;if(String(t).match(o))return String(t).match(/^[0-9]*$/)&&(t=Number(t)),String(t).match(/\-/)&&(t=String(t).replace(/\-/g,"/")),new Date(t);throw new Error("Couldn't cast `"+t+"` to a date object.")}function e(t){var e=t.toString().replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1");return new RegExp(e)}function n(t){return function(n){var r=n.match(/%(-|!)?[A-Z]{1}(:[^;]+;)?/gi);if(r)for(var o=0,a=r.length;o<a;++o){var l=r[o].match(/%(-|!)?([a-zA-Z]{1})(:[^;]+;)?/),u=e(l[0]),c=l[1]||"",h=l[3]||"",d=null;l=l[2],s.hasOwnProperty(l)&&(d=s[l],d=Number(t[d])),null!==d&&("!"===c&&(d=i(h,d)),""===c&&d<10&&(d="0"+d.toString()),n=n.replace(u,d.toString()))}return n=n.replace(/%%/,"%")}}function i(t,e){var n="s",i="";return t&&(t=t.replace(/(:|;|\s)/gi,"").split(/\,/),1===t.length?n=t[0]:(i=t[0],n=t[1])),Math.abs(e)>1?n:i}var r=[],o=[],a={precision:100,elapse:!1,defer:!1};o.push(/^[0-9]*$/.source),o.push(/([0-9]{1,2}\/){2}[0-9]{4}( [0-9]{1,2}(:[0-9]{2}){2})?/.source),o.push(/[0-9]{4}([\/\-][0-9]{1,2}){2}( [0-9]{1,2}(:[0-9]{2}){2})?/.source),o=new RegExp(o.join("|"));var s={Y:"years",m:"months",n:"daysToMonth",d:"daysToWeek",w:"weeks",W:"weeksToMonth",H:"hours",M:"minutes",S:"seconds",D:"totalDays",I:"totalHours",N:"totalMinutes",T:"totalSeconds"},l=function(t,e,n){this.el=t,this.$el=$(t),this.interval=null,this.offset={},this.options=$.extend({},a),this.instanceNumber=r.length,r.push(this),this.$el.data("countdown-instance",this.instanceNumber),n&&("function"==typeof n?(this.$el.on("update.countdown",n),this.$el.on("stoped.countdown",n),this.$el.on("finish.countdown",n)):this.options=$.extend({},a,n)),this.setFinalDate(e),!1===this.options.defer&&this.start()};$.extend(l.prototype,{start:function(){null!==this.interval&&clearInterval(this.interval);var t=this;this.update(),this.interval=setInterval(function(){t.update.call(t)},this.options.precision)},stop:function(){clearInterval(this.interval),this.interval=null,this.dispatchEvent("stoped")},toggle:function(){this.interval?this.stop():this.start()},pause:function(){this.stop()},resume:function(){this.start()},remove:function(){this.stop.call(this),r[this.instanceNumber]=null,delete this.$el.data().countdownInstance},setFinalDate:function(e){this.finalDate=t(e)},update:function(){if(0===this.$el.closest("html").length)return void this.remove();var t,e=void 0!==$._data(this.el,"events"),n=new Date;t=this.finalDate.getTime()-n.getTime(),t=Math.ceil(t/1e3),t=!this.options.elapse&&t<0?0:Math.abs(t),this.totalSecsLeft!==t&&e&&(this.totalSecsLeft=t,this.elapsed=n>=this.finalDate,this.offset={seconds:this.totalSecsLeft%60,minutes:Math.floor(this.totalSecsLeft/60)%60,hours:Math.floor(this.totalSecsLeft/60/60)%24,days:Math.floor(this.totalSecsLeft/60/60/24)%7,daysToWeek:Math.floor(this.totalSecsLeft/60/60/24)%7,daysToMonth:Math.floor(this.totalSecsLeft/60/60/24%30.4368),weeks:Math.floor(this.totalSecsLeft/60/60/24/7),weeksToMonth:Math.floor(this.totalSecsLeft/60/60/24/7)%4,months:Math.floor(this.totalSecsLeft/60/60/24/30.4368),years:Math.abs(this.finalDate.getFullYear()-n.getFullYear()),totalDays:Math.floor(this.totalSecsLeft/60/60/24),totalHours:Math.floor(this.totalSecsLeft/60/60),totalMinutes:Math.floor(this.totalSecsLeft/60),totalSeconds:this.totalSecsLeft},this.options.elapse||0!==this.totalSecsLeft?this.dispatchEvent("update"):(this.stop(),this.dispatchEvent("finish")))},dispatchEvent:function(t){var e=$.Event(t+".countdown");e.finalDate=this.finalDate,e.elapsed=this.elapsed,e.offset=$.extend({},this.offset),e.strftime=n(this.offset),this.$el.trigger(e)}}),$.fn.countdown=function(){var t=Array.prototype.slice.call(arguments,0);return this.each(function(){var e=$(this).data("countdown-instance");if(void 0!==e){var n=r[e],i=t[0];l.prototype.hasOwnProperty(i)?n[i].apply(n,t.slice(1)):null===String(i).match(/^[$A-Z_][0-9A-Z_$]*$/i)?(n.setFinalDate.call(n,i),n.start()):$.error("Method %s does not exist on jQuery.countdown".replace(/\%s/gi,i))}else new l(this,t[0],t[1])})}}}]),t}());e.default=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),r=function(t){return t&&t.__esModule?t:{default:t}}(i),o=function t(e,n,i){(0,r.default)(this,t),$(i).append('\n            <div class="vjs-error-page-box">\n                <div class="vjs-error-page-bo--noise-layer"></div>\n                <div class="vjs-error-page-bo--dark-layer"></div>\n                <div class="vjs-error-page-box--content">\n                    <div class="vjs-error-page-box--artwork">\n                        <i class="vjs-icon-error-sign"></i>\n                    </div>\n                    <h3>'+e.dataset.errorStatus+"</h3>\n                    <h6>"+e.dataset.error+"</h6>\n                </div>\n            </div>\n        ")};e.default=o},function(t,e,n){"use strict";var i=n(1);(function(t){return t&&t.__esModule?t:{default:t}})(i).default.addLanguage("fa",{Auto:"Ø®ÙØ¯Ú©Ø§Ø±",Replay:"Ù¾Ø®Ø´ ÙØ¬Ø¯Ø¯","Close Modal Dialog":"Ø®Ø±ÙØ¬",captions:"Ø²ÛØ±ÙÙÛØ³",resolutionSwitch:"Ú©ÛÙÛØª",share:"Ø§Ø´ØªØ±Ø§Ú©",playbackRate:"Ø³Ø±Ø¹Øª Ù¾Ø®Ø´","Skip in":"Ù¾Ø®Ø´",VR:"ÙØ§ÙØ¹ÛØª ÙØ¬Ø§Ø²Û",Quality:"Ú©ÛÙÛØª",Play:"Ù¾Ø®Ø´",Share:"Ø§Ø´ØªØ±Ø§Ú©",Settings:"ØªÙØ¸ÛÙØ§Øª",Reset:"ØªÙØ¸ÛÙØ§Øª Ù¾ÛØ´ ÙØ±Ø¶","subtitles settings":"ØªÙØ¸ÛÙØ§Øª Ø²ÛØ±ÙÙÛØ³","Seek back {{seconds}} seconds":"{{seconds}} Ø«Ø§ÙÛÙ ÙØ¨Ù","Play Video":"Ù¾Ø®Ø´ ÙÛØ¯ÛÙ",Pause:"ØªÙÙÙ","Current Time":"Ø²ÙØ§Ù Ú¯Ø°Ø´ØªÙ","Duration Time":"Ø²ÙØ§Ù ÙÛØ¯ÛÙ","Remaining Time":"Ø²ÙØ§Ù Ø¨Ø§ÙÛ ÙØ§ÙØ¯Ù","Stream Type":"ÙÙØ¹ ÙÛØ§Ù Ø¯Ø±ÛØ§ÙØªÛ",LIVE:"Ù¾Ø®Ø´ Ø²ÙØ¯Ù",Loaded:"Ø¯Ø±ÛØ§ÙØª Ø´Ø¯Ù",Progress:"Ø±ÙÙØ¯ Ù¾ÛØ´Ø±ÙØª",Fullscreen:"ØªÙØ§Ù ØµÙØ­Ù","Non-Fullscreen":"Ø­Ø§ÙØª ÙØ¹ÙÙÙÛ",Mute:"Ø³Ú©ÙØª",Unmute:"Ù¾Ø®Ø´ ØµØ¯Ø§","Playback Rate":"Ø³Ø±Ø¹Øª Ù¾Ø®Ø´",Subtitles:"Ø²ÛØ±ÙÙÛØ³","subtitles off":"Ø®Ø§ÙÙØ´",OFF:"Ø®Ø§ÙÙØ´",Captions:"Ø²ÛØ±ÙÙÛØ³","captions settings":"ØªÙØ¸ÛÙØ§Øª Ø²ÛØ± ÙÙÛØ³","captions off":"Ø²ÛØ±ÙÙÛØ³ Ø®Ø§ÙÙØ´",Chapters:"ÙØ³ÙØª ÙØ§",Text:"ÙØªÙ",Background:"Ù¾Ø³ Ø²ÙÛÙÙ",Window:"Ù¾ÙØ¬Ø±Ù","Font Size":"Ø§ÙØ¯Ø§Ø²Ù ÙØªÙ","Text Edge Style":"Ø­Ø§ÙØª Ø¯ÙØ± ÙØªÙÙ","Font Family":"Ø§ÙØªØ®Ø§Ø¨ ÙÙÙØª",Defaults:"Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù ØªÙØ¸ÛÙØ§Øª ÙÛØ´ ÙØ±Ø¶",Opaque:"ÙØ§Øª","Semi-Transparent":"ÙÛÙÙ Ø´ÙØ§Ù",Transparent:"Ø´ÙØ§Ù",White:"Ø³ÙÛØ¯",Black:"ÙØ´Ú©Û",Red:"ÙØ±ÙØ²",Green:"Ø³Ø¨Ø²",Blue:"Ø¢Ø¨Û",Yellow:"Ø²Ø±Ø¯",Cyan:"ÙÛØ±ÙØ²Ù Ø§Û",Magenta:"Ø§Ø±ØºÙØ§ÙÛ",None:"ÙÛÚ Ú©Ø¯Ø§Ù",Raised:"Ø­Ø§ÙØª Ø§ÙÙ",Depressed:"Ø­Ø§ÙØª Ø¯ÙÙ",Uniform:"ÙØ±Ù Ø±Ø³ÙÛ",Dropshadow:"Ø³Ø§ÛÙ",Done:"ØªØ§ÛÛØ¯","A network error caused the media download to fail part-way.":"ÙØ´Ú©ÙÛ Ø¯Ø± Ø¯Ø±ÛØ§ÙØª ÙØ§ÛÙ ÙÛØ¯ÛÙ ÙØ¬ÙØ¯ Ø¯Ø§Ø±Ø¯. Ø§ÛÙ ÙØ´Ú©Ù ÙÛ ØªÙØ§ÙØ¯ Ø§Ø² Ø´Ø¨Ú©Ù Ø¨Ø§Ø´Ø¯.","The media could not be loaded, either because the server or network failed or because the format is not supported.":"ÙØ´Ú©ÙÛ Ø¯Ø± Ø¯Ø±ÛØ§ÙØª ÙØ§ÛÙ ÙÛØ¯ÛÙ ÙØ¬ÙØ¯ Ø¯Ø§Ø±Ø¯. Ø§ÛÙ ÙØ´Ú©Ù ÙÛ ØªÙØ§ÙØ¯ Ø§Ø² Ø´Ø¨Ú©Ù Ø¨Ø§Ø´Ø¯.","You aborted the video playback":"Ø´ÙØ§ Ù¾Ø®Ø´ ÙÛØ¯ÛÙ Ø±Ø§ ÙØªÙÙÙ Ú©Ø±Ø¯ÛØ¯.","A network error caused the video download to fail part-way.":"Ø¨Ù Ø¯ÙÛÙ ÙØ´Ú©Ù Ø¯Ø± Ø´Ø¨Ú©Ù Ø¹ÙÙÛØ§Øª Ø¯Ø±ÛØ§ÙØª ÙÛØ¯ÛÙ Ø¨Ø§ ÙØ´Ú©Ù ÙÙØªØ¬Ù Ø´Ø¯Ù Ø§Ø³Øª.","The video could not be loaded, either because the server or network failed or because the format is not supported.":"ÙÛØ¯ÛÙ ÙØ§Ø¨Ù ÙÙØ§ÛØ´ ÙÛØ³Øª Ø¨Ù Ø¯ÙÛÙ Ø®Ø±Ø§Ø¨Û Ø´Ø¨Ú©Ù Ù ÛØ§ ÙØ§ÛÙ.","The video playback was aborted due to a corruption problem or because the video used features your browser did not support.":"ÙÛØ¯ÛÙ ÙØ§Ø¨Ù ÙÙØ§ÛØ´ ÙÛØ³Øª Ø¨Ù Ø¯ÙÛÙ Ø®Ø±Ø§Ø¨Û Ø´Ø¨Ú©Ù Ù ÛØ§ ÙØ§ÛÙ.","No compatible source was found for this video.":"ÙØ§ÛÙ ÙÙØ¨Ø¹ Ø¯ÚØ§Ø± Ø§Ø´Ú©Ø§Ù Ø§Ø³Øª Ù ÙØ§Ø¨Ù Ù¾Ø®Ø´ ÙØ³Øª.","The media playback was aborted due to a corruption problem or because the media used features your browser did not support.":"ÙØ´Ú©ÙÛ Ø¯Ø± Ø¯Ø±ÛØ§ÙØª ÙØ§ÛÙ ÙÛØ¯ÛÙ ÙØ¬ÙØ¯ Ø¯Ø§Ø±Ø¯. Ø§ÛÙ ÙØ´Ú©Ù ÙÛ ØªÙØ§ÙØ¯ Ø§Ø² Ø´Ø¨Ú©Ù Ø¨Ø§Ø´Ø¯."})},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=i(r),a=n(1),s=i(a),l=n(16),u=i(l),c=n(102),h=(i(c),n(98)),d=(i(h),n(93)),p=(i(d),n(99)),f=(i(p),n(100)),m=(i(f),n(106)),v=(i(m),n(97)),g=(i(v),n(94)),y=(i(g),n(105)),b=(i(y),n(103)),_=(i(b),n(96)),w=(i(_),n(95)),T=(i(w),n(101)),x=(i(T),n(92)),E=i(x),S=function t(e,n,i){if((0,o.default)(this,t),n.vast.enabled&&e.adsPlugin(n),n.title.enabled&&e.titlePlugin(n.title),n.unmute.enabled&&e.unmutePlugin(),n.brandLogo.enabled&&e.branLogoPlugin(n.brandLogo),n.seekButton.enabled&&e.seekButtons(n.seekButton),n.share.enabled&&e.sharePlugin(n.share),n.settingsMenu.enabled&&!u.default.isDesktop&&e.settingsPlugin(n),n.panorama.enabled&&new E.default(e,n,i),e.resetPlaybackratePlugin(),n.theaterMode.enabled&&u.default.isDesktop&&e.theaterModePlugin(n.theaterMode),n.playButtonAnimated.enabled&&e.playButtonAnimated(),u.default.isIOS||(e.fullscreenModePlugin(),$(i).find(".vjs-fullscreen-control").hide()),n.tooltip.enabled&&u.default.isDesktop&&e.tippyPlugin(),s.default.dom.addClass(e.el_,"videojs-ready-show"),$(i).find(".vjs-theater-mode-btn").prependTo(".vjs-control-bar"),u.default.isIOS||$(i).find(".vjs-control-settings").prependTo(".vjs-control-bar"),$(i).find(".vjs-fullscreen-mode-btn").prependTo(".vjs-control-bar"),$(i).find(".vjs-play-control").prependTo(".vjs-control-bar"),e.on("ended",function(t){n.onEnded(t,e)}),e.on("loadeddata",function(t){n.onLoadedData(t,e)}),e.on("timeupdate",function(t){n.onTimeUpdate(t,e)}),e.on("play",function(t){n.onPlay(t,e)}),e.on("pause",function(t){n.onPause(t,e)}),n.videojs.autoplay&&e.play(),n.videojs.autoplay&&u.default.isAndroid&&n.panorama.enabled){e.one("loadeddata",function(){e.play(),e.pause(),e.play()});var r=e.getChild("Canvas");window.addEventListener("resize fullscreenchange",function(){r.handleResize()}),e.on("theatermodechanged",function(){r.handleResize()})}$(e.el_).find(".vjs-subs-caps-button").removeAttr("title"),u.default.isDesktop&&$(i).find(".vjs-playback-rate").remove(),u.default.isIOS&&0===$(i).find("track").length&&$(".vjs-subs-caps-button").hide(),u.default.isIOS&&e.on("play",function(){$(".vjs-volume-panel").removeClass("vjs-hidden"),$(".vjs-volume-panel .vjs-mute-control").removeClass("vjs-hidden")})};e.default=S},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=i(r),a=n(4),s=i(a),l=n(16),u=i(l),c=n(1),h=i(c),d=function(){function t(e,n,i,r){var a=this;(0,o.default)(this,t),this.$container=$(i),this.container=i,this.settings=n,this.video=e,this.$player=$(e),this.addInitialClass(e,n,i),this.addCompatibilityClass(e,n,i),this.addCompatibilityProp(e,n,i),this.compatibilityErrors(e,n,i),this.checkMp4MultiResource(e,n,i,r),this.attachEvent(),this.polyfills(),setTimeout(function(){a.addSizeCheckerClass(e,n,i)},100),setTimeout(function(){a.addSizeCheckerClass(e,n,i)},200),setTimeout(function(){a.addSizeCheckerClass(e,n,i)},300),setTimeout(function(){a.addSizeCheckerClass(e,n,i)},500),setTimeout(function(){a.addSizeCheckerClass(e,n,i)},1e3),setTimeout(function(){a.addSizeCheckerClass(e,n,i)},3e3)}return(0,s.default)(t,[{key:"polyfills",value:function(){"NodeList"in window&&!NodeList.prototype.forEach&&(console.info("polyfill for IE11"),NodeList.prototype.forEach=function(t,e){e=e||window;for(var n=0;n<this.length;n++)t.call(e,this[n],n,this)})}},{key:"checkMp4MultiResource",value:function(t,e,n,i){$(t).find("source").length>0&&(i.settings=$.extend(!0,i.settings,{videojs:{plugins:{videoJsResolutionSwitcher:{default:$(t).find("source[default]").attr("res"),dynamicLabel:!0}}}}))}},{key:"isThereAnyPrePlayingPlugins",value:function(){return this.video.dataset.error&&"false"!==this.video.dataset.error||this.video.dataset.countdown&&this.video.dataset.countdown>0||this.video.dataset.publishAt&&"false"!==this.video.dataset.publishAt}},{key:"isThereErrorPluginConfig",value:function(){return this.video.dataset.error&&"false"!==this.video.dataset.error}},{key:"isThereCountdownPluginConfig",value:function(){return this.video.dataset.countdown&&this.video.dataset.countdown>0||this.video.dataset.publishAt&&"false"!==this.video.dataset.publishAt}},{key:"attachEvent",value:function(){var t=this;$(window).resize(function(){t.addSizeCheckerClass()}),$(document).on("mozfullscreenchange webkitfullscreenchange fullscreenchange",function(){t.addSizeCheckerClass()})}},{key:"addInitialClass",value:function(t){this.$container.addClass("fkplayer"),$(t).addClass("video-js")}},{key:"addCompatibilityClass",value:function(t,e,n){u.default.isDesktop&&this.$container.addClass("fkplayer-desktop"),u.default.isMobile&&this.$container.addClass("fkplayer-mobile"),u.default.isiPad&&this.$container.addClass("fkplayer-ipad-mode"),u.default.isIOS&&this.$container.addClass("fkplayer-ios-mode"),u.default.msie&&this.$container.addClass("fkplayer-ie-mode"),"HLS_DVR"==t.dataset.tech&&(this.$player.addClass("vjs-live"),this.$container.addClass("fkplayer-live-dvr"),this.$container.addClass("fkplayer-hls-dvr"),this.$container.addClass("fkplayer-hls")),"HLS"==t.dataset.tech&&this.$container.addClass("fkplayer-hls"),"HLS_LIVE"==t.dataset.tech&&(this.$player.addClass("vjs-live"),this.$container.addClass("fkplayer-live"),this.$container.addClass("fkplayer-hls"))}},{key:"addCompatibilityProp",value:function(){u.default.isAndroid||u.default.isIOS?h.default.dom.setAttribute(this.video,"controls","true"):h.default.dom.setAttribute(this.video,"controls",!1),h.default.dom.setAttribute(this.video,"crossorigin","anonymous"),this.isThereCountdownPluginConfig()||!this.settings.videojs.autoplay&&!this.settings.videojs.autoPlay||!u.default.isMobile||u.default.isSamsungBrowser||(h.default.dom.setAttribute(this.video,"muted","true"),h.default.dom.setAttribute(this.video,"autoplay","true"),h.default.dom.setAttribute(this.video,"preload","true")),u.default.isIOS&&h.default.dom.setAttribute(this.video,"playsinline","playsinline")}},{key:"compatibilityErrors",value:function(t){return!0}},{key:"addSizeCheckerClass",value:function(){var t=this.$player.width();u.default.isIOS&&(t=this.container.offsetWidth),this.$container.removeClass("fkplayer-xxsmall-view").removeClass("fkplayer-xsmall-view").removeClass("fkplayer-small-view").removeClass("fkplayer-medium-view").removeClass("fkplayer-large-view"),t<=300&&this.$container.addClass("fkplayer-xxsmall-view"),t<=360&&this.$container.addClass("fkplayer-xsmall-view"),t>360&&t<500&&this.$container.addClass("fkplayer-small-view"),t>=500&&t<1200&&this.$container.addClass("fkplayer-medium-view"),t>=1200&&this.$container.addClass("fkplayer-large-view")}}]),t}();e.default=d},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=i(r),a=n(4),s=i(a),l=n(16),u=i(l),c=n(90),h=i(c),d=function(){function t(e,n,i){return(0,o.default)(this,t),this.settings=$.extend(!0,h.default,n),this.checkPanorama(e,this.settings,i),this.settings.autoplay&&this.settings.autoPlay&&(this.settings.videojs.autoplay=!0),this.settings&&this.settings.videojs.plugins&&this.settings.videojs.plugins.vastClient&&$(e).is("[panorama]")&&(this.settings.videojs.plugins.vastClient.adsEnabled=!1),u.default.isMobile&&(this.settings.theaterMode.enabled=!1),this.settings}return(0,s.default)(t,[{key:"checkPanorama",value:function(t,e,n){u.default.isMSIE&&parseInt(u.default.browser.version)<=11?this.settings.panorama.enabled=!1:t.getAttribute("panorama")&&(this.settings.panorama.enabled=!0,this.settings.vast.enabled=!1)}}]),t}();e.default=d},function(t,e,n){"use strict";var i={getRandomId:function(){return"videoElem"+(1e4*Math.random()).toString().split(".")[0]}};t.exports=i},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),o=i(r),a=n(0),s=i(a),l=n(4),u=i(l),c=n(6),h=i(c),d=n(5),p=i(d),f=n(1),m=i(f);n(88);var v=m.default.getPlugin("plugin"),g=m.default.getComponent("MenuButton"),y=function(t){function e(t,n){(0,s.default)(this,e);var i=(0,h.default)(this,(e.__proto__||(0,o.default)(e)).call(this,t,n)),r=i,a=document.createElement("span");a.classList.add("vjs-resolution-button-label");var l=m.default.getComponent("MenuItem"),u=m.default.extend(l,{constructor:function(t,e,n){this.onClickListener=n,this.resLevel=e.resLevel,this.label=a,l.call(this,t,e),this.on("click",this.onClick),this.on("tap",this.onClick)},showAsLabel:function(){this.label&&(this.label.innerHTML=this.options_.label)},onClick:function(){-1===this.resLevel?t.hls.nextLevel=-1:t.hls.nextLevel=parseInt(this.resLevel),this.showAsLabel(),this.selected(!0),this.onClickListener(),this.addClass("vjs-selected"),t.userActive(!0),t.trigger("resolutionchange")}}),c=m.default.extend(g,{constructor:function(t,e){g.call(this,t,e),this.label=a,this.label.innerHTML=e.defaultLabel,this.el().appendChild(this.label)},createItems:function(){var e=[],i=t.hls.levels.slice(0),o=i,a=r.getHlsKey(i),s=function(t){e.map(function(e){e.selected(e===t),e.removeClass("vjs-selected")})};for(var l in o)o.hasOwnProperty(l)&&e.push(new u(this.player_,{label:r.getLabel(o,l,a),resLevel:l,src:o[l],customSourcePicker:this.options_.customSourcePicker},s));return e.push(new u(this.player_,{label:n.defaultLabel,resLevel:-1,customSourcePicker:this.options_.customSourcePicker},s)),r.sortMediaList(e,n.sort)}}),d=new c(t,n);return d.el().classList.add("vjs-resolution-button"),d.el().classList.add("vjs-control"),t.controlBar.resolutionSwitcher=t.controlBar.addChild(d),i}return(0,p.default)(e,t),(0,u.default)(e,[{key:"getLabel",value:function(t,e,n){return t[e][n]+"p"}},{key:"getHlsKey",value:function(t){return"height"in t[0]&&t[0].height>0?"height":"bandwidth"}},{key:"sortMediaList",value:function(t,e){return"asc"==e?t.sort(function(t,e){return e.resLevel-t.resLevel}):"desc"==e&&t.sort(function(t,e){return t.resLevel-e.resLevel}),t}}]),e}(v);m.default.registerPlugin("hlsjsSwitch",y),e.default=y},function(t,e){},function(t,e,n){!function(e,n){t.exports=n()}("undefined"!=typeof self&&self,function(){return function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/dist/",e(e.s=9)}([function(t,e,n){"use strict";function i(){}function r(t,e){return e="["+t+"] > "+e}function o(t){var e=self.console[t];return e?function(){for(var n=arguments.length,i=Array(n),o=0;o<n;o++)i[o]=arguments[o];i[0]&&(i[0]=r(t,i[0])),e.apply(self.console,i)}:i}function a(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];n.forEach(function(e){u[e]=t[e]?t[e].bind(t):o(e)})}n.d(e,"a",function(){return c}),n.d(e,"b",function(){return h});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l={trace:i,debug:i,log:i,warn:i,info:i,error:i},u=l,c=function(t){if(!0===t||"object"===(void 0===t?"undefined":s(t))){a(t,"debug","log","info","warn","error");try{u.log()}catch(t){u=l}}else u=l},h=u},function(t,e,n){"use strict";var i={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition"};e.a=i},function(t,e,n){"use strict";n.d(e,"b",function(){return i}),n.d(e,"a",function(){return r});var i={NETWORK_ERROR:"networkError",MEDIA_ERROR:"mediaError",KEY_SYSTEM_ERROR:"keySystemError",MUX_ERROR:"muxError",OTHER_ERROR:"otherError"},r={KEY_SYSTEM_NO_KEYS:"keySystemNoKeys",KEY_SYSTEM_NO_ACCESS:"keySystemNoAccess",KEY_SYSTEM_NO_SESSION:"keySystemNoSession",KEY_SYSTEM_LICENSE_REQUEST_FAILED:"keySystemLicenseRequestFailed",MANIFEST_LOAD_ERROR:"manifestLoadError",MANIFEST_LOAD_TIMEOUT:"manifestLoadTimeOut",MANIFEST_PARSING_ERROR:"manifestParsingError",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"manifestIncompatibleCodecsError",LEVEL_LOAD_ERROR:"levelLoadError",LEVEL_LOAD_TIMEOUT:"levelLoadTimeOut",LEVEL_SWITCH_ERROR:"levelSwitchError",AUDIO_TRACK_LOAD_ERROR:"audioTrackLoadError",AUDIO_TRACK_LOAD_TIMEOUT:"audioTrackLoadTimeOut",FRAG_LOAD_ERROR:"fragLoadError",FRAG_LOAD_TIMEOUT:"fragLoadTimeOut",FRAG_DECRYPT_ERROR:"fragDecryptError",FRAG_PARSING_ERROR:"fragParsingError",REMUX_ALLOC_ERROR:"remuxAllocError",KEY_LOAD_ERROR:"keyLoadError",KEY_LOAD_TIMEOUT:"keyLoadTimeOut",BUFFER_ADD_CODEC_ERROR:"bufferAddCodecError",BUFFER_APPEND_ERROR:"bufferAppendError",BUFFER_APPENDING_ERROR:"bufferAppendingError",BUFFER_STALLED_ERROR:"bufferStalledError",BUFFER_FULL_ERROR:"bufferFullError",BUFFER_SEEK_OVER_HOLE:"bufferSeekOverHole",BUFFER_NUDGE_ON_STALL:"bufferNudgeOnStall",INTERNAL_EXCEPTION:"internalException"}},function(t,e,n){!function(e){var n=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/\;?#]*)?(.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,i=/^([^\/;?#]*)(.*)$/,r=/(?:\/|^)\.(?=\/)/g,o=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,a={buildAbsoluteURL:function(t,e,n){if(n=n||{},t=t.trim(),!(e=e.trim())){if(!n.alwaysNormalize)return t;var r=a.parseURL(t);if(!r)throw new Error("Error trying to parse base URL.");return r.path=a.normalizePath(r.path),a.buildURLFromParts(r)}var o=a.parseURL(e);if(!o)throw new Error("Error trying to parse relative URL.");if(o.scheme)return n.alwaysNormalize?(o.path=a.normalizePath(o.path),a.buildURLFromParts(o)):e;var s=a.parseURL(t);if(!s)throw new Error("Error trying to parse base URL.");if(!s.netLoc&&s.path&&"/"!==s.path[0]){var l=i.exec(s.path);s.netLoc=l[1],s.path=l[2]}s.netLoc&&!s.path&&(s.path="/");var u={scheme:s.scheme,netLoc:o.netLoc,path:null,params:o.params,query:o.query,fragment:o.fragment};if(!o.netLoc&&(u.netLoc=s.netLoc,"/"!==o.path[0]))if(o.path){var c=s.path,h=c.substring(0,c.lastIndexOf("/")+1)+o.path;u.path=a.normalizePath(h)}else u.path=s.path,o.params||(u.params=s.params,o.query||(u.query=s.query));return null===u.path&&(u.path=n.alwaysNormalize?a.normalizePath(o.path):o.path),a.buildURLFromParts(u)},parseURL:function(t){var e=n.exec(t);return e?{scheme:e[1]||"",netLoc:e[2]||"",path:e[3]||"",params:e[4]||"",query:e[5]||"",fragment:e[6]||""}:null},normalizePath:function(t){for(t=t.split("").reverse().join("").replace(r,"");t.length!==(t=t.replace(o,"")).length;);return t.split("").reverse().join("")},buildURLFromParts:function(t){return t.scheme+t.netLoc+t.path+t.params+t.query+t.fragment}};t.exports=a}()},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"b",function(){return o});var r=function(){function t(){i(this,t)}return t.isHeader=function(t,e){return e+10<=t.length&&73===t[e]&&68===t[e+1]&&51===t[e+2]&&t[e+3]<255&&t[e+4]<255&&t[e+6]<128&&t[e+7]<128&&t[e+8]<128&&t[e+9]<128},t.isFooter=function(t,e){return e+10<=t.length&&51===t[e]&&68===t[e+1]&&73===t[e+2]&&t[e+3]<255&&t[e+4]<255&&t[e+6]<128&&t[e+7]<128&&t[e+8]<128&&t[e+9]<128},t.getID3Data=function(e,n){for(var i=n,r=0;t.isHeader(e,n);){r+=10;r+=t._readSize(e,n+6),t.isFooter(e,n+10)&&(r+=10),n+=r}if(r>0)return e.subarray(i,i+r)},t._readSize=function(t,e){var n=0;return n=(127&t[e])<<21,n|=(127&t[e+1])<<14,n|=(127&t[e+2])<<7,n|=127&t[e+3]},t.getTimeStamp=function(e){for(var n=t.getID3Frames(e),i=0;i<n.length;i++){var r=n[i];if(t.isTimeStampFrame(r))return t._readTimeStamp(r)}},t.isTimeStampFrame=function(t){return t&&"PRIV"===t.key&&"com.apple.streaming.transportStreamTimestamp"===t.info},t._getFrameData=function(e){var n=String.fromCharCode(e[0],e[1],e[2],e[3]),i=t._readSize(e,4);return{type:n,size:i,data:e.subarray(10,10+i)}},t.getID3Frames=function(e){for(var n=0,i=[];t.isHeader(e,n);){var r=t._readSize(e,n+6);n+=10;for(var o=n+r;n+8<o;){var a=t._getFrameData(e.subarray(n)),s=t._decodeFrame(a);s&&i.push(s),n+=a.size+10}t.isFooter(e,n)&&(n+=10)}return i},t._decodeFrame=function(e){return"PRIV"===e.type?t._decodePrivFrame(e):"T"===e.type[0]?t._decodeTextFrame(e):"W"===e.type[0]?t._decodeURLFrame(e):void 0},t._readTimeStamp=function(t){if(8===t.data.byteLength){var e=new Uint8Array(t.data),n=1&e[3],i=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return i/=45,n&&(i+=47721858.84),Math.round(i)}},t._decodePrivFrame=function(e){if(!(e.size<2)){var n=t._utf8ArrayToStr(e.data,!0),i=new Uint8Array(e.data.subarray(n.length+1));return{key:e.type,info:n,data:i.buffer}}},t._decodeTextFrame=function(e){if(!(e.size<2)){if("TXXX"===e.type){var n=1,i=t._utf8ArrayToStr(e.data.subarray(n));n+=i.length+1;var r=t._utf8ArrayToStr(e.data.subarray(n));return{key:e.type,info:i,data:r}}var o=t._utf8ArrayToStr(e.data.subarray(1));return{key:e.type,data:o}}},t._decodeURLFrame=function(e){if("WXXX"===e.type){if(e.size<2)return;var n=1,i=t._utf8ArrayToStr(e.data.subarray(n));n+=i.length+1;var r=t._utf8ArrayToStr(e.data.subarray(n));return{key:e.type,info:i,data:r}}var o=t._utf8ArrayToStr(e.data);return{key:e.type,data:o}},t._utf8ArrayToStr=function(t){for(var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.length,i=void 0,r=void 0,o=void 0,a="",s=0;s<n;){if(0===(i=t[s++])&&e)return a;if(0!==i&&3!==i)switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:a+=String.fromCharCode(i);break;case 12:case 13:r=t[s++],a+=String.fromCharCode((31&i)<<6|63&r);break;case 14:r=t[s++],o=t[s++],a+=String.fromCharCode((15&i)<<12|(63&r)<<6|(63&o)<<0)}}return a},t}(),o=r._utf8ArrayToStr;e.a=r},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t){var e=t.byteLength,n=e&&new DataView(t).getUint8(e-1);return n?t.slice(0,e-n):t}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var l=function(){function t(e,n){i(this,t),this.subtle=e,this.aesIV=n}return t.prototype.decrypt=function(t,e){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},e,t)},t}(),u=l,c=function(){function t(e,n){r(this,t),this.subtle=e,this.key=n}return t.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},t}(),h=c,d=function(){function t(){o(this,t),this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}return t.prototype.uint8ArrayToUint32Array_=function(t){for(var e=new DataView(t),n=new Uint32Array(4),i=0;i<4;i++)n[i]=e.getUint32(4*i);return n},t.prototype.initTable=function(){var t=this.sBox,e=this.invSBox,n=this.subMix,i=n[0],r=n[1],o=n[2],a=n[3],s=this.invSubMix,l=s[0],u=s[1],c=s[2],h=s[3],d=new Uint32Array(256),p=0,f=0,m=0;for(m=0;m<256;m++)d[m]=m<128?m<<1:m<<1^283;for(m=0;m<256;m++){var v=f^f<<1^f<<2^f<<3^f<<4;v=v>>>8^255&v^99,t[p]=v,e[v]=p;var g=d[p],y=d[g],b=d[y],_=257*d[v]^16843008*v;i[p]=_<<24|_>>>8,r[p]=_<<16|_>>>16,o[p]=_<<8|_>>>24,a[p]=_,_=16843009*b^65537*y^257*g^16843008*p,l[v]=_<<24|_>>>8,u[v]=_<<16|_>>>16,c[v]=_<<8|_>>>24,h[v]=_,p?(p=g^d[d[d[b^g]]],f^=d[d[f]]):p=f=1}},t.prototype.expandKey=function(t){for(var e=this.uint8ArrayToUint32Array_(t),n=!0,i=0;i<e.length&&n;)n=e[i]===this.key[i],i++;if(!n){this.key=e;var r=this.keySize=e.length;if(4!==r&&6!==r&&8!==r)throw new Error("Invalid aes key size="+r);var o=this.ksRows=4*(r+6+1),a=void 0,s=void 0,l=this.keySchedule=new Uint32Array(o),u=this.invKeySchedule=new Uint32Array(o),c=this.sBox,h=this.rcon,d=this.invSubMix,p=d[0],f=d[1],m=d[2],v=d[3],g=void 0,y=void 0;for(a=0;a<o;a++)a<r?g=l[a]=e[a]:(y=g,a%r==0?(y=y<<8|y>>>24,y=c[y>>>24]<<24|c[y>>>16&255]<<16|c[y>>>8&255]<<8|c[255&y],y^=h[a/r|0]<<24):r>6&&a%r==4&&(y=c[y>>>24]<<24|c[y>>>16&255]<<16|c[y>>>8&255]<<8|c[255&y]),l[a]=g=(l[a-r]^y)>>>0);for(s=0;s<o;s++)a=o-s,y=3&s?l[a]:l[a-4],u[s]=s<4||a<=4?y:p[c[y>>>24]]^f[c[y>>>16&255]]^m[c[y>>>8&255]]^v[c[255&y]],u[s]=u[s]>>>0}},t.prototype.networkToHostOrderSwap=function(t){return t<<24|(65280&t)<<8|(16711680&t)>>8|t>>>24},t.prototype.decrypt=function(t,e,n,i){for(var r=this.keySize+6,o=this.invKeySchedule,s=this.invSBox,l=this.invSubMix,u=l[0],c=l[1],h=l[2],d=l[3],p=this.uint8ArrayToUint32Array_(n),f=p[0],m=p[1],v=p[2],g=p[3],y=new Int32Array(t),b=new Int32Array(y.length),_=void 0,w=void 0,T=void 0,x=void 0,E=void 0,S=void 0,A=void 0,C=void 0,k=void 0,M=void 0,L=void 0,R=void 0,P=void 0,D=void 0,I=this.networkToHostOrderSwap;e<y.length;){for(k=I(y[e]),M=I(y[e+1]),L=I(y[e+2]),R=I(y[e+3]),E=k^o[0],S=R^o[1],A=L^o[2],C=M^o[3],P=4,D=1;D<r;D++)_=u[E>>>24]^c[S>>16&255]^h[A>>8&255]^d[255&C]^o[P],w=u[S>>>24]^c[A>>16&255]^h[C>>8&255]^d[255&E]^o[P+1],T=u[A>>>24]^c[C>>16&255]^h[E>>8&255]^d[255&S]^o[P+2],x=u[C>>>24]^c[E>>16&255]^h[S>>8&255]^d[255&A]^o[P+3],E=_,S=w,A=T,C=x,P+=4;_=s[E>>>24]<<24^s[S>>16&255]<<16^s[A>>8&255]<<8^s[255&C]^o[P],w=s[S>>>24]<<24^s[A>>16&255]<<16^s[C>>8&255]<<8^s[255&E]^o[P+1],T=s[A>>>24]<<24^s[C>>16&255]<<16^s[E>>8&255]<<8^s[255&S]^o[P+2],x=s[C>>>24]<<24^s[E>>16&255]<<16^s[S>>8&255]<<8^s[255&A]^o[P+3],P+=3,b[e]=I(_^f),b[e+1]=I(x^m),b[e+2]=I(T^v),b[e+3]=I(w^g),f=k,m=M,v=L,g=R,e+=4}return i?a(b.buffer):b.buffer},t.prototype.destroy=function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0},t}(),p=d,f=n(2),m=n(0),v=function(){function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=i.removePKCS7Padding,o=void 0===r||r;if(s(this,t),this.logEnabled=!0,this.observer=e,this.config=n,this.removePKCS7Padding=o,o)try{var a=crypto||self.crypto;this.subtle=a.subtle||a.webkitSubtle}catch(t){}this.disableWebCrypto=!this.subtle}return t.prototype.isSync=function(){return this.disableWebCrypto&&this.config.enableSoftwareAES},t.prototype.decrypt=function(t,e,n,i){var r=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){this.logEnabled&&(m.b.log("JS AES decrypt"),this.logEnabled=!1);var o=this.decryptor;o||(this.decryptor=o=new p),o.expandKey(e),i(o.decrypt(t,0,n,this.removePKCS7Padding))}else{this.logEnabled&&(m.b.log("WebCrypto AES decrypt"),this.logEnabled=!1);var a=this.subtle;this.key!==e&&(this.key=e,this.fastAesKey=new h(a,e)),this.fastAesKey.expandKey().then(function(o){new u(a,n).decrypt(t,o).catch(function(o){r.onWebCryptoError(o,t,e,n,i)}).then(function(t){i(t)})}).catch(function(o){r.onWebCryptoError(o,t,e,n,i)})}},t.prototype.onWebCryptoError=function(t,e,n,i,r){this.config.enableSoftwareAES?(m.b.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(e,n,i,r)):(m.b.error("decrypting error : "+t.message),this.observer.trigger(Event.ERROR,{type:f.b.MEDIA_ERROR,details:f.a.FRAG_DECRYPT_ERROR,fatal:!0,reason:t.message}))},t.prototype.destroy=function(){var t=this.decryptor;t&&(t.destroy(),this.decryptor=void 0)},t}();e.a=v},function(t,e){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(t){return"function"==typeof t}function r(t){return"number"==typeof t}function o(t){return"object"==typeof t&&null!==t}function a(t){return void 0===t}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(t){if(!r(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},n.prototype.emit=function(t){var e,n,r,s,l,u;if(this._events||(this._events={}),"error"===t&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;var c=new Error('Uncaught, unspecified "error" event. ('+e+")");throw c.context=e,c}if(n=this._events[t],a(n))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),n.apply(this,s)}else if(o(n))for(s=Array.prototype.slice.call(arguments,1),u=n.slice(),r=u.length,l=0;l<r;l++)u[l].apply(this,s);return!0},n.prototype.addListener=function(t,e){var r;if(!i(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,i(e.listener)?e.listener:e),this._events[t]?o(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,o(this._events[t])&&!this._events[t].warned&&(r=a(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&r>0&&this._events[t].length>r&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(t,e){function n(){this.removeListener(t,n),r||(r=!0,e.apply(this,arguments))}if(!i(e))throw TypeError("listener must be a function");var r=!1;return n.listener=e,this.on(t,n),this},n.prototype.removeListener=function(t,e){var n,r,a,s;if(!i(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(n=this._events[t],a=n.length,r=-1,n===e||i(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(o(n)){for(s=a;s-- >0;)if(n[s]===e||n[s].listener&&n[s].listener===e){r=s;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},n.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[t],i(n))this.removeListener(t,n);else if(n)for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},n.prototype.listeners=function(t){return this._events&&this._events[t]?i(this._events[t])?[this._events[t]]:this._events[t].slice():[]},n.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(i(e))return 1;if(e)return e.length}return 0},n.listenerCount=function(t,e){return t.listenerCount(e)}},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(0),o=n(1),a=Math.pow(2,32)-1,s=function(){function t(e,n){i(this,t),this.observer=e,this.remuxer=n}return t.prototype.resetTimeStamp=function(t){this.initPTS=t},t.prototype.resetInitSegment=function(e,n,i,r){if(e&&e.byteLength){var a=this.initData=t.parseInitSegment(e);null==n&&(n="mp4a.40.5"),null==i&&(i="avc1.42e01e");var s={};a.audio&&a.video?s.audiovideo={container:"video/mp4",codec:n+","+i,initSegment:r?e:null}:(a.audio&&(s.audio={container:"audio/mp4",codec:n,initSegment:r?e:null}),a.video&&(s.video={container:"video/mp4",codec:i,initSegment:r?e:null})),this.observer.trigger(o.a.FRAG_PARSING_INIT_SEGMENT,{tracks:s})}else n&&(this.audioCodec=n),i&&(this.videoCodec=i)},t.probe=function(e){return t.findBox({data:e,start:0,end:Math.min(e.length,16384)},["moof"]).length>0},t.bin2str=function(t){return String.fromCharCode.apply(null,t)},t.readUint16=function(t,e){t.data&&(e+=t.start,t=t.data);var n=t[e]<<8|t[e+1];return n<0?65536+n:n},t.readUint32=function(t,e){t.data&&(e+=t.start,t=t.data);var n=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3];return n<0?4294967296+n:n},t.writeUint32=function(t,e,n){t.data&&(e+=t.start,t=t.data),t[e]=n>>24,t[e+1]=n>>16&255,t[e+2]=n>>8&255,t[e+3]=255&n},t.findBox=function(e,n){var i=[],r=void 0,o=void 0,a=void 0,s=void 0,l=void 0,u=void 0,c=void 0;if(e.data?(u=e.start,s=e.end,e=e.data):(u=0,s=e.byteLength),!n.length)return null;for(r=u;r<s;)o=t.readUint32(e,r),a=t.bin2str(e.subarray(r+4,r+8)),c=o>1?r+o:s,a===n[0]&&(1===n.length?i.push({data:e,start:r+8,end:c}):(l=t.findBox({data:e,start:r+8,end:c},n.slice(1)),l.length&&(i=i.concat(l)))),r=c;return i},t.parseSegmentIndex=function(e){var n=t.findBox(e,["moov"])[0],i=n?n.end:null,r=0,o=t.findBox(e,["sidx"]),a=void 0;if(!o||!o[0])return null;a=[],o=o[0];var s=o.data[0];r=0===s?8:16;var l=t.readUint32(o,r);r+=4;r+=0===s?8:16,r+=2;var u=o.end+0,c=t.readUint16(o,r);r+=2;for(var h=0;h<c;h++){var d=r,p=t.readUint32(o,d);d+=4;var f=2147483647&p;if(1===(2147483648&p)>>>31)return void console.warn("SIDX has hierarchical references (not supported)");var m=t.readUint32(o,d);d+=4,a.push({referenceSize:f,subsegmentDuration:m,info:{duration:m/l,start:u,end:u+f-1}}),u+=f,d+=4,r=d}return{earliestPresentationTime:0,timescale:l,version:s,referencesCount:c,references:a,moovEndOffset:i}},t.parseInitSegment=function(e){var n=[];return t.findBox(e,["moov","trak"]).forEach(function(e){var i=t.findBox(e,["tkhd"])[0];if(i){var o=i.data[i.start],a=0===o?12:20,s=t.readUint32(i,a),l=t.findBox(e,["mdia","mdhd"])[0];if(l){o=l.data[l.start],a=0===o?12:20;var u=t.readUint32(l,a),c=t.findBox(e,["mdia","hdlr"])[0];if(c){var h=t.bin2str(c.data.subarray(c.start+8,c.start+12)),d={soun:"audio",vide:"video"}[h];if(d){var p=t.findBox(e,["mdia","minf","stbl","stsd"]);if(p.length){p=p[0];var f=t.bin2str(p.data.subarray(p.start+12,p.start+16));r.b.log("MP4Demuxer:"+d+":"+f+" found")}n[s]={timescale:u,type:d},n[d]={timescale:u,id:s}}}}}}),n},t.getStartDTS=function(e,n){var i=void 0,r=void 0,o=void 0;return i=t.findBox(n,["moof","traf"]),r=[].concat.apply([],i.map(function(n){return t.findBox(n,["tfhd"]).map(function(i){var r=void 0,o=void 0;return r=t.readUint32(i,4),o=e[r].timescale||9e4,t.findBox(n,["tfdt"]).map(function(e){var n=void 0,i=void 0;return n=e.data[e.start],i=t.readUint32(e,4),1===n&&(i*=Math.pow(2,32),i+=t.readUint32(e,8)),i})[0]/o})})),o=Math.min.apply(null,r),isFinite(o)?o:0},t.offsetStartDTS=function(e,n,i){t.findBox(n,["moof","traf"]).map(function(n){return t.findBox(n,["tfhd"]).map(function(r){var o=t.readUint32(r,4),s=e[o].timescale||9e4;t.findBox(n,["tfdt"]).map(function(e){var n=e.data[e.start],r=t.readUint32(e,4);if(0===n)t.writeUint32(e,4,r-i*s);else{r*=Math.pow(2,32),r+=t.readUint32(e,8),r-=i*s,r=Math.max(r,0);var o=Math.floor(r/(a+1)),l=Math.floor(r%(a+1));t.writeUint32(e,4,o),t.writeUint32(e,8,l)}})})})},t.prototype.append=function(e,n,i,r){var a=this.initData;a||(this.resetInitSegment(e,this.audioCodec,this.videoCodec,!1),a=this.initData);var s=void 0,l=this.initPTS;if(void 0===l){var u=t.getStartDTS(a,e);this.initPTS=l=u-n,this.observer.trigger(o.a.INIT_PTS_FOUND,{initPTS:l})}t.offsetStartDTS(a,e,l),s=t.getStartDTS(a,e),this.remuxer.remux(a.audio,a.video,null,null,s,i,r,e)},t.prototype.destroy=function(){},t}();e.a=s},function(t,e,n){"use strict";function i(t,e,n,i){var r=void 0,o=void 0,a=void 0,s=void 0,l=void 0,u=navigator.userAgent.toLowerCase(),c=i,h=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];return r=1+((192&e[n+2])>>>6),(o=(60&e[n+2])>>>2)>h.length-1?void t.trigger(Event.ERROR,{type:E.b.MEDIA_ERROR,details:E.a.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+o}):(s=(1&e[n+2])<<2,s|=(192&e[n+3])>>>6,A.b.log("manifest codec:"+i+",ADTS data:type:"+r+",sampleingIndex:"+o+"["+h[o]+"Hz],channelConfig:"+s),/firefox/i.test(u)?o>=6?(r=5,l=new Array(4),a=o-3):(r=2,l=new Array(2),a=o):-1!==u.indexOf("android")?(r=2,l=new Array(2),a=o):(r=5,l=new Array(4),i&&(-1!==i.indexOf("mp4a.40.29")||-1!==i.indexOf("mp4a.40.5"))||!i&&o>=6?a=o-3:((i&&-1!==i.indexOf("mp4a.40.2")&&(o>=6&&1===s||/vivaldi/i.test(u))||!i&&1===s)&&(r=2,l=new Array(2)),a=o)),l[0]=r<<3,l[0]|=(14&o)>>1,l[1]|=(1&o)<<7,l[1]|=s<<3,5===r&&(l[1]|=(14&a)>>1,l[2]=(1&a)<<7,l[2]|=8,l[3]=0),{config:l,samplerate:h[o],channelCount:s,codec:"mp4a.40."+r,manifestCodec:c})}function r(t,e){return 255===t[e]&&240==(246&t[e+1])}function o(t,e){return 1&t[e+1]?7:9}function a(t,e){return(3&t[e+3])<<11|t[e+4]<<3|(224&t[e+5])>>>5}function s(t,e){return!!(e+1<t.length&&r(t,e))}function l(t,e){if(e+1<t.length&&r(t,e)){var n=o(t,e),i=n;e+5<t.length&&(i=a(t,e));var s=e+i;if(s===t.length||s+1<t.length&&r(t,s))return!0}return!1}function u(t,e,n,r,o){if(!t.samplerate){var a=i(e,n,r,o);t.config=a.config,t.samplerate=a.samplerate,t.channelCount=a.channelCount,t.codec=a.codec,t.manifestCodec=a.manifestCodec,A.b.log("parsed codec:"+t.codec+",rate:"+a.samplerate+",nb channel:"+a.channelCount)}}function c(t){return 9216e4/t}function h(t,e,n,i,r){var s=void 0,l=void 0,u=void 0,c=t.length;if(s=o(t,e),l=a(t,e),(l-=s)>0&&e+s+l<=c)return u=n+i*r,{headerLength:s,frameLength:l,stamp:u}}function d(t,e,n,i,r){var o=c(t.samplerate),a=h(e,n,i,r,o);if(a){var s=a.stamp,l=a.headerLength,u=a.frameLength,d={unit:e.subarray(n+l,n+l+u),pts:s,dts:s};return t.samples.push(d),t.len+=u,{sample:d,length:u+l}}}function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function v(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function g(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function b(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function w(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function T(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var x=n(1),E=n(2),S=n(5),A=n(0),C=n(4),k=function(){function t(e,n,i){p(this,t),this.observer=e,this.config=i,this.remuxer=n}return t.prototype.resetInitSegment=function(t,e,n,i){this._audioTrack={container:"audio/adts",type:"audio",id:0,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:e,duration:i,inputTimeScale:9e4}},t.prototype.resetTimeStamp=function(){},t.probe=function(t){if(!t)return!1;for(var e=C.a.getID3Data(t,0)||[],n=e.length,i=t.length;n<i;n++)if(l(t,n))return A.b.log("ADTS sync word found !"),!0;return!1},t.prototype.append=function(t,e,n,i){for(var r=this._audioTrack,o=C.a.getID3Data(t,0)||[],a=C.a.getTimeStamp(o),l=a?90*a:9e4*e,c=0,h=l,p=t.length,f=o.length,m=[{pts:h,dts:h,data:o}];f<p-1;)if(s(t,f)&&f+5<p){u(r,this.observer,t,f,r.manifestCodec);var v=d(r,t,f,l,c);if(!v){A.b.log("Unable to parse AAC frame");break}f+=v.length,h=v.sample.pts,c++}else C.a.isHeader(t,f)?(o=C.a.getID3Data(t,f),m.push({pts:h,dts:h,data:o}),f+=o.length):f++;this.remuxer.remux(r,{samples:[]},{samples:m,inputTimeScale:9e4},{samples:[]},e,n,i)},t.prototype.destroy=function(){},t}(),M=k,L=n(7),R={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients:[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot:[0,1,1,4],appendFrame:function(t,e,n,i,r){if(!(n+24>e.length)){var o=this.parseHeader(e,n);if(o&&n+o.frameLength<=e.length){var a=9e4*o.samplesPerFrame/o.sampleRate,s=i+r*a,l={unit:e.subarray(n,n+o.frameLength),pts:s,dts:s};return t.config=[],t.channelCount=o.channelCount,t.samplerate=o.sampleRate,t.samples.push(l),t.len+=o.frameLength,{sample:l,length:o.frameLength}}}},parseHeader:function(t,e){var n=t[e+1]>>3&3,i=t[e+1]>>1&3,r=t[e+2]>>4&15,o=t[e+2]>>2&3,a=t[e+2]>>1&1;if(1!==n&&0!==r&&15!==r&&3!==o){var s=3===n?3-i:3===i?3:4,l=1e3*R.BitratesMap[14*s+r-1],u=3===n?0:2===n?1:2,c=R.SamplingRateMap[3*u+o],h=t[e+3]>>6==3?1:2,d=R.SamplesCoefficients[n][i],p=R.BytesInSlot[i],f=8*d*p;return{sampleRate:c,channelCount:h,frameLength:parseInt(d*l/c+a,10)*p,samplesPerFrame:f}}},isHeaderPattern:function(t,e){return 255===t[e]&&224==(224&t[e+1])&&0!=(6&t[e+1])},isHeader:function(t,e){return!!(e+1<t.length&&this.isHeaderPattern(t,e))},probe:function(t,e){if(e+1<t.length&&this.isHeaderPattern(t,e)){var n=this.parseHeader(t,e),i=4;n&&n.frameLength&&(i=n.frameLength);var r=e+i;if(r===t.length||r+1<t.length&&this.isHeaderPattern(t,r))return!0}return!1}},P=R,D=function(){function t(e){f(this,t),this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}return t.prototype.loadWord=function(){var t=this.data,e=this.bytesAvailable,n=t.byteLength-e,i=new Uint8Array(4),r=Math.min(4,e);if(0===r)throw new Error("no bytes available");i.set(t.subarray(n,n+r)),this.word=new DataView(i.buffer).getUint32(0),this.bitsAvailable=8*r,this.bytesAvailable-=r},t.prototype.skipBits=function(t){var e=void 0;this.bitsAvailable>t?(this.word<<=t,this.bitsAvailable-=t):(t-=this.bitsAvailable,e=t>>3,t-=e>>3,this.bytesAvailable-=e,this.loadWord(),this.word<<=t,this.bitsAvailable-=t)},t.prototype.readBits=function(t){var e=Math.min(this.bitsAvailable,t),n=this.word>>>32-e;return t>32&&A.b.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=e,this.bitsAvailable>0?this.word<<=e:this.bytesAvailable>0&&this.loadWord(),e=t-e,e>0&&this.bitsAvailable?n<<e|this.readBits(e):n},t.prototype.skipLZ=function(){var t=void 0;for(t=0;t<this.bitsAvailable;++t)if(0!=(this.word&2147483648>>>t))return this.word<<=t,this.bitsAvailable-=t,t;return this.loadWord(),t+this.skipLZ()},t.prototype.skipUEG=function(){this.skipBits(1+this.skipLZ())},t.prototype.skipEG=function(){this.skipBits(1+this.skipLZ())},t.prototype.readUEG=function(){var t=this.skipLZ();return this.readBits(t+1)-1},t.prototype.readEG=function(){var t=this.readUEG();return 1&t?1+t>>>1:-1*(t>>>1)},t.prototype.readBoolean=function(){return 1===this.readBits(1)},t.prototype.readUByte=function(){return this.readBits(8)},t.prototype.readUShort=function(){return this.readBits(16)},t.prototype.readUInt=function(){return this.readBits(32)},t.prototype.skipScalingList=function(t){var e=8,n=8,i=void 0,r=void 0;for(i=0;i<t;i++)0!==n&&(r=this.readEG(),n=(e+r+256)%256),e=0===n?e:n},t.prototype.readSPS=function(){var t=0,e=0,n=0,i=0,r=void 0,o=void 0,a=void 0,s=void 0,l=void 0,u=void 0,c=void 0,h=this.readUByte.bind(this),d=this.readBits.bind(this),p=this.readUEG.bind(this),f=this.readBoolean.bind(this),m=this.skipBits.bind(this),v=this.skipEG.bind(this),g=this.skipUEG.bind(this),y=this.skipScalingList.bind(this);if(h(),r=h(),d(5),m(3),h(),g(),100===r||110===r||122===r||244===r||44===r||83===r||86===r||118===r||128===r){var b=p();if(3===b&&m(1),g(),g(),m(1),f())for(u=3!==b?8:12,c=0;c<u;c++)f()&&y(c<6?16:64)}g();var _=p();if(0===_)p();else if(1===_)for(m(1),v(),v(),o=p(),c=0;c<o;c++)v();g(),m(1),a=p(),s=p(),l=d(1),0===l&&m(1),m(1),f()&&(t=p(),e=p(),n=p(),i=p());var w=[1,1];if(f()&&f()){switch(h()){case 1:w=[1,1];break;case 2:w=[12,11];break;case 3:w=[10,11];break;case 4:w=[16,11];break;case 5:w=[40,33];break;case 6:w=[24,11];break;case 7:w=[20,11];break;case 8:w=[32,11];break;case 9:w=[80,33];break;case 10:w=[18,11];break;case 11:w=[15,11];break;case 12:w=[64,33];break;case 13:w=[160,99];break;case 14:w=[4,3];break;case 15:w=[3,2];break;case 16:w=[2,1];break;case 255:w=[h()<<8|h(),h()<<8|h()]}}return{width:Math.ceil(16*(a+1)-2*t-2*e),height:(2-l)*(s+1)*16-(l?2:4)*(n+i),pixelRatio:w}},t.prototype.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},t}(),I=D,F=function(){function t(e,n,i,r){m(this,t),this.decryptdata=i,this.discardEPB=r,this.decrypter=new S.a(e,n,{removePKCS7Padding:!1})}return t.prototype.decryptBuffer=function(t,e){this.decrypter.decrypt(t,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,e)},t.prototype.decryptAacSample=function(t,e,n,i){var r=t[e].unit,o=r.subarray(16,r.length-r.length%16),a=o.buffer.slice(o.byteOffset,o.byteOffset+o.length),s=this;this.decryptBuffer(a,function(o){o=new Uint8Array(o),r.set(o,16),i||s.decryptAacSamples(t,e+1,n)})},t.prototype.decryptAacSamples=function(t,e,n){for(;;e++){if(e>=t.length)return void n();if(!(t[e].unit.length<32)){var i=this.decrypter.isSync();if(this.decryptAacSample(t,e,n,i),!i)return}}},t.prototype.getAvcEncryptedData=function(t){for(var e=16*Math.floor((t.length-48)/160)+16,n=new Int8Array(e),i=0,r=32;r<=t.length-16;r+=160,i+=16)n.set(t.subarray(r,r+16),i);return n},t.prototype.getAvcDecryptedUnit=function(t,e){e=new Uint8Array(e);for(var n=0,i=32;i<=t.length-16;i+=160,n+=16)t.set(e.subarray(n,n+16),i);return t},t.prototype.decryptAvcSample=function(t,e,n,i,r,o){var a=this.discardEPB(r.data),s=this.getAvcEncryptedData(a),l=this;this.decryptBuffer(s.buffer,function(s){r.data=l.getAvcDecryptedUnit(a,s),o||l.decryptAvcSamples(t,e,n+1,i)})},t.prototype.decryptAvcSamples=function(t,e,n,i){for(;;e++,n=0){if(e>=t.length)return void i();for(var r=t[e].units;!(n>=r.length);n++){var o=r[n];if(!(o.length<=48||1!==o.type&&5!==o.type)){var a=this.decrypter.isSync();if(this.decryptAvcSample(t,e,n,i,o,a),!a)return}}}},t}(),O=F,N={video:0,audio:1,id3:2,text:3},U=function(){function t(e,n,i,r){v(this,t),this.observer=e,this.config=i,this.typeSupported=r,this.remuxer=n,this.sampleAes=null}return t.prototype.setDecryptData=function(t){null!=t&&null!=t.key&&"SAMPLE-AES"===t.method?this.sampleAes=new O(this.observer,this.config,t,this.discardEPB):this.sampleAes=null},t.probe=function(e){var n=t._syncOffset(e);return!(n<0)&&(n&&A.b.warn("MPEG2-TS detected but first sync word found @ offset "+n+", junk ahead ?"),!0)},t._syncOffset=function(t){for(var e=Math.min(1e3,t.length-564),n=0;n<e;){if(71===t[n]&&71===t[n+188]&&71===t[n+376])return n;n++}return-1},t.createTrack=function(t,e){return{container:"video"===t||"audio"===t?"video/mp2t":void 0,type:t,id:N[t],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],len:0,dropped:"video"===t?0:void 0,isAAC:"audio"===t||void 0,duration:"audio"===t?e:void 0}},t.prototype.resetInitSegment=function(e,n,i,r){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=t.createTrack("video",r),this._audioTrack=t.createTrack("audio",r),this._id3Track=t.createTrack("id3",r),this._txtTrack=t.createTrack("text",r),this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=n,this.videoCodec=i,this._duration=r},t.prototype.resetTimeStamp=function(){},t.prototype.append=function(e,n,i,r){var o=void 0,a=e.length,s=void 0,l=void 0,u=void 0,c=void 0,h=!1;this.contiguous=i;var d=this.pmtParsed,p=this._avcTrack,f=this._audioTrack,m=this._id3Track,v=p.pid,g=f.pid,y=m.pid,b=this._pmtId,_=p.pesData,w=f.pesData,T=m.pesData,S=this._parsePAT,C=this._parsePMT,k=this._parsePES,M=this._parseAVCPES.bind(this),L=this._parseAACPES.bind(this),R=this._parseMPEGPES.bind(this),P=this._parseID3PES.bind(this),D=t._syncOffset(e);for(a-=(a+D)%188,o=D;o<a;o+=188)if(71===e[o]){if(s=!!(64&e[o+1]),l=((31&e[o+1])<<8)+e[o+2],(48&e[o+3])>>4>1){if((u=o+5+e[o+4])===o+188)continue}else u=o+4;switch(l){case v:s&&(_&&(c=k(_))&&void 0!==c.pts&&M(c,!1),_={data:[],size:0}),_&&(_.data.push(e.subarray(u,o+188)),_.size+=o+188-u);break;case g:s&&(w&&(c=k(w))&&void 0!==c.pts&&(f.isAAC?L(c):R(c)),w={data:[],size:0}),w&&(w.data.push(e.subarray(u,o+188)),w.size+=o+188-u);break;case y:s&&(T&&(c=k(T))&&void 0!==c.pts&&P(c),T={data:[],size:0}),T&&(T.data.push(e.subarray(u,o+188)),T.size+=o+188-u);break;case 0:s&&(u+=e[u]+1),b=this._pmtId=S(e,u);break;case b:s&&(u+=e[u]+1);var I=C(e,u,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,null!=this.sampleAes);v=I.avc,v>0&&(p.pid=v),g=I.audio,g>0&&(f.pid=g,f.isAAC=I.isAAC),y=I.id3,y>0&&(m.pid=y),h&&!d&&(A.b.log("reparse from beginning"),h=!1,o=D-188),d=this.pmtParsed=!0;break;case 17:case 8191:break;default:h=!0}}else this.observer.trigger(x.a.ERROR,{type:E.b.MEDIA_ERROR,details:E.a.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});_&&(c=k(_))&&void 0!==c.pts?(M(c,!0),p.pesData=null):p.pesData=_,w&&(c=k(w))&&void 0!==c.pts?(f.isAAC?L(c):R(c),f.pesData=null):(w&&w.size&&A.b.log("last AAC PES packet truncated,might overlap between fragments"),f.pesData=w),T&&(c=k(T))&&void 0!==c.pts?(P(c),m.pesData=null):m.pesData=T,null==this.sampleAes?this.remuxer.remux(f,p,m,this._txtTrack,n,i,r):this.decryptAndRemux(f,p,m,this._txtTrack,n,i,r)},t.prototype.decryptAndRemux=function(t,e,n,i,r,o,a){if(t.samples&&t.isAAC){var s=this;this.sampleAes.decryptAacSamples(t.samples,0,function(){s.decryptAndRemuxAvc(t,e,n,i,r,o,a)})}else this.decryptAndRemuxAvc(t,e,n,i,r,o,a)},t.prototype.decryptAndRemuxAvc=function(t,e,n,i,r,o,a){if(e.samples){var s=this;this.sampleAes.decryptAvcSamples(e.samples,0,0,function(){s.remuxer.remux(t,e,n,i,r,o,a)})}else this.remuxer.remux(t,e,n,i,r,o,a)},t.prototype.destroy=function(){this._initPTS=this._initDTS=void 0,this._duration=0},t.prototype._parsePAT=function(t,e){return(31&t[e+10])<<8|t[e+11]},t.prototype._parsePMT=function(t,e,n,i){var r=void 0,o=void 0,a=void 0,s=void 0,l={audio:-1,avc:-1,id3:-1,isAAC:!0};for(r=(15&t[e+1])<<8|t[e+2],o=e+3+r-4,a=(15&t[e+10])<<8|t[e+11],e+=12+a;e<o;){switch(s=(31&t[e+1])<<8|t[e+2],t[e]){case 207:if(!i){A.b.log("unkown stream type:"+t[e]);break}case 15:-1===l.audio&&(l.audio=s);break;case 21:-1===l.id3&&(l.id3=s);break;case 219:if(!i){A.b.log("unkown stream type:"+t[e]);break}case 27:-1===l.avc&&(l.avc=s);break;case 3:case 4:n?-1===l.audio&&(l.audio=s,l.isAAC=!1):A.b.log("MPEG audio found, not supported in this browser for now");break;case 36:A.b.warn("HEVC stream type found, not supported for now");break;default:A.b.log("unkown stream type:"+t[e])}e+=5+((15&t[e+3])<<8|t[e+4])}return l},t.prototype._parsePES=function(t){var e=0,n=void 0,i=void 0,r=void 0,o=void 0,a=void 0,s=void 0,l=void 0,u=void 0,c=t.data;if(!t||0===t.size)return null;for(;c[0].length<19&&c.length>1;){var h=new Uint8Array(c[0].length+c[1].length);h.set(c[0]),h.set(c[1],c[0].length),c[0]=h,c.splice(1,1)}if(n=c[0],1===(n[0]<<16)+(n[1]<<8)+n[2]){if((r=(n[4]<<8)+n[5])&&r>t.size-6)return null;i=n[7],192&i&&(s=536870912*(14&n[9])+4194304*(255&n[10])+16384*(254&n[11])+128*(255&n[12])+(254&n[13])/2,s>4294967295&&(s-=8589934592),64&i?(l=536870912*(14&n[14])+4194304*(255&n[15])+16384*(254&n[16])+128*(255&n[17])+(254&n[18])/2,l>4294967295&&(l-=8589934592),s-l>54e5&&(A.b.warn(Math.round((s-l)/9e4)+"s delta between PTS and DTS, align them"),s=l)):l=s),o=n[8],u=o+9,t.size-=u,a=new Uint8Array(t.size);for(var d=0,p=c.length;d<p;d++){n=c[d];var f=n.byteLength;if(u){if(u>f){u-=f;continue}n=n.subarray(u),f-=u,u=0}a.set(n,e),e+=f}return r&&(r-=o+3),{data:a,pts:s,dts:l,len:r}}return null},t.prototype.pushAccesUnit=function(t,e){if(t.units.length&&t.frame){var n=e.samples,i=n.length;!this.config.forceKeyFrameOnDiscontinuity||!0===t.key||e.sps&&(i||this.contiguous)?(t.id=i,n.push(t)):e.dropped++}t.debug.length&&A.b.log(t.pts+"/"+t.dts+":"+t.debug)},t.prototype._parseAVCPES=function(t,e){var n=this,i=this._avcTrack,r=this._parseAVCNALu(t.data),o=void 0,a=this.avcSample,s=void 0,l=!1,u=void 0,c=this.pushAccesUnit.bind(this),h=function(t,e,n,i){return{key:t,pts:e,dts:n,units:[],debug:i}};t.data=null,a&&r.length&&!i.audFound&&(c(a,i),a=this.avcSample=h(!1,t.pts,t.dts,"")),r.forEach(function(e){switch(e.type){case 1:s=!0,a||(a=n.avcSample=h(!0,t.pts,t.dts,"")),a.frame=!0;var r=e.data;if(l&&r.length>4){var d=new I(r).readSliceType();2!==d&&4!==d&&7!==d&&9!==d||(a.key=!0)}break;case 5:s=!0,a||(a=n.avcSample=h(!0,t.pts,t.dts,"")),a.key=!0,a.frame=!0;break;case 6:s=!0,o=new I(n.discardEPB(e.data)),o.readUByte();for(var p=0,f=0,m=!1,v=0;!m&&o.bytesAvailable>1;){p=0;do{v=o.readUByte(),p+=v}while(255===v);f=0;do{v=o.readUByte(),f+=v}while(255===v);if(4===p&&0!==o.bytesAvailable){m=!0;if(181===o.readUByte()){if(49===o.readUShort()){if(1195456820===o.readUInt()){if(3===o.readUByte()){var g=o.readUByte(),y=o.readUByte(),b=31&g,_=[g,y];for(u=0;u<b;u++)_.push(o.readUByte()),_.push(o.readUByte()),_.push(o.readUByte());n._insertSampleInOrder(n._txtTrack.samples,{type:3,pts:t.pts,bytes:_})}}}}}else if(f<o.bytesAvailable)for(u=0;u<f;u++)o.readUByte()}break;case 7:if(s=!0,l=!0,!i.sps){o=new I(e.data);var w=o.readSPS();i.width=w.width,i.height=w.height,i.pixelRatio=w.pixelRatio,i.sps=[e.data],i.duration=n._duration;var T=e.data.subarray(1,4),x="avc1.";for(u=0;u<3;u++){var E=T[u].toString(16);E.length<2&&(E="0"+E),x+=E}i.codec=x}break;case 8:s=!0,i.pps||(i.pps=[e.data]);break;case 9:s=!1,i.audFound=!0,a&&c(a,i),a=n.avcSample=h(!1,t.pts,t.dts,"");break;case 12:s=!1;break;default:s=!1,a&&(a.debug+="unknown NAL "+e.type+" ")}if(a&&s){a.units.push(e)}}),e&&a&&(c(a,i),this.avcSample=null)},t.prototype._insertSampleInOrder=function(t,e){var n=t.length;if(n>0){if(e.pts>=t[n-1].pts)t.push(e);else for(var i=n-1;i>=0;i--)if(e.pts<t[i].pts){t.splice(i,0,e);break}}else t.push(e)},t.prototype._getLastNalUnit=function(){var t=this.avcSample,e=void 0;if(!t||0===t.units.length){var n=this._avcTrack,i=n.samples;t=i[i.length-1]}if(t){var r=t.units;e=r[r.length-1]}return e},t.prototype._parseAVCNALu=function(t){var e=0,n=t.byteLength,i=void 0,r=void 0,o=this._avcTrack,a=o.naluState||0,s=a,l=[],u=void 0,c=void 0,h=-1,d=void 0;for(-1===a&&(h=0,d=31&t[0],a=0,e=1);e<n;)if(i=t[e++],a)if(1!==a)if(i)if(1===i){if(h>=0)u={data:t.subarray(h,e-a-1),type:d},l.push(u);else{var p=this._getLastNalUnit();if(p&&(s&&e<=4-s&&p.state&&(p.data=p.data.subarray(0,p.data.byteLength-s)),(r=e-a-1)>0)){var f=new Uint8Array(p.data.byteLength+r);f.set(p.data,0),f.set(t.subarray(0,r),p.data.byteLength),p.data=f}}e<n?(c=31&t[e],h=e,d=c,a=0):a=-1}else a=0;else a=3;else a=i?0:2;else a=i?0:1;if(h>=0&&a>=0&&(u={data:t.subarray(h,n),type:d,state:a},l.push(u)),0===l.length){var m=this._getLastNalUnit();if(m){var v=new Uint8Array(m.data.byteLength+t.byteLength);v.set(m.data,0),v.set(t,m.data.byteLength),m.data=v}}return o.naluState=a,l},t.prototype.discardEPB=function(t){for(var e=t.byteLength,n=[],i=1,r=void 0,o=void 0;i<e-2;)0===t[i]&&0===t[i+1]&&3===t[i+2]?(n.push(i+2),i+=2):i++;if(0===n.length)return t;r=e-n.length,o=new Uint8Array(r);var a=0;for(i=0;i<r;a++,i++)a===n[0]&&(a++,n.shift()),o[i]=t[a];return o},t.prototype._parseAACPES=function(t){var e=this._audioTrack,n=t.data,i=t.pts,r=this.aacOverFlow,o=this.aacLastPTS,a=void 0,l=void 0,h=void 0,p=void 0,f=void 0;if(r){var m=new Uint8Array(r.byteLength+n.byteLength);m.set(r,0),m.set(n,r.byteLength),n=m}for(h=0,f=n.length;h<f-1&&!s(n,h);h++);if(h){var v=void 0,g=void 0;if(h<f-1?(v="AAC PES did not start with ADTS header,offset:"+h,g=!1):(v="no ADTS header found in AAC PES",g=!0),A.b.warn("parsing error:"+v),this.observer.trigger(x.a.ERROR,{type:E.b.MEDIA_ERROR,details:E.a.FRAG_PARSING_ERROR,fatal:g,reason:v}),g)return}if(u(e,this.observer,n,h,this.audioCodec),l=0,a=c(e.samplerate),r&&o){var y=o+a;Math.abs(y-i)>1&&(A.b.log("AAC: align PTS for overlapping frames by "+Math.round((y-i)/90)),i=y)}for(;h<f;)if(s(n,h)&&h+5<f){var b=d(e,n,h,i,l);if(!b)break;h+=b.length,p=b.sample.pts,l++}else h++;r=h<f?n.subarray(h,f):null,this.aacOverFlow=r,this.aacLastPTS=p},t.prototype._parseMPEGPES=function(t){for(var e=t.data,n=e.length,i=0,r=0,o=t.pts;r<n;)if(P.isHeader(e,r)){var a=P.appendFrame(this._audioTrack,e,r,o,i);if(!a)break;r+=a.length,i++}else r++},t.prototype._parseID3PES=function(t){this._id3Track.samples.push(t)},t}(),V=U,B=function(){function t(e,n,i){g(this,t),this.observer=e,this.config=i,this.remuxer=n}return t.prototype.resetInitSegment=function(t,e,n,i){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:e,duration:i,inputTimeScale:9e4}},t.prototype.resetTimeStamp=function(){},t.probe=function(t){var e=void 0,n=void 0,i=C.a.getID3Data(t,0);if(i&&void 0!==C.a.getTimeStamp(i))for(e=i.length,n=Math.min(t.length-1,e+100);e<n;e++)if(P.probe(t,e))return A.b.log("MPEG Audio sync word found !"),!0;return!1},t.prototype.append=function(t,e,n,i){for(var r=C.a.getID3Data(t,0),o=C.a.getTimeStamp(r),a=o?90*o:9e4*e,s=r.length,l=t.length,u=0,c=0,h=this._audioTrack,d=[{pts:a,dts:a,data:r}];s<l;)if(P.isHeader(t,s)){var p=P.appendFrame(h,t,s,a,u);if(!p)break;s+=p.length,c=p.sample.pts,u++}else C.a.isHeader(t,s)?(r=C.a.getID3Data(t,s),d.push({pts:c,dts:c,data:r}),s+=r.length):s++;this.remuxer.remux(h,{samples:[]},{samples:d,inputTimeScale:9e4},{samples:[]},e,n,i)},t.prototype.destroy=function(){},t}(),j=B,G=function(){function t(){y(this,t)}return t.getSilentFrame=function(t,e){switch(t){case"mp4a.40.2":if(1===e)return new Uint8Array([0,200,0,128,35,128]);if(2===e)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===e)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===e)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===e)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},t}(),H=G,z=Math.pow(2,32)-1,W=function(){function t(){b(this,t)}return t.init=function(){t.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var e=void 0;for(e in t.types)t.types.hasOwnProperty(e)&&(t.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);var n=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),i=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);t.HDLR_TYPES={video:n,audio:i};var r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),o=new Uint8Array([0,0,0,0,0,0,0,0]);t.STTS=t.STSC=t.STCO=o,t.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),t.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),t.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),t.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var a=new Uint8Array([105,115,111,109]),s=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);t.FTYP=t.box(t.types.ftyp,a,l,a,s),t.DINF=t.box(t.types.dinf,t.box(t.types.dref,r))},t.box=function(t){for(var e=Array.prototype.slice.call(arguments,1),n=8,i=e.length,r=i,o=void 0;i--;)n+=e[i].byteLength;for(o=new Uint8Array(n),o[0]=n>>24&255,o[1]=n>>16&255,o[2]=n>>8&255,o[3]=255&n,o.set(t,4),i=0,n=8;i<r;i++)o.set(e[i],n),n+=e[i].byteLength;return o},t.hdlr=function(e){return t.box(t.types.hdlr,t.HDLR_TYPES[e])},t.mdat=function(e){return t.box(t.types.mdat,e)},t.mdhd=function(e,n){n*=e;var i=Math.floor(n/(z+1)),r=Math.floor(n%(z+1));return t.box(t.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,i>>24,i>>16&255,i>>8&255,255&i,r>>24,r>>16&255,r>>8&255,255&r,85,196,0,0]))},t.mdia=function(e){return t.box(t.types.mdia,t.mdhd(e.timescale,e.duration),t.hdlr(e.type),t.minf(e))},t.mfhd=function(e){return t.box(t.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]))},t.minf=function(e){return"audio"===e.type?t.box(t.types.minf,t.box(t.types.smhd,t.SMHD),t.DINF,t.stbl(e)):t.box(t.types.minf,t.box(t.types.vmhd,t.VMHD),t.DINF,t.stbl(e))},t.moof=function(e,n,i){return t.box(t.types.moof,t.mfhd(e),t.traf(i,n))},t.moov=function(e){for(var n=e.length,i=[];n--;)i[n]=t.trak(e[n]);return t.box.apply(null,[t.types.moov,t.mvhd(e[0].timescale,e[0].duration)].concat(i).concat(t.mvex(e)))},t.mvex=function(e){for(var n=e.length,i=[];n--;)i[n]=t.trex(e[n]);return t.box.apply(null,[t.types.mvex].concat(i))},t.mvhd=function(e,n){n*=e;var i=Math.floor(n/(z+1)),r=Math.floor(n%(z+1)),o=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,i>>24,i>>16&255,i>>8&255,255&i,r>>24,r>>16&255,r>>8&255,255&r,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return t.box(t.types.mvhd,o)},t.sdtp=function(e){var n=e.samples||[],i=new Uint8Array(4+n.length),r=void 0,o=void 0;for(o=0;o<n.length;o++)r=n[o].flags,i[o+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return t.box(t.types.sdtp,i)},t.stbl=function(e){return t.box(t.types.stbl,t.stsd(e),t.box(t.types.stts,t.STTS),t.box(t.types.stsc,t.STSC),t.box(t.types.stsz,t.STSZ),t.box(t.types.stco,t.STCO))},t.avc1=function(e){var n=[],i=[],r=void 0,o=void 0,a=void 0;for(r=0;r<e.sps.length;r++)o=e.sps[r],a=o.byteLength,n.push(a>>>8&255),n.push(255&a),n=n.concat(Array.prototype.slice.call(o));for(r=0;r<e.pps.length;r++)o=e.pps[r],a=o.byteLength,i.push(a>>>8&255),i.push(255&a),i=i.concat(Array.prototype.slice.call(o));var s=t.box(t.types.avcC,new Uint8Array([1,n[3],n[4],n[5],255,224|e.sps.length].concat(n).concat([e.pps.length]).concat(i))),l=e.width,u=e.height,c=e.pixelRatio[0],h=e.pixelRatio[1];return t.box(t.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,255&l,u>>8&255,255&u,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s,t.box(t.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),t.box(t.types.pasp,new Uint8Array([c>>24,c>>16&255,c>>8&255,255&c,h>>24,h>>16&255,h>>8&255,255&h])))},t.esds=function(t){var e=t.config.length;return new Uint8Array([0,0,0,0,3,23+e,0,1,0,4,15+e,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([e]).concat(t.config).concat([6,1,2]))},t.mp4a=function(e){var n=e.samplerate;return t.box(t.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,n>>8&255,255&n,0,0]),t.box(t.types.esds,t.esds(e)))},t.mp3=function(e){var n=e.samplerate;return t.box(t.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,n>>8&255,255&n,0,0]))},t.stsd=function(e){return"audio"===e.type?e.isAAC||"mp3"!==e.codec?t.box(t.types.stsd,t.STSD,t.mp4a(e)):t.box(t.types.stsd,t.STSD,t.mp3(e)):t.box(t.types.stsd,t.STSD,t.avc1(e))},t.tkhd=function(e){var n=e.id,i=e.duration*e.timescale,r=e.width,o=e.height,a=Math.floor(i/(z+1)),s=Math.floor(i%(z+1));return t.box(t.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,n>>24&255,n>>16&255,n>>8&255,255&n,0,0,0,0,a>>24,a>>16&255,a>>8&255,255&a,s>>24,s>>16&255,s>>8&255,255&s,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,r>>8&255,255&r,0,0,o>>8&255,255&o,0,0]))},t.traf=function(e,n){var i=t.sdtp(e),r=e.id,o=Math.floor(n/(z+1)),a=Math.floor(n%(z+1));return t.box(t.types.traf,t.box(t.types.tfhd,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r])),t.box(t.types.tfdt,new Uint8Array([1,0,0,0,o>>24,o>>16&255,o>>8&255,255&o,a>>24,a>>16&255,a>>8&255,255&a])),t.trun(e,i.length+16+20+8+16+8+8),i)},t.trak=function(e){return e.duration=e.duration||4294967295,t.box(t.types.trak,t.tkhd(e),t.mdia(e))},t.trex=function(e){var n=e.id;return t.box(t.types.trex,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},t.trun=function(e,n){var i=e.samples||[],r=i.length,o=12+16*r,a=new Uint8Array(o),s=void 0,l=void 0,u=void 0,c=void 0,h=void 0,d=void 0;for(n+=8+o,a.set([0,0,15,1,r>>>24&255,r>>>16&255,r>>>8&255,255&r,n>>>24&255,n>>>16&255,n>>>8&255,255&n],0),s=0;s<r;s++)l=i[s],u=l.duration,c=l.size,h=l.flags,d=l.cts,a.set([u>>>24&255,u>>>16&255,u>>>8&255,255&u,c>>>24&255,c>>>16&255,c>>>8&255,255&c,h.isLeading<<2|h.dependsOn,h.isDependedOn<<6|h.hasRedundancy<<4|h.paddingValue<<1|h.isNonSync,61440&h.degradPrio,15&h.degradPrio,d>>>24&255,d>>>16&255,d>>>8&255,255&d],12+16*s);return t.box(t.types.trun,a)},t.initSegment=function(e){t.types||t.init();var n=t.moov(e),i=void 0;return i=new Uint8Array(t.FTYP.byteLength+n.byteLength),i.set(t.FTYP),i.set(n,t.FTYP.byteLength),i},t}(),X=W,q=function(){function t(e,n,i,r){_(this,t),this.observer=e,this.config=n,this.typeSupported=i;var o=navigator.userAgent;this.isSafari=r&&r.indexOf("Apple")>-1&&o&&!o.match("CriOS"),this.ISGenerated=!1}return t.prototype.destroy=function(){},t.prototype.resetTimeStamp=function(t){this._initPTS=this._initDTS=t},t.prototype.resetInitSegment=function(){this.ISGenerated=!1},t.prototype.remux=function(t,e,n,i,r,o,a){if(this.ISGenerated||this.generateIS(t,e,r),this.ISGenerated){var s=t.samples.length,l=e.samples.length,u=r,c=r;if(s&&l){var h=(t.samples[0].dts-e.samples[0].dts)/e.inputTimeScale;u+=Math.max(0,h),c+=Math.max(0,-h)}if(s){t.timescale||(A.b.warn("regenerate InitSegment as audio detected"),this.generateIS(t,e,r));var d=this.remuxAudio(t,u,o,a);if(l){var p=void 0;d&&(p=d.endPTS-d.startPTS),e.timescale||(A.b.warn("regenerate InitSegment as video detected"),this.generateIS(t,e,r)),this.remuxVideo(e,c,o,p,a)}}else if(l){var f=this.remuxVideo(e,c,o,0,a);f&&t.codec&&this.remuxEmptyAudio(t,u,o,f)}}n.samples.length&&this.remuxID3(n,r),i.samples.length&&this.remuxText(i,r),this.observer.trigger(x.a.FRAG_PARSED)},t.prototype.generateIS=function(t,e,n){var i=this.observer,r=t.samples,o=e.samples,a=this.typeSupported,s="audio/mp4",l={},u={tracks:l},c=void 0===this._initPTS,h=void 0,d=void 0;if(c&&(h=d=1/0),t.config&&r.length&&(t.timescale=t.samplerate,A.b.log("audio sampling rate : "+t.samplerate),t.isAAC||(a.mpeg?(s="audio/mpeg",t.codec=""):a.mp3&&(t.codec="mp3")),l.audio={container:s,codec:t.codec,initSegment:!t.isAAC&&a.mpeg?new Uint8Array:X.initSegment([t]),metadata:{channelCount:t.channelCount}},c&&(h=d=r[0].pts-t.inputTimeScale*n)),e.sps&&e.pps&&o.length){var p=e.inputTimeScale;e.timescale=p,l.video={container:"video/mp4",codec:e.codec,initSegment:X.initSegment([e]),metadata:{width:e.width,height:e.height}},c&&(h=Math.min(h,o[0].pts-p*n),d=Math.min(d,o[0].dts-p*n),this.observer.trigger(x.a.INIT_PTS_FOUND,{initPTS:h}))}Object.keys(l).length?(i.trigger(x.a.FRAG_PARSING_INIT_SEGMENT,u),this.ISGenerated=!0,c&&(this._initPTS=h,this._initDTS=d)):i.trigger(x.a.ERROR,{type:E.b.MEDIA_ERROR,details:E.a.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})},t.prototype.remuxVideo=function(t,e,n,i,r){var o=8,a=t.timescale,s=void 0,l=void 0,u=void 0,c=void 0,h=void 0,d=void 0,p=void 0,f=t.samples,m=[],v=f.length,g=this._PTSNormalize,y=this._initDTS,b=this.nextAvcDts,_=this.isSafari;if(0!==v){_&&(n|=f.length&&b&&(r&&Math.abs(e-b/a)<.1||Math.abs(f[0].pts-b-y)<a/5)),n||(b=e*a),f.forEach(function(t){t.pts=g(t.pts-y,b),t.dts=g(t.dts-y,b)}),f.sort(function(t,e){var n=t.dts-e.dts,i=t.pts-e.pts;return n||i||t.id-e.id});var w=f.reduce(function(t,e){return Math.max(Math.min(t,e.pts-e.dts),-18e3)},0);if(w<0){A.b.warn("PTS < DTS detected in video samples, shifting DTS by "+Math.round(w/90)+" ms to overcome this issue");for(var T=0;T<f.length;T++)f[T].dts+=w}var S=f[0];h=Math.max(S.dts,0),c=Math.max(S.pts,0);var C=Math.round((h-b)/90);n&&C&&(C>1?A.b.log("AVC:"+C+" ms hole between fragments detected,filling it"):C<-1&&A.b.log("AVC:"+-C+" ms overlapping between fragments detected"),h=b,f[0].dts=h,c=Math.max(c-C,b),f[0].pts=c,A.b.log("Video/PTS/DTS adjusted: "+Math.round(c/90)+"/"+Math.round(h/90)+",delta:"+C+" ms")),h,S=f[f.length-1],p=Math.max(S.dts,0),d=Math.max(S.pts,0,p),_&&(s=Math.round((p-h)/(f.length-1)));for(var k=0,M=0,L=0;L<v;L++){for(var R=f[L],P=R.units,D=P.length,I=0,F=0;F<D;F++)I+=P[F].data.length;M+=I,k+=D,R.length=I,R.dts=_?h+L*s:Math.max(R.dts,h),R.pts=Math.max(R.pts,R.dts)}var O=M+4*k+8;try{l=new Uint8Array(O)}catch(t){return void this.observer.trigger(x.a.ERROR,{type:E.b.MUX_ERROR,details:E.a.REMUX_ALLOC_ERROR,fatal:!1,bytes:O,reason:"fail allocating video mdat "+O})}var N=new DataView(l.buffer);N.setUint32(0,O),l.set(X.types.mdat,4);for(var U=0;U<v;U++){for(var V=f[U],B=V.units,j=0,G=void 0,H=0,z=B.length;H<z;H++){var W=B[H],q=W.data,K=W.data.byteLength;N.setUint32(o,K),o+=4,l.set(q,o),o+=K,j+=4+K}if(_)G=Math.max(0,s*Math.round((V.pts-V.dts)/s));else{if(U<v-1)s=f[U+1].dts-V.dts;else{var Y=this.config,$=V.dts-f[U>0?U-1:U].dts;if(Y.stretchShortVideoTrack){var Q=Y.maxBufferHole,J=Math.floor(Q*a),Z=(i?c+i*a:this.nextAudioPts)-V.pts;Z>J?(s=Z-$,s<0&&(s=$),A.b.log("It is approximately "+Z/90+" ms to the next segment; using duration "+s/90+" ms for the last video frame.")):s=$}else s=$}G=Math.round(V.pts-V.dts)}m.push({size:j,duration:s,cts:G,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:V.key?2:1,isNonSync:V.key?0:1}})}this.nextAvcDts=p+s;var tt=t.dropped;if(t.len=0,t.nbNalu=0,t.dropped=0,m.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var et=m[0].flags;et.dependsOn=2,et.isNonSync=0}t.samples=m,u=X.moof(t.sequenceNumber++,h,t),t.samples=[];var nt={data1:u,data2:l,startPTS:c/a,endPTS:(d+s)/a,startDTS:h/a,endDTS:this.nextAvcDts/a,type:"video",hasAudio:!1,hasVideo:!0,nb:m.length,dropped:tt};return this.observer.trigger(x.a.FRAG_PARSING_DATA,nt),nt}},t.prototype.remuxAudio=function(t,e,n,i){var r=t.inputTimeScale,o=t.timescale,a=r/o,s=t.isAAC?1024:1152,l=s*a,u=this._PTSNormalize,c=this._initDTS,h=!t.isAAC&&this.typeSupported.mpeg,d=void 0,p=void 0,f=void 0,m=void 0,v=void 0,g=void 0,y=void 0,b=t.samples,_=[],w=this.nextAudioPts;if(n|=b.length&&w&&(i&&Math.abs(e-w/r)<.1||Math.abs(b[0].pts-w-c)<20*l),b.forEach(function(t){t.pts=t.dts=u(t.pts-c,e*r)}),b=b.filter(function(t){return t.pts>=0}),0!==b.length){if(n||(w=i?e*r:b[0].pts),t.isAAC)for(var T=this.config.maxAudioFramesDrift,S=0,C=w;S<b.length;){var k,M=b[S],L=M.pts;k=L-C;var R=Math.abs(1e3*k/r);if(k<=-T*l)A.b.warn("Dropping 1 audio frame @ "+(C/r).toFixed(3)+"s due to "+Math.round(R)+" ms overlap."),b.splice(S,1),t.len-=M.unit.length;else if(k>=T*l&&R<1e4&&C){var P=Math.round(k/l);A.b.warn("Injecting "+P+" audio frame @ "+(C/r).toFixed(3)+"s due to "+Math.round(1e3*k/r)+" ms gap.");for(var D=0;D<P;D++){var I=Math.max(C,0);f=H.getSilentFrame(t.manifestCodec||t.codec,t.channelCount),f||(A.b.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),f=M.unit.subarray()),b.splice(S,0,{unit:f,pts:I,dts:I}),t.len+=f.length,C+=l,S++}M.pts=M.dts=C,C+=l,S++}else Math.abs(k),M.pts=M.dts=C,C+=l,S++}for(var F=0,O=b.length;F<O;F++){var N=b[F],U=N.unit,V=N.pts;if(void 0!==y)p.duration=Math.round((V-y)/a);else{var B=Math.round(1e3*(V-w)/r),j=0;if(n&&t.isAAC&&B){if(B>0&&B<1e4)j=Math.round((V-w)/l),A.b.log(B+" ms hole between AAC samples detected,filling it"),j>0&&(f=H.getSilentFrame(t.manifestCodec||t.codec,t.channelCount),f||(f=U.subarray()),t.len+=j*f.length);else if(B<-12){A.b.log("drop overlapping AAC sample, expected/parsed/delta:"+(w/r).toFixed(3)+"s/"+(V/r).toFixed(3)+"s/"+-B+"ms"),t.len-=U.byteLength;continue}V=w}if(g=V,!(t.len>0))return;var G=h?t.len:t.len+8;d=h?0:8;try{m=new Uint8Array(G)}catch(t){return void this.observer.trigger(x.a.ERROR,{type:E.b.MUX_ERROR,details:E.a.REMUX_ALLOC_ERROR,fatal:!1,bytes:G,reason:"fail allocating audio mdat "+G})}if(!h){new DataView(m.buffer).setUint32(0,G),m.set(X.types.mdat,4)}for(var z=0;z<j;z++)f=H.getSilentFrame(t.manifestCodec||t.codec,t.channelCount),f||(A.b.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),f=U.subarray()),m.set(f,d),d+=f.byteLength,p={size:f.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},_.push(p)}m.set(U,d);var W=U.byteLength;d+=W,p={size:W,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},_.push(p),y=V}var q=0,K=_.length;if(K>=2&&(q=_[K-2].duration,p.duration=q),K){this.nextAudioPts=w=y+a*q,t.len=0,t.samples=_,v=h?new Uint8Array:X.moof(t.sequenceNumber++,g/a,t),t.samples=[];var Y=g/r,$=w/r,Q={data1:v,data2:m,startPTS:Y,endPTS:$,startDTS:Y,endDTS:$,type:"audio",hasAudio:!0,hasVideo:!1,nb:K};return this.observer.trigger(x.a.FRAG_PARSING_DATA,Q),Q}return null}},t.prototype.remuxEmptyAudio=function(t,e,n,i){var r=t.inputTimeScale,o=t.samplerate?t.samplerate:r,a=r/o,s=this.nextAudioPts,l=(void 0!==s?s:i.startDTS*r)+this._initDTS,u=i.endDTS*r+this._initDTS,c=1024*a,h=Math.ceil((u-l)/c),d=H.getSilentFrame(t.manifestCodec||t.codec,t.channelCount);if(A.b.warn("remux empty Audio"),!d)return void A.b.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!");for(var p=[],f=0;f<h;f++){var m=l+f*c;p.push({unit:d,pts:m,dts:m}),t.len+=d.length}t.samples=p,this.remuxAudio(t,e,n)},t.prototype.remuxID3=function(t,e){var n=t.samples.length,i=void 0,r=t.inputTimeScale,o=this._initPTS,a=this._initDTS;if(n){for(var s=0;s<n;s++)i=t.samples[s],i.pts=(i.pts-o)/r,i.dts=(i.dts-a)/r;this.observer.trigger(x.a.FRAG_PARSING_METADATA,{samples:t.samples})}t.samples=[],e=e},t.prototype.remuxText=function(t,e){t.samples.sort(function(t,e){return t.pts-e.pts});var n=t.samples.length,i=void 0,r=t.inputTimeScale,o=this._initPTS;if(n){for(var a=0;a<n;a++)i=t.samples[a],i.pts=(i.pts-o)/r;this.observer.trigger(x.a.FRAG_PARSING_USERDATA,{samples:t.samples})}t.samples=[],e=e},t.prototype._PTSNormalize=function(t,e){var n=void 0;if(void 0===e)return t;for(n=e<t?-8589934592:8589934592;Math.abs(t-e)>4294967296;)t+=n;return t},t}(),K=q,Y=function(){function t(e){w(this,t),this.observer=e}return t.prototype.destroy=function(){},t.prototype.resetTimeStamp=function(){},t.prototype.resetInitSegment=function(){},t.prototype.remux=function(t,e,n,i,r,o,a,s){var l=this.observer,u="";t&&(u+="audio"),e&&(u+="video"),l.trigger(x.a.FRAG_PARSING_DATA,{data1:s,startPTS:r,startDTS:r,type:u,hasAudio:!!t,hasVideo:!!e,nb:1,dropped:0}),l.trigger(x.a.FRAG_PARSED)},t}(),$=Y,Q=function(){function t(e,n,i,r){T(this,t),this.observer=e,this.typeSupported=n,this.config=i,this.vendor=r}return t.prototype.destroy=function(){var t=this.demuxer;t&&t.destroy()},t.prototype.push=function(t,e,n,i,r,o,a,s,l,u,c,h){if(t.byteLength>0&&null!=e&&null!=e.key&&"AES-128"===e.method){var d=this.decrypter;null==d&&(d=this.decrypter=new S.a(this.observer,this.config));var p=this,f=void 0;try{f=performance.now()}catch(t){f=Date.now()}d.decrypt(t,e.key.buffer,e.iv.buffer,function(t){var d=void 0;try{d=performance.now()}catch(t){d=Date.now()}p.observer.trigger(x.a.FRAG_DECRYPTED,{stats:{tstart:f,tdecrypt:d}}),p.pushDecrypted(new Uint8Array(t),e,new Uint8Array(n),i,r,o,a,s,l,u,c,h)})}else this.pushDecrypted(new Uint8Array(t),e,new Uint8Array(n),i,r,o,a,s,l,u,c,h)},t.prototype.pushDecrypted=function(t,e,n,i,r,o,a,s,l,u,c,h){var d=this.demuxer;if(!d||(a||s)&&!this.probe(t)){for(var p=this.observer,f=this.typeSupported,m=this.config,v=[{demux:V,remux:K},{demux:L.a,remux:$},{demux:M,remux:K},{demux:j,remux:K}],g=0,y=v.length;g<y;g++){var b=v[g],_=b.demux.probe;if(_(t)){var w=this.remuxer=new b.remux(p,m,f,this.vendor);d=new b.demux(p,w,m,f),this.probe=_;break}}if(!d)return void p.trigger(x.a.ERROR,{type:E.b.MEDIA_ERROR,details:E.a.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});this.demuxer=d}var T=this.remuxer;(a||s)&&(d.resetInitSegment(n,i,r,u),T.resetInitSegment()),a&&(d.resetTimeStamp(h),T.resetTimeStamp(h)),"function"==typeof d.setDecryptData&&d.setDecryptData(e),d.append(t,o,l,c)},t}();e.a=Q},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){var n=se[e];return!!n&&!0===n[t.slice(0,4)]}function l(t,e){return MediaSource.isTypeSupported((e||"video")+'/mp4;codecs="'+t+'"')}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function d(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function f(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function m(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function v(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function g(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function y(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function b(){if("undefined"!=typeof window)return window.MediaSource||window.WebKitMediaSource}function _(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function w(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function T(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function x(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function E(t,e,n){var i=t[e],r=t[n],o=r.startPTS;isNaN(o)?r.start=n>e?i.start+i.duration:Math.max(i.start-r.duration,0):n>e?(i.duration=o-i.start,i.duration<0&&Wt.b.warn("negative duration computed for frag "+i.sn+",level "+i.level+", there should be some duration drift between playlist and fragment!")):(r.duration=i.start-o,r.duration<0&&Wt.b.warn("negative duration computed for frag "+r.sn+",level "+r.level+", there should be some duration drift between playlist and fragment!"))}function S(t,e,n,i,r,o){var a=n;if(!isNaN(e.startPTS)){var s=Math.abs(e.startPTS-n);isNaN(e.deltaPTS)?e.deltaPTS=s:e.deltaPTS=Math.max(s,e.deltaPTS),a=Math.max(n,e.startPTS),n=Math.min(n,e.startPTS),i=Math.max(i,e.endPTS),r=Math.min(r,e.startDTS),o=Math.max(o,e.endDTS)}var l=n-e.start;e.start=e.startPTS=n,e.maxStartPTS=a,e.endPTS=i,e.startDTS=r,e.endDTS=o,e.duration=i-n;var u=e.sn;if(!t||u<t.startSN||u>t.endSN)return 0;var c=void 0,h=void 0,d=void 0;for(c=u-t.startSN,h=t.fragments,h[c]=e,d=c;d>0;d--)E(h,d,d-1);for(d=c;d<h.length-1;d++)E(h,d,d+1);return t.PTSKnown=!0,l}function A(t,e){var n=Math.max(t.startSN,e.startSN)-e.startSN,i=Math.min(t.endSN,e.endSN)-e.startSN,r=e.startSN-t.startSN,o=t.fragments,a=e.fragments,s=0,l=void 0;if(e.initSegment&&t.initSegment&&(e.initSegment=t.initSegment),i<n)return void(e.PTSKnown=!1);for(var u=n;u<=i;u++){var c=o[r+u],h=a[u];h&&c&&(s=c.cc-h.cc,isNaN(c.startPTS)||(h.start=h.startPTS=c.startPTS,h.endPTS=c.endPTS,h.duration=c.duration,h.backtracked=c.backtracked,h.dropped=c.dropped,l=h))}if(s)for(Wt.b.log("discontinuity sliding from playlist, take drift into account"),u=0;u<a.length;u++)a[u].cc+=s;if(l)S(e,l,l.startPTS,l.endPTS,l.startDTS,l.endDTS);else if(r>=0&&r<o.length){var d=o[r].start;for(u=0;u<a.length;u++)a[u].start+=d}e.PTSKnown=t.PTSKnown}function C(t,e){for(var n=null,i=0;i<t.length;i+=1){var r=t[i];if(r&&r.cc===e){n=r;break}}return n}function k(t,e){return Ee.search(t,function(t){return t.cc<e?1:t.cc>e?-1:0})}function M(t,e,n){var i=!1;return e&&e.details&&n&&(n.endCC>n.startCC||t&&t.cc<n.startCC)&&(i=!0),i}function L(t,e){var n=t.fragments,i=e.fragments;if(!i.length||!n.length)return void Wt.b.log("No fragments to align");var r=C(n,i[0].cc);return!r||r&&!r.startPTS?void Wt.b.log("No frag in previous level to align on"):r}function R(t,e){e.fragments.forEach(function(e){if(e){var n=e.start+t;e.start=e.startPTS=n,e.endPTS=n+e.duration}}),e.PTSKnown=!0}function P(t,e,n){if(M(t,e,n)){var i=L(e.details,n);i&&(Wt.b.log("Adjusting PTS using last level due to CC increase within current level"),R(i.start,n))}if(!1===n.PTSKnown&&e&&e.details&&e.details.fragments&&e.details.fragments.length){var r=e.details.programDateTime,o=n.programDateTime,a=(o-r)/1e3+e.details.fragments[0].start;isNaN(a)||(Wt.b.log("adjusting PTS using programDateTime delta, sliding:"+a.toFixed(3)),R(a,n))}}function D(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function I(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function F(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function O(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function N(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function U(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function V(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function B(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function j(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function G(t,e){var n=null;try{n=new window.Event("addtrack")}catch(t){n=document.createEvent("Event"),n.initEvent("addtrack",!1,!1)}n.track=t,e.dispatchEvent(n)}function H(t){if(t&&t.cues)for(;t.cues.length>0;)t.removeCue(t.cues[0])}function z(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function W(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function X(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function q(){var t=b(),e=window.SourceBuffer||window.WebKitSourceBuffer,n=t&&"function"==typeof t.isTypeSupported&&t.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),i=!e||e.prototype&&"function"==typeof e.prototype.appendBuffer&&"function"==typeof e.prototype.remove;return!!n&&!!i}function K(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Q(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function J(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function Z(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function tt(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function et(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function nt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function it(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function rt(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function ot(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function at(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function st(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function lt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ut(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ct(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function ht(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function dt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function pt(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function ft(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function mt(){this.window=window,this.state="INITIAL",this.buffer="",this.decoder=new xn,this.regionList=[]}function vt(t){function e(t,e,n,i){return 3600*(0|t)+60*(0|e)+(0|n)+(0|i)/1e3}var n=t.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return n?n[3]?e(n[1],n[2],n[3].replace(":",""),n[4]):n[1]>59?e(n[1],n[2],0,n[4]):e(0,n[1],n[2],n[4]):null}function gt(){this.values=Object.create(null)}function yt(t,e,n,i){var r=i?t.split(i):[t];for(var o in r)if("string"==typeof r[o]){var a=r[o].split(n);if(2===a.length){var s=a[0],l=a[1];e(s,l)}}}function bt(t,e,n){function i(){var e=vt(t);if(null===e)throw new Error("Malformed timestamp: "+o);return t=t.replace(/^[^\sa-zA-Z-]+/,""),e}function r(){t=t.replace(/^\s+/,"")}var o=t;if(r(),e.startTime=i(),r(),"--\x3e"!==t.substr(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+o);t=t.substr(3),r(),e.endTime=i(),r(),function(t,e){var i=new gt;yt(t,function(t,e){switch(t){case"region":for(var r=n.length-1;r>=0;r--)if(n[r].id===e){i.set(t,n[r].region);break}break;case"vertical":i.alt(t,e,["rl","lr"]);break;case"line":var o=e.split(","),a=o[0];i.integer(t,a),i.percent(t,a)&&i.set("snapToLines",!1),i.alt(t,a,["auto"]),2===o.length&&i.alt("lineAlign",o[1],["start",Sn,"end"]);break;case"position":o=e.split(","),i.percent(t,o[0]),2===o.length&&i.alt("positionAlign",o[1],["start",Sn,"end","line-left","line-right","auto"]);break;case"size":i.percent(t,e);break;case"align":i.alt(t,e,["start",Sn,"end","left","right"])}},/:/,/\s/),e.region=i.get("region",null),e.vertical=i.get("vertical","");var r=i.get("line","auto");"auto"===r&&-1===En.line&&(r=-1),e.line=r,e.lineAlign=i.get("lineAlign","start"),e.snapToLines=i.get("snapToLines",!0),e.size=i.get("size",100),e.align=i.get("align",Sn);var o=i.get("position","auto");"auto"===o&&50===En.position&&(o="start"===e.align||"left"===e.align?0:"end"===e.align||"right"===e.align?100:50),e.position=o}(t,e)}function _t(t){return t.replace(/<br(?: \/)?>/gi,"\n")}function wt(t,e,n,i){for(var r=void 0,o=void 0,a=void 0,s=void 0,l=void 0,u=window.VTTCue||window.TextTrackCue,c=0;c<i.rows.length;c++)if(r=i.rows[c],a=!0,s=0,l="",!r.isEmpty()){for(var h=0;h<r.chars.length;h++)r.chars[h].uchar.match(/\s/)&&a?s++:(l+=r.chars[h].uchar,a=!1);r.cueStartTime=e,e===n&&(n+=1e-4),o=new u(e,n,_t(l.trim())),s>=16?s--:s++,navigator.userAgent.match(/Firefox\//)?o.line=c+1:o.line=c>7?c-2:c+1,o.align="left",o.position=Math.max(0,Math.min(100,s/32*100+(navigator.userAgent.match(/Firefox\//)?50:0))),t.addCue(o)}}function Tt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Et(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function St(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function At(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function Ct(t,e){return t&&t.label===e.name&&!(t.textTrack1||t.textTrack2)}function kt(t,e,n,i){return Math.min(e,i)-Math.max(t,n)}function Mt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Lt(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function Rt(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function Pt(t){for(var e=[],n=0;n<t.length;n++)"subtitles"===t[n].kind&&e.push(t[n]);return e}function Dt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function It(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function Ft(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function Ot(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Nt(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function Ut(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function Vt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var Bt={};n.d(Bt,"newCue",function(){return wt});var jt=n(3),Gt=n.n(jt),Ht=n(2),zt=n(1),Wt=n(0),Xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qt=new Set(["hlsEventGeneric","hlsHandlerDestroying","hlsHandlerDestroyed"]),Kt=function(){function t(e){i(this,t),this.hls=e,this.onEvent=this.onEvent.bind(this);for(var n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];this.handledEvents=r,this.useGenericHandler=!0,this.registerListeners()}return t.prototype.destroy=function(){this.onHandlerDestroying(),this.unregisterListeners(),this.onHandlerDestroyed()},t.prototype.onHandlerDestroying=function(){},t.prototype.onHandlerDestroyed=function(){},t.prototype.isEventHandler=function(){return"object"===Xt(this.handledEvents)&&this.handledEvents.length&&"function"==typeof this.onEvent},t.prototype.registerListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(t){if(qt.has(t))throw new Error("Forbidden event-name: "+t);this.hls.on(t,this.onEvent)},this)},t.prototype.unregisterListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(t){this.hls.off(t,this.onEvent)},this)},t.prototype.onEvent=function(t,e){this.onEventGeneric(t,e)},t.prototype.onEventGeneric=function(t,e){var n=function(t,e){var n="on"+t.replace("hls","");if("function"!=typeof this[n])throw new Error("Event "+t+" has no generic handler in this "+this.constructor.name+" class (tried "+n+")");return this[n].bind(this,e)};try{n.call(this,t,e).call()}catch(e){Wt.b.error("An internal error happened while handling event "+t+'. Error message: "'+e.message+'". Here is a stacktrace:',e),this.hls.trigger(zt.a.ERROR,{type:Ht.b.OTHER_ERROR,details:Ht.a.INTERNAL_EXCEPTION,fatal:!1,event:t,err:e})}},t}(),Yt=Kt,$t=n(7),Qt=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),Jt=function(){function t(){r(this,t),this.method=null,this.key=null,this.iv=null,this._uri=null}return Qt(t,[{key:"uri",get:function(){return!this._uri&&this.reluri&&(this._uri=Gt.a.buildAbsoluteURL(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri}}]),t}(),Zt=Jt,te=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),ee=function(){function t(){var e;o(this,t),this._url=null,this._byteRange=null,this._decryptdata=null,this.tagList=[],this._elementaryStreams=(e={},e[t.ElementaryStreamTypes.AUDIO]=!1,e[t.ElementaryStreamTypes.VIDEO]=!1,e)}return t.prototype.addElementaryStream=function(t){this._elementaryStreams[t]=!0},t.prototype.hasElementaryStream=function(t){return!0===this._elementaryStreams[t]},t.prototype.createInitializationVector=function(t){for(var e=new Uint8Array(16),n=12;n<16;n++)e[n]=t>>8*(15-n)&255;return e},t.prototype.fragmentDecryptdataFromLevelkey=function(t,e){var n=t;return t&&t.method&&t.uri&&!t.iv&&(n=new Zt,n.method=t.method,n.baseuri=t.baseuri,n.reluri=t.reluri,n.iv=this.createInitializationVector(e)),n},te(t,[{key:"url",get:function(){return!this._url&&this.relurl&&(this._url=Gt.a.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(t){this._url=t}},{key:"programDateTime",get:function(){return!this._programDateTime&&this.rawProgramDateTime&&(this._programDateTime=new Date(Date.parse(this.rawProgramDateTime))),this._programDateTime}},{key:"byteRange",get:function(){if(!this._byteRange&&!this.rawByteRange)return[];if(this._byteRange)return this._byteRange;var t=[];if(this.rawByteRange){var e=this.rawByteRange.split("@",2);if(1===e.length){var n=this.lastByteRangeEndOffset;t[0]=n||0}else t[0]=parseInt(e[1]);t[1]=parseInt(e[0])+t[0],this._byteRange=t}return t}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"decryptdata",get:function(){return this._decryptdata||(this._decryptdata=this.fragmentDecryptdataFromLevelkey(this.levelkey,this.sn)),this._decryptdata}}],[{key:"ElementaryStreamTypes",get:function(){return{AUDIO:"audio",VIDEO:"video"}}}]),t}(),ne=ee,ie=/^(\d+)x(\d+)$/,re=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,oe=function(){function t(e){a(this,t),"string"==typeof e&&(e=t.parseAttrList(e));for(var n in e)e.hasOwnProperty(n)&&(this[n]=e[n])}return t.prototype.decimalInteger=function(t){var e=parseInt(this[t],10);return e>Number.MAX_SAFE_INTEGER?1/0:e},t.prototype.hexadecimalInteger=function(t){if(this[t]){var e=(this[t]||"0x").slice(2);e=(1&e.length?"0":"")+e;for(var n=new Uint8Array(e.length/2),i=0;i<e.length/2;i++)n[i]=parseInt(e.slice(2*i,2*i+2),16);return n}return null},t.prototype.hexadecimalIntegerAsNumber=function(t){var e=parseInt(this[t],16);return e>Number.MAX_SAFE_INTEGER?1/0:e},t.prototype.decimalFloatingPoint=function(t){return parseFloat(this[t])},t.prototype.enumeratedString=function(t){return this[t]},t.prototype.decimalResolution=function(t){var e=ie.exec(this[t]);if(null!==e)return{width:parseInt(e[1],10),height:parseInt(e[2],10)}},t.parseAttrList=function(t){var e=void 0,n={};for(re.lastIndex=0;null!==(e=re.exec(t));){var i=e[2];0===i.indexOf('"')&&i.lastIndexOf('"')===i.length-1&&(i=i.slice(1,-1)),n[e[1]]=i}return n},t}(),ae=oe,se={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0}},le=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,ue=/#EXT-X-MEDIA:(.*)/g,ce=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)(\S+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),he=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)(.*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,de=function(){function t(){u(this,t)}return t.findGroup=function(t,e){if(!t)return null;for(var n=null,i=0;i<t.length;i++){var r=t[i];r.id===e&&(n=r)}return n},t.convertAVC1ToAVCOTI=function(t){var e=void 0,n=t.split(".");return n.length>2?(e=n.shift()+".",e+=parseInt(n.shift()).toString(16),e+=("000"+parseInt(n.shift()).toString(16)).substr(-4)):e=t,e},t.resolve=function(t,e){return Gt.a.buildAbsoluteURL(e,t,{alwaysNormalize:!0})},t.parseMasterPlaylist=function(e,n){var i=[],r=void 0;for(le.lastIndex=0;null!=(r=le.exec(e));){var o={},a=o.attrs=new ae(r[1]);o.url=t.resolve(r[2],n);var l=a.decimalResolution("RESOLUTION");l&&(o.width=l.width,o.height=l.height),o.bitrate=a.decimalInteger("AVERAGE-BANDWIDTH")||a.decimalInteger("BANDWIDTH"),o.name=a.NAME,function(t,e){["video","audio"].forEach(function(n){var i=t.filter(function(t){return s(t,n)});if(i.length){var r=i.filter(function(t){return 0===t.lastIndexOf("avc1",0)||0===t.lastIndexOf("mp4a",0)});e[n+"Codec"]=r.length>0?r[0]:i[0],t=t.filter(function(t){return-1===i.indexOf(t)})}}),e.unknownCodecs=t}([].concat((a.CODECS||"").split(/[ ,]+/)),o),o.videoCodec&&-1!==o.videoCodec.indexOf("avc1")&&(o.videoCodec=t.convertAVC1ToAVCOTI(o.videoCodec)),i.push(o)}return i},t.parseMasterPlaylistMedia=function(e,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=void 0,a=[],s=0;for(ue.lastIndex=0;null!==(o=ue.exec(e));){var l={},u=new ae(o[1]);if(u.TYPE===i){if(l.groupId=u["GROUP-ID"],l.name=u.NAME,l.type=i,l.default="YES"===u.DEFAULT,l.autoselect="YES"===u.AUTOSELECT,l.forced="YES"===u.FORCED,u.URI&&(l.url=t.resolve(u.URI,n)),l.lang=u.LANGUAGE,l.name||(l.name=l.lang),r.length){var c=t.findGroup(r,l.groupId);l.audioCodec=c?c.codec:r[0].codec}l.id=s++,a.push(l)}}return a},t.parseLevelPlaylist=function(t,e,n,i){var r=0,o=0,a={type:null,version:null,url:e,fragments:[],live:!0,startSN:0},s=new Zt,l=0,u=null,c=new ne,h=void 0,d=void 0;for(ce.lastIndex=0;null!==(h=ce.exec(t));){var p=h[1];if(p){c.duration=parseFloat(p);var f=(" "+h[2]).slice(1);c.title=f||null,c.tagList.push(f?["INF",p,f]:["INF",p])}else if(h[3]){if(!isNaN(c.duration)){var m=r++;c.type=i,c.start=o,c.levelkey=s,c.sn=m,c.level=n,c.cc=l,c.baseurl=e,c.relurl=(" "+h[3]).slice(1),a.programDateTime&&(u?c.rawProgramDateTime?c.pdt=Date.parse(c.rawProgramDateTime):c.pdt=u.pdt+1e3*u.duration:c.pdt=Date.parse(a.programDateTime),c.endPdt=c.pdt+1e3*c.duration),a.fragments.push(c),u=c,o+=c.duration,c=new ne}}else if(h[4]){if(c.rawByteRange=(" "+h[4]).slice(1),u){var v=u.byteRangeEndOffset;v&&(c.lastByteRangeEndOffset=v)}}else if(h[5])c.rawProgramDateTime=(" "+h[5]).slice(1),c.tagList.push(["PROGRAM-DATE-TIME",c.rawProgramDateTime]),void 0===a.programDateTime&&(a.programDateTime=new Date(new Date(Date.parse(h[5]))-1e3*o));else{for(h=h[0].match(he),d=1;d<h.length&&void 0===h[d];d++);var g=(" "+h[d+1]).slice(1),y=(" "+h[d+2]).slice(1);switch(h[d]){case"#":c.tagList.push(y?[g,y]:[g]);break;case"PLAYLIST-TYPE":a.type=g.toUpperCase();break;case"MEDIA-SEQUENCE":r=a.startSN=parseInt(g);break;case"TARGETDURATION":a.targetduration=parseFloat(g);break;case"VERSION":a.version=parseInt(g);break;case"EXTM3U":break;case"ENDLIST":a.live=!1;break;case"DIS":l++,c.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":l=parseInt(g);break;case"KEY":var b=g,_=new ae(b),w=_.enumeratedString("METHOD"),T=_.URI,x=_.hexadecimalInteger("IV");w&&(s=new Zt,T&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(w)>=0&&(s.method=w,s.baseuri=e,s.reluri=T,s.key=null,s.iv=x));break;case"START":var E=g,S=new ae(E),A=S.decimalFloatingPoint("TIME-OFFSET");isNaN(A)||(a.startTimeOffset=A);break;case"MAP":var C=new ae(g);c.relurl=C.URI,c.rawByteRange=C.BYTERANGE,c.baseurl=e,c.level=n,c.type=i,c.sn="initSegment",a.initSegment=c,c=new ne;break;default:Wt.b.warn("line parsed but not handled: "+h)}}}return c=u,c&&!c.relurl&&(a.fragments.pop(),o-=c.duration),a.totalduration=o,a.averagetargetduration=o/a.fragments.length,a.endSN=r-1,a.startCC=a.fragments[0]?a.fragments[0].cc:0,a.endCC=l,!a.initSegment&&a.fragments.length&&a.fragments.every(function(t){return t.relurl.endsWith(".mp4")})&&(Wt.b.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),c=new ne,c.relurl=a.fragments[0].relurl,c.baseurl=e,c.level=n,c.type=i,c.sn="initSegment",a.initSegment=c,a.needSidxRanges=!0),a},t}(),pe=de,fe=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),me={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},ve={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"},ge=function(t){function e(n){c(this,e);var i=h(this,t.call(this,n,zt.a.MANIFEST_LOADING,zt.a.LEVEL_LOADING,zt.a.AUDIO_TRACK_LOADING,zt.a.SUBTITLE_TRACK_LOADING));return i.loaders={},i}return d(e,t),e.canHaveQualityLevels=function(t){return t!==me.AUDIO_TRACK&&t!==me.SUBTITLE_TRACK},e.mapContextToLevelType=function(t){switch(t.type){case me.AUDIO_TRACK:return ve.AUDIO;case me.SUBTITLE_TRACK:return ve.SUBTITLE;default:return ve.MAIN}},e.getResponseUrl=function(t,e){var n=t.url;return void 0!==n&&0!==n.indexOf("data:")||(n=e.url),n},e.prototype.createInternalLoader=function(t){var e=this.hls.config,n=e.pLoader,i=e.loader,r=n||i,o=new r(e);return t.loader=o,this.loaders[t.type]=o,o},e.prototype.getInternalLoader=function(t){return this.loaders[t.type]},e.prototype.resetInternalLoader=function(t){this.loaders[t]&&delete this.loaders[t]},e.prototype.destroyInternalLoaders=function(){for(var t in this.loaders){var e=this.loaders[t];e&&e.destroy(),this.resetInternalLoader(t)}},e.prototype.destroy=function(){this.destroyInternalLoaders(),t.prototype.destroy.call(this)},e.prototype.onManifestLoading=function(t){this.load(t.url,{type:me.MANIFEST})},e.prototype.onLevelLoading=function(t){this.load(t.url,{type:me.LEVEL,level:t.level,id:t.id})},e.prototype.onAudioTrackLoading=function(t){this.load(t.url,{type:me.AUDIO_TRACK,id:t.id})},e.prototype.onSubtitleTrackLoading=function(t){this.load(t.url,{type:me.SUBTITLE_TRACK,id:t.id})},e.prototype.load=function(t,e){var n=this.hls.config,i=this.getInternalLoader(e);if(i){var r=i.context;if(r&&r.url===t)return Wt.b.trace("playlist request ongoing"),!1;Wt.b.warn("aborting previous loader for type: "+e.type),i.abort()}var o=void 0,a=void 0,s=void 0,l=void 0;switch(e.type){case me.MANIFEST:o=n.manifestLoadingMaxRetry,a=n.manifestLoadingTimeOut,s=n.manifestLoadingRetryDelay,l=n.manifestLoadingMaxRetryTimeout;break;case me.LEVEL:o=0,a=n.levelLoadingTimeOut;break;default:o=n.levelLoadingMaxRetry,a=n.levelLoadingTimeOut,s=n.levelLoadingRetryDelay,l=n.levelLoadingMaxRetryTimeout,Wt.b.log("Playlist loader for "+e.type+" "+(e.level||e.id))}i=this.createInternalLoader(e),e.url=t,e.responseType=e.responseType||"";var u=void 0,c=void 0;return u={timeout:a,maxRetry:o,retryDelay:s,maxRetryDelay:l},c={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},i.load(e,u,c),!0},e.prototype.loadsuccess=function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(n.isSidxRequest)return this._handleSidxRequest(t,n),void this._handlePlaylistLoaded(t,e,n,i);this.resetInternalLoader(n.type);var r=t.data;if(e.tload=performance.now(),0!==r.indexOf("#EXTM3U"))return void this._handleManifestParsingError(t,n,"no EXTM3U delimiter",i);r.indexOf("#EXTINF:")>0||r.indexOf("#EXT-X-TARGETDURATION:")>0?this._handleTrackOrLevelPlaylist(t,e,n,i):this._handleMasterPlaylist(t,e,n,i)},e.prototype.loaderror=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._handleNetworkError(e,n)},e.prototype.loadtimeout=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._handleNetworkError(e,n,!0)},e.prototype._handleMasterPlaylist=function(t,n,i,r){var o=this.hls,a=t.data,s=e.getResponseUrl(t,i),l=pe.parseMasterPlaylist(a,s);if(!l.length)return void this._handleManifestParsingError(t,i,"no level found in manifest",r);var u=l.map(function(t){return{id:t.attrs.AUDIO,codec:t.audioCodec}}),c=pe.parseMasterPlaylistMedia(a,s,"AUDIO",u),h=pe.parseMasterPlaylistMedia(a,s,"SUBTITLES");if(c.length){var d=!1;c.forEach(function(t){t.url||(d=!0)}),!1===d&&l[0].audioCodec&&!l[0].attrs.AUDIO&&(Wt.b.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),c.unshift({type:"main",name:"main"}))}o.trigger(zt.a.MANIFEST_LOADED,{levels:l,audioTracks:c,subtitles:h,url:s,stats:n,networkDetails:r})},e.prototype._handleTrackOrLevelPlaylist=function(t,n,i,r){var o=this.hls,a=i.id,s=i.level,l=i.type,u=e.getResponseUrl(t,i),c=isNaN(s)?isNaN(a)?0:a:s,h=e.mapContextToLevelType(i),d=pe.parseLevelPlaylist(t.data,u,c,h);if(d.tload=n.tload,l===me.MANIFEST){var p={url:u,details:d};o.trigger(zt.a.MANIFEST_LOADED,{levels:[p],audioTracks:[],url:u,stats:n,networkDetails:r})}if(n.tparsed=performance.now(),d.needSidxRanges){var f=d.initSegment.url;return void this.load(f,{isSidxRequest:!0,type:l,level:s,levelDetails:d,id:a,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer"})}i.levelDetails=d,this._handlePlaylistLoaded(t,n,i,r)},e.prototype._handleSidxRequest=function(t,e){var n=$t.a.parseSegmentIndex(new Uint8Array(t.data));n.references.forEach(function(t,n){var i=t.info,r=e.levelDetails.fragments[n];0===r.byteRange.length&&(r.rawByteRange=String(1+i.end-i.start)+"@"+String(i.start))}),e.levelDetails.initSegment.rawByteRange=String(n.moovEndOffset)+"@0"},e.prototype._handleManifestParsingError=function(t,e,n,i){this.hls.trigger(zt.a.ERROR,{type:Ht.b.NETWORK_ERROR,details:Ht.a.MANIFEST_PARSING_ERROR,fatal:!0,url:t.url,reason:n,networkDetails:i})},e.prototype._handleNetworkError=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=void 0,r=void 0,o=this.getInternalLoader(t);switch(t.type){case me.MANIFEST:i=n?Ht.a.MANIFEST_LOAD_TIMEOUT:Ht.a.MANIFEST_LOAD_ERROR,r=!0;break;case me.LEVEL:i=n?Ht.a.LEVEL_LOAD_TIMEOUT:Ht.a.LEVEL_LOAD_ERROR,r=!1;break;case me.AUDIO_TRACK:i=n?Ht.a.AUDIO_TRACK_LOAD_TIMEOUT:Ht.a.AUDIO_TRACK_LOAD_ERROR,r=!1;break;default:r=!1}o&&(o.abort(),this.resetInternalLoader(t.type)),this.hls.trigger(zt.a.ERROR,{type:Ht.b.NETWORK_ERROR,details:i,fatal:r,url:o.url,loader:o,context:t,networkDetails:e})},e.prototype._handlePlaylistLoaded=function(t,n,i,r){var o=i.type,a=i.level,s=i.id,l=i.levelDetails;if(!l.targetduration)return void this._handleManifestParsingError(t,i,"invalid target duration",r);if(e.canHaveQualityLevels(i.type))this.hls.trigger(zt.a.LEVEL_LOADED,{details:l,level:a||0,id:s||0,stats:n,networkDetails:r});else switch(o){case me.AUDIO_TRACK:this.hls.trigger(zt.a.AUDIO_TRACK_LOADED,{details:l,id:s,stats:n,networkDetails:r});break;case me.SUBTITLE_TRACK:this.hls.trigger(zt.a.SUBTITLE_TRACK_LOADED,{details:l,id:s,stats:n,networkDetails:r})}},fe(e,null,[{key:"ContextType",get:function(){return me}},{key:"LevelType",get:function(){return ve}}]),e}(Yt),ye=ge,be=function(t){function e(n){p(this,e);var i=f(this,t.call(this,n,zt.a.FRAG_LOADING));return i.loaders={},i}return m(e,t),e.prototype.destroy=function(){var e=this.loaders;for(var n in e){var i=e[n];i&&i.destroy()}this.loaders={},t.prototype.destroy.call(this)},e.prototype.onFragLoading=function(t){var e=t.frag,n=e.type,i=this.loaders,r=this.hls.config,o=r.fLoader,a=r.loader;e.loaded=0;var s=i[n];s&&(Wt.b.warn("abort previous fragment loader for type: "+n),s.abort()),s=i[n]=e.loader=r.fLoader?new o(r):new a(r);var l=void 0,u=void 0,c=void 0;l={url:e.url,frag:e,responseType:"arraybuffer",progressData:!1};var h=e.byteRangeStartOffset,d=e.byteRangeEndOffset;isNaN(h)||isNaN(d)||(l.rangeStart=h,l.rangeEnd=d),u={timeout:r.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:r.fragLoadingMaxRetryTimeout},c={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},s.load(l,u,c)},e.prototype.loadsuccess=function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=t.data,o=n.frag;o.loader=void 0,this.loaders[o.type]=void 0,this.hls.trigger(zt.a.FRAG_LOADED,{payload:r,frag:o,stats:e,networkDetails:i})},e.prototype.loaderror=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=e.loader;i&&i.abort(),this.loaders[e.type]=void 0,this.hls.trigger(zt.a.ERROR,{type:Ht.b.NETWORK_ERROR,details:Ht.a.FRAG_LOAD_ERROR,fatal:!1,frag:e.frag,response:t,networkDetails:n})},e.prototype.loadtimeout=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=e.loader;i&&i.abort(),this.loaders[e.type]=void 0,this.hls.trigger(zt.a.ERROR,{type:Ht.b.NETWORK_ERROR,details:Ht.a.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e.frag,networkDetails:n})},e.prototype.loadprogress=function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=e.frag;r.loaded=t.loaded,this.hls.trigger(zt.a.FRAG_LOAD_PROGRESS,{frag:r,stats:t,networkDetails:i})},e}(Yt),_e=be,we=function(t){function e(n){v(this,e);var i=g(this,t.call(this,n,zt.a.KEY_LOADING));return i.loaders={},i.decryptkey=null,i.decrypturl=null,i}return y(e,t),e.prototype.destroy=function(){for(var t in this.loaders){var e=this.loaders[t];e&&e.destroy()}this.loaders={},Yt.prototype.destroy.call(this)},e.prototype.onKeyLoading=function(t){var e=t.frag,n=e.type,i=this.loaders[n],r=e.decryptdata,o=r.uri;if(o!==this.decrypturl||null===this.decryptkey){var a=this.hls.config;i&&(Wt.b.warn("abort previous key loader for type:"+n),i.abort()),e.loader=this.loaders[n]=new a.loader(a),this.decrypturl=o,this.decryptkey=null;var s=void 0,l=void 0,u=void 0;s={url:o,frag:e,responseType:"arraybuffer"},l={timeout:a.fragLoadingTimeOut,maxRetry:a.fragLoadingMaxRetry,retryDelay:a.fragLoadingRetryDelay,maxRetryDelay:a.fragLoadingMaxRetryTimeout},u={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},e.loader.load(s,l,u)}else this.decryptkey&&(r.key=this.decryptkey,this.hls.trigger(zt.a.KEY_LOADED,{frag:e}))},e.prototype.loadsuccess=function(t,e,n){var i=n.frag;this.decryptkey=i.decryptdata.key=new Uint8Array(t.data),i.loader=void 0,this.loaders[i.type]=void 0,this.hls.trigger(zt.a.KEY_LOADED,{frag:i})},e.prototype.loaderror=function(t,e){var n=e.frag,i=n.loader;i&&i.abort(),this.loaders[e.type]=void 0,this.hls.trigger(zt.a.ERROR,{type:Ht.b.NETWORK_ERROR,details:Ht.a.KEY_LOAD_ERROR,fatal:!1,frag:n,response:t})},e.prototype.loadtimeout=function(t,e){var n=e.frag,i=n.loader;i&&i.abort(),this.loaders[e.type]=void 0,this.hls.trigger(zt.a.ERROR,{type:Ht.b.NETWORK_ERROR,details:Ht.a.KEY_LOAD_TIMEOUT,fatal:!1,frag:n})},e}(Yt),Te=we,xe={search:function(t,e){for(var n=0,i=t.length-1,r=null,o=null;n<=i;){r=(n+i)/2|0,o=t[r];var a=e(o);if(a>0)n=r+1;else{if(!(a<0))return o;i=r-1}}return null}},Ee=xe,Se={isBuffered:function(t,e){try{if(t)for(var n=t.buffered,i=0;i<n.length;i++)if(e>=n.start(i)&&e<=n.end(i))return!0}catch(t){}return!1},bufferInfo:function(t,e,n){try{if(t){var i=t.buffered,r=[],o=void 0;for(o=0;o<i.length;o++)r.push({start:i.start(o),end:i.end(o)});return this.bufferedInfo(r,e,n)}}catch(t){}return{len:0,start:e,end:e,nextStart:void 0}},bufferedInfo:function(t,e,n){var i=[],r=void 0,o=void 0,a=void 0,s=void 0,l=void 0;for(t.sort(function(t,e){var n=t.start-e.start;return n||e.end-t.end}),l=0;l<t.length;l++){var u=i.length;if(u){var c=i[u-1].end;t[l].start-c<n?t[l].end>c&&(i[u-1].end=t[l].end):i.push(t[l])}else i.push(t[l])}for(l=0,r=0,o=a=e;l<i.length;l++){var h=i[l].start,d=i[l].end;if(e+n>=h&&e<d)o=h,a=d,r=a-e;else if(e+n<h){s=h;break}}return{len:r,start:o,end:a,nextStart:s}}},Ae=Se,Ce=n(8),ke=n(6),Me=n.n(ke),Le=n(10),Re=n.n(Le),Pe=b(),De=function(){function t(e,n){_(this,t),this.hls=e,this.id=n;var i=this.observer=new Me.a,r=e.config;i.trigger=function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];i.emit.apply(i,[t,t].concat(n))},i.off=function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];i.removeListener.apply(i,[t].concat(n))};var o=function(t,n){n=n||{},n.frag=this.frag,n.id=this.id,e.trigger(t,n)}.bind(this);i.on(zt.a.FRAG_DECRYPTED,o),i.on(zt.a.FRAG_PARSING_INIT_SEGMENT,o),i.on(zt.a.FRAG_PARSING_DATA,o),i.on(zt.a.FRAG_PARSED,o),i.on(zt.a.ERROR,o),i.on(zt.a.FRAG_PARSING_METADATA,o),i.on(zt.a.FRAG_PARSING_USERDATA,o),i.on(zt.a.INIT_PTS_FOUND,o);var a={mp4:Pe.isTypeSupported("video/mp4"),mpeg:Pe.isTypeSupported("audio/mpeg"),mp3:Pe.isTypeSupported('audio/mp4; codecs="mp3"')},s=navigator.vendor;if(r.enableWorker&&"undefined"!=typeof Worker){Wt.b.log("demuxing in webworker");var l=void 0;try{l=this.w=Re()(11),this.onwmsg=this.onWorkerMessage.bind(this),l.addEventListener("message",this.onwmsg),l.onerror=function(t){e.trigger(zt.a.ERROR,{type:Ht.b.OTHER_ERROR,details:Ht.a.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:t.message+" ("+t.filename+":"+t.lineno+")"}})},l.postMessage({cmd:"init",typeSupported:a,vendor:s,id:n,config:JSON.stringify(r)})}catch(t){Wt.b.error("error while initializing DemuxerWorker, fallback on DemuxerInline"),l&&URL.revokeObjectURL(l.objectURL),this.demuxer=new Ce.a(i,a,r,s),this.w=void 0}}else this.demuxer=new Ce.a(i,a,r,s)}return t.prototype.destroy=function(){var t=this.w;if(t)t.removeEventListener("message",this.onwmsg),t.terminate(),this.w=null;else{var e=this.demuxer;e&&(e.destroy(),this.demuxer=null)}var n=this.observer;n&&(n.removeAllListeners(),this.observer=null)},t.prototype.push=function(t,e,n,i,r,o,a,s){var l=this.w,u=isNaN(r.startDTS)?r.start:r.startDTS,c=r.decryptdata,h=this.frag,d=!(h&&r.cc===h.cc),p=!(h&&r.level===h.level),f=h&&r.sn===h.sn+1,m=!p&&f;if(d&&Wt.b.log(this.id+":discontinuity detected"),p&&Wt.b.log(this.id+":switch detected"),this.frag=r,l)l.postMessage({cmd:"demux",data:t,decryptdata:c,initSegment:e,audioCodec:n,videoCodec:i,timeOffset:u,discontinuity:d,trackSwitch:p,contiguous:m,duration:o,accurateTimeOffset:a,defaultInitPTS:s},t instanceof ArrayBuffer?[t]:[]);else{var v=this.demuxer;v&&v.push(t,c,e,n,i,u,d,p,m,o,a,s)}},t.prototype.onWorkerMessage=function(t){var e=t.data,n=this.hls;switch(e.event){case"init":URL.revokeObjectURL(this.w.objectURL);break;case zt.a.FRAG_PARSING_DATA:e.data.data1=new Uint8Array(e.data1),e.data2&&(e.data.data2=new Uint8Array(e.data2));default:e.data=e.data||{},e.data.frag=this.frag,e.data.id=this.id,n.trigger(e.event,e.data)}},t}(),Ie=De,Fe={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"},Oe=function(t){function e(n){w(this,e);var i=T(this,t.call(this,n,zt.a.BUFFER_APPENDED,zt.a.FRAG_BUFFERED,zt.a.FRAG_LOADED));return i.bufferPadding=.2,i.fragments=Object.create(null),i.timeRanges=Object.create(null),i.config=n.config,i}return x(e,t),e.prototype.destroy=function(){this.fragments=null,this.timeRanges=null,this.config=null,Yt.prototype.destroy.call(this),t.prototype.destroy.call(this)},e.prototype.getBufferedFrag=function(t,e){var n=this.fragments,i=Object.keys(n).filter(function(i){var r=n[i];if(r.body.type!==e)return!1;if(!r.buffered)return!1;var o=r.body;return o.startPTS<=t&&t<=o.endPTS});if(0===i.length)return null;var r=i.pop();return n[r].body},e.prototype.detectEvictedFragments=function(t,e){var n=this,i=void 0,r=void 0;Object.keys(this.fragments).forEach(function(o){var a=n.fragments[o];if(!0===a.buffered){var s=a.range[t];if(s){i=s.time;for(var l=0;l<i.length;l++)if(r=i[l],!1===n.isTimeBuffered(r.startPTS,r.endPTS,e)){n.removeFragment(a.body);break}}}})},e.prototype.detectPartialFragments=function(t){var e=this,n=this.getFragmentKey(t),i=this.fragments[n];i&&(i.buffered=!0,Object.keys(this.timeRanges).forEach(function(n){if(!0===t.hasElementaryStream(n)){var r=e.timeRanges[n];i.range[n]=e.getBufferedTimes(t.startPTS,t.endPTS,r)}}))},e.prototype.getBufferedTimes=function(t,e,n){for(var i=[],r=void 0,o=void 0,a=!1,s=0;s<n.length;s++){if(r=n.start(s)-this.bufferPadding,o=n.end(s)+this.bufferPadding,t>=r&&e<=o){i.push({startPTS:Math.max(t,n.start(s)),endPTS:Math.min(e,n.end(s))});break}if(t<o&&e>r)i.push({startPTS:Math.max(t,n.start(s)),endPTS:Math.min(e,n.end(s))}),a=!0;else if(e<=r)break}return{time:i,partial:a}},e.prototype.getFragmentKey=function(t){return t.type+"_"+t.level+"_"+t.sn},e.prototype.getPartialFragment=function(t){var e=this,n=void 0,i=void 0,r=void 0,o=null,a=0;return Object.keys(this.fragments).forEach(function(s){var l=e.fragments[s];e.isPartial(l)&&(i=l.body.startPTS-e.bufferPadding,r=l.body.endPTS+e.bufferPadding,t>=i&&t<=r&&(n=Math.min(t-i,r-t),a<=n&&(o=l.body,a=n)))}),o},e.prototype.getState=function(t){var e=this.getFragmentKey(t),n=this.fragments[e],i=Fe.NOT_LOADED;return void 0!==n&&(i=n.buffered?!0===this.isPartial(n)?Fe.PARTIAL:Fe.OK:Fe.APPENDING),i},e.prototype.isPartial=function(t){return!0===t.buffered&&(void 0!==t.range.video&&!0===t.range.video.partial||void 0!==t.range.audio&&!0===t.range.audio.partial)},e.prototype.isTimeBuffered=function(t,e,n){for(var i=void 0,r=void 0,o=0;o<n.length;o++){if(i=n.start(o)-this.bufferPadding,r=n.end(o)+this.bufferPadding,t>=i&&e<=r)return!0;if(e<=i)return!1}return!1},e.prototype.onFragLoaded=function(t){var e=t.frag;if(!isNaN(e.sn)){var n=this.getFragmentKey(e),i={body:e,range:Object.create(null),buffered:!1};this.fragments[n]=i}},e.prototype.onBufferAppended=function(t){var e=this;this.timeRanges=t.timeRanges,Object.keys(this.timeRanges).forEach(function(t){var n=e.timeRanges[t];e.detectEvictedFragments(t,n)})},e.prototype.onFragBuffered=function(t){this.detectPartialFragments(t.frag)},e.prototype.hasFragment=function(t){var e=this.getFragmentKey(t);return void 0!==this.fragments[e]},e.prototype.removeFragment=function(t){var e=this.getFragmentKey(t);delete this.fragments[e]},e.prototype.removeAllFragments=function(){this.fragments=Object.create(null)},e}(Yt),Ne={toString:function(t){for(var e="",n=t.length,i=0;i<n;i++)e+="["+t.start(i).toFixed(3)+","+t.end(i).toFixed(3)+"]";return e}},Ue=Ne,Ve=function(t){function e(n){D(this,e);for(var i=arguments.length,r=Array(i>1?i-1:0),o=1;o<i;o++)r[o-1]=arguments[o];var a=I(this,t.call.apply(t,[this,n].concat(r)));return a._tickInterval=null,a._tickCallCount=0,a}return F(e,t),e.prototype.destroy=function(){this.clearInterval(),t.prototype.destroy.call(this)},e.prototype.hasInterval=function(){return null!==this._tickInterval},e.prototype.setInterval=function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t){return!this._tickInterval&&(this._tickInterval=setInterval(this.tick.bind(this,!1),t),!0)}),e.prototype.clearInterval=function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(){return!!this._tickInterval&&(clearInterval(this._tickInterval),this._tickInterval=null,!0)}),e.prototype.tick=function(){1===++this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&setTimeout(this.tick.bind(this),0),this._tickCallCount=0)},e.prototype.doTick=function(){throw new Error("TaskLoop is abstract and `doLoop` must be implemented")},e}(Yt),Be=Ve,je=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),Ge={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_LEVEL:"WAITING_LEVEL",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR"},He=function(t){function e(n,i){O(this,e);var r=N(this,t.call(this,n,zt.a.MEDIA_ATTACHED,zt.a.MEDIA_DETACHING,zt.a.MANIFEST_LOADING,zt.a.MANIFEST_PARSED,zt.a.LEVEL_LOADED,zt.a.KEY_LOADED,zt.a.FRAG_LOADED,zt.a.FRAG_LOAD_EMERGENCY_ABORTED,zt.a.FRAG_PARSING_INIT_SEGMENT,zt.a.FRAG_PARSING_DATA,zt.a.FRAG_PARSED,zt.a.ERROR,zt.a.AUDIO_TRACK_SWITCHING,zt.a.AUDIO_TRACK_SWITCHED,zt.a.BUFFER_CREATED,zt.a.BUFFER_APPENDED,zt.a.BUFFER_FLUSHED));return r.fragmentTracker=i,r.config=n.config,r.audioCodecSwap=!1,r._state=Ge.STOPPED,r}return U(e,t),e.prototype.onHandlerDestroying=function(){this.stopLoad()},e.prototype.onHandlerDestroyed=function(){this.state=Ge.STOPPED,this.fragmentTracker=null},e.prototype.startLoad=function(t){if(this.levels){var e=this.lastCurrentTime,n=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var i=n.startLevel;-1===i&&(i=0,this.bitrateTest=!0),this.level=n.nextLoadLevel=i,this.loadedmetadata=!1}e>0&&-1===t&&(Wt.b.log("override startPosition with lastCurrentTime @"+e.toFixed(3)),t=e),this.state=Ge.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=t,this.tick()}else this.forceStartLoad=!0,this.state=Ge.STOPPED},e.prototype.stopLoad=function(){var t=this.fragCurrent;t&&(t.loader&&t.loader.abort(),this.fragmentTracker.removeFragment(t),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.clearInterval(),this.state=Ge.STOPPED,this.forceStartLoad=!1},e.prototype.doTick=function(){switch(this.state){case Ge.BUFFER_FLUSHING:this.fragLoadError=0;break;case Ge.IDLE:this._doTickIdle();break;case Ge.WAITING_LEVEL:var t=this.levels[this.level];t&&t.details&&(this.state=Ge.IDLE);break;case Ge.FRAG_LOADING_WAITING_RETRY:var e=performance.now(),n=this.retryDate;(!n||e>=n||this.media&&this.media.seeking)&&(Wt.b.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=Ge.IDLE);break;case Ge.ERROR:case Ge.STOPPED:case Ge.FRAG_LOADING:case Ge.PARSING:case Ge.PARSED:case Ge.ENDED:}this._checkBuffer(),this._checkFragmentChanged()},e.prototype._doTickIdle=function(){var t=this.hls,e=t.config,n=this.media;if(void 0!==this.levelLastLoaded&&(n||!this.startFragRequested&&e.startFragPrefetch)){var i=void 0;i=this.loadedmetadata?n.currentTime:this.nextLoadPosition;var r=t.nextLoadLevel,o=this.levels[r];if(o){var a=o.bitrate,s=void 0;s=a?Math.max(8*e.maxBufferSize/a,e.maxBufferLength):e.maxBufferLength,s=Math.min(s,e.maxMaxBufferLength);var l=Ae.bufferInfo(this.mediaBuffer?this.mediaBuffer:n,i,e.maxBufferHole),u=l.len;if(!(u>=s)){Wt.b.trace("buffer length of "+u.toFixed(3)+" is below max of "+s.toFixed(3)+". checking for more payload ..."),this.level=t.nextLoadLevel=r;var c=o.details;if(void 0===c||!0===c.live&&this.levelLastLoaded!==r)return void(this.state=Ge.WAITING_LEVEL);var h=this.fragPrevious;if(!c.live&&h&&!h.backtracked&&h.sn===c.endSN&&!l.nextStart){if(Math.min(n.duration,h.start+h.duration)-Math.max(l.end,h.start)<=Math.max(.2,h.duration)){var d={};return this.altAudio&&(d.type="video"),this.hls.trigger(zt.a.BUFFER_EOS,d),void(this.state=Ge.ENDED)}}this._fetchPayloadOrEos(i,l,c)}}}},e.prototype._fetchPayloadOrEos=function(t,e,n){var i=this.fragPrevious,r=this.level,o=n.fragments,a=o.length;if(0!==a){var s=o[0].start,l=o[a-1].start+o[a-1].duration,u=e.end,c=void 0;if(n.initSegment&&!n.initSegment.data)c=n.initSegment;else if(n.live){var h=this.config.initialLiveManifestSize;if(a<h)return void Wt.b.warn("Can not start playback of a level, reason: not enough fragments "+a+" < "+h);if(null===(c=this._ensureFragmentAtLivePoint(n,u,s,l,i,o,a)))return}else u<s&&(c=o[0]);c||(c=this._findFragment(s,i,a,o,u,l,n)),c&&this._loadFragmentOrKey(c,r,n,t,u)}},e.prototype._ensureFragmentAtLivePoint=function(t,e,n,i,r,o,a){var s=this.hls.config,l=this.media,u=void 0,c=void 0!==s.liveMaxLatencyDuration?s.liveMaxLatencyDuration:s.liveMaxLatencyDurationCount*t.targetduration;if(e<Math.max(n-s.maxFragLookUpTolerance,i-c)){var h=this.liveSyncPosition=this.computeLivePosition(n,t);Wt.b.log("buffer end: "+e.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+h.toFixed(3)),e=h,l&&l.readyState&&l.duration>h&&(l.currentTime=h),this.nextLoadPosition=h}if(t.PTSKnown&&e>i&&l&&l.readyState)return null;if(this.startFragRequested&&!t.PTSKnown){if(r)if(t.programDateTime)u=this._findFragmentByPDT(o,r.endPdt+1);else{var d=r.sn+1;if(d>=t.startSN&&d<=t.endSN){var p=o[d-t.startSN];r.cc===p.cc&&(u=p,Wt.b.log("live playlist, switching playlist, load frag with next SN: "+u.sn))}u||(u=Ee.search(o,function(t){return r.cc-t.cc}))&&Wt.b.log("live playlist, switching playlist, load frag with same CC: "+u.sn)}u||(u=o[Math.min(a-1,Math.round(a/2))],Wt.b.log("live playlist, switching playlist, unknown, load middle frag : "+u.sn))}return u},e.prototype._findFragmentByPDT=function(t,e){if(!t||void 0===e)return null;if(e<t[0].pdt)return null;if(e>=t[t.length-1].endPdt)return null;for(var n=0;n<t.length;++n){var i=t[n];if(e<i.endPdt)return i}return null},e.prototype._findFragmentBySN=function(t,e,n,i){var r=this.hls.config,o=void 0,a=r.maxFragLookUpTolerance,s=t?e[t.sn-e[0].sn+1]:void 0,l=function(t){var e=Math.min(a,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-e<=n?1:t.start-e>n&&t.start?-1:0};return n<i&&(n>i-a&&(a=0),o=s&&!l(s)?s:Ee.search(e,l)),o},e.prototype._findFragment=function(t,e,n,i,r,o,a){var s=this.hls.config,l=void 0,u=void 0;if(u=r<o?a.programDateTime?this._findFragmentByPDT(i,1e3*r+(a.programDateTime?Date.parse(a.programDateTime):0)-1e3*t):this._findFragmentBySN(e,i,r,o):i[n-1]){l=u;var c=l.sn-a.startSN,h=e&&l.level===e.level,d=i[c-1],p=i[c+1];if(e&&l.sn===e.sn)if(h&&!l.backtracked)if(l.sn<a.endSN){var f=e.deltaPTS;f&&f>s.maxBufferHole&&e.dropped&&c?(l=d,Wt.b.warn("SN just loaded, with large PTS gap between audio and video, maybe frag is not starting with a keyframe ? load previous one to try to overcome this")):(l=p,Wt.b.log("SN just loaded, load next one: "+l.sn))}else l=null;else l.backtracked&&(p&&p.backtracked?(Wt.b.warn("Already backtracked from fragment "+p.sn+", will not backtrack to fragment "+l.sn+". Loading fragment "+p.sn),l=p):(Wt.b.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),l.dropped=0,d?(l=d,l.backtracked=!0):c&&(l=null)))}return l},e.prototype._loadFragmentOrKey=function(t,e,n,i,r){if(t.decryptdata&&null!=t.decryptdata.uri&&null==t.decryptdata.key)Wt.b.log("Loading key for "+t.sn+" of ["+n.startSN+" ,"+n.endSN+"],level "+e),this.state=Ge.KEY_LOADING,this.hls.trigger(zt.a.KEY_LOADING,{frag:t});else{Wt.b.log("Loading "+t.sn+" of ["+n.startSN+" ,"+n.endSN+"],level "+e+", currentTime:"+i.toFixed(3)+",bufferEnd:"+r.toFixed(3));var o=this.fragmentTracker.getState(t);this.fragCurrent=t,this.startFragRequested=!0,isNaN(t.sn)||t.bitrateTest||(this.nextLoadPosition=t.start+t.duration),t.backtracked||o===Fe.NOT_LOADED?(t.autoLevel=this.hls.autoLevelEnabled,t.bitrateTest=this.bitrateTest,this.hls.trigger(zt.a.FRAG_LOADING,{frag:t}),this.demuxer||(this.demuxer=new Ie(this.hls,"main")),this.state=Ge.FRAG_LOADING):o===Fe.APPENDING&&this._reduceMaxBufferLength(t.duration)&&this.fragmentTracker.removeFragment(t)}},e.prototype.getBufferedFrag=function(t){return this.fragmentTracker.getBufferedFrag(t,ye.LevelType.MAIN)},e.prototype.followingBufferedFrag=function(t){return t?this.getBufferedFrag(t.endPTS+.5):null},e.prototype._checkFragmentChanged=function(){var t=void 0,e=void 0,n=this.media;if(n&&n.readyState&&!1===n.seeking&&(e=n.currentTime,e>n.playbackRate*this.lastCurrentTime&&(this.lastCurrentTime=e),Ae.isBuffered(n,e)?t=this.getBufferedFrag(e):Ae.isBuffered(n,e+.1)&&(t=this.getBufferedFrag(e+.1)),t)){var i=t;if(i!==this.fragPlaying){this.hls.trigger(zt.a.FRAG_CHANGED,{frag:i});var r=i.level;this.fragPlaying&&this.fragPlaying.level===r||this.hls.trigger(zt.a.LEVEL_SWITCHED,{level:r}),this.fragPlaying=i}}},e.prototype.immediateLevelSwitch=function(){if(Wt.b.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var t=this.media,e=void 0;t?(e=t.paused,t.pause()):e=!0,this.previouslyPaused=e}var n=this.fragCurrent;n&&n.loader&&n.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},e.prototype.immediateLevelSwitchEnd=function(){var t=this.media;t&&t.buffered.length&&(this.immediateSwitch=!1,Ae.isBuffered(t,t.currentTime)&&(t.currentTime-=1e-4),this.previouslyPaused||t.play())},e.prototype.nextLevelSwitch=function(){var t=this.media;if(t&&t.readyState){var e=void 0,n=void 0,i=void 0;if(n=this.getBufferedFrag(t.currentTime),n&&n.startPTS>1&&this.flushMainBuffer(0,n.startPTS-1),t.paused)e=0;else{var r=this.hls.nextLoadLevel,o=this.levels[r],a=this.fragLastKbps;e=a&&this.fragCurrent?this.fragCurrent.duration*o.bitrate/(1e3*a)+1:0}if((i=this.getBufferedFrag(t.currentTime+e))&&(i=this.followingBufferedFrag(i))){var s=this.fragCurrent;s&&s.loader&&s.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(i.maxStartPTS,Number.POSITIVE_INFINITY)}}},e.prototype.flushMainBuffer=function(t,e){this.state=Ge.BUFFER_FLUSHING;var n={startOffset:t,endOffset:e};this.altAudio&&(n.type="video"),this.hls.trigger(zt.a.BUFFER_FLUSHING,n)},e.prototype.onMediaAttached=function(t){var e=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),e.addEventListener("seeking",this.onvseeking),e.addEventListener("seeked",this.onvseeked),e.addEventListener("ended",this.onvended);var n=this.config;this.levels&&n.autoStartLoad&&this.hls.startLoad(n.startPosition)},e.prototype.onMediaDetaching=function(){var t=this.media;t&&t.ended&&(Wt.b.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var e=this.levels;e&&e.forEach(function(t){t.details&&t.details.fragments.forEach(function(t){t.backtracked=void 0})}),t&&(t.removeEventListener("seeking",this.onvseeking),t.removeEventListener("seeked",this.onvseeked),t.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()},e.prototype.onMediaSeeking=function(){var t=this.media,e=t?t.currentTime:void 0,n=this.config;isNaN(e)||Wt.b.log("media seeking to "+e.toFixed(3));var i=this.mediaBuffer?this.mediaBuffer:t,r=Ae.bufferInfo(i,e,this.config.maxBufferHole);if(this.state===Ge.FRAG_LOADING){var o=this.fragCurrent;if(0===r.len&&o){var a=n.maxFragLookUpTolerance,s=o.start-a,l=o.start+o.duration+a;e<s||e>l?(o.loader&&(Wt.b.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),o.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=Ge.IDLE):Wt.b.log("seeking outside of buffer but within currently loaded fragment range")}}else this.state===Ge.ENDED&&(0===r.len&&(this.fragPrevious=0),this.state=Ge.IDLE);t&&(this.lastCurrentTime=e),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=e),this.tick()},e.prototype.onMediaSeeked=function(){var t=this.media,e=t?t.currentTime:void 0;isNaN(e)||Wt.b.log("media seeked to "+e.toFixed(3)),this.tick()},e.prototype.onMediaEnded=function(){Wt.b.log("media ended"),this.startPosition=this.lastCurrentTime=0},e.prototype.onManifestLoading=function(){Wt.b.log("trigger BUFFER_RESET"),this.hls.trigger(zt.a.BUFFER_RESET),this.fragmentTracker.removeAllFragments(),this.stalled=!1,this.startPosition=this.lastCurrentTime=0},e.prototype.onManifestParsed=function(t){var e=!1,n=!1,i=void 0;t.levels.forEach(function(t){(i=t.audioCodec)&&(-1!==i.indexOf("mp4a.40.2")&&(e=!0),-1!==i.indexOf("mp4a.40.5")&&(n=!0))}),this.audioCodecSwitch=e&&n,this.audioCodecSwitch&&Wt.b.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1;var r=this.config;(r.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(r.startPosition)},e.prototype.onLevelLoaded=function(t){var e=t.details,n=t.level,i=this.levels[this.levelLastLoaded],r=this.levels[n],o=e.totalduration,a=0;if(Wt.b.log("level "+n+" loaded ["+e.startSN+","+e.endSN+"],duration:"+o),e.live){var s=r.details;s&&e.fragments.length>0?(A(s,e),a=e.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(a,s),e.PTSKnown&&!isNaN(a)?Wt.b.log("live playlist sliding:"+a.toFixed(3)):(Wt.b.log("live playlist - outdated PTS, unknown sliding"),P(this.fragPrevious,i,e))):(Wt.b.log("live playlist - first load, unknown sliding"),e.PTSKnown=!1,P(this.fragPrevious,i,e))}else e.PTSKnown=!1;if(r.details=e,this.levelLastLoaded=n,this.hls.trigger(zt.a.LEVEL_UPDATED,{details:e,level:n}),!1===this.startFragRequested){if(-1===this.startPosition||-1===this.lastCurrentTime){var l=e.startTimeOffset;isNaN(l)?e.live?(this.startPosition=this.computeLivePosition(a,e),Wt.b.log("configure startPosition to "+this.startPosition)):this.startPosition=0:(l<0&&(Wt.b.log("negative start time offset "+l+", count from end of last fragment"),l=a+o+l),Wt.b.log("start time offset found in playlist, adjust startPosition to "+l),this.startPosition=l),this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===Ge.WAITING_LEVEL&&(this.state=Ge.IDLE),this.tick()},e.prototype.onKeyLoaded=function(){this.state===Ge.KEY_LOADING&&(this.state=Ge.IDLE,this.tick())},e.prototype.onFragLoaded=function(t){var e=this.fragCurrent,n=t.frag;if(this.state===Ge.FRAG_LOADING&&e&&"main"===n.type&&n.level===e.level&&n.sn===e.sn){var i=t.stats,r=this.levels[e.level],o=r.details;if(Wt.b.log("Loaded  "+e.sn+" of ["+o.startSN+" ,"+o.endSN+"],level "+e.level),this.bitrateTest=!1,this.stats=i,!0===n.bitrateTest&&this.hls.nextLoadLevel)this.state=Ge.IDLE,this.startFragRequested=!1,i.tparsed=i.tbuffered=performance.now(),this.hls.trigger(zt.a.FRAG_BUFFERED,{stats:i,frag:e,id:"main"}),this.tick();else if("initSegment"===n.sn)this.state=Ge.IDLE,i.tparsed=i.tbuffered=performance.now(),o.initSegment.data=t.payload,this.hls.trigger(zt.a.FRAG_BUFFERED,{stats:i,frag:e,id:"main"}),this.tick();else{this.state=Ge.PARSING;var a=o.totalduration,s=e.level,l=e.sn,u=this.config.defaultAudioCodec||r.audioCodec;this.audioCodecSwap&&(Wt.b.log("swapping playlist audio codec"),void 0===u&&(u=this.lastAudioCodec),u&&(u=-1!==u.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5")),this.pendingBuffering=!0,this.appended=!1,Wt.b.log("Parsing "+l+" of ["+o.startSN+" ,"+o.endSN+"],level "+s+", cc "+e.cc);var c=this.demuxer;c||(c=this.demuxer=new Ie(this.hls,"main"));var h=this.media,d=h&&h.seeking,p=!d&&(o.PTSKnown||!o.live),f=o.initSegment?o.initSegment.data:[];c.push(t.payload,f,u,r.videoCodec,e,a,p,void 0)}}this.fragLoadError=0},e.prototype.onFragParsingInitSegment=function(t){var e=this.fragCurrent,n=t.frag;if(e&&"main"===t.id&&n.sn===e.sn&&n.level===e.level&&this.state===Ge.PARSING){var i=t.tracks,r=void 0,o=void 0;if(i.audio&&this.altAudio&&delete i.audio,o=i.audio){var a=this.levels[this.level].audioCodec,s=navigator.userAgent.toLowerCase();a&&this.audioCodecSwap&&(Wt.b.log("swapping playlist audio codec"),a=-1!==a.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==o.metadata.channelCount&&-1===s.indexOf("firefox")&&(a="mp4a.40.5"),-1!==s.indexOf("android")&&"audio/mpeg"!==o.container&&(a="mp4a.40.2",Wt.b.log("Android: force audio codec to "+a)),o.levelCodec=a,o.id=t.id}o=i.video,o&&(o.levelCodec=this.levels[this.level].videoCodec,o.id=t.id),this.hls.trigger(zt.a.BUFFER_CODECS,i);for(r in i){o=i[r],Wt.b.log("main track:"+r+",container:"+o.container+",codecs[level/parsed]=["+o.levelCodec+"/"+o.codec+"]");var l=o.initSegment;l&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(zt.a.BUFFER_APPENDING,{type:r,data:l,parent:"main",content:"initSegment"}))}this.tick()}},e.prototype.onFragParsingData=function(t){var e=this,n=this.fragCurrent,i=t.frag;if(n&&"main"===t.id&&i.sn===n.sn&&i.level===n.level&&("audio"!==t.type||!this.altAudio)&&this.state===Ge.PARSING){var r=this.levels[this.level],o=n;if(isNaN(t.endPTS)&&(t.endPTS=t.startPTS+n.duration,t.endDTS=t.startDTS+n.duration),!0===t.hasAudio&&o.addElementaryStream(ne.ElementaryStreamTypes.AUDIO),!0===t.hasVideo&&o.addElementaryStream(ne.ElementaryStreamTypes.VIDEO),Wt.b.log("Parsed "+t.type+",PTS:["+t.startPTS.toFixed(3)+","+t.endPTS.toFixed(3)+"],DTS:["+t.startDTS.toFixed(3)+"/"+t.endDTS.toFixed(3)+"],nb:"+t.nb+",dropped:"+(t.dropped||0)),"video"===t.type)if(o.dropped=t.dropped,o.dropped)if(o.backtracked)Wt.b.warn("Already backtracked on this fragment, appending with the gap");else{var a=r.details;if(!a||o.sn!==a.startSN)return Wt.b.warn("missing video frame(s), backtracking fragment"),this.fragmentTracker.removeFragment(o),o.backtracked=!0,this.nextLoadPosition=t.startPTS,this.state=Ge.IDLE,this.fragPrevious=o,void this.tick();Wt.b.warn("missing video frame(s) on first frag, appending with gap")}else o.backtracked=!1;var s=S(r.details,o,t.startPTS,t.endPTS,t.startDTS,t.endDTS),l=this.hls;l.trigger(zt.a.LEVEL_PTS_UPDATED,{details:r.details,level:this.level,drift:s,type:t.type,start:t.startPTS,end:t.endPTS}),[t.data1,t.data2].forEach(function(n){n&&n.length&&e.state===Ge.PARSING&&(e.appended=!0,e.pendingBuffering=!0,l.trigger(zt.a.BUFFER_APPENDING,{type:t.type,data:n,parent:"main",content:"data"}))}),this.tick()}},e.prototype.onFragParsed=function(t){var e=this.fragCurrent,n=t.frag;e&&"main"===t.id&&n.sn===e.sn&&n.level===e.level&&this.state===Ge.PARSING&&(this.stats.tparsed=performance.now(),this.state=Ge.PARSED,this._checkAppendedParsed())},e.prototype.onAudioTrackSwitching=function(t){var e=!!t.url,n=t.id;if(!e){if(this.mediaBuffer!==this.media){Wt.b.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var i=this.fragCurrent;i.loader&&(Wt.b.log("switching to main audio track, cancel main fragment load"),i.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=Ge.IDLE}var r=this.hls;r.trigger(zt.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),r.trigger(zt.a.AUDIO_TRACK_SWITCHED,{id:n}),this.altAudio=!1}},e.prototype.onAudioTrackSwitched=function(t){var e=t.id,n=!!this.hls.audioTracks[e].url;if(n){var i=this.videoBuffer;i&&this.mediaBuffer!==i&&(Wt.b.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=i)}this.altAudio=n,this.tick()},e.prototype.onBufferCreated=function(t){var e=t.tracks,n=void 0,i=void 0,r=!1;for(var o in e){var a=e[o];"main"===a.id?(i=o,n=a,"video"===o&&(this.videoBuffer=e[o].buffer)):r=!0}r&&n?(Wt.b.log("alternate track found, use "+i+".buffered to schedule main fragment loading"),this.mediaBuffer=n.buffer):this.mediaBuffer=this.media},e.prototype.onBufferAppended=function(t){if("main"===t.parent){var e=this.state;e!==Ge.PARSING&&e!==Ge.PARSED||(this.pendingBuffering=t.pending>0,this._checkAppendedParsed())}},e.prototype._checkAppendedParsed=function(){if(!(this.state!==Ge.PARSED||this.appended&&this.pendingBuffering)){var t=this.fragCurrent;if(t){var e=this.mediaBuffer?this.mediaBuffer:this.media;Wt.b.log("main buffered : "+Ue.toString(e.buffered)),this.fragPrevious=t;var n=this.stats;n.tbuffered=performance.now(),this.fragLastKbps=Math.round(8*n.total/(n.tbuffered-n.tfirst)),this.hls.trigger(zt.a.FRAG_BUFFERED,{stats:n,frag:t,id:"main"}),this.state=Ge.IDLE}this.tick()}},e.prototype.onError=function(t){var e=t.frag||this.fragCurrent;if(!e||"main"===e.type){var n=!!this.media&&Ae.isBuffered(this.media,this.media.currentTime)&&Ae.isBuffered(this.media,this.media.currentTime+.5);switch(t.details){case Ht.a.FRAG_LOAD_ERROR:case Ht.a.FRAG_LOAD_TIMEOUT:case Ht.a.KEY_LOAD_ERROR:case Ht.a.KEY_LOAD_TIMEOUT:if(!t.fatal)if(this.fragLoadError+1<=this.config.fragLoadingMaxRetry){var i=Math.min(Math.pow(2,this.fragLoadError)*this.config.fragLoadingRetryDelay,this.config.fragLoadingMaxRetryTimeout);Wt.b.warn("mediaController: frag loading failed, retry in "+i+" ms"),this.retryDate=performance.now()+i,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.fragLoadError++,this.state=Ge.FRAG_LOADING_WAITING_RETRY}else Wt.b.error("mediaController: "+t.details+" reaches max retry, redispatch as fatal ..."),t.fatal=!0,this.state=Ge.ERROR;break;case Ht.a.LEVEL_LOAD_ERROR:case Ht.a.LEVEL_LOAD_TIMEOUT:this.state!==Ge.ERROR&&(t.fatal?(this.state=Ge.ERROR,Wt.b.warn("streamController: "+t.details+",switch to "+this.state+" state ...")):t.levelRetry||this.state!==Ge.WAITING_LEVEL||(this.state=Ge.IDLE));break;case Ht.a.BUFFER_FULL_ERROR:"main"!==t.parent||this.state!==Ge.PARSING&&this.state!==Ge.PARSED||(n?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=Ge.IDLE):(Wt.b.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)))}}},e.prototype._reduceMaxBufferLength=function(t){var e=this.config;return e.maxMaxBufferLength>=t&&(e.maxMaxBufferLength/=2,Wt.b.warn("main:reduce max buffer length to "+e.maxMaxBufferLength+"s"),!0)},e.prototype._checkBuffer=function(){var t=this.media,e=this.config;if(t&&t.readyState){var n=t.currentTime,i=this.mediaBuffer?this.mediaBuffer:t,r=i.buffered;if(!this.loadedmetadata&&r.length){this.loadedmetadata=!0;var o=t.seeking?n:this.startPosition;n!==o&&(Wt.b.log("target start position not buffered, seek to buffered.start(0) "+o+" from current time"+n+" "),t.currentTime=o)}else if(this.immediateSwitch)this.immediateLevelSwitchEnd();else{var a=Ae.bufferInfo(t,n,e.maxBufferHole),s=!(t.paused&&t.readyState>1||t.ended||0===t.buffered.length),l=n!==this.lastCurrentTime;if(l)this.stallReported&&(Wt.b.warn("playback not stuck anymore @"+n+", after "+Math.round(performance.now()-this.stalled)+"ms"),this.stallReported=!1),this.stalled=void 0,this.nudgeRetry=0;else if(s){var u=performance.now(),c=this.hls;if(this.stalled){var h=u-this.stalled,d=a.len,p=this.nudgeRetry||0,f=this.fragmentTracker.getPartialFragment(n);if(null!==f)for(var m=0,v=0;v<t.buffered.length;v++){var g=t.buffered.start(v);if(n>=m&&n<g)return t.currentTime=Math.max(g,t.currentTime+.1),Wt.b.warn("skipping hole, adjusting currentTime from "+n+" to "+t.currentTime),this.stalled=void 0,void c.trigger(zt.a.ERROR,{type:Ht.b.MEDIA_ERROR,details:Ht.a.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+n+" to "+t.currentTime,frag:f});m=t.buffered.end(v)}if(d>.5&&h>1e3*e.highBufferWatchdogPeriod)if(this.stallReported||(this.stallReported=!0,Wt.b.warn("playback stalling in high buffer @"+n),c.trigger(zt.a.ERROR,{type:Ht.b.MEDIA_ERROR,details:Ht.a.BUFFER_STALLED_ERROR,fatal:!1,buffer:d})),this.stalled=void 0,this.nudgeRetry=++p,p<e.nudgeMaxRetry){var y=t.currentTime,b=y+p*e.nudgeOffset;Wt.b.log("adjust currentTime from "+y+" to "+b),t.currentTime=b,c.trigger(zt.a.ERROR,{type:Ht.b.MEDIA_ERROR,details:Ht.a.BUFFER_NUDGE_ON_STALL,fatal:!1})}else Wt.b.error("still stuck in high buffer @"+n+" after "+e.nudgeMaxRetry+", raise fatal error"),c.trigger(zt.a.ERROR,{type:Ht.b.MEDIA_ERROR,details:Ht.a.BUFFER_STALLED_ERROR,fatal:!0})}else this.stalled=u,this.stallReported=!1}}}},e.prototype.onFragLoadEmergencyAborted=function(){this.state=Ge.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()},e.prototype.onBufferFlushed=function(){var t=this.mediaBuffer?this.mediaBuffer:this.media;this.fragmentTracker.detectEvictedFragments(ne.ElementaryStreamTypes.VIDEO,t.buffered),this.state=Ge.IDLE,this.fragPrevious=null},e.prototype.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},e.prototype.computeLivePosition=function(t,e){var n=void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*e.targetduration;return t+Math.max(0,e.totalduration-n)},je(e,[{key:"state",set:function(t){if(this.state!==t){var e=this.state;this._state=t,Wt.b.log("main stream:"+e+"->"+t),this.hls.trigger(zt.a.STREAM_STATE_TRANSITION,{previousState:e,nextState:t})}},get:function(){return this._state}},{key:"currentLevel",get:function(){var t=this.media;if(t){var e=this.getBufferedFrag(t.currentTime);if(e)return e.level}return-1}},{key:"nextBufferedFrag",get:function(){var t=this.media;return t?this.followingBufferedFrag(this.getBufferedFrag(t.currentTime)):null}},{key:"nextLevel",get:function(){var t=this.nextBufferedFrag;return t?t.level:-1}},{key:"liveSyncPosition",get:function(){return this._liveSyncPosition},set:function(t){this._liveSyncPosition=t}}]),e}(Be),ze=He,We=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),Xe=function(t){function e(n){V(this,e);var i=B(this,t.call(this,n,zt.a.MANIFEST_LOADED,zt.a.LEVEL_LOADED,zt.a.FRAG_LOADED,zt.a.ERROR));return i.canload=!1,i.currentLevelIndex=null,i.manualLevelIndex=-1,i.timer=null,i}return j(e,t),e.prototype.onHandlerDestroying=function(){this.cleanTimer(),this.manualLevelIndex=-1},e.prototype.cleanTimer=function(){null!==this.timer&&(clearTimeout(this.timer),this.timer=null)},e.prototype.startLoad=function(){var t=this._levels;this.canload=!0,this.levelRetryCount=0,t&&t.forEach(function(t){t.loadError=0;var e=t.details;e&&e.live&&(t.details=void 0)}),null!==this.timer&&this.loadLevel()},e.prototype.stopLoad=function(){this.canload=!1},e.prototype.onManifestLoaded=function(t){var e=[],n=void 0,i={},r=null,o=!1,a=!1,s=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),u=[];if(t.levels.forEach(function(t){t.loadError=0,t.fragmentError=!1,o=o||!!t.videoCodec,a=a||!!t.audioCodec||!(!t.attrs||!t.attrs.AUDIO),!0===s&&t.audioCodec&&-1!==t.audioCodec.indexOf("mp4a.40.34")&&(t.audioCodec=void 0),r=i[t.bitrate],void 0===r?(t.url=[t.url],t.urlId=0,i[t.bitrate]=t,e.push(t)):r.url.push(t.url)}),!0===o&&!0===a&&(e=e.filter(function(t){return!!t.videoCodec})),e=e.filter(function(t){var e=t.audioCodec,n=t.videoCodec;return(!e||l(e))&&(!n||l(n))}),t.audioTracks&&(u=t.audioTracks.filter(function(t){return!t.audioCodec||l(t.audioCodec,"audio")})),e.length>0){n=e[0].bitrate,e.sort(function(t,e){return t.bitrate-e.bitrate}),this._levels=e;for(var c=0;c<e.length;c++)if(e[c].bitrate===n){this._firstLevel=c,Wt.b.log("manifest loaded,"+e.length+" level(s) found, first bitrate:"+n);break}this.hls.trigger(zt.a.MANIFEST_PARSED,{levels:e,audioTracks:u,firstLevel:this._firstLevel,stats:t.stats,audio:a,video:o,altAudio:u.length>0})}else this.hls.trigger(zt.a.ERROR,{type:Ht.b.MEDIA_ERROR,details:Ht.a.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:this.hls.url,reason:"no level with compatible codecs found in manifest"})},e.prototype.setLevelInternal=function(t){var e=this._levels,n=this.hls;if(t>=0&&t<e.length){if(this.cleanTimer(),this.currentLevelIndex!==t){Wt.b.log("switching to level "+t),this.currentLevelIndex=t;var i=e[t];i.level=t,n.trigger(zt.a.LEVEL_SWITCHING,i)}var r=e[t],o=r.details;if(!o||!0===o.live){var a=r.urlId;n.trigger(zt.a.LEVEL_LOADING,{url:r.url[a],level:t,id:a})}}else n.trigger(zt.a.ERROR,{type:Ht.b.OTHER_ERROR,details:Ht.a.LEVEL_SWITCH_ERROR,level:t,fatal:!1,reason:"invalid level idx"})},e.prototype.onError=function(t){if(!0===t.fatal)return void(t.type===Ht.b.NETWORK_ERROR&&this.cleanTimer());var e=!1,n=!1,i=void 0;switch(t.details){case Ht.a.FRAG_LOAD_ERROR:case Ht.a.FRAG_LOAD_TIMEOUT:case Ht.a.KEY_LOAD_ERROR:case Ht.a.KEY_LOAD_TIMEOUT:i=t.frag.level,n=!0;break;case Ht.a.LEVEL_LOAD_ERROR:case Ht.a.LEVEL_LOAD_TIMEOUT:i=t.context.level,e=!0;break;case Ht.a.REMUX_ALLOC_ERROR:i=t.level,e=!0}void 0!==i&&this.recoverLevel(t,i,e,n)},e.prototype.recoverLevel=function(t,e,n,i){var r=this,o=this.hls.config,a=t.details,s=this._levels[e],l=void 0,u=void 0,c=void 0;if(s.loadError++,s.fragmentError=i,!0===n){if(!(this.levelRetryCount+1<=o.levelLoadingMaxRetry))return Wt.b.error("level controller, cannot recover from "+a+" error"),this.currentLevelIndex=null,this.cleanTimer(),void(t.fatal=!0);u=Math.min(Math.pow(2,this.levelRetryCount)*o.levelLoadingRetryDelay,o.levelLoadingMaxRetryTimeout),this.timer=setTimeout(function(){return r.loadLevel()},u),t.levelRetry=!0,this.levelRetryCount++,Wt.b.warn("level controller, "+a+", retry in "+u+" ms, current retry count is "+this.levelRetryCount)}!0!==n&&!0!==i||(l=s.url.length,l>1&&s.loadError<l?(Wt.b.warn("level controller, "+a+" for level "+e+": switching to redundant stream id "+s.urlId),s.urlId=(s.urlId+1)%l,s.details=void 0):-1===this.manualLevelIndex?(c=0===e?this._levels.length-1:e-1,Wt.b.warn("level controller, "+a+": switch to "+c),this.hls.nextAutoLevel=this.currentLevelIndex=c):!0===i&&(Wt.b.warn("level controller, "+a+": reload a fragment"),this.currentLevelIndex=null))},e.prototype.onFragLoaded=function(t){var e=t.frag;if(void 0!==e&&"main"===e.type){var n=this._levels[e.level];void 0!==n&&(n.fragmentError=!1,n.loadError=0,this.levelRetryCount=0)}},e.prototype.onLevelLoaded=function(t){var e=this,n=t.level;if(n===this.currentLevelIndex){var i=this._levels[n];!1===i.fragmentError&&(i.loadError=0,this.levelRetryCount=0);var r=t.details;if(r.live){var o=1e3*(r.averagetargetduration?r.averagetargetduration:r.targetduration),a=o,s=i.details;s&&r.endSN===s.endSN&&(a/=2,Wt.b.log("same live playlist, reload twice faster")),a-=performance.now()-t.stats.trequest,a=Math.max(o/2,Math.round(a)),Wt.b.log("live playlist, reload in "+Math.round(a)+" ms"),this.timer=setTimeout(function(){return e.loadLevel()},a)}else this.cleanTimer()}},e.prototype.loadLevel=function(){var t=void 0,e=void 0;null!==this.currentLevelIndex&&!0===this.canload&&void 0!==(t=this._levels[this.currentLevelIndex])&&t.url.length>0&&(e=t.urlId,this.hls.trigger(zt.a.LEVEL_LOADING,{url:t.url[e],level:this.currentLevelIndex,id:e}))},We(e,[{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(t){var e=this._levels;e&&(t=Math.min(t,e.length-1),this.currentLevelIndex===t&&void 0!==e[t].details||this.setLevelInternal(t))}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(t){this.manualLevelIndex=t,void 0===this._startLevel&&(this._startLevel=t),-1!==t&&(this.level=t)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(t){this._firstLevel=t}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var t=this.hls.config.startLevel;return void 0!==t?t:this._firstLevel}return this._startLevel},set:function(t){this._startLevel=t}},{key:"nextLoadLevel",get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(t){this.level=t,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=t)}}]),e}(Yt),qe=Xe,Ke=n(4),Ye=function(t){function e(n){z(this,e);var i=W(this,t.call(this,n,zt.a.MEDIA_ATTACHED,zt.a.MEDIA_DETACHING,zt.a.FRAG_PARSING_METADATA));return i.id3Track=void 0,i.media=void 0,i}return X(e,t),e.prototype.destroy=function(){Yt.prototype.destroy.call(this)},e.prototype.onMediaAttached=function(t){this.media=t.media,this.media},e.prototype.onMediaDetaching=function(){H(this.id3Track),this.id3Track=void 0,this.media=void 0},e.prototype.getID3Track=function(t){for(var e=0;e<t.length;e++){var n=t[e];if("metadata"===n.kind&&"id3"===n.label)return G(n,this.media),n}return this.media.addTextTrack("metadata","id3")},e.prototype.onFragParsingMetadata=function(t){var e=t.frag,n=t.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var i=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,r=0;r<n.length;r++){var o=Ke.a.getID3Frames(n[r].data);if(o){var a=n[r].pts,s=r<n.length-1?n[r+1].pts:e.endPTS;a===s&&(s+=1e-4);for(var l=0;l<o.length;l++){var u=o[l];if(!Ke.a.isTimeStampFrame(u)){var c=new i(a,s,"");c.value=u,this.id3Track.addCue(c)}}}}},e}(Yt),$e=Ye,Qe=function(){function t(e){K(this,t),this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=0,this.totalWeight_=0}return t.prototype.sample=function(t,e){var n=Math.pow(this.alpha_,t);this.estimate_=e*(1-n)+n*this.estimate_,this.totalWeight_+=t},t.prototype.getTotalWeight=function(){return this.totalWeight_},t.prototype.getEstimate=function(){if(this.alpha_){var t=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/t}return this.estimate_},t}(),Je=Qe,Ze=function(){function t(e,n,i,r){Y(this,t),this.hls=e,this.defaultEstimate_=r,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Je(n),this.fast_=new Je(i)}return t.prototype.sample=function(t,e){t=Math.max(t,this.minDelayMs_);var n=8e3*e/t,i=t/1e3;this.fast_.sample(i,n),this.slow_.sample(i,n)},t.prototype.canEstimate=function(){var t=this.fast_;return t&&t.getTotalWeight()>=this.minWeight_},t.prototype.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},t.prototype.destroy=function(){},t}(),tn=Ze,en=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),nn=function(t){function e(n){$(this,e);var i=Q(this,t.call(this,n,zt.a.FRAG_LOADING,zt.a.FRAG_LOADED,zt.a.FRAG_BUFFERED,zt.a.ERROR));return i.lastLoadedFragLevel=0,i._nextAutoLevel=-1,i.hls=n,i.timer=null,i._bwEstimator=null,i.onCheck=i._abandonRulesCheck.bind(i),i}return J(e,t),e.prototype.destroy=function(){this.clearTimer(),Yt.prototype.destroy.call(this)},e.prototype.onFragLoading=function(t){var e=t.frag;if("main"===e.type){if(this.timer||(this.timer=setInterval(this.onCheck,100)),!this._bwEstimator){var n=this.hls,i=t.frag.level,r=n.levels[i].details.live,o=n.config,a=void 0,s=void 0;r?(a=o.abrEwmaFastLive,s=o.abrEwmaSlowLive):(a=o.abrEwmaFastVoD,s=o.abrEwmaSlowVoD),this._bwEstimator=new tn(n,s,a,o.abrEwmaDefaultEstimate)}this.fragCurrent=e}},e.prototype._abandonRulesCheck=function(){var t=this.hls,e=t.media,n=this.fragCurrent,i=n.loader,r=t.minAutoLevel;if(!i||i.stats&&i.stats.aborted)return Wt.b.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),void(this._nextAutoLevel=-1);var o=i.stats;if(e&&o&&(!e.paused&&0!==e.playbackRate||!e.readyState)&&n.autoLevel&&n.level){var a=performance.now()-o.trequest,s=Math.abs(e.playbackRate);if(a>500*n.duration/s){var l=t.levels,u=Math.max(1,o.bw?o.bw/8:1e3*o.loaded/a),c=l[n.level],h=c.realBitrate?Math.max(c.realBitrate,c.bitrate):c.bitrate,d=o.total?o.total:Math.max(o.loaded,Math.round(n.duration*h/8)),p=e.currentTime,f=(d-o.loaded)/u,m=(Ae.bufferInfo(e,p,t.config.maxBufferHole).end-p)/s;if(m<2*n.duration/s&&f>m){var v=void 0,g=void 0;for(g=n.level-1;g>r;g--){var y=l[g].realBitrate?Math.max(l[g].realBitrate,l[g].bitrate):l[g].bitrate;if((v=n.duration*y/(6.4*u))<m)break}v<f&&(Wt.b.warn("loading too slow, abort fragment loading and switch to level "+g+":fragLoadedDelay["+g+"]<fragLoadedDelay["+(n.level-1)+"];bufferStarvationDelay:"+v.toFixed(1)+"<"+f.toFixed(1)+":"+m.toFixed(1)),t.nextLoadLevel=g,this._bwEstimator.sample(a,o.loaded),i.abort(),this.clearTimer(),t.trigger(zt.a.FRAG_LOAD_EMERGENCY_ABORTED,{frag:n,stats:o}))}}}},e.prototype.onFragLoaded=function(t){var e=t.frag;if("main"===e.type&&!isNaN(e.sn)){if(this.clearTimer(),this.lastLoadedFragLevel=e.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var n=this.hls.levels[e.level],i=(n.loaded?n.loaded.bytes:0)+t.stats.loaded,r=(n.loaded?n.loaded.duration:0)+t.frag.duration;n.loaded={bytes:i,duration:r},n.realBitrate=Math.round(8*i/r)}if(t.frag.bitrateTest){var o=t.stats;o.tparsed=o.tbuffered=o.tload,this.onFragBuffered(t)}}},e.prototype.onFragBuffered=function(t){var e=t.stats,n=t.frag;if(!(!0===e.aborted||"main"!==n.type||isNaN(n.sn)||n.bitrateTest&&e.tload!==e.tbuffered)){var i=e.tparsed-e.trequest;Wt.b.log("latency/loading/parsing/append/kbps:"+Math.round(e.tfirst-e.trequest)+"/"+Math.round(e.tload-e.tfirst)+"/"+Math.round(e.tparsed-e.tload)+"/"+Math.round(e.tbuffered-e.tparsed)+"/"+Math.round(8*e.loaded/(e.tbuffered-e.trequest))),this._bwEstimator.sample(i,e.loaded),e.bwEstimate=this._bwEstimator.getEstimate(),n.bitrateTest?this.bitrateTestDelay=i/1e3:this.bitrateTestDelay=0}},e.prototype.onError=function(t){switch(t.details){case Ht.a.FRAG_LOAD_ERROR:case Ht.a.FRAG_LOAD_TIMEOUT:this.clearTimer()}},e.prototype.clearTimer=function(){clearInterval(this.timer),this.timer=null},e.prototype._findBestLevel=function(t,e,n,i,r,o,a,s,l){for(var u=r;u>=i;u--){var c=l[u],h=c.details,d=h?h.totalduration/h.fragments.length:e,p=!!h&&h.live,f=void 0;f=u<=t?a*n:s*n;var m=l[u].realBitrate?Math.max(l[u].realBitrate,l[u].bitrate):l[u].bitrate,v=m*d/f;if(Wt.b.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+u+"/"+Math.round(f)+"/"+m+"/"+d+"/"+o+"/"+v),f>m&&(!v||p&&!this.bitrateTestDelay||v<o))return u}return-1},en(e,[{key:"nextAutoLevel",get:function(){var t=this._nextAutoLevel,e=this._bwEstimator;if(!(-1===t||e&&e.canEstimate()))return t;var n=this._nextABRAutoLevel;return-1!==t&&(n=Math.min(t,n)),n},set:function(t){this._nextAutoLevel=t}},{key:"_nextABRAutoLevel",get:function(){var t=this.hls,e=t.maxAutoLevel,n=t.levels,i=t.config,r=t.minAutoLevel,o=t.media,a=this.lastLoadedFragLevel,s=this.fragCurrent?this.fragCurrent.duration:0,l=o?o.currentTime:0,u=o&&0!==o.playbackRate?Math.abs(o.playbackRate):1,c=this._bwEstimator?this._bwEstimator.getEstimate():i.abrEwmaDefaultEstimate,h=(Ae.bufferInfo(o,l,i.maxBufferHole).end-l)/u,d=this._findBestLevel(a,s,c,r,e,h,i.abrBandWidthFactor,i.abrBandWidthUpFactor,n);if(d>=0)return d;Wt.b.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var p=s?Math.min(s,i.maxStarvationDelay):i.maxStarvationDelay,f=i.abrBandWidthFactor,m=i.abrBandWidthUpFactor;if(0===h){var v=this.bitrateTestDelay;if(v){p=(s?Math.min(s,i.maxLoadingDelay):i.maxLoadingDelay)-v,Wt.b.trace("bitrate test took "+Math.round(1e3*v)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*p)+" ms"),f=m=1}}return d=this._findBestLevel(a,s,c,r,e,h+p,f,m,n),Math.max(d,0)}}]),e}(Yt),rn=nn,on=b(),an=function(t){function e(n){Z(this,e);var i=tt(this,t.call(this,n,zt.a.MEDIA_ATTACHING,zt.a.MEDIA_DETACHING,zt.a.MANIFEST_PARSED,zt.a.BUFFER_RESET,zt.a.BUFFER_APPENDING,zt.a.BUFFER_CODECS,zt.a.BUFFER_EOS,zt.a.BUFFER_FLUSHING,zt.a.LEVEL_PTS_UPDATED,zt.a.LEVEL_UPDATED));return i._msDuration=null,i._levelDuration=null,i._live=null,i._objectUrl=null,i.onsbue=i.onSBUpdateEnd.bind(i),i.onsbe=i.onSBUpdateError.bind(i),i.pendingTracks={},i.tracks={},i}return et(e,t),e.prototype.destroy=function(){Yt.prototype.destroy.call(this)},e.prototype.onLevelPtsUpdated=function(t){var e=t.type,n=this.tracks.audio;if("audio"===e&&n&&"audio/mpeg"===n.container){var i=this.sourceBuffer.audio;if(Math.abs(i.timestampOffset-t.start)>.1){var r=i.updating;try{i.abort()}catch(t){r=!0,Wt.b.warn("can not abort audio buffer: "+t)}r?this.audioTimestampOffset=t.start:(Wt.b.warn("change mpeg audio timestamp offset from "+i.timestampOffset+" to "+t.start),i.timestampOffset=t.start)}}},e.prototype.onManifestParsed=function(t){var e=t.audio,n=t.video||t.levels.length&&t.audio,i=0;t.altAudio&&(e||n)&&(i=(e?1:0)+(n?1:0),Wt.b.log(i+" sourceBuffer(s) expected")),this.sourceBufferNb=i},e.prototype.onMediaAttaching=function(t){var e=this.media=t.media;if(e){var n=this.mediaSource=new on;this.onmso=this.onMediaSourceOpen.bind(this),this.onmse=this.onMediaSourceEnded.bind(this),this.onmsc=this.onMediaSourceClose.bind(this),n.addEventListener("sourceopen",this.onmso),n.addEventListener("sourceended",this.onmse),n.addEventListener("sourceclose",this.onmsc),e.src=URL.createObjectURL(n),this._objectUrl=e.src}},e.prototype.onMediaDetaching=function(){Wt.b.log("media source detaching");var t=this.mediaSource;if(t){if("open"===t.readyState)try{t.endOfStream()}catch(t){Wt.b.warn("onMediaDetaching:"+t.message+" while calling endOfStream")}t.removeEventListener("sourceopen",this.onmso),t.removeEventListener("sourceended",this.onmse),t.removeEventListener("sourceclose",this.onmsc),this.media&&(URL.revokeObjectURL(this._objectUrl),this.media.src===this._objectUrl?(this.media.removeAttribute("src"),this.media.load()):Wt.b.warn("media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.onmso=this.onmse=this.onmsc=null,this.hls.trigger(zt.a.MEDIA_DETACHED)},e.prototype.onMediaSourceOpen=function(){Wt.b.log("media source opened"),this.hls.trigger(zt.a.MEDIA_ATTACHED,{media:this.media});var t=this.mediaSource;t&&t.removeEventListener("sourceopen",this.onmso),this.checkPendingTracks()},e.prototype.checkPendingTracks=function(){var t=this.pendingTracks,e=Object.keys(t).length;e&&(this.sourceBufferNb<=e||0===this.sourceBufferNb)&&(this.createSourceBuffers(t),this.pendingTracks={},this.doAppending())},e.prototype.onMediaSourceClose=function(){Wt.b.log("media source closed")},e.prototype.onMediaSourceEnded=function(){Wt.b.log("media source ended")},e.prototype.onSBUpdateEnd=function(){if(this.audioTimestampOffset){var t=this.sourceBuffer.audio;Wt.b.warn("change mpeg audio timestamp offset from "+t.timestampOffset+" to "+this.audioTimestampOffset),t.timestampOffset=this.audioTimestampOffset,delete this.audioTimestampOffset}this._needsFlush&&this.doFlush(),this._needsEos&&this.checkEos(),this.appending=!1;var e=this.parent,n=this.segments.reduce(function(t,n){return n.parent===e?t+1:t},0),i={},r=this.sourceBuffer;for(var o in r)i[o]=r[o].buffered;this.hls.trigger(zt.a.BUFFER_APPENDED,{parent:e,pending:n,timeRanges:i}),this._needsFlush||this.doAppending(),this.updateMediaElementDuration()},e.prototype.onSBUpdateError=function(t){Wt.b.error("sourceBuffer error:",t),this.hls.trigger(zt.a.ERROR,{type:Ht.b.MEDIA_ERROR,details:Ht.a.BUFFER_APPENDING_ERROR,fatal:!1})},e.prototype.onBufferReset=function(){var t=this.sourceBuffer;for(var e in t){var n=t[e];try{this.mediaSource.removeSourceBuffer(n),n.removeEventListener("updateend",this.onsbue),n.removeEventListener("error",this.onsbe)}catch(t){}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0},e.prototype.onBufferCodecs=function(t){if(0===Object.keys(this.sourceBuffer).length){for(var e in t)this.pendingTracks[e]=t[e];var n=this.mediaSource;n&&"open"===n.readyState&&this.checkPendingTracks()}},e.prototype.createSourceBuffers=function(t){var e=this.sourceBuffer,n=this.mediaSource;for(var i in t)if(!e[i]){var r=t[i],o=r.levelCodec||r.codec,a=r.container+";codecs="+o;Wt.b.log("creating sourceBuffer("+a+")");try{var s=e[i]=n.addSourceBuffer(a);s.addEventListener("updateend",this.onsbue),s.addEventListener("error",this.onsbe),this.tracks[i]={codec:o,container:r.container},r.buffer=s}catch(t){Wt.b.error("error while trying to add sourceBuffer:"+t.message),this.hls.trigger(zt.a.ERROR,{type:Ht.b.MEDIA_ERROR,details:Ht.a.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:t,mimeType:a})}}this.hls.trigger(zt.a.BUFFER_CREATED,{tracks:t})},e.prototype.onBufferAppending=function(t){this._needsFlush||(this.segments?this.segments.push(t):this.segments=[t],this.doAppending())},e.prototype.onBufferAppendFail=function(t){Wt.b.error("sourceBuffer error:",t.event),this.hls.trigger(zt.a.ERROR,{type:Ht.b.MEDIA_ERROR,details:Ht.a.BUFFER_APPENDING_ERROR,fatal:!1})},e.prototype.onBufferEos=function(t){var e=this.sourceBuffer,n=t.type;for(var i in e)n&&i!==n||e[i].ended||(e[i].ended=!0,Wt.b.log(i+" sourceBuffer now EOS"));this.checkEos()},e.prototype.checkEos=function(){var t=this.sourceBuffer,e=this.mediaSource;if(!e||"open"!==e.readyState)return void(this._needsEos=!1);for(var n in t){var i=t[n];if(!i.ended)return;if(i.updating)return void(this._needsEos=!0)}Wt.b.log("all media data available, signal endOfStream() to MediaSource and stop loading fragment");try{e.endOfStream()}catch(t){Wt.b.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1},e.prototype.onBufferFlushing=function(t){this.flushRange.push({start:t.startOffset,end:t.endOffset,type:t.type}),this.flushBufferCounter=0,this.doFlush()},e.prototype.onLevelUpdated=function(t){var e=t.details;e.fragments.length>0&&(this._levelDuration=e.totalduration+e.fragments[0].start,this._live=e.live,this.updateMediaElementDuration())},e.prototype.updateMediaElementDuration=function(){var t=this.hls.config,e=void 0;if(null!==this._levelDuration&&this.media&&this.mediaSource&&this.sourceBuffer&&0!==this.media.readyState&&"open"===this.mediaSource.readyState){for(var n in this.sourceBuffer)if(!0===this.sourceBuffer[n].updating)return;e=this.media.duration,null===this._msDuration&&(this._msDuration=this.mediaSource.duration),!0===this._live&&!0===t.liveDurationInfinity?(Wt.b.log("Media Source duration is set to Infinity"),this._msDuration=this.mediaSource.duration=1/0):(this._levelDuration>this._msDuration&&this._levelDuration>e||e===1/0||isNaN(e))&&(Wt.b.log("Updating Media Source duration to "+this._levelDuration.toFixed(3)),this._msDuration=this.mediaSource.duration=this._levelDuration)}},e.prototype.doFlush=function(){for(;this.flushRange.length;){var t=this.flushRange[0];if(!this.flushBuffer(t.start,t.end,t.type))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var e=0,n=this.sourceBuffer;try{for(var i in n)e+=n[i].buffered.length}catch(t){Wt.b.error("error while accessing sourceBuffer.buffered")}this.appended=e,this.hls.trigger(zt.a.BUFFER_FLUSHED)}},e.prototype.doAppending=function(){var t=this.hls,e=this.sourceBuffer,n=this.segments;if(Object.keys(e).length){if(this.media.error)return this.segments=[],void Wt.b.error("trying to append although a media error occured, flush segment and abort");if(this.appending)return;if(n&&n.length){var i=n.shift();try{var r=i.type,o=e[r];o?o.updating?n.unshift(i):(o.ended=!1,this.parent=i.parent,o.appendBuffer(i.data),this.appendError=0,this.appended++,this.appending=!0):this.onSBUpdateEnd()}catch(e){Wt.b.error("error while trying to append buffer:"+e.message),n.unshift(i);var a={type:Ht.b.MEDIA_ERROR,parent:i.parent};22!==e.code?(this.appendError?this.appendError++:this.appendError=1,a.details=Ht.a.BUFFER_APPEND_ERROR,this.appendError>t.config.appendErrorMaxRetry?(Wt.b.log("fail "+t.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),n=[],a.fatal=!0,t.trigger(zt.a.ERROR,a)):(a.fatal=!1,t.trigger(zt.a.ERROR,a))):(this.segments=[],a.details=Ht.a.BUFFER_FULL_ERROR,a.fatal=!1,t.trigger(zt.a.ERROR,a))}}}},e.prototype.flushBuffer=function(t,e,n){var i=void 0,r=void 0,o=void 0,a=void 0,s=void 0,l=void 0,u=this.sourceBuffer;if(Object.keys(u).length){if(Wt.b.log("flushBuffer,pos/start/end: "+this.media.currentTime.toFixed(3)+"/"+t+"/"+e),this.flushBufferCounter<this.appended){for(var c in u)if(!n||c===n){if(i=u[c],i.ended=!1,i.updating)return Wt.b.warn("cannot flush, sb updating in progress"),!1;try{for(r=0;r<i.buffered.length;r++)if(o=i.buffered.start(r),a=i.buffered.end(r),-1!==navigator.userAgent.toLowerCase().indexOf("firefox")&&e===Number.POSITIVE_INFINITY?(s=t,l=e):(s=Math.max(o,t),l=Math.min(a,e)),Math.min(l,a)-s>.5)return this.flushBufferCounter++,Wt.b.log("flush "+c+" ["+s+","+l+"], of ["+o+","+a+"], pos:"+this.media.currentTime),i.remove(s,l),!1}catch(t){Wt.b.warn("exception while accessing sourcebuffer, it might have been removed from MediaSource")}}}else Wt.b.warn("abort flushing too many retries");Wt.b.log("buffer flushed")}return!0},e}(Yt),sn=an,ln=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),un=function(t){function e(n){return nt(this,e),it(this,t.call(this,n,zt.a.FPS_DROP_LEVEL_CAPPING,zt.a.MEDIA_ATTACHING,zt.a.MANIFEST_PARSED))}return rt(e,t),e.prototype.destroy=function(){this.hls.config.capLevelToPlayerSize&&(this.media=this.restrictedLevels=null,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer)))},e.prototype.onFpsDropLevelCapping=function(t){e.isLevelAllowed(t.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(t.droppedLevel)},e.prototype.onMediaAttaching=function(t){this.media=t.media instanceof HTMLVideoElement?t.media:null},e.prototype.onManifestParsed=function(t){var e=this.hls;this.restrictedLevels=[],e.config.capLevelToPlayerSize&&(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.levels=t.levels,e.firstLevel=this.getMaxLevel(t.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},e.prototype.detectPlayerSize=function(){if(this.media){var t=this.levels?this.levels.length:0;if(t){var e=this.hls;e.autoLevelCapping=this.getMaxLevel(t-1),e.autoLevelCapping>this.autoLevelCapping&&e.streamController.nextLevelSwitch(),this.autoLevelCapping=e.autoLevelCapping}}},e.prototype.getMaxLevel=function(t){var n=this;if(!this.levels)return-1;var i=this.levels.filter(function(i,r){return e.isLevelAllowed(r,n.restrictedLevels)&&r<=t});return e.getMaxLevelByMediaSize(i,this.mediaWidth,this.mediaHeight)},e.isLevelAllowed=function(t){return-1===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).indexOf(t)},e.getMaxLevelByMediaSize=function(t,e,n){if(!t||t&&!t.length)return-1;for(var i=t.length-1,r=0;r<t.length;r+=1){var o=t[r];if((o.width>=e||o.height>=n)&&function(t,e){return!e||(t.width!==e.width||t.height!==e.height)}(o,t[r+1])){i=r;break}}return i},ln(e,[{key:"mediaWidth",get:function(){var t=void 0,n=this.media;return n&&(t=n.width||n.clientWidth||n.offsetWidth,t*=e.contentScaleFactor),t}},{key:"mediaHeight",get:function(){var t=void 0,n=this.media;return n&&(t=n.height||n.clientHeight||n.offsetHeight,t*=e.contentScaleFactor),t}}],[{key:"contentScaleFactor",get:function(){var t=1;try{t=window.devicePixelRatio}catch(t){}return t}}]),e}(Yt),cn=un,hn=function(t){function e(n){return ot(this,e),at(this,t.call(this,n,zt.a.MEDIA_ATTACHING))}return st(e,t),e.prototype.destroy=function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1},e.prototype.onMediaAttaching=function(t){var e=this.hls.config;if(e.capLevelOnFPSDrop){"function"==typeof(this.video=t.media instanceof HTMLVideoElement?t.media:null).getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),e.fpsDroppedMonitoringPeriod)}},e.prototype.checkFPS=function(t,e,n){var i=performance.now();if(e){if(this.lastTime){var r=i-this.lastTime,o=n-this.lastDroppedFrames,a=e-this.lastDecodedFrames,s=1e3*o/r,l=this.hls;if(l.trigger(zt.a.FPS_DROP,{currentDropped:o,currentDecoded:a,totalDroppedFrames:n}),s>0&&o>l.config.fpsDroppedMonitoringThreshold*a){var u=l.currentLevel;Wt.b.warn("drop FPS ratio greater than max allowed value for currentLevel: "+u),u>0&&(-1===l.autoLevelCapping||l.autoLevelCapping>=u)&&(u-=1,l.trigger(zt.a.FPS_DROP_LEVEL_CAPPING,{level:u,droppedLevel:l.currentLevel}),l.autoLevelCapping=u,l.streamController.nextLevelSwitch())}}this.lastTime=i,this.lastDroppedFrames=n,this.lastDecodedFrames=e}},e.prototype.checkFPSInterval=function(){var t=this.video;if(t)if(this.isVideoPlaybackQualityAvailable){var e=t.getVideoPlaybackQuality();this.checkFPS(t,e.totalVideoFrames,e.droppedVideoFrames)}else this.checkFPS(t,t.webkitDecodedFrameCount,t.webkitDroppedFrameCount)},e}(Yt),dn=hn,pn=function(){function t(e){lt(this,t),e&&e.xhrSetup&&(this.xhrSetup=e.xhrSetup)}return t.prototype.destroy=function(){this.abort(),this.loader=null},t.prototype.abort=function(){var t=this.loader;t&&4!==t.readyState&&(this.stats.aborted=!0,t.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null},t.prototype.load=function(t,e,n){this.context=t,this.config=e,this.callbacks=n,this.stats={trequest:performance.now(),retry:0},this.retryDelay=e.retryDelay,this.loadInternal()},t.prototype.loadInternal=function(){var t=void 0,e=this.context;t=this.loader=new XMLHttpRequest;var n=this.stats;n.tfirst=0,n.loaded=0;var i=this.xhrSetup;try{if(i)try{i(t,e.url)}catch(n){t.open("GET",e.url,!0),i(t,e.url)}t.readyState||t.open("GET",e.url,!0)}catch(n){return void this.callbacks.onError({code:t.status,text:n.message},e,t)}e.rangeEnd&&t.setRequestHeader("Range","bytes="+e.rangeStart+"-"+(e.rangeEnd-1)),t.onreadystatechange=this.readystatechange.bind(this),t.onprogress=this.loadprogress.bind(this),t.responseType=e.responseType,this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),t.send()},t.prototype.readystatechange=function(t){var e=t.currentTarget,n=e.readyState,i=this.stats,r=this.context,o=this.config;if(!i.aborted&&n>=2)if(window.clearTimeout(this.requestTimeout),0===i.tfirst&&(i.tfirst=Math.max(performance.now(),i.trequest)),4===n){var a=e.status;if(a>=200&&a<300){i.tload=Math.max(i.tfirst,performance.now());var s=void 0,l=void 0;"arraybuffer"===r.responseType?(s=e.response,l=s.byteLength):(s=e.responseText,l=s.length),i.loaded=i.total=l;var u={url:e.responseURL,data:s};this.callbacks.onSuccess(u,i,r,e)}else i.retry>=o.maxRetry||a>=400&&a<499?(Wt.b.error(a+" while loading "+r.url),this.callbacks.onError({code:a,text:e.statusText},r,e)):(Wt.b.warn(a+" while loading "+r.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,o.maxRetryDelay),i.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),o.timeout)},t.prototype.loadtimeout=function(){Wt.b.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context,null)},t.prototype.loadprogress=function(t){var e=t.currentTarget,n=this.stats;n.loaded=t.loaded,t.lengthComputable&&(n.total=t.total);var i=this.callbacks.onProgress;i&&i(n,this.context,null,e)},t}(),fn=pn,mn=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),vn=function(t){function e(n){ut(this,e);var i=ct(this,t.call(this,n,zt.a.MANIFEST_LOADING,zt.a.MANIFEST_PARSED,zt.a.AUDIO_TRACK_LOADED,zt.a.ERROR));return i.ticks=0,i.ontick=i.tick.bind(i),i}return ht(e,t),e.prototype.destroy=function(){this.cleanTimer(),Yt.prototype.destroy.call(this)},e.prototype.cleanTimer=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},e.prototype.tick=function(){1===++this.ticks&&(this.doTick(),this.ticks>1&&setTimeout(this.tick,1),this.ticks=0)},e.prototype.doTick=function(){this.updateTrack(this.trackId)},e.prototype.onError=function(t){t.fatal&&t.type===Ht.b.NETWORK_ERROR&&this.cleanTimer()},e.prototype.onManifestLoading=function(){this.tracks=[],this.trackId=-1},e.prototype.onManifestParsed=function(t){var e=this,n=t.audioTracks||[],i=!1;this.tracks=n,this.hls.trigger(zt.a.AUDIO_TRACKS_UPDATED,{audioTracks:n});var r=0;n.forEach(function(t){if(t.default&&!i)return e.audioTrack=r,void(i=!0);r++}),!1===i&&n.length&&(Wt.b.log("no default audio track defined, use first audio track as default"),this.audioTrack=0)},e.prototype.onAudioTrackLoaded=function(t){t.id<this.tracks.length&&(Wt.b.log("audioTrack "+t.id+" loaded"),this.tracks[t.id].details=t.details,t.details.live&&!this.timer&&(this.timer=setInterval(this.ontick,1e3*t.details.targetduration)),!t.details.live&&this.timer&&this.cleanTimer())},e.prototype.setAudioTrackInternal=function(t){if(t>=0&&t<this.tracks.length){this.cleanTimer(),this.trackId=t,Wt.b.log("switching to audioTrack "+t);var e=this.tracks[t],n=this.hls,i=e.type,r=e.url,o={id:t,type:i,url:r};n.trigger(zt.a.AUDIO_TRACK_SWITCHING,o);var a=e.details;!r||void 0!==a&&!0!==a.live||(Wt.b.log("(re)loading playlist for audioTrack "+t),n.trigger(zt.a.AUDIO_TRACK_LOADING,{url:r,id:t}))}},e.prototype.updateTrack=function(t){if(t>=0&&t<this.tracks.length){this.cleanTimer(),this.trackId=t,Wt.b.log("updating audioTrack "+t);var e=this.tracks[t],n=e.url,i=e.details;!n||void 0!==i&&!0!==i.live||(Wt.b.log("(re)loading playlist for audioTrack "+t),this.hls.trigger(zt.a.AUDIO_TRACK_LOADING,{url:n,id:t}))}},mn(e,[{key:"audioTracks",get:function(){return this.tracks}},{key:"audioTrack",get:function(){return this.trackId},set:function(t){this.trackId===t&&void 0!==this.tracks[t].details||this.setAudioTrackInternal(t)}}]),e}(Yt),gn=vn,yn=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),bn={STOPPED:"STOPPED",STARTING:"STARTING",IDLE:"IDLE",PAUSED:"PAUSED",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS"},_n=function(t){function e(n,i){dt(this,e);var r=pt(this,t.call(this,n,zt.a.MEDIA_ATTACHED,zt.a.MEDIA_DETACHING,zt.a.AUDIO_TRACKS_UPDATED,zt.a.AUDIO_TRACK_SWITCHING,zt.a.AUDIO_TRACK_LOADED,zt.a.KEY_LOADED,zt.a.FRAG_LOADED,zt.a.FRAG_PARSING_INIT_SEGMENT,zt.a.FRAG_PARSING_DATA,zt.a.FRAG_PARSED,zt.a.ERROR,zt.a.BUFFER_RESET,zt.a.BUFFER_CREATED,zt.a.BUFFER_APPENDED,zt.a.BUFFER_FLUSHED,zt.a.INIT_PTS_FOUND));return r.fragmentTracker=i,r.config=n.config,r.audioCodecSwap=!1,r._state=bn.STOPPED,r.initPTS=[],r.waitingFragment=null,r.videoTrackCC=null,r}return ft(e,t),e.prototype.onHandlerDestroying=function(){this.stopLoad()},e.prototype.onHandlerDestroyed=function(){this.state=bn.STOPPED,this.fragmentTracker=null},e.prototype.onInitPtsFound=function(t){var e=t.id,n=t.frag.cc,i=t.initPTS;"main"===e&&(this.initPTS[n]=i,this.videoTrackCC=n,Wt.b.log("InitPTS for cc: "+n+" found from video track: "+i),this.state===bn.WAITING_INIT_PTS&&this.tick())},e.prototype.startLoad=function(t){if(this.tracks){var e=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),this.fragLoadError=0,e>0&&-1===t?(Wt.b.log("audio:override startPosition with lastCurrentTime @"+e.toFixed(3)),this.state=bn.IDLE):(this.lastCurrentTime=this.startPosition?this.startPosition:t,this.state=bn.STARTING),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()}else this.startPosition=t,this.state=bn.STOPPED},e.prototype.stopLoad=function(){var t=this.fragCurrent;t&&(t.loader&&t.loader.abort(),this.fragmentTracker.removeFragment(t),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=bn.STOPPED},e.prototype.doTick=function(){var t=void 0,e=void 0,n=void 0,i=this.hls,r=i.config;switch(this.state){case bn.ERROR:case bn.PAUSED:case bn.BUFFER_FLUSHING:break;case bn.STARTING:this.state=bn.WAITING_TRACK,this.loadedmetadata=!1;break;case bn.IDLE:var o=this.tracks;if(!o)break;if(!this.media&&(this.startFragRequested||!r.startFragPrefetch))break;if(this.loadedmetadata)t=this.media.currentTime;else if(void 0===(t=this.nextLoadPosition))break;var a=this.mediaBuffer?this.mediaBuffer:this.media,s=this.videoBuffer?this.videoBuffer:this.media,l=Ae.bufferInfo(a,t,r.maxBufferHole),u=Ae.bufferInfo(s,t,r.maxBufferHole),c=l.len,h=l.end,d=this.fragPrevious,p=Math.min(r.maxBufferLength,r.maxMaxBufferLength),f=Math.max(p,u.len),m=this.audioSwitch,v=this.trackId;if((c<f||m)&&v<o.length){if(void 0===(n=o[v].details)){this.state=bn.WAITING_TRACK;break}if(!m&&!n.live&&d&&d.sn===n.endSN&&!l.nextStart&&(!this.media.seeking||this.media.duration-h<d.duration/2)){this.hls.trigger(zt.a.BUFFER_EOS,{type:"audio"}),this.state=bn.ENDED;break}var g=n.fragments,y=g.length,b=g[0].start,_=g[y-1].start+g[y-1].duration,w=void 0;if(m)if(n.live&&!n.PTSKnown)Wt.b.log("switching audiotrack, live stream, unknown PTS,load first fragment"),h=0;else if(h=t,n.PTSKnown&&t<b){if(!(l.end>b||l.nextStart))return;Wt.b.log("alt audio track ahead of main track, seek to start of alt audio track"),this.media.currentTime=b+.05}if(n.initSegment&&!n.initSegment.data)w=n.initSegment;else if(h<=b){if(w=g[0],null!==this.videoTrackCC&&w.cc!==this.videoTrackCC&&(w=k(g,this.videoTrackCC)),n.live&&w.loadIdx&&w.loadIdx===this.fragLoadIdx){var T=l.nextStart?l.nextStart:b;return Wt.b.log("no alt audio available @currentTime:"+this.media.currentTime+", seeking @"+(T+.05)),void(this.media.currentTime=T+.05)}}else{var x=void 0,E=r.maxFragLookUpTolerance,S=d?g[d.sn-g[0].sn+1]:void 0,A=function(t){var e=Math.min(E,t.duration);return t.start+t.duration-e<=h?1:t.start-e>h&&t.start?-1:0};h<_?(h>_-E&&(E=0),x=S&&!A(S)?S:Ee.search(g,A)):x=g[y-1],x&&(w=x,b=x.start,d&&w.level===d.level&&w.sn===d.sn&&(w.sn<n.endSN?(w=g[w.sn+1-n.startSN],Wt.b.log("SN just loaded, load next one: "+w.sn)):w=null))}w&&(w.decryptdata&&null!=w.decryptdata.uri&&null==w.decryptdata.key?(Wt.b.log("Loading key for "+w.sn+" of ["+n.startSN+" ,"+n.endSN+"],track "+v),this.state=bn.KEY_LOADING,i.trigger(zt.a.KEY_LOADING,{frag:w})):(Wt.b.log("Loading "+w.sn+", cc: "+w.cc+" of ["+n.startSN+" ,"+n.endSN+"],track "+v+", currentTime:"+t+",bufferEnd:"+h.toFixed(3)),this.fragmentTracker.getState(w)===Fe.NOT_LOADED&&(this.fragCurrent=w,this.startFragRequested=!0,isNaN(w.sn)||(this.nextLoadPosition=w.start+w.duration),i.trigger(zt.a.FRAG_LOADING,{frag:w}),this.state=bn.FRAG_LOADING)))}break;case bn.WAITING_TRACK:e=this.tracks[this.trackId],e&&e.details&&(this.state=bn.IDLE);break;case bn.FRAG_LOADING_WAITING_RETRY:var C=performance.now(),M=this.retryDate;a=this.media;var L=a&&a.seeking;(!M||C>=M||L)&&(Wt.b.log("audioStreamController: retryDate reached, switch back to IDLE state"),this.state=bn.IDLE);break;case bn.WAITING_INIT_PTS:var R=this.videoTrackCC;if(void 0===this.initPTS[R])break;var P=this.waitingFragment;if(P){var D=P.frag.cc;R!==D?(e=this.tracks[this.trackId],e.details&&e.details.live&&(Wt.b.warn("Waiting fragment CC ("+D+") does not match video track CC ("+R+")"),this.waitingFragment=null,this.state=bn.IDLE)):(this.state=bn.FRAG_LOADING,this.onFragLoaded(this.waitingFragment),this.waitingFragment=null)}else this.state=bn.IDLE;break;case bn.STOPPED:case bn.FRAG_LOADING:case bn.PARSING:case bn.PARSED:case bn.ENDED:}},e.prototype.onMediaAttached=function(t){var e=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),e.addEventListener("seeking",this.onvseeking),e.addEventListener("ended",this.onvended);var n=this.config;this.tracks&&n.autoStartLoad&&this.startLoad(n.startPosition)},e.prototype.onMediaDetaching=function(){var t=this.media;t&&t.ended&&(Wt.b.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),t&&(t.removeEventListener("seeking",this.onvseeking),t.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1,this.stopLoad()},e.prototype.onMediaSeeking=function(){this.state===bn.ENDED&&(this.state=bn.IDLE),this.media&&(this.lastCurrentTime=this.media.currentTime),this.tick()},e.prototype.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},e.prototype.onAudioTracksUpdated=function(t){Wt.b.log("audio tracks updated"),this.tracks=t.audioTracks},e.prototype.onAudioTrackSwitching=function(t){var e=!!t.url;this.trackId=t.id,this.fragCurrent=null,this.state=bn.PAUSED,this.waitingFragment=null,e?this.setInterval(100):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),e&&(this.audioSwitch=!0,this.state=bn.IDLE),this.tick()},e.prototype.onAudioTrackLoaded=function(t){var e=t.details,n=t.id,i=this.tracks[n],r=e.totalduration,o=0;if(Wt.b.log("track "+n+" loaded ["+e.startSN+","+e.endSN+"],duration:"+r),e.live){var a=i.details;a&&e.fragments.length>0?(A(a,e),o=e.fragments[0].start,e.PTSKnown?Wt.b.log("live audio playlist sliding:"+o.toFixed(3)):Wt.b.log("live audio playlist - outdated PTS, unknown sliding")):(e.PTSKnown=!1,Wt.b.log("live audio playlist - first load, unknown sliding"))}else e.PTSKnown=!1;if(i.details=e,!this.startFragRequested){if(-1===this.startPosition){var s=e.startTimeOffset;isNaN(s)?this.startPosition=0:(Wt.b.log("start time offset found in playlist, adjust startPosition to "+s),this.startPosition=s)}this.nextLoadPosition=this.startPosition}this.state===bn.WAITING_TRACK&&(this.state=bn.IDLE),this.tick()},e.prototype.onKeyLoaded=function(){this.state===bn.KEY_LOADING&&(this.state=bn.IDLE,this.tick())},e.prototype.onFragLoaded=function(t){var e=this.fragCurrent,n=t.frag;if(this.state===bn.FRAG_LOADING&&e&&"audio"===n.type&&n.level===e.level&&n.sn===e.sn){var i=this.tracks[this.trackId],r=i.details,o=r.totalduration,a=e.level,s=e.sn,l=e.cc,u=this.config.defaultAudioCodec||i.audioCodec||"mp4a.40.2",c=this.stats=t.stats;if("initSegment"===s)this.state=bn.IDLE,c.tparsed=c.tbuffered=performance.now(),r.initSegment.data=t.payload,this.hls.trigger(zt.a.FRAG_BUFFERED,{stats:c,frag:e,id:"audio"}),this.tick();else{this.state=bn.PARSING,this.appended=!1,this.demuxer||(this.demuxer=new Ie(this.hls,"audio"));var h=this.initPTS[l],d=r.initSegment?r.initSegment.data:[];if(r.initSegment||void 0!==h){this.pendingBuffering=!0,Wt.b.log("Demuxing "+s+" of ["+r.startSN+" ,"+r.endSN+"],track "+a);this.demuxer.push(t.payload,d,u,null,e,o,!1,h)}else Wt.b.log("unknown video PTS for continuity counter "+l+", waiting for video PTS before demuxing audio frag "+s+" of ["+r.startSN+" ,"+r.endSN+"],track "+a),this.waitingFragment=t,this.state=bn.WAITING_INIT_PTS}}this.fragLoadError=0},e.prototype.onFragParsingInitSegment=function(t){var e=this.fragCurrent,n=t.frag;if(e&&"audio"===t.id&&n.sn===e.sn&&n.level===e.level&&this.state===bn.PARSING){var i=t.tracks,r=void 0;if(i.video&&delete i.video,r=i.audio){r.levelCodec=r.codec,r.id=t.id,this.hls.trigger(zt.a.BUFFER_CODECS,i),Wt.b.log("audio track:audio,container:"+r.container+",codecs[level/parsed]=["+r.levelCodec+"/"+r.codec+"]");var o=r.initSegment;if(o){var a={type:"audio",data:o,parent:"audio",content:"initSegment"};this.audioSwitch?this.pendingData=[a]:(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(zt.a.BUFFER_APPENDING,a))}this.tick()}}},e.prototype.onFragParsingData=function(t){var e=this,n=this.fragCurrent,i=t.frag;if(n&&"audio"===t.id&&"audio"===t.type&&i.sn===n.sn&&i.level===n.level&&this.state===bn.PARSING){var r=this.trackId,o=this.tracks[r],a=this.hls;isNaN(t.endPTS)&&(t.endPTS=t.startPTS+n.duration,t.endDTS=t.startDTS+n.duration),n.addElementaryStream(ne.ElementaryStreamTypes.AUDIO),Wt.b.log("parsed "+t.type+",PTS:["+t.startPTS.toFixed(3)+","+t.endPTS.toFixed(3)+"],DTS:["+t.startDTS.toFixed(3)+"/"+t.endDTS.toFixed(3)+"],nb:"+t.nb),S(o.details,n,t.startPTS,t.endPTS);var s=this.audioSwitch,l=this.media,u=!1;if(s&&l)if(l.readyState){var c=l.currentTime;Wt.b.log("switching audio track : currentTime:"+c),c>=t.startPTS&&(Wt.b.log("switching audio track : flushing all audio"),this.state=bn.BUFFER_FLUSHING,a.trigger(zt.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),u=!0,this.audioSwitch=!1,a.trigger(zt.a.AUDIO_TRACK_SWITCHED,{id:r}))}else this.audioSwitch=!1,a.trigger(zt.a.AUDIO_TRACK_SWITCHED,{id:r});var h=this.pendingData;if(!h)return console.warn("Apparently attempt to enqueue media payload without codec initialization data upfront"),void a.trigger(zt.a.ERROR,{type:Ht.b.MEDIA_ERROR,details:null,fatal:!0});this.audioSwitch||([t.data1,t.data2].forEach(function(e){e&&e.length&&h.push({type:t.type,data:e,parent:"audio",content:"data"})}),!u&&h.length&&(h.forEach(function(t){e.state===bn.PARSING&&(e.pendingBuffering=!0,e.hls.trigger(zt.a.BUFFER_APPENDING,t))}),this.pendingData=[],this.appended=!0)),this.tick()}},e.prototype.onFragParsed=function(t){var e=this.fragCurrent,n=t.frag;e&&"audio"===t.id&&n.sn===e.sn&&n.level===e.level&&this.state===bn.PARSING&&(this.stats.tparsed=performance.now(),this.state=bn.PARSED,this._checkAppendedParsed())},e.prototype.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},e.prototype.onBufferCreated=function(t){var e=t.tracks.audio;e&&(this.mediaBuffer=e.buffer,this.loadedmetadata=!0),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer)},e.prototype.onBufferAppended=function(t){if("audio"===t.parent){var e=this.state;e!==bn.PARSING&&e!==bn.PARSED||(this.pendingBuffering=t.pending>0,this._checkAppendedParsed())}},e.prototype._checkAppendedParsed=function(){if(!(this.state!==bn.PARSED||this.appended&&this.pendingBuffering)){var t=this.fragCurrent,e=this.stats,n=this.hls;if(t){this.fragPrevious=t,e.tbuffered=performance.now(),n.trigger(zt.a.FRAG_BUFFERED,{stats:e,frag:t,id:"audio"});var i=this.mediaBuffer?this.mediaBuffer:this.media;Wt.b.log("audio buffered : "+Ue.toString(i.buffered)),this.audioSwitch&&this.appended&&(this.audioSwitch=!1,n.trigger(zt.a.AUDIO_TRACK_SWITCHED,{id:this.trackId})),this.state=bn.IDLE}this.tick()}},e.prototype.onError=function(t){var e=t.frag;if(!e||"audio"===e.type)switch(t.details){case Ht.a.FRAG_LOAD_ERROR:case Ht.a.FRAG_LOAD_TIMEOUT:if(!t.fatal){var n=this.fragLoadError;n?n++:n=1;var i=this.config;if(n<=i.fragLoadingMaxRetry){this.fragLoadError=n;var r=Math.min(Math.pow(2,n-1)*i.fragLoadingRetryDelay,i.fragLoadingMaxRetryTimeout);Wt.b.warn("audioStreamController: frag loading failed, retry in "+r+" ms"),this.retryDate=performance.now()+r,this.state=bn.FRAG_LOADING_WAITING_RETRY}else Wt.b.error("audioStreamController: "+t.details+" reaches max retry, redispatch as fatal ..."),t.fatal=!0,this.state=bn.ERROR}break;case Ht.a.AUDIO_TRACK_LOAD_ERROR:case Ht.a.AUDIO_TRACK_LOAD_TIMEOUT:case Ht.a.KEY_LOAD_ERROR:case Ht.a.KEY_LOAD_TIMEOUT:this.state!==bn.ERROR&&(this.state=t.fatal?bn.ERROR:bn.IDLE,Wt.b.warn("audioStreamController: "+t.details+" while loading frag,switch to "+this.state+" state ..."));break;case Ht.a.BUFFER_FULL_ERROR:if("audio"===t.parent&&(this.state===bn.PARSING||this.state===bn.PARSED)){var o=this.mediaBuffer,a=this.media.currentTime;if(o&&Ae.isBuffered(o,a)&&Ae.isBuffered(o,a+.5)){var s=this.config;s.maxMaxBufferLength>=s.maxBufferLength&&(s.maxMaxBufferLength/=2,Wt.b.warn("audio:reduce max buffer length to "+s.maxMaxBufferLength+"s")),this.state=bn.IDLE}else Wt.b.warn("buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,this.state=bn.BUFFER_FLUSHING,this.hls.trigger(zt.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"})}}},e.prototype.onBufferFlushed=function(){var t=this,e=this.pendingData;e&&e.length?(Wt.b.log("appending pending audio data on Buffer Flushed"),e.forEach(function(e){t.hls.trigger(zt.a.BUFFER_APPENDING,e)}),this.appended=!0,this.pendingData=[],this.state=bn.PARSED):(this.state=bn.IDLE,this.fragPrevious=null,this.tick())},yn(e,[{key:"state",set:function(t){if(this.state!==t){var e=this.state;this._state=t,Wt.b.log("audio stream:"+e+"->"+t)}},get:function(){return this._state}}]),e}(Be),wn=_n,Tn=function(){function t(t){return"string"==typeof t&&(!!o[t.toLowerCase()]&&t.toLowerCase())}function e(t){return"string"==typeof t&&(!!a[t.toLowerCase()]&&t.toLowerCase())}function n(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)t[i]=n[i]}return t}function i(i,o,a){var s=this,l=function(){if("undefined"!=typeof navigator)return/MSIE\s8\.0/.test(navigator.userAgent)}(),u={};l?s=document.createElement("custom"):u.enumerable=!0,s.hasBeenReset=!1;var c="",h=!1,d=i,p=o,f=a,m=null,v="",g=!0,y="auto",b="start",_=50,w="middle",T=50,x="middle";if(Object.defineProperty(s,"id",n({},u,{get:function(){return c},set:function(t){c=""+t}})),Object.defineProperty(s,"pauseOnExit",n({},u,{get:function(){return h},set:function(t){h=!!t}})),Object.defineProperty(s,"startTime",n({},u,{get:function(){return d},set:function(t){if("number"!=typeof t)throw new TypeError("Start time must be set to a number.");d=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"endTime",n({},u,{get:function(){return p},set:function(t){if("number"!=typeof t)throw new TypeError("End time must be set to a number.");p=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"text",n({},u,{get:function(){return f},set:function(t){f=""+t,this.hasBeenReset=!0}})),Object.defineProperty(s,"region",n({},u,{get:function(){return m},set:function(t){m=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"vertical",n({},u,{get:function(){return v},set:function(e){var n=t(e);if(!1===n)throw new SyntaxError("An invalid or illegal string was specified.");v=n,this.hasBeenReset=!0}})),Object.defineProperty(s,"snapToLines",n({},u,{get:function(){return g},set:function(t){g=!!t,this.hasBeenReset=!0}})),Object.defineProperty(s,"line",n({},u,{get:function(){return y},set:function(t){if("number"!=typeof t&&t!==r)throw new SyntaxError("An invalid number or illegal string was specified.");y=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"lineAlign",n({},u,{get:function(){return b},set:function(t){var n=e(t);if(!n)throw new SyntaxError("An invalid or illegal string was specified.");b=n,this.hasBeenReset=!0}})),Object.defineProperty(s,"position",n({},u,{get:function(){return _},set:function(t){if(t<0||t>100)throw new Error("Position must be between 0 and 100.");_=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"positionAlign",n({},u,{get:function(){return w},set:function(t){var n=e(t);if(!n)throw new SyntaxError("An invalid or illegal string was specified.");w=n,this.hasBeenReset=!0}})),Object.defineProperty(s,"size",n({},u,{get:function(){return T},set:function(t){if(t<0||t>100)throw new Error("Size must be between 0 and 100.");T=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"align",n({},u,{get:function(){return x},set:function(t){var n=e(t);if(!n)throw new SyntaxError("An invalid or illegal string was specified.");x=n,this.hasBeenReset=!0}})),s.displayState=void 0,l)return s}if("undefined"!=typeof window&&window.VTTCue)return window.VTTCue;var r="auto",o={"":!0,lr:!0,rl:!0},a={start:!0,middle:!0,end:!0,left:!0,right:!0};return i.prototype.getCueAsHTML=function(){return window.WebVTT.convertCueToDOMTree(window,this.text)},i}(),xn=function(){return{decode:function(t){if(!t)return"";if("string"!=typeof t)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(t))}}};gt.prototype={set:function(t,e){this.get(t)||""===e||(this.values[t]=e)},get:function(t,e,n){return n?this.has(t)?this.values[t]:e[n]:this.has(t)?this.values[t]:e},has:function(t){return t in this.values},alt:function(t,e,n){for(var i=0;i<n.length;++i)if(e===n[i]){this.set(t,e);break}},integer:function(t,e){/^-?\d+$/.test(e)&&this.set(t,parseInt(e,10))},percent:function(t,e){return!!(e.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(e=parseFloat(e))>=0&&e<=100)&&(this.set(t,e),!0)}};var En=new Tn(0,0,0),Sn="middle"===En.align?"middle":"center";mt.prototype={parse:function(t){function e(){var t=n.buffer,e=0;for(t=_t(t);e<t.length&&"\r"!==t[e]&&"\n"!==t[e];)++e;var i=t.substr(0,e);return"\r"===t[e]&&++e,"\n"===t[e]&&++e,n.buffer=t.substr(e),i}var n=this;t&&(n.buffer+=n.decoder.decode(t,{stream:!0}));try{var i=void 0;if("INITIAL"===n.state){if(!/\r\n|\n/.test(n.buffer))return this;i=e();var r=i.match(/^(Ã¯Â»Â¿)?WEBVTT([ \t].*)?$/);if(!r||!r[0])throw new Error("Malformed WebVTT signature.");n.state="HEADER"}for(var o=!1;n.buffer;){if(!/\r\n|\n/.test(n.buffer))return this;switch(o?o=!1:i=e(),n.state){case"HEADER":/:/.test(i)?function(t){yt(t,function(t,e){switch(t){case"Region":console.log("parse region",e)}},/:/)}(i):i||(n.state="ID");continue;case"NOTE":i||(n.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(i)){n.state="NOTE";break}if(!i)continue;if(n.cue=new Tn(0,0,""),n.state="CUE",-1===i.indexOf("--\x3e")){n.cue.id=i;continue}case"CUE":try{bt(i,n.cue,n.regionList)}catch(t){n.cue=null,n.state="BADCUE";continue}n.state="CUETEXT";continue;case"CUETEXT":var a=-1!==i.indexOf("--\x3e");if(!i||a&&(o=!0)){n.oncue&&n.oncue(n.cue),n.cue=null,n.state="ID";continue}n.cue.text&&(n.cue.text+="\n"),n.cue.text+=i;continue;case"BADCUE":i||(n.state="ID");continue}}}catch(t){"CUETEXT"===n.state&&n.cue&&n.oncue&&n.oncue(n.cue),n.cue=null,n.state="INITIAL"===n.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var t=this;try{if(t.buffer+=t.decoder.decode(),(t.cue||"HEADER"===t.state)&&(t.buffer+="\n\n",t.parse()),"INITIAL"===t.state)throw new Error("Malformed WebVTT signature.")}catch(t){throw t}return t.onflush&&t.onflush(),this}};var An=mt,Cn={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},kn=function(t){var e=t;return Cn.hasOwnProperty(t)&&(e=Cn[t]),String.fromCharCode(e)},Mn=15,Ln=100,Rn={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},Pn={17:2,18:4,21:6,22:8,23:10,19:13,20:15},Dn={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},In={25:2,26:4,29:6,30:8,31:10,27:13,28:15},Fn=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],On={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(t){this.time=t},log:function(t,e){var n=this.verboseFilter[t];this.verboseLevel>=n&&console.log(this.time+" ["+t+"] "+e)}},Nn=function(t){for(var e=[],n=0;n<t.length;n++)e.push(t[n].toString(16));return e},Un=function(){function t(e,n,i,r,o){Tt(this,t),this.foreground=e||"white",this.underline=n||!1,this.italics=i||!1,this.background=r||"black",this.flash=o||!1}return t.prototype.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},t.prototype.setStyles=function(t){for(var e=["foreground","underline","italics","background","flash"],n=0;n<e.length;n++){var i=e[n];t.hasOwnProperty(i)&&(this[i]=t[i])}},t.prototype.isDefault=function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},t.prototype.equals=function(t){return this.foreground===t.foreground&&this.underline===t.underline&&this.italics===t.italics&&this.background===t.background&&this.flash===t.flash},t.prototype.copy=function(t){this.foreground=t.foreground,this.underline=t.underline,this.italics=t.italics,this.background=t.background,this.flash=t.flash},t.prototype.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},t}(),Vn=function(){function t(e,n,i,r,o,a){Tt(this,t),this.uchar=e||" ",this.penState=new Un(n,i,r,o,a)}return t.prototype.reset=function(){this.uchar=" ",this.penState.reset()},t.prototype.setChar=function(t,e){this.uchar=t,this.penState.copy(e)},t.prototype.setPenState=function(t){this.penState.copy(t)},t.prototype.equals=function(t){return this.uchar===t.uchar&&this.penState.equals(t.penState)},t.prototype.copy=function(t){this.uchar=t.uchar,this.penState.copy(t.penState)},t.prototype.isEmpty=function(){return" "===this.uchar&&this.penState.isDefault()},t}(),Bn=function(){function t(){Tt(this,t),this.chars=[];for(var e=0;e<Ln;e++)this.chars.push(new Vn);this.pos=0,this.currPenState=new Un}return t.prototype.equals=function(t){for(var e=!0,n=0;n<Ln;n++)if(!this.chars[n].equals(t.chars[n])){e=!1;break}return e},t.prototype.copy=function(t){for(var e=0;e<Ln;e++)this.chars[e].copy(t.chars[e])},t.prototype.isEmpty=function(){for(var t=!0,e=0;e<Ln;e++)if(!this.chars[e].isEmpty()){t=!1;break}return t},t.prototype.setCursor=function(t){this.pos!==t&&(this.pos=t),this.pos<0?(On.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>Ln&&(On.log("ERROR","Too large cursor position "+this.pos),this.pos=Ln)},t.prototype.moveCursor=function(t){var e=this.pos+t;if(t>1)for(var n=this.pos+1;n<e+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(e)},t.prototype.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},t.prototype.insertChar=function(t){t>=144&&this.backSpace();var e=kn(t);if(this.pos>=Ln)return void On.log("ERROR","Cannot insert "+t.toString(16)+" ("+e+") at position "+this.pos+". Skipping it!");this.chars[this.pos].setChar(e,this.currPenState),this.moveCursor(1)},t.prototype.clearFromPos=function(t){var e=void 0;for(e=t;e<Ln;e++)this.chars[e].reset()},t.prototype.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},t.prototype.clearToEndOfRow=function(){this.clearFromPos(this.pos)},t.prototype.getTextString=function(){for(var t=[],e=!0,n=0;n<Ln;n++){var i=this.chars[n].uchar;" "!==i&&(e=!1),t.push(i)}return e?"":t.join("")},t.prototype.setPenStyles=function(t){this.currPenState.setStyles(t),this.chars[this.pos].setPenState(this.currPenState)},t}(),jn=function(){function t(){Tt(this,t),this.rows=[];for(var e=0;e<Mn;e++)this.rows.push(new Bn);this.currRow=Mn-1,this.nrRollUpRows=null,this.reset()}return t.prototype.reset=function(){for(var t=0;t<Mn;t++)this.rows[t].clear();this.currRow=Mn-1},t.prototype.equals=function(t){for(var e=!0,n=0;n<Mn;n++)if(!this.rows[n].equals(t.rows[n])){e=!1;break}return e},t.prototype.copy=function(t){for(var e=0;e<Mn;e++)this.rows[e].copy(t.rows[e])},t.prototype.isEmpty=function(){for(var t=!0,e=0;e<Mn;e++)if(!this.rows[e].isEmpty()){t=!1;break}return t},t.prototype.backSpace=function(){this.rows[this.currRow].backSpace()},t.prototype.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},t.prototype.insertChar=function(t){this.rows[this.currRow].insertChar(t)},t.prototype.setPen=function(t){this.rows[this.currRow].setPenStyles(t)},t.prototype.moveCursor=function(t){this.rows[this.currRow].moveCursor(t)},t.prototype.setCursor=function(t){On.log("INFO","setCursor: "+t),this.rows[this.currRow].setCursor(t)},t.prototype.setPAC=function(t){On.log("INFO","pacData = "+JSON.stringify(t));var e=t.row-1;if(this.nrRollUpRows&&e<this.nrRollUpRows-1&&(e=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==e){for(var n=0;n<Mn;n++)this.rows[n].clear();var i=this.currRow+1-this.nrRollUpRows,r=this.lastOutputScreen;if(r){var o=r.rows[i].cueStartTime;if(o&&o<On.time)for(var a=0;a<this.nrRollUpRows;a++)this.rows[e-this.nrRollUpRows+a+1].copy(r.rows[i+a])}}this.currRow=e;var s=this.rows[this.currRow];if(null!==t.indent){var l=t.indent,u=Math.max(l-1,0);s.setCursor(t.indent),t.color=s.chars[u].penState.foreground}var c={foreground:t.color,underline:t.underline,italics:t.italics,background:"black",flash:!1};this.setPen(c)},t.prototype.setBkgData=function(t){On.log("INFO","bkgData = "+JSON.stringify(t)),this.backSpace(),this.setPen(t),this.insertChar(32)},t.prototype.setRollUpRows=function(t){this.nrRollUpRows=t},t.prototype.rollUp=function(){if(null===this.nrRollUpRows)return void On.log("DEBUG","roll_up but nrRollUpRows not set yet");On.log("TEXT",this.getDisplayText());var t=this.currRow+1-this.nrRollUpRows,e=this.rows.splice(t,1)[0];e.clear(),this.rows.splice(this.currRow,0,e),On.log("INFO","Rolling up")},t.prototype.getDisplayText=function(t){t=t||!1;for(var e=[],n="",i=-1,r=0;r<Mn;r++){var o=this.rows[r].getTextString();o&&(i=r+1,t?e.push("Row "+i+": '"+o+"'"):e.push(o.trim()))}return e.length>0&&(n=t?"["+e.join(" | ")+"]":e.join("\n")),n},t.prototype.getTextAndFormat=function(){return this.rows},t}(),Gn=function(){function t(e,n){Tt(this,t),this.chNr=e,this.outputFilter=n,this.mode=null,this.verbose=0,this.displayedMemory=new jn,this.nonDisplayedMemory=new jn,this.lastOutputScreen=new jn,this.currRollUpRow=this.displayedMemory.rows[Mn-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}return t.prototype.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[Mn-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null},t.prototype.getHandler=function(){return this.outputFilter},t.prototype.setHandler=function(t){this.outputFilter=t},t.prototype.setPAC=function(t){this.writeScreen.setPAC(t)},t.prototype.setBkgData=function(t){this.writeScreen.setBkgData(t)},t.prototype.setMode=function(t){t!==this.mode&&(this.mode=t,On.log("INFO","MODE="+t),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=t)},t.prototype.insertChars=function(t){for(var e=0;e<t.length;e++)this.writeScreen.insertChar(t[e]);var n=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";On.log("INFO",n+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(On.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},t.prototype.ccRCL=function(){On.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},t.prototype.ccBS=function(){On.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},t.prototype.ccAOF=function(){},t.prototype.ccAON=function(){},t.prototype.ccDER=function(){On.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},t.prototype.ccRU=function(t){On.log("INFO","RU("+t+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(t)},t.prototype.ccFON=function(){On.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})},t.prototype.ccRDC=function(){On.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},t.prototype.ccTR=function(){On.log("INFO","TR"),this.setMode("MODE_TEXT")},t.prototype.ccRTD=function(){On.log("INFO","RTD"),this.setMode("MODE_TEXT")},t.prototype.ccEDM=function(){On.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},t.prototype.ccCR=function(){On.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},t.prototype.ccENM=function(){On.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},t.prototype.ccEOC=function(){if(On.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var t=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=t,this.writeScreen=this.nonDisplayedMemory,On.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},t.prototype.ccTO=function(t){On.log("INFO","TO("+t+") - Tab Offset"),this.writeScreen.moveCursor(t)},t.prototype.ccMIDROW=function(t){var e={flash:!1};if(e.underline=t%2==1,e.italics=t>=46,e.italics)e.foreground="white";else{var n=Math.floor(t/2)-16,i=["white","green","blue","cyan","red","yellow","magenta"];e.foreground=i[n]}On.log("INFO","MIDROW: "+JSON.stringify(e)),this.writeScreen.setPen(e)},t.prototype.outputDataUpdate=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=On.time;null!==e&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&(this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),!0===t&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue()),this.cueStartTime=this.displayedMemory.isEmpty()?null:e):this.cueStartTime=e,this.lastOutputScreen.copy(this.displayedMemory))},t.prototype.cueSplitAtTime=function(t){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,t,this.displayedMemory),this.cueStartTime=t))},t}(),Hn=function(){function t(e,n,i){Tt(this,t),this.field=e||1,this.outputs=[n,i],this.channels=[new Gn(1,n),new Gn(2,i)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}}return t.prototype.getHandler=function(t){return this.channels[t].getHandler()},t.prototype.setHandler=function(t,e){this.channels[t].setHandler(e)},t.prototype.addData=function(t,e){var n=void 0,i=void 0,r=void 0,o=!1;this.lastTime=t,On.setTime(t);for(var a=0;a<e.length;a+=2)if(i=127&e[a],r=127&e[a+1],0!==i||0!==r){if(On.log("DATA","["+Nn([e[a],e[a+1]])+"] -> ("+Nn([i,r])+")"),n=this.parseCmd(i,r),n||(n=this.parseMidrow(i,r)),n||(n=this.parsePAC(i,r)),n||(n=this.parseBackgroundAttributes(i,r)),!n&&(o=this.parseChars(i,r)))if(this.currChNr&&this.currChNr>=0){var s=this.channels[this.currChNr-1];s.insertChars(o)}else On.log("WARNING","No channel found yet. TEXT-MODE?");n?this.dataCounters.cmd+=2:o?this.dataCounters.char+=2:(this.dataCounters.other+=2,On.log("WARNING","Couldn't parse cleaned data "+Nn([i,r])+" orig: "+Nn([e[a],e[a+1]])))}else this.dataCounters.padding+=2},t.prototype.parseCmd=function(t,e){var n=null,i=(20===t||28===t)&&e>=32&&e<=47,r=(23===t||31===t)&&e>=33&&e<=35;if(!i&&!r)return!1;if(t===this.lastCmdA&&e===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,On.log("DEBUG","Repeated command ("+Nn([t,e])+") is dropped"),!0;n=20===t||23===t?1:2;var o=this.channels[n-1];return 20===t||28===t?32===e?o.ccRCL():33===e?o.ccBS():34===e?o.ccAOF():35===e?o.ccAON():36===e?o.ccDER():37===e?o.ccRU(2):38===e?o.ccRU(3):39===e?o.ccRU(4):40===e?o.ccFON():41===e?o.ccRDC():42===e?o.ccTR():43===e?o.ccRTD():44===e?o.ccEDM():45===e?o.ccCR():46===e?o.ccENM():47===e&&o.ccEOC():o.ccTO(e-32),this.lastCmdA=t,this.lastCmdB=e,this.currChNr=n,!0},t.prototype.parseMidrow=function(t,e){var n=null;if((17===t||25===t)&&e>=32&&e<=47){if((n=17===t?1:2)!==this.currChNr)return On.log("ERROR","Mismatch channel in midrow parsing"),!1;return this.channels[n-1].ccMIDROW(e),On.log("DEBUG","MIDROW ("+Nn([t,e])+")"),!0}return!1},t.prototype.parsePAC=function(t,e){var n=null,i=null,r=(t>=17&&t<=23||t>=25&&t<=31)&&e>=64&&e<=127,o=(16===t||24===t)&&e>=64&&e<=95;if(!r&&!o)return!1;if(t===this.lastCmdA&&e===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,!0;n=t<=23?1:2,i=e>=64&&e<=95?1===n?Rn[t]:Dn[t]:1===n?Pn[t]:In[t];var a=this.interpretPAC(i,e);return this.channels[n-1].setPAC(a),this.lastCmdA=t,this.lastCmdB=e,this.currChNr=n,!0},t.prototype.interpretPAC=function(t,e){var n=e,i={color:null,italics:!1,indent:null,underline:!1,row:t};return n=e>95?e-96:e-64,i.underline=1==(1&n),n<=13?i.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(i.italics=!0,i.color="white"):i.indent=4*Math.floor((n-16)/2),i},t.prototype.parseChars=function(t,e){var n=null,i=null,r=null;if(t>=25?(n=2,r=t-8):(n=1,r=t),r>=17&&r<=19){var o=e;o=17===r?e+80:18===r?e+112:e+144,On.log("INFO","Special char '"+kn(o)+"' in channel "+n),i=[o]}else t>=32&&t<=127&&(i=0===e?[t]:[t,e]);if(i){var a=Nn(i);On.log("DEBUG","Char codes =  "+a.join(",")),this.lastCmdA=null,this.lastCmdB=null}return i},t.prototype.parseBackgroundAttributes=function(t,e){var n=void 0,i=void 0,r=void 0,o=void 0,a=(16===t||24===t)&&e>=32&&e<=47,s=(23===t||31===t)&&e>=45&&e<=47;return!(!a&&!s)&&(n={},16===t||24===t?(i=Math.floor((e-32)/2),n.background=Fn[i],e%2==1&&(n.background=n.background+"_semi")):45===e?n.background="transparent":(n.foreground="black",47===e&&(n.underline=!0)),r=t<24?1:2,o=this.channels[r-1],o.setBkgData(n),this.lastCmdA=null,this.lastCmdB=null,!0)},t.prototype.reset=function(){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].reset();this.lastCmdA=null,this.lastCmdB=null},t.prototype.cueSplitAtTime=function(t){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].cueSplitAtTime(t)},t}(),zn=Hn,Wn=function(){function t(e,n){xt(this,t),this.timelineController=e,this.track=n,this.startTime=null,this.endTime=null,this.screen=null}return t.prototype.dispatchCue=function(){null!==this.startTime&&(this.timelineController.addCues("textTrack"+this.track,this.startTime,this.endTime,this.screen),this.startTime=null)},t.prototype.newCue=function(t,e,n){(null===this.startTime||this.startTime>t)&&(this.startTime=t),this.endTime=e,this.screen=n,this.timelineController.createCaptionsTrack(this.track)},t}(),Xn=Wn,qn=function(t,e,n){return t.substr(n||0,e.length)===e},Kn=function(t){var e=parseInt(t.substr(-3)),n=parseInt(t.substr(-6,2)),i=parseInt(t.substr(-9,2)),r=t.length>9?parseInt(t.substr(0,t.indexOf(":"))):0;return isNaN(e)||isNaN(n)||isNaN(i)||isNaN(r)?-1:(e+=1e3*n,e+=6e4*i,e+=36e5*r)},Yn=function(t){for(var e=5381,n=t.length;n;)e=33*e^t.charCodeAt(--n);return(e>>>0).toString()},$n=function(t,e,n){var i=t[e],r=t[i.prevCC];if(!r||!r.new&&i.new)return t.ccOffset=t.presentationOffset=i.start,void(i.new=!1);for(;r&&r.new;)t.ccOffset+=i.start-r.start,i.new=!1,i=r,r=t[i.prevCC];t.presentationOffset=n},Qn={parse:function(t,e,n,i,r,o){var a=/\r\n|\n\r|\n|\r/g,s=Object(Ke.b)(new Uint8Array(t)).trim().replace(a,"\n").split("\n"),l="00:00.000",u=0,c=0,h=0,d=[],p=void 0,f=!0,m=new An;m.oncue=function(t){var e=n[i],r=n.ccOffset;e&&e.new&&(void 0!==c?r=n.ccOffset=e.start:$n(n,i,h)),h&&(r=h+n.ccOffset-n.presentationOffset),t.startTime+=r-c,t.endTime+=r-c,t.id=Yn(t.startTime.toString())+Yn(t.endTime.toString())+Yn(t.text),t.text=decodeURIComponent(encodeURIComponent(t.text)),t.endTime>0&&d.push(t)},m.onparsingerror=function(t){p=t},m.onflush=function(){if(p&&o)return void o(p);r(d)},s.forEach(function(t){if(f){if(qn(t,"X-TIMESTAMP-MAP=")){f=!1,t.substr(16).split(",").forEach(function(t){qn(t,"LOCAL:")?l=t.substr(6):qn(t,"MPEGTS:")&&(u=parseInt(t.substr(7)))});try{e=e<0?e+8589934592:e,u-=e,c=Kn(l)/1e3,h=u/9e4,-1===c&&(p=new Error("Malformed X-TIMESTAMP-MAP: "+t))}catch(e){p=new Error("Malformed X-TIMESTAMP-MAP: "+t)}return}""===t&&(f=!1)}m.parse(t+"\n")}),m.flush()}},Jn=Qn,Zn=function(t){function e(n){Et(this,e);var i=St(this,t.call(this,n,zt.a.MEDIA_ATTACHING,zt.a.MEDIA_DETACHING,zt.a.FRAG_PARSING_USERDATA,zt.a.FRAG_DECRYPTED,zt.a.MANIFEST_LOADING,zt.a.MANIFEST_LOADED,zt.a.FRAG_LOADED,zt.a.LEVEL_SWITCHING,zt.a.INIT_PTS_FOUND));if(i.hls=n,i.config=n.config,i.enabled=!0,i.Cues=n.config.cueHandler,i.textTracks=[],i.tracks=[],i.unparsedVttFrags=[],i.initPTS=void 0,i.cueRanges=[],i.config.enableCEA708Captions){var r=new Xn(i,1),o=new Xn(i,2);i.cea608Parser=new zn(0,r,o)}return i}return At(e,t),e.prototype.addCues=function(t,e,n,i){for(var r=this.cueRanges,o=!1,a=r.length;a--;){var s=r[a],l=kt(s[0],s[1],e,n);if(l>=0&&(s[0]=Math.min(s[0],e),s[1]=Math.max(s[1],n),o=!0,l/(n-e)>.5))return}o||r.push([e,n]),this.Cues.newCue(this[t],e,n,i)},e.prototype.onInitPtsFound=function(t){var e=this;void 0===this.initPTS&&(this.initPTS=t.initPTS),this.unparsedVttFrags.length&&(this.unparsedVttFrags.forEach(function(t){e.onFragLoaded(t)}),this.unparsedVttFrags=[])},e.prototype.getExistingTrack=function(t){var e=this.media;if(e)for(var n=0;n<e.textTracks.length;n++){var i=e.textTracks[n],r="textTrack"+t;if(!0===i[r])return i}return null},e.prototype.createCaptionsTrack=function(t){var e="textTrack"+t;if(!this[e]){var n=this.getExistingTrack(t);if(n)this[e]=n,H(this[e]),G(this[e],this.media);else{var i=this.createTextTrack("captions",this.config["captionsTextTrack"+t+"Label"],this.config["captionsTextTrack"+t+"LanguageCode"]);i&&(i[e]=!0,this[e]=i)}}},e.prototype.createTextTrack=function(t,e,n){var i=this.media;if(i)return i.addTextTrack(t,e,n)},e.prototype.destroy=function(){Yt.prototype.destroy.call(this)},e.prototype.onMediaAttaching=function(t){this.media=t.media,this._cleanTracks()},e.prototype.onMediaDetaching=function(){H(this.textTrack1),H(this.textTrack2)},e.prototype.onManifestLoading=function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0},this._cleanTracks()},e.prototype._cleanTracks=function(){var t=this.media;if(t){var e=t.textTracks;if(e)for(var n=0;n<e.length;n++)H(e[n])}},e.prototype.onManifestLoaded=function(t){var e=this;if(this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=void 0,this.cueRanges=[],this.config.enableWebVTT){this.tracks=t.subtitles||[];var n=this.media?this.media.textTracks:[];this.tracks.forEach(function(t,i){var r=void 0;if(i<n.length){var o=n[i];Ct(o,t)&&(r=o)}r||(r=e.createTextTrack("subtitles",t.name,t.lang)),t.default?r.mode=e.hls.subtitleDisplay?"showing":"hidden":r.mode="disabled",e.textTracks.push(r)})}},e.prototype.onLevelSwitching=function(){this.enabled="NONE"!==this.hls.currentLevel.closedCaptions},e.prototype.onFragLoaded=function(t){var e=t.frag,n=t.payload;if("main"===e.type){var i=e.sn;if(i!==this.lastSn+1){var r=this.cea608Parser;r&&r.reset()}this.lastSn=i}else if("subtitle"===e.type)if(n.byteLength){if(void 0===this.initPTS)return void this.unparsedVttFrags.push(t);var o=e.decryptdata;null!=o&&null!=o.key&&"AES-128"===o.method||this._parseVTTs(e,n)}else this.hls.trigger(zt.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e})},e.prototype._parseVTTs=function(t,e){var n=this.vttCCs;n[t.cc]||(n[t.cc]={start:t.start,prevCC:this.prevCC,new:!0},this.prevCC=t.cc);var i=this.textTracks,r=this.hls;Jn.parse(e,this.initPTS,n,t.cc,function(e){var n=i[t.trackId];if("disabled"===n.mode)return void r.trigger(zt.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t});e.forEach(function(t){if(!n.cues.getCueById(t.id))try{n.addCue(t)}catch(i){var e=new window.TextTrackCue(t.startTime,t.endTime,t.text);e.id=t.id,n.addCue(e)}}),r.trigger(zt.a.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:t})},function(e){Wt.b.log("Failed to parse VTT cue: "+e),r.trigger(zt.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t})})},e.prototype.onFragDecrypted=function(t){var e=t.payload,n=t.frag;if("subtitle"===n.type){if(void 0===this.initPTS)return void this.unparsedVttFrags.push(t);this._parseVTTs(n,e)}},e.prototype.onFragParsingUserdata=function(t){if(this.enabled&&this.config.enableCEA708Captions)for(var e=0;e<t.samples.length;e++){var n=this.extractCea608Data(t.samples[e].bytes);this.cea608Parser.addData(t.samples[e].pts,n)}},e.prototype.extractCea608Data=function(t){for(var e=31&t[0],n=2,i=void 0,r=void 0,o=void 0,a=void 0,s=void 0,l=[],u=0;u<e;u++)i=t[n++],r=127&t[n++],o=127&t[n++],a=0!=(4&i),s=3&i,0===r&&0===o||a&&0===s&&(l.push(r),l.push(o));return l},e}(Yt),ti=Zn,ei=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),ni=function(t){function e(n){Mt(this,e);var i=Lt(this,t.call(this,n,zt.a.MEDIA_ATTACHED,zt.a.MEDIA_DETACHING,zt.a.MANIFEST_LOADING,zt.a.MANIFEST_LOADED,zt.a.SUBTITLE_TRACK_LOADED));return i.tracks=[],i.trackId=-1,i.media=void 0,i.subtitleDisplay=!1,i}return Rt(e,t),e.prototype._onTextTracksChanged=function(){if(this.media){for(var t=-1,e=Pt(this.media.textTracks),n=0;n<e.length;n++)if("hidden"===e[n].mode)t=n;else if("showing"===e[n].mode){t=n;break}this.subtitleTrack=t}},e.prototype.destroy=function(){Yt.prototype.destroy.call(this)},e.prototype.onMediaAttached=function(t){var e=this;this.media=t.media,this.media&&(void 0!==this.queuedDefaultTrack&&(this.subtitleTrack=this.queuedDefaultTrack,delete this.queuedDefaultTrack),this.trackChangeListener=this._onTextTracksChanged.bind(this),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.subtitlePollingInterval=setInterval(function(){e.trackChangeListener()},500):this.media.textTracks.addEventListener("change",this.trackChangeListener))},e.prototype.onMediaDetaching=function(){this.media&&(this.useTextTrackPolling?clearInterval(this.subtitlePollingInterval):this.media.textTracks.removeEventListener("change",this.trackChangeListener),this.media=void 0)},e.prototype.onManifestLoading=function(){this.tracks=[],this.trackId=-1},e.prototype.onManifestLoaded=function(t){var e=this,n=t.subtitles||[];this.tracks=n,this.trackId=-1,this.hls.trigger(zt.a.SUBTITLE_TRACKS_UPDATED,{subtitleTracks:n}),n.forEach(function(t){t.default&&(e.media?e.subtitleTrack=t.id:e.queuedDefaultTrack=t.id)})},e.prototype.onTick=function(){var t=this.trackId,e=this.tracks[t];if(e){var n=e.details;void 0!==n&&!0!==n.live||(Wt.b.log("(re)loading playlist for subtitle track "+t),this.hls.trigger(zt.a.SUBTITLE_TRACK_LOADING,{url:e.url,id:t}))}},e.prototype.onSubtitleTrackLoaded=function(t){var e=this;t.id<this.tracks.length&&(Wt.b.log("subtitle track "+t.id+" loaded"),this.tracks[t.id].details=t.details,t.details.live&&!this.timer&&(this.timer=setInterval(function(){e.onTick()},1e3*t.details.targetduration,this)),!t.details.live&&this.timer&&(clearInterval(this.timer),this.timer=null))},e.prototype.setSubtitleTrackInternal=function(t){if(!(t<-1||t>=this.tracks.length)){this.timer&&(clearInterval(this.timer),this.timer=null);var e=Pt(this.media.textTracks);if(-1!==this.trackId&&(e[this.trackId].mode="disabled"),this.trackId=t,Wt.b.log("switching to subtitle track "+t),this.hls.trigger(zt.a.SUBTITLE_TRACK_SWITCH,{id:t}),-1!==t){var n=this.tracks[t];t<e.length&&(e[t].mode=this.subtitleDisplay?"showing":"hidden");var i=n.details;void 0!==i&&!0!==i.live||(Wt.b.log("(re)loading playlist for subtitle track "+t),this.hls.trigger(zt.a.SUBTITLE_TRACK_LOADING,{url:n.url,id:t}))}}},ei(e,[{key:"subtitleTracks",get:function(){return this.tracks}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(t){this.trackId!==t&&this.setSubtitleTrackInternal(t)}}]),e}(Yt),ii=ni,ri=n(5),oi={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING"},ai=function(t){function e(n){Dt(this,e);var i=It(this,t.call(this,n,zt.a.MEDIA_ATTACHED,zt.a.ERROR,zt.a.KEY_LOADED,zt.a.FRAG_LOADED,zt.a.SUBTITLE_TRACKS_UPDATED,zt.a.SUBTITLE_TRACK_SWITCH,zt.a.SUBTITLE_TRACK_LOADED,zt.a.SUBTITLE_FRAG_PROCESSED));return i.config=n.config,i.vttFragSNsProcessed={},i.vttFragQueues=void 0,i.currentlyProcessing=null,i.state=oi.STOPPED,i.currentTrackId=-1,i.decrypter=new ri.a(n.observer,n.config),i}return Ft(e,t),e.prototype.onHandlerDestroyed=function(){this.state=oi.STOPPED},e.prototype.clearVttFragQueues=function(){var t=this;this.vttFragQueues={},this.tracks.forEach(function(e){t.vttFragQueues[e.id]=[]})},e.prototype.nextFrag=function(){if(null===this.currentlyProcessing&&this.currentTrackId>-1&&this.vttFragQueues[this.currentTrackId].length){var t=this.currentlyProcessing=this.vttFragQueues[this.currentTrackId].shift();this.fragCurrent=t,this.hls.trigger(zt.a.FRAG_LOADING,{frag:t}),this.state=oi.FRAG_LOADING}},e.prototype.onSubtitleFragProcessed=function(t){t.success&&this.vttFragSNsProcessed[t.frag.trackId].push(t.frag.sn),this.currentlyProcessing=null,this.state=oi.IDLE,this.nextFrag()},e.prototype.onMediaAttached=function(){this.state=oi.IDLE},e.prototype.onError=function(t){var e=t.frag;e&&"subtitle"!==e.type||this.currentlyProcessing&&(this.currentlyProcessing=null,this.nextFrag())},e.prototype.doTick=function(){var t=this;switch(this.state){case oi.IDLE:var e=this.tracks,n=this.currentTrackId,i=this.vttFragSNsProcessed[n],r=this.vttFragQueues[n],o=this.currentlyProcessing?this.currentlyProcessing.sn:-1,a=function(t){return i.indexOf(t.sn)>-1},s=function(t){return r.some(function(e){return e.sn===t.sn})};if(!e)break;var l;if(n<e.length&&(l=e[n].details),void 0===l)break;l.fragments.forEach(function(e){a(e)||e.sn===o||s(e)||(e.decryptdata&&null!=e.decryptdata.uri&&null==e.decryptdata.key?(Wt.b.log("Loading key for "+e.sn),t.state=oi.KEY_LOADING,t.hls.trigger(zt.a.KEY_LOADING,{frag:e})):(e.trackId=n,r.push(e),t.nextFrag()))})}},e.prototype.onSubtitleTracksUpdated=function(t){var e=this;Wt.b.log("subtitle tracks updated"),this.tracks=t.subtitleTracks,this.clearVttFragQueues(),this.vttFragSNsProcessed={},this.tracks.forEach(function(t){e.vttFragSNsProcessed[t.id]=[]})},e.prototype.onSubtitleTrackSwitch=function(t){if(this.currentTrackId=t.id,-1!==this.currentTrackId){void 0!==this.tracks[this.currentTrackId].details&&this.tick()}},e.prototype.onSubtitleTrackLoaded=function(){this.tick()},e.prototype.onKeyLoaded=function(){this.state===oi.KEY_LOADING&&(this.state=oi.IDLE,this.tick())},e.prototype.onFragLoaded=function(t){var e=this.fragCurrent,n=t.frag.decryptdata,i=t.frag,r=this.hls;if(this.state===oi.FRAG_LOADING&&e&&"subtitle"===t.frag.type&&e.sn===t.frag.sn&&t.payload.byteLength>0&&null!=n&&null!=n.key&&"AES-128"===n.method){var o=void 0;try{o=performance.now()}catch(t){o=Date.now()}this.decrypter.decrypt(t.payload,n.key.buffer,n.iv.buffer,function(t){var e=void 0;try{e=performance.now()}catch(t){e=Date.now()}r.trigger(zt.a.FRAG_DECRYPTED,{frag:i,payload:t,stats:{tstart:o,tdecrypt:e}})})}},e}(Be),si=ai,li=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),ui={WIDEVINE:"com.widevine.alpha",PLAYREADY:"com.microsoft.playready"},ci=function(t,e,n){var i={videoCapabilities:[]};return e.forEach(function(t){i.videoCapabilities.push({contentType:'video/mp4; codecs="'+t+'"'})}),[i]},hi=function(t,e,n){switch(t){case ui.WIDEVINE:return ci(0,n);default:throw Error("Unknown key-system: "+t)}},di=function(t){function e(n){Ot(this,e);var i=Nt(this,t.call(this,n,zt.a.MEDIA_ATTACHED,zt.a.MANIFEST_PARSED));return i._widevineLicenseUrl=n.config.widevineLicenseUrl,i._licenseXhrSetup=n.config.licenseXhrSetup,i._emeEnabled=n.config.emeEnabled,i._requestMediaKeySystemAccess=n.config.requestMediaKeySystemAccessFunc,i._mediaKeysList=[],i._media=null,i._hasSetMediaKeys=!1,i._isMediaEncrypted=!1,i._requestLicenseFailureCount=0,i}return Ut(e,t),e.prototype.getLicenseServerUrl=function(t){var e=void 0;switch(t){case ui.WIDEVINE:e=this._widevineLicenseUrl;break;default:e=null}return e||(Wt.b.error('No license server URL configured for key-system "'+t+'"'),this.hls.trigger(zt.a.ERROR,{type:Ht.b.KEY_SYSTEM_ERROR,details:Ht.a.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})),e},e.prototype._attemptKeySystemAccess=function(t,e,n){var i=this,r=hi(t,0,n);if(!r)return void Wt.b.warn("Can not create config for key-system (maybe because platform is not supported):",t);Wt.b.log("Requesting encrypted media key-system access"),this.requestMediaKeySystemAccess(t,r).then(function(e){i._onMediaKeySystemAccessObtained(t,e)}).catch(function(e){Wt.b.error('Failed to obtain key-system "'+t+'" access:',e)})},e.prototype._onMediaKeySystemAccessObtained=function(t,e){var n=this;Wt.b.log('Access for key-system "'+t+'" obtained');var i={mediaKeys:null,mediaKeysSession:null,mediaKeysSessionInitialized:!1,mediaKeySystemAccess:e,mediaKeySystemDomain:t};this._mediaKeysList.push(i),e.createMediaKeys().then(function(e){i.mediaKeys=e,Wt.b.log('Media-keys created for key-system "'+t+'"'),n._onMediaKeysCreated()}).catch(function(t){Wt.b.error("Failed to create media-keys:",t)})},e.prototype._onMediaKeysCreated=function(){var t=this;this._mediaKeysList.forEach(function(e){e.mediaKeysSession||(e.mediaKeysSession=e.mediaKeys.createSession(),t._onNewMediaKeySession(e.mediaKeysSession))})},e.prototype._onNewMediaKeySession=function(t){var e=this;Wt.b.log("New key-system session "+t.sessionId),t.addEventListener("message",function(n){e._onKeySessionMessage(t,n.message)},!1)},e.prototype._onKeySessionMessage=function(t,e){Wt.b.log("Got EME message event, creating license request"),this._requestLicense(e,function(e){Wt.b.log("Received license data, updating key-session"),t.update(e)})},e.prototype._onMediaEncrypted=function(t,e){Wt.b.log('Media is encrypted using "'+t+'" init data type'),this._isMediaEncrypted=!0,this._mediaEncryptionInitDataType=t,this._mediaEncryptionInitData=e,this._attemptSetMediaKeys(),this._generateRequestWithPreferredKeySession()},e.prototype._attemptSetMediaKeys=function(){if(!this._hasSetMediaKeys){var t=this._mediaKeysList[0];if(!t||!t.mediaKeys)return Wt.b.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),void this.hls.trigger(zt.a.ERROR,{type:Ht.b.KEY_SYSTEM_ERROR,details:Ht.a.KEY_SYSTEM_NO_KEYS,fatal:!0});Wt.b.log("Setting keys for encrypted media"),this._media.setMediaKeys(t.mediaKeys),this._hasSetMediaKeys=!0}},e.prototype._generateRequestWithPreferredKeySession=function(){var t=this,e=this._mediaKeysList[0];if(!e)return Wt.b.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),void this.hls.trigger(zt.a.ERROR,{type:Ht.b.KEY_SYSTEM_ERROR,details:Ht.a.KEY_SYSTEM_NO_ACCESS,fatal:!0});if(e.mediaKeysSessionInitialized)return void Wt.b.warn("Key-Session already initialized but requested again");var n=e.mediaKeysSession;n||(Wt.b.error("Fatal: Media is encrypted but no key-session existing"),this.hls.trigger(zt.a.ERROR,{type:Ht.b.KEY_SYSTEM_ERROR,details:Ht.a.KEY_SYSTEM_NO_SESSION,fatal:!0}));var i=this._mediaEncryptionInitDataType,r=this._mediaEncryptionInitData;Wt.b.log('Generating key-session request for "'+i+'" init data type'),e.mediaKeysSessionInitialized=!0,n.generateRequest(i,r).then(function(){Wt.b.debug("Key-session generation succeeded")}).catch(function(e){Wt.b.error("Error generating key-session request:",e),t.hls.trigger(zt.a.ERROR,{type:Ht.b.KEY_SYSTEM_ERROR,details:Ht.a.KEY_SYSTEM_NO_SESSION,fatal:!1})})},e.prototype._createLicenseXhr=function(t,e,n){var i=new XMLHttpRequest,r=this._licenseXhrSetup;try{if(r)try{r(i,t)}catch(e){i.open("POST",t,!0),r(i,t)}i.readyState||i.open("POST",t,!0)}catch(t){return Wt.b.error("Error setting up key-system license XHR",t),void this.hls.trigger(zt.a.ERROR,{type:Ht.b.KEY_SYSTEM_ERROR,details:Ht.a.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}return i.responseType="arraybuffer",i.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,i,t,e,n),i},e.prototype._onLicenseRequestReadyStageChange=function(t,e,n,i){switch(t.readyState){case 4:if(200===t.status)this._requestLicenseFailureCount=0,Wt.b.log("License request succeeded"),i(t.response);else{if(Wt.b.error("License Request XHR failed ("+e+"). Status: "+t.status+" ("+t.statusText+")"),++this._requestLicenseFailureCount<=3){var r=3-this._requestLicenseFailureCount+1;return Wt.b.warn("Retrying license request, "+r+" attempts left"),void this._requestLicense(n,i)}this.hls.trigger(zt.a.ERROR,{type:Ht.b.KEY_SYSTEM_ERROR,details:Ht.a.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}}},e.prototype._generateLicenseRequestChallenge=function(t,e){var n=void 0;return t.mediaKeySystemDomain===ui.PLAYREADY?Wt.b.error("PlayReady is not supported (yet)"):t.mediaKeySystemDomain===ui.WIDEVINE?n=e:Wt.b.error("Unsupported key-system:",t.mediaKeySystemDomain),n},e.prototype._requestLicense=function(t,e){Wt.b.log("Requesting content license for key-system");var n=this._mediaKeysList[0];if(!n)return Wt.b.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),void this.hls.trigger(zt.a.ERROR,{type:Ht.b.KEY_SYSTEM_ERROR,details:Ht.a.KEY_SYSTEM_NO_ACCESS,fatal:!0});var i=this.getLicenseServerUrl(n.mediaKeySystemDomain),r=this._createLicenseXhr(i,t,e);Wt.b.log("Sending license request to URL: "+i),r.send(this._generateLicenseRequestChallenge(n,t))},e.prototype.onMediaAttached=function(t){var e=this;if(this._emeEnabled){var n=t.media;this._media=n,n.addEventListener("encrypted",function(t){e._onMediaEncrypted(t.initDataType,t.initData)})}},e.prototype.onManifestParsed=function(t){if(this._emeEnabled){var e=t.levels.map(function(t){return t.audioCodec}),n=t.levels.map(function(t){return t.videoCodec});this._attemptKeySystemAccess(ui.WIDEVINE,e,n)}},li(e,[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}]),e}(Yt),pi=di,fi=function(){return window.navigator&&window.navigator.requestMediaKeySystemAccess?window.navigator.requestMediaKeySystemAccess.bind(window.navigator):null}(),mi={autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,liveDurationInfinity:!1,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:fn,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,abrController:rn,bufferController:sn,capLevelController:cn,fpsController:dn,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,requestMediaKeySystemAccessFunc:fi};mi.subtitleStreamController=si,mi.subtitleTrackController=ii,mi.timelineController=ti,mi.cueHandler=Bt,mi.enableCEA708Captions=!0,mi.enableWebVTT=!0,mi.captionsTextTrack1Label="English",mi.captionsTextTrack1LanguageCode="en",mi.captionsTextTrack2Label="Spanish",mi.captionsTextTrack2LanguageCode="es",mi.audioStreamController=wn,mi.audioTrackController=gn,mi.emeController=pi;var vi=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();n(12);var gi=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Vt(this,t);var i=t.DefaultConfig;if((n.liveSyncDurationCount||n.liveMaxLatencyDurationCount)&&(n.liveSyncDuration||n.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");for(var r in i)r in n||(n[r]=i[r]);if(void 0!==n.liveMaxLatencyDurationCount&&n.liveMaxLatencyDurationCount<=n.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==n.liveMaxLatencyDuration&&(n.liveMaxLatencyDuration<=n.liveSyncDuration||void 0===n.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');Object(Wt.a)(n.debug),this.config=n,this._autoLevelCapping=-1;var o=this.observer=new Me.a;o.trigger=function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];o.emit.apply(o,[t,t].concat(n))},o.off=function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];o.removeListener.apply(o,[t].concat(n))},this.on=o.on.bind(o),this.off=o.off.bind(o),this.trigger=o.trigger.bind(o);var a=this.abrController=new n.abrController(this),s=new n.bufferController(this),l=new n.capLevelController(this),u=new n.fpsController(this),c=new ye(this),h=new _e(this),d=new Te(this),p=new $e(this),f=this.levelController=new qe(this),m=new Oe(this),v=this.streamController=new ze(this,m),g=[f,v],y=n.audioStreamController;y&&g.push(new y(this,m)),this.networkControllers=g;var b=[c,h,d,a,s,l,u,p,m];if(y=n.audioTrackController){var _=new y(this);this.audioTrackController=_,b.push(_)}if(y=n.subtitleTrackController){var w=new y(this);this.subtitleTrackController=w,b.push(w)}if(y=n.emeController){var T=new y(this);this.emeController=T,b.push(T)}[n.subtitleStreamController,n.timelineController].forEach(function(t){t&&b.push(new t(e))}),this.coreComponents=b}return t.isSupported=function(){return q()},vi(t,null,[{key:"version",get:function(){return"0.9.1"}},{key:"Events",get:function(){return zt.a}},{key:"ErrorTypes",get:function(){return Ht.b}},{key:"ErrorDetails",get:function(){return Ht.a}},{key:"DefaultConfig",get:function(){return t.defaultConfig?t.defaultConfig:mi},set:function(e){t.defaultConfig=e}}]),t.prototype.destroy=function(){Wt.b.log("destroy"),this.trigger(zt.a.DESTROYING),this.detachMedia(),this.coreComponents.concat(this.networkControllers).forEach(function(t){t.destroy()}),this.url=null,this.observer.removeAllListeners(),this._autoLevelCapping=-1},t.prototype.attachMedia=function(t){Wt.b.log("attachMedia"),this.media=t,this.trigger(zt.a.MEDIA_ATTACHING,{media:t})},t.prototype.detachMedia=function(){Wt.b.log("detachMedia"),this.trigger(zt.a.MEDIA_DETACHING),this.media=null},t.prototype.loadSource=function(t){t=Gt.a.buildAbsoluteURL(window.location.href,t,{alwaysNormalize:!0}),Wt.b.log("loadSource:"+t),this.url=t,this.trigger(zt.a.MANIFEST_LOADING,{url:t})},t.prototype.startLoad=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;Wt.b.log("startLoad("+t+")"),this.networkControllers.forEach(function(e){e.startLoad(t)})},t.prototype.stopLoad=function(){Wt.b.log("stopLoad"),this.networkControllers.forEach(function(t){t.stopLoad()})},t.prototype.swapAudioCodec=function(){Wt.b.log("swapAudioCodec"),this.streamController.swapAudioCodec()},t.prototype.recoverMediaError=function(){Wt.b.log("recoverMediaError");var t=this.media;this.detachMedia(),this.attachMedia(t)},vi(t,[{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(t){Wt.b.log("set currentLevel:"+t),this.loadLevel=t,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(t){Wt.b.log("set nextLevel:"+t),this.levelController.manualLevel=t,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(t){Wt.b.log("set loadLevel:"+t),this.levelController.manualLevel=t}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(t){this.levelController.nextLoadLevel=t}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(t){Wt.b.log("set firstLevel:"+t),this.levelController.firstLevel=t}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(t){Wt.b.log("set startLevel:"+t);var e=this;-1!==t&&(t=Math.max(t,e.minAutoLevel)),e.levelController.startLevel=t}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(t){Wt.b.log("set autoLevelCapping:"+t),this._autoLevelCapping=t}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){for(var t=this,e=t.levels,n=t.config.minAutoBitrate,i=e?e.length:0,r=0;r<i;r++){if((e[r].realBitrate?Math.max(e[r].realBitrate,e[r].bitrate):e[r].bitrate)>n)return r}return 0}},{key:"maxAutoLevel",get:function(){var t=this,e=t.levels,n=t.autoLevelCapping;return-1===n&&e&&e.length?e.length-1:n}},{key:"nextAutoLevel",get:function(){var t=this;return Math.min(Math.max(t.abrController.nextAutoLevel,t.minAutoLevel),t.maxAutoLevel)},set:function(t){var e=this;e.abrController.nextAutoLevel=Math.max(e.minAutoLevel,t)}},{key:"audioTracks",get:function(){var t=this.audioTrackController;return t?t.audioTracks:[]}},{key:"audioTrack",get:function(){var t=this.audioTrackController;return t?t.audioTrack:-1},set:function(t){var e=this.audioTrackController;e&&(e.audioTrack=t)}},{key:"liveSyncPosition",get:function(){return this.streamController.liveSyncPosition}},{key:"subtitleTracks",get:function(){var t=this.subtitleTrackController;return t?t.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var t=this.subtitleTrackController;return t?t.subtitleTrack:-1},set:function(t){var e=this.subtitleTrackController;e&&(e.subtitleTrack=t)}},{key:"subtitleDisplay",get:function(){var t=this.subtitleTrackController;return!!t&&t.subtitleDisplay},set:function(t){var e=this.subtitleTrackController;e&&(e.subtitleDisplay=t)}}]),t}();e.default=gi},function(t,e,n){function i(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/",e.oe=function(t){throw console.error(t),t};var i=e(e.s=ENTRY_MODULE);return i.default||i}function r(t){return(t+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function o(t,e,i){var o={};o[i]=[];var a=e.toString(),s=a.match(/^function\s?\(\w+,\s*\w+,\s*(\w+)\)/);if(!s)return o;for(var c,h=s[1],d=new RegExp("(\\\\n|\\W)"+r(h)+u,"g");c=d.exec(a);)"dll-reference"!==c[3]&&o[i].push(c[3]);for(d=new RegExp("\\("+r(h)+'\\("(dll-reference\\s('+l+'))"\\)\\)'+u,"g");c=d.exec(a);)t[c[2]]||(o[i].push(c[1]),t[c[2]]=n(c[1]).m),o[c[2]]=o[c[2]]||[],o[c[2]].push(c[4]);return o}function a(t){return Object.keys(t).reduce(function(e,n){return e||t[n].length>0},!1)}function s(t,e){for(var n={main:[e]},i={main:[]},r={main:{}};a(n);)for(var s=Object.keys(n),l=0;l<s.length;l++){var u=s[l],c=n[u],h=c.pop();if(r[u]=r[u]||{},!r[u][h]&&t[u][h]){r[u][h]=!0,i[u]=i[u]||[],i[u].push(h);for(var d=o(t,t[u][h],u),p=Object.keys(d),f=0;f<p.length;f++)n[p[f]]=n[p[f]]||[],n[p[f]]=n[p[f]].concat(d[p[f]])}}return i}var l="[\\.|\\-|\\+|\\w|/|@]+",u="\\((/\\*.*?\\*/)?s?.*?("+l+").*?\\)";t.exports=function(t,e){e=e||{};var r={main:n.m},o=e.all?{main:Object.keys(r)}:s(r,t),a="";Object.keys(o).filter(function(t){return"main"!==t}).forEach(function(t){for(var e=0;o[t][e];)e++;o[t].push(e),r[t][e]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",a=a+"var "+t+" = ("+i.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+o[t].map(function(e){return JSON.stringify(e)+": "+r[t][e].toString()}).join(",")+"});\n"}),a=a+"("+i.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+o.main.map(function(t){return JSON.stringify(t)+": "+r.main[t].toString()}).join(",")+"})(self);";var l=new window.Blob([a],{type:"text/javascript"});if(e.bare)return l;var u=window.URL||window.webkitURL||window.mozURL||window.msURL,c=u.createObjectURL(l),h=new window.Worker(c);return h.objectURL=c,h}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(8),r=n(1),o=n(0),a=n(6),s=n.n(a),l=function(t){var e=new s.a;e.trigger=function(t){for(var n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];e.emit.apply(e,[t,t].concat(i))},e.off=function(t){for(var n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];e.removeListener.apply(e,[t].concat(i))};var n=function(e,n){t.postMessage({event:e,data:n})};t.addEventListener("message",function(r){var a=r.data;switch(a.cmd){case"init":var s=JSON.parse(a.config);t.demuxer=new i.a(e,a.typeSupported,s,a.vendor);try{Object(o.a)(!0===s.debug)}catch(t){console.warn("demuxerWorker: unable to enable logs")}n("init",null);break;case"demux":t.demuxer.push(a.data,a.decryptdata,a.initSegment,a.audioCodec,a.videoCodec,a.timeOffset,a.discontinuity,a.trackSwitch,a.contiguous,a.duration,a.accurateTimeOffset,a.defaultInitPTS)}}),e.on(r.a.FRAG_DECRYPTED,n),e.on(r.a.FRAG_PARSING_INIT_SEGMENT,n),e.on(r.a.FRAG_PARSED,n),e.on(r.a.ERROR,n),e.on(r.a.FRAG_PARSING_METADATA,n),e.on(r.a.FRAG_PARSING_USERDATA,n),e.on(r.a.INIT_PTS_FOUND,n),e.on(r.a.FRAG_PARSING_DATA,function(e,n){var i=[],r={event:e,data:n};n.data1&&(r.data1=n.data1.buffer,i.push(n.data1.buffer),delete n.data1),n.data2&&(r.data2=n.data2.buffer,i.push(n.data2.buffer),delete n.data2),t.postMessage(r,i)})};e.default=l},function(t,e){String.prototype.endsWith||function(){"use strict";var t=function(){try{var t={},e=Object.defineProperty,n=e(t,t,t)&&e}catch(t){}return n}(),e={}.toString,n=function(t){if(null==this)throw TypeError();var n=String(this);if(t&&"[object RegExp]"==e.call(t))throw TypeError();var i=n.length,r=String(t),o=r.length,a=i;if(arguments.length>1){var s=arguments[1];void 0!==s&&(a=s?Number(s):0)!=a&&(a=0)}var l=Math.min(Math.max(a,0),i),u=l-o;if(u<0)return!1;for(var c=-1;++c<o;)if(n.charCodeAt(u+c)!=r.charCodeAt(c))return!1;return!0};t?t(String.prototype,"endsWith",{value:n,configurable:!0,writable:!0}):String.prototype.endsWith=n}()}]).default})},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r,o=n(116),a=i(o),s=n(16),l=i(s),u={autoPlay:!1,hlsjsConfig:{autoStartLoad:!1,debug:!1},playButtonAnimated:{enabled:!0},unmute:{enabled:!0},tooltip:{enabled:!0},vast:{enabled:!1,forceSkipTimeoute:5e3,verbosity:0,adTagUrl:"",playAdAlways:!0,adCancelTimeout:5e3,adsEnabled:!1},settingsMenu:{tooltip:"ØªÙØ¸ÛÙØ§Øª",enabled:!1,plugins:["brandLogo","panorama","quality","share","playbackRate","captions"],desktopAvailableButton:[],tabletAvailableButton:[],mobileAvailableButton:[]},share:{enabled:!1,url:window.location.href,gplus:!0,facebook:!0,twitter:!0,telegram:!0,tooltip:"Ø§Ø´ØªØ±Ø§Ú©"},countdown:{onFinish:function(){}},brandLogo:(r={enabled:!1,imgUrl:null,linUrl:null,title:""},(0,a.default)(r,"enabled",!1),(0,a.default)(r,"tooltip",""),r),title:{enabled:!1,text:""},videojs:{playbackRates:[.1,.5,1,2,3],html5:{nativeAudioTracks:!1,nativeVideoTracks:!1,hlsjsConfig:{autoStartLoad:!1,debug:!1,startLevel:0}},textTrackSettings:!0,language:"fa",controlBar:{},notSupportedMessage:"ÙØ±ÙØ±Ú¯Ø± Ø´ÙØ§ ÙØ§Ø¯Ø± Ø¨Ù Ù¾Ø®Ø´ Ø§ÛÙ ÙÛØ¯ÛÙ ÙÛØ³Øª."},panorama:{enabled:!1,clickToToggle:!l.default.isMobile,clickAndDrag:!0,autoMobileOrientation:!0,initFov:100,closePanorama:!1,NoticeMessage:l.default.isMobile?"ØªÙÙÙ ÙÙØ±Ø§Ù Ø®ÙØ¯ Ø±Ø§ Ø­Ø±Ú©Øª Ø¯ÙÛØ¯.":"Ø§Ø² ÙØ´Ø§ÙÚ¯Ø± ÙÙØ³ Ø¨Ø±Ø§Û Ø¯ÛØ¯Ù Ø§Ø·Ø±Ø§Ù Ø§Ø³ØªÙØ§Ø¯Ù Ú©ÙÛØ¯.",callback:function(){},backToVerticalCenter:!1,backToHorizonCenter:!1},hotkeys:{enabled:!0,volumeStep:.1,seekStep:5},hlsJsSwitch:{enabled:!0,strict:!1,defaultLabel:"Ø§ØªÙÙØ§ØªÛÚ©",sort:"asc"},theaterMode:{enabled:!0,tooltip:"Ø­Ø§ÙØª ØªØ¦Ø§ØªØ±"},onEnded:function(t){},onLoadedData:function(t){},onTimeUpdate:function(t){},onPlay:function(t){},onPause:function(t){},onAddLoadDone:function(t){},oneSkipAds:function(t){},oneAdsEnd:function(t){},oneAdsClick:function(t){},oneAdsStart:function(t){},oneContentEnd:function(t){},oneAdError:function(t){},oneAdCancel:function(t){},seekButton:{enabled:!1}};t.exports=u},function(t,e,n){"use strict";!function(e,i,r){void 0!==t&&t.exports?t.exports=r():n(187)("bowser",r)}(0,0,function(){function t(t){function e(e){var n=t.match(e);return n&&n.length>1&&n[1]||""}function n(e){var n=t.match(e);return n&&n.length>1&&n[2]||""}var i,r=e(/(ipod|iphone|ipad)/i).toLowerCase(),o=/like android/i.test(t),s=!o&&/android/i.test(t),l=/nexus\s*[0-6]\s*/i.test(t),u=!l&&/nexus\s*[0-9]+/i.test(t),c=/CrOS/.test(t),h=/silk/i.test(t),d=/sailfish/i.test(t),p=/tizen/i.test(t),f=/(web|hpw)os/i.test(t),m=/windows phone/i.test(t),v=(/SamsungBrowser/i.test(t),!m&&/windows/i.test(t)),g=!r&&!h&&/macintosh/i.test(t),y=!s&&!d&&!p&&!f&&/linux/i.test(t),b=n(/edg([ea]|ios)\/(\d+(\.\d+)?)/i),_=e(/version\/(\d+(\.\d+)?)/i),w=/tablet/i.test(t)&&!/tablet pc/i.test(t),T=!w&&/[^-]mobi/i.test(t),x=/xbox/i.test(t);/opera/i.test(t)?i={name:"Opera",opera:a,version:_||e(/(?:opera|opr|opios)[\s\/](\d+(\.\d+)?)/i)}:/opr\/|opios/i.test(t)?i={name:"Opera",opera:a,version:e(/(?:opr|opios)[\s\/](\d+(\.\d+)?)/i)||_}:/SamsungBrowser/i.test(t)?i={name:"Samsung Internet for Android",samsungBrowser:a,version:_||e(/(?:SamsungBrowser)[\s\/](\d+(\.\d+)?)/i)}:/coast/i.test(t)?i={name:"Opera Coast",coast:a,version:_||e(/(?:coast)[\s\/](\d+(\.\d+)?)/i)}:/yabrowser/i.test(t)?i={name:"Yandex Browser",yandexbrowser:a,version:_||e(/(?:yabrowser)[\s\/](\d+(\.\d+)?)/i)}:/ucbrowser/i.test(t)?i={name:"UC Browser",ucbrowser:a,version:e(/(?:ucbrowser)[\s\/](\d+(?:\.\d+)+)/i)}:/mxios/i.test(t)?i={name:"Maxthon",maxthon:a,version:e(/(?:mxios)[\s\/](\d+(?:\.\d+)+)/i)}:/epiphany/i.test(t)?i={name:"Epiphany",epiphany:a,version:e(/(?:epiphany)[\s\/](\d+(?:\.\d+)+)/i)}:/puffin/i.test(t)?i={name:"Puffin",puffin:a,version:e(/(?:puffin)[\s\/](\d+(?:\.\d+)?)/i)}:/sleipnir/i.test(t)?i={name:"Sleipnir",sleipnir:a,version:e(/(?:sleipnir)[\s\/](\d+(?:\.\d+)+)/i)}:/k-meleon/i.test(t)?i={name:"K-Meleon",kMeleon:a,version:e(/(?:k-meleon)[\s\/](\d+(?:\.\d+)+)/i)}:m?(i={name:"Windows Phone",osname:"Windows Phone",windowsphone:a},b?(i.msedge=a,i.version=b):(i.msie=a,i.version=e(/iemobile\/(\d+(\.\d+)?)/i))):/msie|trident/i.test(t)?i={name:"Internet Explorer",msie:a,version:e(/(?:msie |rv:)(\d+(\.\d+)?)/i)}:c?i={name:"Chrome",osname:"Chrome OS",chromeos:a,chromeBook:a,chrome:a,version:e(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:/edg([ea]|ios)/i.test(t)?i={name:"Microsoft Edge",msedge:a,version:b}:/vivaldi/i.test(t)?i={name:"Vivaldi",vivaldi:a,version:e(/vivaldi\/(\d+(\.\d+)?)/i)||_}:d?i={name:"Sailfish",osname:"Sailfish OS",sailfish:a,version:e(/sailfish\s?browser\/(\d+(\.\d+)?)/i)}:/seamonkey\//i.test(t)?i={name:"SeaMonkey",seamonkey:a,version:e(/seamonkey\/(\d+(\.\d+)?)/i)}:/firefox|iceweasel|fxios/i.test(t)?(i={name:"Firefox",firefox:a,version:e(/(?:firefox|iceweasel|fxios)[ \/](\d+(\.\d+)?)/i)},/\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(t)&&(i.firefoxos=a,i.osname="Firefox OS")):h?i={name:"Amazon Silk",silk:a,version:e(/silk\/(\d+(\.\d+)?)/i)}:/phantom/i.test(t)?i={name:"PhantomJS",phantom:a,version:e(/phantomjs\/(\d+(\.\d+)?)/i)}:/slimerjs/i.test(t)?i={name:"SlimerJS",slimer:a,version:e(/slimerjs\/(\d+(\.\d+)?)/i)}:/blackberry|\bbb\d+/i.test(t)||/rim\stablet/i.test(t)?i={name:"BlackBerry",osname:"BlackBerry OS",blackberry:a,version:_||e(/blackberry[\d]+\/(\d+(\.\d+)?)/i)}:f?(i={name:"WebOS",osname:"WebOS",webos:a,version:_||e(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i)},/touchpad\//i.test(t)&&(i.touchpad=a)):/bada/i.test(t)?i={name:"Bada",osname:"Bada",bada:a,version:e(/dolfin\/(\d+(\.\d+)?)/i)}:p?i={name:"Tizen",osname:"Tizen",tizen:a,version:e(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i)||_}:/qupzilla/i.test(t)?i={name:"QupZilla",qupzilla:a,version:e(/(?:qupzilla)[\s\/](\d+(?:\.\d+)+)/i)||_}:/chromium/i.test(t)?i={name:"Chromium",chromium:a,version:e(/(?:chromium)[\s\/](\d+(?:\.\d+)?)/i)||_}:/chrome|crios|crmo/i.test(t)?i={name:"Chrome",chrome:a,version:e(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:s?i={name:"Android",version:_}:/safari|applewebkit/i.test(t)?(i={name:"Safari",safari:a},_&&(i.version=_)):r?(i={name:"iphone"==r?"iPhone":"ipad"==r?"iPad":"iPod"},_&&(i.version=_)):i=/googlebot/i.test(t)?{name:"Googlebot",googlebot:a,version:e(/googlebot\/(\d+(\.\d+))/i)||_}:{name:e(/^(.*)\/(.*) /),version:n(/^(.*)\/(.*) /)},!i.msedge&&/(apple)?webkit/i.test(t)?(/(apple)?webkit\/537\.36/i.test(t)?(i.name=i.name||"Blink",i.blink=a):(i.name=i.name||"Webkit",i.webkit=a),!i.version&&_&&(i.version=_)):!i.opera&&/gecko\//i.test(t)&&(i.name=i.name||"Gecko",i.gecko=a,i.version=i.version||e(/gecko\/(\d+(\.\d+)?)/i)),i.windowsphone||!s&&!i.silk?!i.windowsphone&&r?(i[r]=a,i.ios=a,i.osname="iOS"):g?(i.mac=a,i.osname="macOS"):x?(i.xbox=a,i.osname="Xbox"):v?(i.windows=a,i.osname="Windows"):y&&(i.linux=a,i.osname="Linux"):(i.android=a,i.osname="Android");var E="";i.windows?E=function(t){switch(t){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}(e(/Windows ((NT|XP)( \d\d?.\d)?)/i)):i.windowsphone?E=e(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i):i.mac?(E=e(/Mac OS X (\d+([_\.\s]\d+)*)/i),E=E.replace(/[_\s]/g,".")):r?(E=e(/os (\d+([_\s]\d+)*) like mac os x/i),E=E.replace(/[_\s]/g,".")):s?E=e(/android[ \/-](\d+(\.\d+)*)/i):i.webos?E=e(/(?:web|hpw)os\/(\d+(\.\d+)*)/i):i.blackberry?E=e(/rim\stablet\sos\s(\d+(\.\d+)*)/i):i.bada?E=e(/bada\/(\d+(\.\d+)*)/i):i.tizen&&(E=e(/tizen[\/\s](\d+(\.\d+)*)/i)),E&&(i.osversion=E);var S=!i.windows&&E.split(".")[0];return w||u||"ipad"==r||s&&(3==S||S>=4&&!T)||i.silk?i.tablet=a:(T||"iphone"==r||"ipod"==r||s||l||i.blackberry||i.webos||i.bada)&&(i.mobile=a),i.msedge||i.msie&&i.version>=10||i.yandexbrowser&&i.version>=15||i.vivaldi&&i.version>=1||i.chrome&&i.version>=20||i.samsungBrowser&&i.version>=4||i.firefox&&i.version>=20||i.safari&&i.version>=6||i.opera&&i.version>=10||i.ios&&i.osversion&&i.osversion.split(".")[0]>=6||i.blackberry&&i.version>=10.1||i.chromium&&i.version>=20?i.a=a:i.msie&&i.version<10||i.chrome&&i.version<20||i.firefox&&i.version<20||i.safari&&i.version<6||i.opera&&i.version<10||i.ios&&i.osversion&&i.osversion.split(".")[0]<6||i.chromium&&i.version<20?i.c=a:i.x=a,i}function e(t){return t.split(".").length}function n(t,e){var n,i=[];if(Array.prototype.map)return Array.prototype.map.call(t,e);for(n=0;n<t.length;n++)i.push(e(t[n]));return i}function i(t){for(var i=Math.max(e(t[0]),e(t[1])),r=n(t,function(t){var r=i-e(t);return t+=new Array(r+1).join(".0"),n(t.split("."),function(t){return new Array(20-t.length).join("0")+t}).reverse()});--i>=0;){if(r[0][i]>r[1][i])return 1;if(r[0][i]!==r[1][i])return-1;if(0===i)return 0}}function r(e,n,r){var o=s;"string"==typeof n&&(r=n,n=void 0),void 0===n&&(n=!1),r&&(o=t(r));var a=""+o.version;for(var l in e)if(e.hasOwnProperty(l)&&o[l]){if("string"!=typeof e[l])throw new Error("Browser version in the minVersion map should be a string: "+l+": "+String(e));return i([a,e[l]])<0}return n}function o(t,e,n){return!r(t,e,n)}var a=!0,s=t("undefined"!=typeof navigator?navigator.userAgent||"":"");return s.test=function(t){for(var e=0;e<t.length;++e){var n=t[e];if("string"==typeof n&&n in s)return!0}return!1},s.isUnsupportedBrowser=r,s.compareVersions=i,s.check=o,s._detect=t,s.detect=t,s})},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=i(r),a=n(4),s=i(a);n(175),n(178);var l=n(16),u=i(l),c=n(104),h=(i(c),function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;(0,o.default)(this,t),$(e.el_).is("[panorama]")&&(this.initPlugin(e,n,i),this.compatibilityThings(e,n,i),this.attachEvents(e,n,i))}return(0,s.default)(t,[{key:"initPlugin",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(arguments.length>2&&void 0!==arguments[2]&&arguments[2],t.el_),i=n.offsetWidth,r=n.offsetHeight;t.width(i),t.height(r),t.panorama(e.panorama)}},{key:"attachEvents",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;arguments.length>1&&void 0!==arguments[1]&&arguments[1],arguments.length>2&&void 0!==arguments[2]&&arguments[2];t.on("fullscreenchange",function(){t.getChild("Canvas").handleResize(),t.isFullscreen_&&screen&&screen.orientation&&u.default.isMobile&&screen.orientation.lock("landscape")}),window.addEventListener("resize",function(){t.getChild("Canvas").handleResize()}),t.on("theatermodechanged",function(){t.getChild("Canvas").handleResize()})}},{key:"compatibilityThings",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};arguments.length>2&&void 0!==arguments[2]&&arguments[2];e.ads&&e.ads.enabled&&(setTimeout(function(){t.play(),t.pause(),t.play()},1e3),setTimeout(function(){t.play(),t.pause(),t.play()},200))}}]),t}());e.default=h},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(3),o=i(r),a=n(0),s=i(a),l=n(6),u=i(l),c=n(5),h=i(c),d=n(1),p=i(d);n(176);var f=p.default.getPlugin("plugin"),m=p.default.getComponent("Button"),v=function(t){function e(t,n){(0,s.default)(this,e);var i=(0,u.default)(this,(e.__proto__||(0,o.default)(e)).call(this,t,n)),r=p.default.extend(m,{constructor:function(t,e){m.call(this,t,e),this.addClass("vjs-control-brand-logo"),this.setAttribute("title",n.title),this.el_.innerHTML="<a target='_blank' href='"+n.linkUrl+"'><img src='"+n.imgUrl+"' /></a>"}}),a=new r(t,{});return t.controlBar.brandLogo=t.controlBar.addChild(a),i}return(0,h.default)(e,t),e}(f);p.default.registerPlugin("branLogoPlugin",v)},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(3),o=i(r),a=n(0),s=i(a),l=n(6),u=i(l),c=n(5),h=i(c),d=n(1),p=i(d),f=n(76),m=i(f);n(177);var v=p.default.getPlugin("plugin"),g=p.default.getComponent("Button"),y=p.default.extend(g,{constructor:function(t,e){g.apply(this,arguments),this.setAttribute("title",t.localize("Fullscreen"))},buildCSSClass:function(){return"vjs-fullscreen-mode-btn vjs-icon-fullscreen-enter"},handleClick:function(){var t=this.player_.container_;p.default.dom.hasClass(t,"fkplayer-fullscreen")?(m.default.exit(),p.default.dom.removeClass(t,"fkplayer-fullscreen"),p.default.dom.removeClass(this.el_,"vjs-icon-fullscreen-exit"),p.default.dom.addClass(this.el_,"vjs-icon-fullscreen-enter")):m.default.enabled&&(m.default.request(t),p.default.dom.addClass(t,"fkplayer-fullscreen"),p.default.dom.addClass(this.el_,"vjs-icon-fullscreen-exit"),p.default.dom.removeClass(this.el_,"vjs-icon-fullscreen-enter")),this.player_.trigger("fullscreenchange")}});p.default.registerComponent("fullscreenButton",y);var b=function(t){function e(t,n){function i(){document.fullscreenElement||document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement?(p.default.dom.addClass(a,"fkplayer-fullscreen"),p.default.dom.addClass(l,"vjs-icon-fullscreen-exit"),p.default.dom.removeClass(l,"vjs-icon-fullscreen-enter")):(p.default.dom.removeClass(a,"fkplayer-fullscreen"),p.default.dom.removeClass(l,"vjs-icon-fullscreen-exit"),p.default.dom.addClass(l,"vjs-icon-fullscreen-enter"))}(0,s.default)(this,e);var r=(0,u.default)(this,(e.__proto__||(0,o.default)(e)).call(this,t,n));t.getChild("controlBar").addChild("fullscreenButton",{});var a=t.container_,l=p.default.dom.$(".vjs-fullscreen-mode-btn",a);return document.addEventListener("fullscreenchange",i),document.addEventListener("webkitfullscreenchange",i),document.addEventListener("mozfullscreenchange",i),document.addEventListener("MSFullscreenChange",i),r}return(0,h.default)(e,t),e}(v);p.default.registerPlugin("fullscreenModePlugin",b)},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(3),o=i(r),a=n(0),s=i(a),l=n(4),u=i(l),c=n(6),h=i(c),d=n(5),p=i(d),f=n(1),m=i(f);n(179);var v=m.default.getPlugin("plugin"),g=function(t){function e(t,n){(0,s.default)(this,e);var i=(0,h.default)(this,(e.__proto__||(0,o.default)(e)).call(this,t,n));i.player=t,i.initEnableFlag(),i.$container=document.createElement("div"),i.$button=document.createElement("div"),i.$icon=document.createElement("div"),m.default.dom.addClass(i.$container,"video-js--play-button-animated-container"),m.default.dom.addClass(i.$button,"video-js--play-button-animated"),m.default.dom.addClass(i.$icon,"vjs-icon-play"),i.$button.appendChild(i.$icon),i.$container.appendChild(i.$button),t.el_.appendChild(i.$container),i.playedOneTime=!1;m.default.dom.$(".vjs-play-control",t.el_);return t.one("play",function(){i.playedOneTime=!0}),t.on("play",function(){i.toggle()}),t.on("pause",function(){i.toggle()}),i}return(0,p.default)(e,t),(0,u.default)(e,[{key:"initEnableFlag",value:function(){void 0===this.player.playButtonAnimatedEnabled&&(this.player.playButtonAnimatedEnabled=!0)}},{key:"toggle",value:function(){this.player.playButtonAnimatedEnabled&&(this.player.paused()?this.animatePause():this.animatePlay())}},{key:"animatePlay",value:function(){var t=this;this.player.hasStarted_&&this.playedOneTime&&(this.$container.style.display="block",m.default.dom.removeClass(this.$icon,"vjs-icon-pause"),m.default.dom.addClass(this.$icon,"vjs-icon-play"),m.default.dom.addClass(this.$container,"video-js--play-button-animated--animate"),setTimeout(function(){m.default.dom.removeClass(t.$container,"video-js--play-button-animated--animate"),t.$container.style.display="none"},500)),this.playedOneTime=!0}},{key:"animatePause",value:function(){var t=this;this.player.hasStarted_&&this.playedOneTime&&(this.$container.style.display="block",m.default.dom.addClass(this.$icon,"vjs-icon-pause"),m.default.dom.removeClass(this.$icon,"vjs-icon-play"),m.default.dom.removeClass(this.$container,"video-js--play-button-animated--animate"),m.default.dom.addClass(this.$container,"video-js--play-button-animated--animate"),setTimeout(function(){m.default.dom.removeClass(t.$container,"video-js--play-button-animated--animate"),t.$container.style.display="none"},500)),this.playedOneTime=!0}}]),e}(v);m.default.registerPlugin("playButtonAnimated",g)},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(3),o=i(r),a=n(0),s=i(a),l=n(4),u=i(l),c=n(6),h=i(c),d=n(5),p=i(d);n(180);var f=n(1),m=i(f),v=m.default.getPlugin("plugin"),g=function(t){function e(t,n){(0,s.default)(this,e);var i=(0,h.default)(this,(e.__proto__||(0,o.default)(e)).call(this,t,n)),r=i;return i.player=t,i.$button=document.createElement("DIV"),m.default.dom.addClass(i.$button,"vjs-big-reset-playback-rate-button"),i.$label=document.createElement("DIV"),m.default.dom.addClass(i.$label,"vjs-big-reset-playback-rate-label"),t.el_.appendChild(i.$button),i.$button.appendChild(i.$label),t.one("play",function(){1!==t.playbackRate()?r.showMuteButton():r.hideMuteButton()}),t.on("ratechange",function(){1!==t.playbackRate()?(r.$label.innerHTML=t.playbackRate()+" x",r.showMuteButton()):r.hideMuteButton()}),i.$button.addEventListener("click",function(){t.playbackRate(1)}),i}return(0,p.default)(e,t),(0,u.default)(e,[{key:"hideMuteButton",value:function(){this.$button.style.display="none"}},{key:"showMuteButton",value:function(){this.$button.style.display="block"}}]),e}(v);m.default.registerPlugin("resetPlaybackratePlugin",g)},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(3),o=i(r),a=n(0),s=i(a),l=n(4),u=i(l),c=n(6),h=i(c),d=n(5),p=i(d),f=n(1),m=i(f);n(181);var v=n(76),g=(i(v),n(87)),y=(i(g),n(89)),b=i(y),_=n(16),w=i(_),T=m.default.getPlugin("plugin"),x=m.default.getComponent("ModalDialog"),E=function(t){function e(t,n){(0,s.default)(this,e);var i=(0,h.default)(this,(e.__proto__||(0,o.default)(e)).call(this,t,n));return i.player=t,i.settings=n,i.addInitialThings(),setTimeout(function(){i.hideControlButton()},500),i.modal.one("modalopen",function(){i.menuContainer=m.default.dom.$(".vjs-settings-box--menu-container",i.player.el_),i.optionsContainer=m.default.dom.$(".vjs-settings-box--options-container",i.player.el_),i.initPlugins(),i.hideControlButton()}),i}return(0,p.default)(e,t),(0,u.default)(e,[{key:"initPlugins",value:function(){var t=this;this.settings.settingsMenu.plugins.forEach(function(e){"share"==e&&t.settings.share.enabled&&t.handleShare(),"brandLogo"==e&&t.settings.brandLogo.enabled&&t.handleBrandLogo(),"quality"==e&&("HLS"==t.player.el_.dataset.tech?t.handleResolutionSwitchHls():t.handleResolutionSwitchMp4()),"playbackRate"!=e||w.default.isSamsungBrowser||t.handlePlaybackRate(),"captions"==e&&t.player.remoteTextTracks().length>0&&t.handleCaptions(),"panorama"==e&&t.settings.panorama.enabled&&t.handleVrButton()})}},{key:"hideControlButton",value:function(){var t=this;this.settings.settingsMenu.plugins.forEach(function(e){var n=m.default.dom.$(".vjs-share-button",t.player.controlBar.el_),i=m.default.dom.$(".vjs-control-brand-logo",t.player.controlBar.el_),r=m.default.dom.$(".vjs-button-quality",t.player.controlBar.el_),o=m.default.dom.$(".vjs-playback-rate",t.player.controlBar.el_),a=m.default.dom.$(".vjs-subs-caps-button",t.player.controlBar.el_),s=m.default.dom.$(".vjs-VR-control",t.player.controlBar.el_),l=m.default.dom.$(".vjs-resolution-button",t.player.controlBar.el_),u=function(e){return w.default.isDesktop?t.settings.settingsMenu.desktopAvailableButton.indexOf(e)<0:w.default.isTablet?t.settings.settingsMenu.tabletAvailableButton.indexOf(e)<0:!w.default.isMobile||t.settings.settingsMenu.mobileAvailableButton.indexOf(e)<0};"share"==e&&n&&u("share")&&(n.style.display="none"),"brandLogo"==e&&i&&u("brandLogo")&&(i.style.display="none"),"quality"==e&&r&&u("quality")&&(r.style.display="none"),"quality"==e&&l&&u("quality")&&(l.style.display="none"),"playbackRate"==e&&o&&u("playbackRate")&&(o.style.display="none"),"captions"==e&&a&&u("captions")&&(a.style.display="none"),"panorama"==e&&s&&u("panorama")&&(s.style.display="none")})}},{key:"addInitialThings",value:function(){var t=this,e=this;this.$button=this.player.controlBar.addChild("button",{});var n=this.$button;n.setAttribute("title",this.settings.settingsMenu.tooltip),n.addClass("vjs-icon-cog"),n.addClass("vjs-control-settings");var i=document.createElement("div");m.default.dom.addClass(i,"vjs-settings-box"),i.innerHTML='<div class="vjs-modal-content-box--center-vertical vjs-settings-box--content">\n                  <div class="vjs-settings-box--menu-container"></div>\n                  <div class="vjs-settings-box--options-container"></div>\n            </div>\n    <div class="vjs-settings-box--breadcrumbs">\n        <div class="vjs-settings-box--breadcrumbs-icon vjs-icon-cog"></div>\n        <span>'+e.player.localize("Settings")+'</span>\n        <span class="vjs-settings-box--breadcrumbs--separator">/</span>\n        <span class="vjs-settings-box--breadcrumbs--sub-menu"></span>\n    </div>',this.modal=new x(this.player,{content:i,temporary:!1});var r=document.createElement("div");m.default.dom.addClass(r,"vjs-modal-back-btn"),m.default.dom.addClass(r,"vjs-icon-back"),this.modal.el_.appendChild(r),this.player.addChild(this.modal);var o=function(){e.openSettingsBox()};i.addEventListener("click",function(e){m.default.hasClass(e.target,"vjs-settings-box")&&t.modal.close()}),m.default.dom.$(".vjs-settings-box--breadcrumbs",i).addEventListener("click",function(){t.isInOptionsMode?t.goBackFromOptions():t.modal.close()}),n.el_.addEventListener("click",o),n.el_.addEventListener("touchstart",o),r.addEventListener("click",function(){t.goBackFromOptions()}),this.modal.on("modalclose",function(){t.goBackFromOptions(),m.default.dom.removeClass(e.$button.el_,"vjs-active"),m.default.dom.removeClass(e.player.container_,"vjs-settings-menu-is-open")}),this.modal.on("modalopen",function(){m.default.dom.addClass(e.player.container_,"vjs-settings-menu-is-open")})}},{key:"handleBrandLogo",value:function(){var t=document.createElement("div"),e=this.settings.brandLogo;m.default.dom.addClass(t,"vjs-settings-menu-item"),t.innerHTML="<div class=\"vjs-settings-menu-item--icon\">\n                          <a target='_blank' href='"+e.linkUrl+"'>\n                              <img src='"+e.imgUrl+'\' />\n                          </a>\n                        </div>\n                        <div class="vjs-settings-menu-item--title" >'+e.tooltip+"</div>",this.menuContainer.appendChild(t)}},{key:"openSettingsBox",value:function(){var t=this;t.modal.open(),t.modal.addClass("vjs-visible"),m.default.dom.addClass(t.$button.el_,"vjs-active");var e=m.default.dom.$$(".vjs-settings-menu-item",this.menuContainer);t.menuContainer.style.width=e[0].offsetWidth*e.length+100+"px",setTimeout(function(){t.menuContainer.style.width=e[0].offsetWidth*e.length+100+"px"},600)}},{key:"goToOptions",value:function(t){var e=this,n=null;this.isInOptionsMode=!0;var i=m.default.dom.$(".vjs-modal-content-box--center-vertical",this.player.el_);this.optionsContainer.style.display="block",m.default.dom.$(".vjs-settings-box--breadcrumbs--sub-menu",this.player.el).innerHTML=this.player.localize(t),m.default.dom.$(".vjs-settings-box--breadcrumbs--separator",this.player.el).style.display="block";var r=(m.default.dom.$$(".vjs-settings-menu-options-box",this.player.el_).forEach(function(e,i){e.dataset.optionName==t?(e.style.display="block",n=e):e.style.display="none"}),m.default.dom.$(".vjs-settings-box--content",this.player.el_));m.default.dom.addClass(r,"vjs-settings-box--content-options-view"),m.default.dom.$(".vjs-modal-back-btn",this.player.el_).style.display="block";var o=m.default.dom.$$(".vjs-settings-options-item",n);this.optionsContainer.style.width=o[0].offsetWidth*o.length+100+"px",setTimeout(function(){e.optionsContainer.style.width=o[0].offsetWidth*o.length+100+"px"},600),i.style.display="none",setTimeout(function(){i.style.display="block",i.scrollLeft=0},0)}},{key:"goBackFromOptions",value:function(){this.isInOptionsMode=!1;var t=m.default.dom.$(".vjs-modal-content-box--center-vertical",this.player.el_);this.optionsContainer.style.display="none";var e=m.default.dom.$(".vjs-settings-box--content",this.player.el_);m.default.dom.removeClass(e,"vjs-settings-box--content-options-view"),m.default.dom.$(".vjs-modal-back-btn",this.player.el_).style.display="none",m.default.dom.$(".vjs-settings-box--breadcrumbs--separator",this.player.el).style.display="none",m.default.dom.$(".vjs-settings-box--breadcrumbs--sub-menu",this.player.el).innerHTML="",t.style.display="none",setTimeout(function(){t.style.display="block"},0),setTimeout(function(){t.scrollLeft=0},200)}},{key:"handleShare",value:function(){var t=this,e=document.createElement("div"),n=this.settings.share,i=this.settings.share.url,r=this.player.localize("Share");m.default.dom.addClass(e,"vjs-settings-menu-item"),e.innerHTML='<div class="vjs-settings-menu-item--icon vjs-icon-share" ></div>\n                        <div class="vjs-settings-menu-item--title" >'+r+"</div>",this.menuContainer.appendChild(e),e.addEventListener("click",function(){t.goToOptions("share")});var o=document.createElement("div");o.dataset.optionName="share",m.default.dom.addClass(o,"vjs-settings-menu-options-box"),o.innerHTML='\n                <a target="_blank" data-visible="'+n.facebook+'EXTERNAL_FRAGMENT" href="http://www.facebook.com/sharer.php?u='+i+'EXTERNAL" class=\'vjs-settings-options-item\' >\n                    <span class="vjs-settings-menu-item--icon vjs-icon-facebook"></span>\n                </a>\n                <a target="_blank" data-visible="'+n.twitter+'" href="http://twitter.com/share?url='+i+"\" class='vjs-settings-options-item' >\n                    <span class=\"vjs-settings-menu-item--icon vjs-icon-twitter\"></span>\n                </a>\n                <a target='_blank' data-visible='"+n.telegram+"' href='https://telegram.me/share/url?url="+i+"' class='vjs-settings-options-item' >\n                    <span class=\"vjs-settings-menu-item--icon vjs-icon-telegram\"></span>\n                </a>\n                <a target='_blank' data-visible='"+n.gplus+"' href='https://plus.google.com/share?url="+i+"' class='vjs-settings-options-item' >\n                    <span class=\"vjs-settings-menu-item--icon  vjs-icon-gplus\"></span>\n                </a>\n              ",this.optionsContainer.appendChild(o)}},{key:"handlePlaybackRate",value:function(){var t=this,e=this,n=document.createElement("div");m.default.dom.addClass(n,"vjs-settings-menu-item");var i=this.player.localize("Playback Rate");n.innerHTML='<div class="vjs-settings-menu-item--icon vjs-icon-playrate" ></div>\n                        <div class="vjs-settings-menu-item--title" >'+i+"</div>",this.menuContainer.appendChild(n),n.addEventListener("click",function(){e.goToOptions("playbackRate")});var r=document.createElement("div");r.dataset.optionName="playbackRate";var o=this.player.playbackRate();m.default.dom.addClass(r,"vjs-settings-menu-options-box");var a=this.player.options_.playbackRates;for(var s in a){var l=document.createElement("div");m.default.dom.addClass(l,"vjs-settings-options-item"),a[s]==o&&m.default.dom.addClass(l,"vjs-settings-options-item--activated"),l.innerHTML=a[s],l.dataset.label=a[s],r.appendChild(l),l.addEventListener("click",function(n){var i=n.target.dataset.label;t.player.playbackRate(i),e.closeModal()})}var u=m.default.dom.$(".vjs-settings-menu-item--icon",n);this.player.on("ratechange",function(){var e=t.player.playbackRate();m.default.dom.$$(".vjs-settings-options-item",r).forEach(function(t,n){e==t.dataset.label?m.default.dom.addClass(t,"vjs-settings-options-item--activated"):m.default.dom.removeClass(t,"vjs-settings-options-item--activated")}),1==t.player.playbackRate()?(m.default.dom.removeClass(u,"vjs-icon-playrate-on"),m.default.dom.addClass(u,"vjs-icon-playrate"),m.default.dom.removeClass(n,"vjs-settings-menu-item--activated")):(m.default.dom.addClass(u,"vjs-icon-playrate-on"),m.default.dom.removeClass(u,"vjs-icon-playrate"),m.default.dom.addClass(n,"vjs-settings-menu-item--activated"))}),this.optionsContainer.appendChild(r)}},{key:"closeModal",value:function(){this.modal.close()}},{key:"handleCaptions",value:function(){var t=this,e=document.createElement("div");m.default.dom.addClass(e,"vjs-settings-menu-item"),e.innerHTML='<div class="vjs-settings-menu-item--icon vjs-icon-captions" ></div>\n                        <div class="vjs-settings-menu-item--title" >Ø²ÛØ±ÙÙÛØ³</div>',this.menuContainer.appendChild(e),e.addEventListener("click",function(){t.goToOptions("captions")});var n=document.createElement("div");n.dataset.optionName="captions";var i=this.player.remoteTextTracks().tracks_,r=i.filter(function(t){return"showing"==t.mode}),o=r?r[0]:"";m.default.dom.addClass(n,"vjs-settings-menu-options-box");var a=function(t){i.forEach(function(e,n){e.label==t?e.mode="showing":e.mode="disabled"})},s=document.createElement("div");m.default.dom.addClass(s,"vjs-settings-options-item"),s.innerHTML=this.player.localize("OFF"),s.dataset.label="OFF",n.appendChild(s),s.addEventListener("click",function(e){var n=e.target.dataset.label;a(n),t.closeModal()});for(var l in i){var u=document.createElement("div");m.default.dom.addClass(u,"vjs-settings-options-item"),i[l].label==o&&m.default.dom.addClass(u,"vjs-settings-options-item--activated"),u.innerHTML=i[l].label,u.dataset.label=i[l].label,n.appendChild(u),u.addEventListener("click",function(e){var n=e.target.dataset.label;a(n),t.closeModal()})}this.player.on("texttrackchange",function(){var t=i.filter(function(t){return"showing"==t.mode})[0];m.default.dom.$$(".vjs-settings-options-item",n).forEach(function(e,n){t&&e.dataset.label==t.label?m.default.dom.addClass(e,"vjs-settings-options-item--activated"):m.default.dom.removeClass(e,"vjs-settings-options-item--activated"),void 0===t&&"OFF"==e.dataset.label&&m.default.dom.addClass(e,"vjs-settings-options-item--activated")})}),this.optionsContainer.appendChild(n)}},{key:"resolutionBadger",value:function(t,e){if("720p"==e){var n=document.createElement("div");m.default.dom.addClass(n,"vjs-settings-options-item--badge"),m.default.dom.addClass(n,"vjs-icon-hd-badge"),t.appendChild(n)}if("1080p"==e){var i=document.createElement("div");m.default.dom.addClass(i,"vjs-settings-options-item--badge"),m.default.dom.addClass(i,"vjs-icon-video-2k-badge"),t.appendChild(i)}if("2160p"==e){var r=document.createElement("div");m.default.dom.addClass(r,"vjs-settings-options-item--badge"),m.default.dom.addClass(r,"vjs-icon-video-4k-badge"),t.appendChild(r)}}},{key:"handleResolutionSwitchMp4",value:function(){var t=this;if(void 0===this.player.getGroupedSrc())return!1;var e=this,n=this.player.localize("Quality"),i=document.createElement("div");m.default.dom.addClass(i,"vjs-settings-menu-item"),i.innerHTML='<div class="vjs-settings-menu-item--icon vjs-icon-quality" ></div>\n                        <div class="vjs-settings-menu-item--title" >'+n+"</div>",this.menuContainer.appendChild(i),i.addEventListener("click",function(){e.goToOptions("resolutionSwitch")});var r=document.createElement("div");r.dataset.optionName="resolutionSwitch";var o=this.player.getGroupedSrc()?this.player.getGroupedSrc().label:"",a=this.player.currentResolution()?this.player.currentResolution().label:"";m.default.dom.addClass(r,"vjs-settings-menu-options-box");for(var s in o)if(w.default.isMobile&&parseInt(s)<=1080||isNaN(parseInt(s))){var l=document.createElement("div");m.default.dom.addClass(l,"vjs-settings-options-item"),s==a&&m.default.dom.addClass(l,"vjs-settings-options-item--activated"),l.innerHTML=s,e.resolutionBadger(l,s),l.dataset&&(l.dataset.label=s),r.insertBefore(l,r.childNodes[0]),l.addEventListener("click",function(n){if(n.target.dataset){var i=n.target.dataset.label;void 0===i&&(i=n.target.parentElement.dataset.label),t.player.currentResolution(i)}e.closeModal()})}var u=m.default.dom.$(".vjs-settings-menu-item--icon",i);this.player.on("resolutionchange",function(){var n=t.player.currentResolution().label;m.default.dom.$(".vjs-resolution-button-label",t.player.controlBar.el_).innerHTML=n,m.default.dom.$$(".vjs-settings-options-item",r).forEach(function(t,e){m.default.dom.removeClass(t,"vjs-settings-options-item--activated"),t.dataset.label==n&&m.default.dom.addClass(t,"vjs-settings-options-item--activated")}),n==e.player.localize("Auto")?(m.default.dom.removeClass(u,"vjs-icon-quality-on"),m.default.dom.addClass(u,"vjs-icon-quality"),m.default.dom.removeClass(i,"vjs-settings-menu-item--activated")):(m.default.dom.addClass(u,"vjs-icon-quality-on"),m.default.dom.removeClass(u,"vjs-icon-quality"),m.default.dom.addClass(i,"vjs-settings-menu-item--activated")),e.removeSettingButtonBadge(),e.appendResolutionBadgeToSettingsButton(n)}),this.optionsContainer.appendChild(r)}},{key:"removeSettingButtonBadge",value:function(){var t=m.default.dom.$(".vjs-settings-button--badge",this.$button.el_);t&&t.parentNode.removeChild(t)}},{key:"appendResolutionBadgeToSettingsButton",value:function(t){if("720p"==t){var e=document.createElement("div");m.default.dom.addClass(e,"vjs-settings-button--badge"),m.default.dom.addClass(e,"vjs-icon-hd-badge"),this.$button.el_.appendChild(e)}if("1080p"==t){var n=document.createElement("div");m.default.dom.addClass(n,"vjs-settings-button--badge"),m.default.dom.addClass(n,"vjs-icon-video-2k-badge"),this.$button.el_.appendChild(n)}if("2160p"==t){var i=document.createElement("div");m.default.dom.addClass(i,"vjs-settings-button--badge"),m.default.dom.addClass(i,"vjs-icon-video-4k-badge"),this.$button.el_.appendChild(i)}}},{key:"handleResolutionSwitchHls",value:function(){var t=this,e=this,n=this.player.localize("Quality"),i=document.createElement("div");m.default.dom.addClass(i,"vjs-settings-menu-item"),i.innerHTML='<div class="vjs-settings-menu-item--icon vjs-icon-quality" ></div>\n                        <div class="vjs-settings-menu-item--title" >'+n+"</div>",this.menuContainer.appendChild(i),i.addEventListener("click",function(){e.goToOptions("resolutionSwitch")});var r=document.createElement("div"),o=this.player.hls.levels.slice(0),a=this.player.hls.currentLevel;r.dataset.optionName="resolutionSwitch",m.default.dom.addClass(r,"vjs-settings-menu-options-box");var s=document.createElement("div");m.default.dom.addClass(s,"vjs-settings-options-item"),s.innerHTML=e.player.localize("Auto"),s.dataset.label=-1,r.appendChild(s),s.addEventListener("click",function(n){t.player.hls.currentLevel=-1,t.player.trigger("resolutionchange"),e.closeModal()});for(var l in o){var u=document.createElement("div");m.default.dom.addClass(u,"vjs-settings-options-item"),l==a&&m.default.dom.addClass(u,"vjs-settings-options-item--activated"),u.innerHTML=o[l].height,e.resolutionBadger(u,l),u.dataset.label=l,u.dataset.title=o[l].height+"p",r.append(u),u.addEventListener("click",function(n){var i=void 0;n.target.dataset&&(i=parseInt(n.target.dataset.label)),void 0===i&&n.target.parentElement.dataset&&(i=n.target.parentElement.dataset.label),t.player.hls.currentLevel=parseInt(i),t.player.trigger("resolutionchange"),e.closeModal()})}var c=m.default.dom.$(".vjs-settings-menu-item--icon",i);this.player.hls.on(b.default.Events.LEVEL_LOADED,function(){m.default.dom.$$(".vjs-settings-options-item",r).forEach(function(n,r){m.default.dom.removeClass(n,"vjs-settings-options-item--activated"),n.dataset&&n.dataset.label==t.player.hls.loadLevel&&-1!=n.dataset.label&&!t.player.hls.autoLevelEnabled&&m.default.dom.addClass(n,"vjs-settings-options-item--activated"),n.dataset&&-1==n.dataset.label&&t.player.hls.autoLevelEnabled&&m.default.dom.addClass(n,"vjs-settings-options-item--activated"),t.player.hls.autoLevelEnabled?(m.default.dom.removeClass(c,"vjs-icon-quality-on"),m.default.dom.addClass(c,"vjs-icon-quality"),m.default.dom.removeClass(i,"vjs-settings-menu-item--activated")):(m.default.dom.addClass(c,"vjs-icon-quality-on"),m.default.dom.removeClass(c,"vjs-icon-quality"),m.default.dom.addClass(i,"vjs-settings-menu-item--activated")),e.removeSettingButtonBadge(),e.appendResolutionBadgeToSettingsButton(t.player.hls.loadLevel)})}),this.optionsContainer.appendChild(r)}},{key:"handleVrButton",value:function(){var t=this,e=this.player.controlBar.children_.filter(function(t){return"VRButton"==t.name_})[0],n=document.createElement("div"),i=this.player.localize("VR");m.default.dom.addClass(n,"vjs-settings-menu-item"),n.innerHTML='<div class="vjs-settings-menu-item--icon vjs-icon-vr-mode-disable" ></div>\n                        <div class="vjs-settings-menu-item--title" >'+i+"</div>",this.menuContainer.appendChild(n),n.addEventListener("click",function(){e.trigger("click"),t.modal.close()});var r=m.default.dom.$(".vjs-settings-menu-item--icon",n);this.player.on("VRModeOn",function(){m.default.dom.addClass(n,"vjs-settings-menu-item--activated"),m.default.dom.$(".vjs-settings-menu-item--icon",n),m.default.dom.removeClass(r,"vjs-icon-vr-mode-disable"),m.default.dom.addClass(r,"vjs-icon-vr-mode-enable")}),this.player.on("VRModeOff",function(){m.default.dom.removeClass(n,"vjs-settings-menu-item--activated"),m.default.dom.addClass(r,"vjs-icon-vr-mode-disable"),m.default.dom.removeClass(r,"vjs-icon-vr-mode-enable")})}}]),e}(T);m.default.registerPlugin("settingsPlugin",E)},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(3),o=i(r),a=n(0),s=i(a),l=n(6),u=i(l),c=n(5),h=i(c),d=n(1),p=i(d);n(182);var f=p.default.getPlugin("plugin"),m=p.default.getComponent("ModalDialog"),v=function(t){function e(t,n){(0,s.default)(this,e);var i=(0,u.default)(this,(e.__proto__||(0,o.default)(e)).call(this,t,n)),r=n.url,a=t.controlBar.addChild("button",{});a.setAttribute("title",n.tooltip),a.addClass("vjs-share-button");var l=document.createElement("div");p.default.dom.addClass(l,"vjs-share-box"),l.innerHTML="<div class=\"vjs-modal-content-box--center-vertical vjs-share-box--content\">\n                <a target='_blank' data-visible='"+n.facebook+"' href='http://www.facebook.com/sharer.php?u="+r+"' class='vjs-share-box--icon vjs-icon-facebook vjs-share-box--icon-share-fb' ></a>\n                <a target='_blank' data-visible='"+n.twitter+"' href='http://twitter.com/share?url="+r+"' class='vjs-share-box--icon vjs-icon-twitter vjs-share-box--icon-share-tw' ></a>\n                <a target='_blank' data-visible='"+n.telegram+"' href='https://telegram.me/share/url?url="+r+"' class='vjs-share-box--icon vjs-icon-telegram vjs-share-box--icon-share-tl' ></a>\n                <a target='_blank' data-visible='"+n.gplus+"' href='https://plus.google.com/share?url="+r+"' class='vjs-share-box--icon vjs-icon-gplus vjs-share-box--icon-share-tl' ></a>\n              </div>";var c=new m(t,{content:l,temporary:!1});return t.addChild(c),a.el_.addEventListener("click",function(){c.open()}),i}return(0,h.default)(e,t),e}(f);p.default.registerPlugin("sharePlugin",v)},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(3),o=i(r),a=n(0),s=i(a),l=n(4),u=i(l),c=n(6),h=i(c),d=n(5),p=i(d),f=n(1),m=i(f);n(183);var v=m.default.getPlugin("plugin"),g=function(t){function e(t,n){(0,s.default)(this,e);var i=(0,h.default)(this,(e.__proto__||(0,o.default)(e)).call(this,t,n)),r=i;return i.player=t,i.$button=i.player.controlBar.addChild("button",{}),i.$body=document.getElementsByTagName("body")[0],i.$theaterOverlay=document.getElementsByClassName("vjs-theatre-overlay")[0],i.$theaterOverlay||(i.$theaterOverlay=document.createElement("div"),m.default.dom.addClass(i.$theaterOverlay,"vjs-theatre-overlay"),i.$body.appendChild(i.$theaterOverlay)),i.$button.setAttribute("title",n.tooltip),i.$button.addClass("vjs-theater-mode-btn"),i.$theaterOverlay.addEventListener("click",r.offTheaterMode),i.$button.el_.addEventListener("click",function(){if(m.default.dom.hasClass(i.$body,"vjs-theater-mode"))r.offTheaterMode();else{r.onTheaterMode();var e=function t(e){27===e.keyCode&&(i.offTheaterMode(),document.removeEventListener("keyup",t))};document.addEventListener("keyup",e)}t.trigger("theatermodechanged")}),i.player.exitTheaterMode=function(){i.offTheaterMode()},i}return(0,p.default)(e,t),(0,u.default)(e,[{key:"offTheaterMode",value:function(){m.default.dom.removeClass(this.player.el_,"vjs-theater-mode-box"),m.default.dom.removeClass(this.$body,"vjs-theater-mode")}},{key:"onTheaterMode",value:function(){m.default.dom.addClass(this.player.el_,"vjs-theater-mode-box"),m.default.dom.addClass(this.$body,"vjs-theater-mode")}}]),e}(v);m.default.registerPlugin("theaterModePlugin",g)},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(3),o=i(r),a=n(0),s=i(a),l=n(6),u=i(l),c=n(5),h=i(c),d=n(1),p=i(d);n(184);var f=p.default.getPlugin("plugin"),m=function(t){function e(t,n){(0,s.default)(this,e);var i=(0,u.default)(this,(e.__proto__||(0,o.default)(e)).call(this,t,n)),r=document.createElement("div");return p.default.dom.addClass(r,"video-js--video-title"),r.innerHTML="<span>"+n.text+"</span>",t.el_.appendChild(r),i}return(0,h.default)(e,t),e}(f);p.default.registerPlugin("titlePlugin",m)},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(3),o=i(r),a=n(0),s=i(a),l=n(6),u=i(l),c=n(5),h=i(c),d=n(1),p=i(d),f=n(111),m=i(f);n(185);var v=p.default.getPlugin("plugin"),g=function(t){function e(t,n){(0,s.default)(this,e);var i=(0,u.default)(this,(e.__proto__||(0,o.default)(e)).call(this,t,n)),r=p.default.dom.$(".vjs-fullscreen-mode-btn",t.container_);return p.default.dom.setAttribute(r,"title",""),setTimeout(function(){(0,m.default)(".fkplayer .vjs-control-bar .vjs-control, .vjs-big-play-button",{appendTo:t.el_,position:"left",delay:0,duration:0,updateDuration:100,size:"small",flip:!0,animation:!1,dynamicTitle:!0,animateFill:!1,performance:!1,flipBehavior:"flip",hideOnClick:!1,distance:30})},1e3),i}return(0,h.default)(e,t),e}(v);p.default.registerPlugin("tippyPlugin",g)},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(3),o=i(r),a=n(0),s=i(a),l=n(4),u=i(l),c=n(6),h=i(c),d=n(5),p=i(d),f=n(1),m=i(f);n(186);var v=m.default.getPlugin("plugin"),g=function(t){function e(t,n){(0,s.default)(this,e);var i=(0,h.default)(this,(e.__proto__||(0,o.default)(e)).call(this,t,n)),r=i;return i.player=t,i.$unmuteButton=document.createElement("DIV"),m.default.dom.addClass(i.$unmuteButton,"vjs-big-unmute-button"),t.el_.appendChild(i.$unmuteButton),t.one("play",function(){t.muted()?r.showMuteButton():r.hideMuteButton()}),t.one("volumechange",function(){r.hideMuteButton()}),i.$unmuteButton.addEventListener("click",function(){r.hideMuteButton()}),i}return(0,p.default)(e,t),(0,u.default)(e,[{key:"hideMuteButton",value:function(){this.$unmuteButton.style.display="none",this.player.muted(!1)}},{key:"showMuteButton",value:function(){this.$unmuteButton.style.display="block"}}]),e}(v);m.default.registerPlugin("unmutePlugin",g)},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(3),o=i(r),a=n(0),s=i(a),l=n(4),u=i(l),c=n(6),h=i(c),d=n(5),p=i(d),f=n(1),m=i(f),v=n(108),g=(i(v),n(107)),y=(i(g),m.default.getPlugin("plugin")),b=function(t){function e(t,n){(0,s.default)(this,e);var i=(0,h.default)(this,(e.__proto__||(0,o.default)(e)).call(this,t,n));return i.settings=n,i.player=t,i.container=t.container_,i.disableAnimatedPlayButton(),n.vast.adTagUrl.indexOf("videoboom.net")>-1?(t.vastVideoBoomClient(n.vast),t.on("vast.adDataLoaded",function(t){try{t.response.ads[0].inLine.creatives[0].linear.skipoffset=n.vast.forceSkipTimeoute,t.response.skipoffset=n.vast.forceSkipTimeoute}catch(t){}})):n.vast.adTagUrl.indexOf("adform.net")>-1?(t.vastAdformClient(n.vast),t.on("vast.adDataLoaded",function(t){try{t.response.ads[1].inLine.creatives[0].linear.skipoffset=n.vast.forceSkipTimeoute,t.response.skipoffset=n.vast.forceSkipTimeoute}catch(t){}}),t.one("vast.adStart",function(e){t.one("vast.adEnd",function(e){var n=t.src();t.src(n),t.play()})}),t.one("vast.adSkip",function(e){var n=t.src();t.src(n),t.play()})):(t.vastVideoBoomClient(n.vast),t.on("vast.adDataLoaded",function(t){try{t.response.ads[0].inLine.creatives[0].linear.skipoffset=n.vast.forceSkipTimeoute,t.response.skipoffset=n.vast.forceSkipTimeoute}catch(t){}})),i.prepare(),i}return(0,p.default)(e,t),(0,u.default)(e,[{key:"disableAnimatedPlayButton",value:function(){this.player.playButtonAnimatedEnabled=!1}},{key:"enableAnimatedPlayButton",value:function(){this.player.playButtonAnimatedEnabled=!0}},{key:"showPoster",value:function(){m.default.dom.$(".vjs-poster",this.player.container_).style.display="block"}},{key:"hidePoster",value:function(){m.default.dom.$(".vjs-poster",this.player.container_).style.display="none"}},{key:"startWaiting",value:function(){m.default.dom.addClass(this.player.el_,"vjs-waiting")}},{key:"stopWaiting",value:function(){m.default.dom.removeClass(this.player.el_,"vjs-waiting")}},{key:"makeControlBarInvisible",value:function(){m.default.dom.addClass(this.player.controlBar.el_,"vjs-hidden")}},{key:"makeControlBarVisible",value:function(){m.default.dom.removeClass(this.player.controlBar.el_,"vjs-hidden")}},{key:"hideAndShowPlyButton",value:function(){var t=this,e=m.default.dom.$(".vjs-big-play-button",this.player.el_);m.default.dom.addClass(e,"vjs-hidden"),setTimeout(function(){t.player.on("timeupdate",function(){m.default.dom.removeClass(e,"vjs-hidden")})},3e3)}},{key:"prepare",value:function(){var t=this;t.player.on("vast.firstPlay",function(){t.showPoster(),t.hideAndShowPlyButton(),t.makeControlBarInvisible(),setTimeout(function(){t.startWaiting()},100)}),t.player.one("vast.adStart",function(){t.hidePoster(),t.enableAnimatedPlayButton(),t.settings.oneAdsStart(t.player),t.stopWaiting(),t.makeControlBarVisible()}),t.player.one("vast.adEnd",function(){t.hidePoster(),t.settings.oneAdsEnd(t.player),t.startWaiting(),t.player.one("play",function(){t.stopWaiting()}),t.hideAndShowPlyButton(),t.makeControlBarVisible()}),t.player.one("vast.adSkip",function(){t.hidePoster(),t.settings.oneSkipAds(t.player),t.startWaiting(),t.player.one("play",function(){t.stopWaiting()}),t.hideAndShowPlyButton(),t.makeControlBarVisible()}),t.player.one("vast.adClick",function(){console.log("vast.adClick ---\x3e>>"),t.settings.oneAdsClick(t.player)}),t.player.one("vast.contentEnd",function(){t.hidePoster(),t.stopWaiting(),t.settings.oneContentEnd(t.player),t.makeControlBarVisible(),t.player.one("play",function(){t.stopWaiting()})}),t.player.one("vast.adError",function(){t.hidePoster(),t.stopWaiting(),t.settings.oneAdError(t.player),t.makeControlBarVisible(),t.player.one("play",function(){t.stopWaiting()}),setTimeout(function(){t.stopWaiting()},200)}),t.player.one("vast.adsCancel",function(){t.hidePoster(),t.stopWaiting(),t.settings.oneAdCancel(t.player),t.player.play(),t.makeControlBarVisible(),t.player.one("play",function(){t.stopWaiting()}),setTimeout(function(){t.stopWaiting()},100)})}}]),e}(y);m.default.registerPlugin("adsPlugin",b)},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(){var t,e=document.createElement("fakeelement"),n={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(t in n)if(void 0!==e.style[t])return n[t]}function o(){var t=!1;return function(e){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0)}(navigator.userAgent||navigator.vendor||window.opera),t}function a(){return/iPhone|iPad|iPod/i.test(navigator.userAgent)}function s(){return/iPhone|iPod/i.test(navigator.platform)}function l(t){var e=2/(t.leftTan+t.rightTan),n=(t.leftTan-t.rightTan)*e*.5,i=2/(t.upTan+t.downTan);return{scale:[e,i],offset:[n,(t.upTan-t.downTan)*i*.5]}}function u(t,e,n,i){e=void 0===e||e,n=void 0===n?.01:n,i=void 0===i?1e4:i;var r=e?-1:1,o=new THREE.Matrix4,a=o.elements,s=l(t);return a[0]=s.scale[0],a[1]=0,a[2]=s.offset[0]*r,a[3]=0,a[4]=0,a[5]=s.scale[1],a[6]=-s.offset[1]*r,a[7]=0,a[8]=0,a[9]=0,a[10]=i/(n-i)*-r,a[11]=i*n/(n-i),a[12]=0,a[13]=0,a[14]=r,a[15]=0,o.transpose(),o}function c(t,e,n,i){var r=Math.PI/180;return u({upTan:Math.tan(t.upDegrees*r),downTan:Math.tan(t.downDegrees*r),leftTan:Math.tan(t.leftDegrees*r),rightTan:Math.tan(t.rightDegrees*r)},e,n,i)}function h(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(var n in t)t.hasOwnProperty(n)&&!e.hasOwnProperty(n)&&(e[n]=t[n]);return e}function d(t){var e={};for(var n in t)e[n]=t[n];return e}function p(t,e,n,i){function r(n){o=e(r,i),t(n-(a||n)),a=n}var o,a;return{start:function(){o||r(0)},stop:function(){n(o),o=null,a=0}}}function f(t){return p(t,requestAnimationFrame,cancelAnimationFrame)}function m(t,e,n,i){function r(e){Boolean(t[n])===Boolean(i)&&e.stopImmediatePropagation(),delete t[n]}return t.addEventListener(e,r,!1),r}function v(t,e,n,i){function r(){return n[e]}function o(t){n[e]=t}i&&o(t[e]),(0,F.default)(t,e,{get:r,set:o})}function g(t,e,n){n.addEventListener(e,function(){return t.dispatchEvent(new Event(e))})}function y(t,e){D.default.resolve().then(function(){t.dispatchEvent(new Event(e))})}function b(t){var e=new Audio;return g(t,"play",e),g(t,"playing",e),g(t,"pause",e),e.crossOrigin=t.crossOrigin,e.src=t.src||t.currentSrc||"data:",e}function _(t,e,n){(rt||0)+200<Date.now()&&(t[lt]=!0,rt=Date.now()),n||(t.currentTime=e),ht[++dt%3]=100*e|0}function w(t){return t.driver.currentTime>=t.video.duration}function T(t){var e=this;e.video.readyState>=e.video.HAVE_FUTURE_DATA?(e.hasAudio||(e.driver.currentTime=e.video.currentTime+t*e.video.playbackRate/1e3,e.video.loop&&w(e)&&(e.driver.currentTime=0)),_(e.video,e.driver.currentTime)):e.video.networkState!==e.video.NETWORK_IDLE||e.video.buffered.length||e.video.load(),e.video.ended&&(delete e.video[lt],e.video.pause(!0))}function x(){var t=this,e=t[st];if(t.webkitDisplayingFullscreen)return void t[ut]();"data:"!==e.driver.src&&e.driver.src!==t.src&&(_(t,0,!0),e.driver.src=t.src),t.paused&&(e.paused=!1,t.buffered.length||t.load(),e.driver.play(),e.updater.start(),e.hasAudio||(y(t,"play"),e.video.readyState>=e.video.HAVE_ENOUGH_DATA&&y(t,"playing")))}function E(t){var e=this,n=e[st];n.driver.pause(),n.updater.stop(),e.webkitDisplayingFullscreen&&e[ct](),n.paused&&!t||(n.paused=!0,n.hasAudio||y(e,"pause"),e.ended&&(e[lt]=!0,y(e,"ended")))}function S(t,e){var n=t[st]={};n.paused=!0,n.hasAudio=e,n.video=t,n.updater=f(T.bind(n)),e?n.driver=b(t):(t.addEventListener("canplay",function(){t.paused||y(t,"playing")}),n.driver={src:t.src||t.currentSrc||"data:",muted:!0,paused:!0,pause:function(){n.driver.paused=!0},play:function(){n.driver.paused=!1,w(n)&&_(t,0)},get ended(){return w(n)}}),t.addEventListener("emptied",function(){var e=!n.driver.src||"data:"===n.driver.src;n.driver.src&&n.driver.src!==t.src&&(_(t,0,!0),n.driver.src=t.src,e?n.driver.play():n.updater.stop())},!1),t.addEventListener("webkitbeginfullscreen",function(){t.paused?e&&!n.driver.buffered.length&&n.driver.load():(t.pause(),t[ut]())}),e&&(t.addEventListener("webkitendfullscreen",function(){n.driver.currentTime=t.currentTime}),t.addEventListener("seeking",function(){ht.indexOf(100*t.currentTime|0)<0&&(n.driver.currentTime=t.currentTime)}))}function A(t){var e=t[st];t[ut]=t.play,t[ct]=t.pause,t.play=x,t.pause=E,v(t,"paused",e.driver),v(t,"muted",e.driver,!0),v(t,"playbackRate",e.driver,!0),v(t,"ended",e.driver),v(t,"loop",e.driver,!0),m(t,"seeking"),m(t,"seeked"),m(t,"timeupdate",lt,!1),m(t,"ended",lt,!1)}function C(t,e,n){void 0===e&&(e=!0),void 0===n&&(n=!0),n&&!at||t[st]||(S(t,e),A(t),t.classList.add("IIV"),!e&&t.autoplay&&t.play(),/iPhone|iPod|iPad/.test(navigator.platform)||console.warn("iphone-inline-video is not guaranteed to work in emulated environments"))}function k(t){var e=t.getChild("Canvas");return function(){t.el().style.width=window.innerWidth+"px",t.el().style.height=window.innerHeight+"px",e.handleResize()}}function M(t,e){var n=k(t);t.controlBar.fullscreenToggle.off("tap",e),t.controlBar.fullscreenToggle.on("tap",function(){var e=t.getChild("Canvas");t.isFullscreen()?(t.isFullscreen(!1),t.exitFullWindow(),t.el().style.width="",t.el().style.height="",e.handleResize(),window.removeEventListener("devicemotion",n)):(t.isFullscreen(!0),t.enterFullWindow(),n(),window.addEventListener("devicemotion",n))})}function L(t){return t.tech({IWillNotUseThisInPlugins:!0}).el()}function R(t){return t.controlBar.fullscreenToggle.handleClick}Object.defineProperty(e,"__esModule",{value:!0});var P=n(115),D=i(P),I=n(13),F=i(I),O=n(3),N=i(O),U=n(39),V=i(U),B=n(23),j=i(B),G=n(14),H=i(G),z=n(22),W=i(z),X=n(1),q=i(X),K=n(110),Y=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(K),$={canvas:!!window.CanvasRenderingContext2D,webgl:function(){try{var t=document.createElement("canvas");return!(!window.WebGLRenderingContext||!t.getContext("webgl")&&!t.getContext("experimental-webgl"))}catch(t){return!1}}(),workers:!!window.Worker,fileapi:window.File&&window.FileReader&&window.FileList&&window.Blob,Check_Version:function(){var t=-1;if("Microsoft Internet Explorer"==navigator.appName){var e=navigator.userAgent,n=new RegExp("MSIE ([0-9]{1,}[\\.0-9]{0,})");null!==n.exec(e)&&(t=parseFloat(RegExp.$1))}else if("Netscape"==navigator.appName)if(-1!==navigator.appVersion.indexOf("Trident"))t=11;else{var e=navigator.userAgent,n=new RegExp("Edge/([0-9]{1,}[\\.0-9]{0,})");null!==n.exec(e)&&(t=parseFloat(RegExp.$1))}return t},supportVideoTexture:function(){var t=this.Check_Version();return-1===t||t>=13},isLiveStreamOnSafari:function(t){for(var e=t.querySelectorAll("source"),n=!1,i=0;i<e.length;i++){var r=e[i];("application/x-mpegURL"==r.type||"application/vnd.apple.mpegurl"==r.type)&&/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor)&&(n=!0);break}return n},getWebGLErrorMessage:function(){var t=document.createElement("div");return t.id="webgl-error-message",this.webgl||(t.innerHTML=window.WebGLRenderingContext?['Your graphics card does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br />','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join("\n"):['Your browser does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br/>','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join("\n")),t},addGetWebGLMessage:function(t){var e,n,i;t=t||{},e=void 0!==t.parent?t.parent:document.body,n=void 0!==t.id?t.id:"oldie",i=$.getWebGLErrorMessage(),i.id=n,e.appendChild(i)}},Q={prev_currentTime:0,counter:0,isBuffering:function(t){return t==this.prev_currentTime?this.counter++:this.counter=0,this.prev_currentTime=t,this.counter>10&&(this.counter=10,!0)}},J=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return{constructor:function(i,r){this.settings=r,this.width=i.el().offsetWidth,this.height=i.el().offsetHeight,this.lon=r.initLon,this.lat=r.initLat,this.phi=0,this.theta=0,this.videoType=r.videoType,this.clickToToggle=r.clickToToggle,this.mouseDown=!1,this.isUserInteracting=!1,this.renderer=new e.WebGLRenderer,this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.width,this.height),this.renderer.autoClear=!1,this.renderer.setClearColor(0,1);var o=n.getTech(i);if(this.supportVideoTexture=$.supportVideoTexture(),this.liveStreamOnSafari=$.isLiveStreamOnSafari(o),this.liveStreamOnSafari&&(this.supportVideoTexture=!1),this.supportVideoTexture)this.texture=new e.Texture(o);else{this.helperCanvas=i.addChild("HelperCanvas",{video:o,width:this.width,height:this.height});var a=this.helperCanvas.el();this.texture=new e.Texture(a)}o.style.display="none",this.texture.generateMipmaps=!1,this.texture.minFilter=e.LinearFilter,this.texture.maxFilter=e.LinearFilter,this.texture.format=e.RGBFormat,this.el_=this.renderer.domElement,this.el_.classList.add("vjs-video-canvas"),r.el=this.el_,t.call(this,i,r),this.attachControlEvents(),this.player().on("play",function(){this.time=(new Date).getTime(),this.animate()}.bind(this))},attachControlEvents:function(){this.on("mousemove",this.handleMouseMove.bind(this)),this.on("touchmove",this.handleMouseMove.bind(this)),this.on("mousedown",this.handleMouseDown.bind(this)),this.on("touchstart",this.handleMouseDown.bind(this)),this.on("mouseup",this.handleMouseUp.bind(this)),this.on("touchend",this.handleMouseUp.bind(this)),this.settings.scrollable&&(this.on("mousewheel",this.handleMouseWheel.bind(this)),this.on("MozMousePixelScroll",this.handleMouseWheel.bind(this))),this.on("mouseenter",this.handleMouseEnter.bind(this)),this.on("mouseleave",this.handleMouseLease.bind(this))},handleResize:function(){this.width=this.player().el().offsetWidth,this.height=this.player().el().offsetHeight,this.renderer.setSize(this.width,this.height)},handleMouseUp:function(t){if(this.mouseDown=!1,this.clickToToggle){var e=t.clientX||t.changedTouches&&t.changedTouches[0].clientX,n=t.clientY||t.changedTouches&&t.changedTouches[0].clientY;if(void 0===e||"undefined"===n)return;var i=Math.abs(e-this.onPointerDownPointerX),r=Math.abs(n-this.onPointerDownPointerY);i<.1&&r<.1&&(this.player().paused()?this.player().play():this.player().pause())}},handleMouseDown:function(t){t.preventDefault();var e=t.clientX||t.touches&&t.touches[0].clientX,n=t.clientY||t.touches&&t.touches[0].clientY;void 0!==e&&"undefined"!==n&&(this.mouseDown=!0,this.onPointerDownPointerX=e,this.onPointerDownPointerY=n,this.onPointerDownLon=this.lon,this.onPointerDownLat=this.lat)},handleMouseMove:function(t){var e=t.clientX||t.touches&&t.touches[0].clientX,n=t.clientY||t.touches&&t.touches[0].clientY;if(void 0!==e&&"undefined"!==n)if(this.settings.clickAndDrag)this.mouseDown&&(this.lon=.2*(this.onPointerDownPointerX-e)+this.onPointerDownLon,this.lat=.2*(n-this.onPointerDownPointerY)+this.onPointerDownLat);else{var i=t.pageX-this.el_.offsetLeft,r=t.pageY-this.el_.offsetTop;this.lon=i/this.width*430-225,this.lat=r/this.height*-180+90}},handleMobileOrientation:function(t){if(void 0!==t.rotationRate){var e=t.rotationRate.alpha,n=t.rotationRate.beta,i=void 0!==t.portrait?t.portrait:window.matchMedia("(orientation: portrait)").matches,r=void 0!==t.landscape?t.landscape:window.matchMedia("(orientation: landscape)").matches,o=t.orientation||window.orientation;if(i)this.lon=this.lon-n*this.settings.mobileVibrationValue,this.lat=this.lat+e*this.settings.mobileVibrationValue;else if(r){var a=-90;void 0!==o&&(a=o),this.lon=-90==a?this.lon+e*this.settings.mobileVibrationValue:this.lon-e*this.settings.mobileVibrationValue,this.lat=-90==a?this.lat+n*this.settings.mobileVibrationValue:this.lat-n*this.settings.mobileVibrationValue}}},handleMouseWheel:function(t){t.stopPropagation(),t.preventDefault()},handleMouseEnter:function(t){this.isUserInteracting=!0},handleMouseLease:function(t){this.isUserInteracting=!1},animate:function(){if(this.requestAnimationId=requestAnimationFrame(this.animate.bind(this)),!this.player().paused()&&void 0!==this.texture&&(!this.isPlayOnMobile&&this.player().readyState()>=2||this.isPlayOnMobile&&this.player().hasClass("vjs-playing"))){var t=(new Date).getTime();if(t-this.time>=30&&(this.texture.needsUpdate=!0,this.time=t),this.isPlayOnMobile){var e=this.player().currentTime();Q.isBuffering(e)?this.player().hasClass("vjs-panorama-mobile-inline-video-buffering")||this.player().addClass("vjs-panorama-mobile-inline-video-buffering"):this.player().hasClass("vjs-panorama-mobile-inline-video-buffering")&&this.player().removeClass("vjs-panorama-mobile-inline-video-buffering")}}this.render()},render:function(){if(!this.isUserInteracting){var t=this.lat>this.settings.initLat?-1:1,n=this.lon>this.settings.initLon?-1:1;this.settings.backToVerticalCenter&&(this.lat=this.lat>this.settings.initLat-Math.abs(this.settings.returnStepLat)&&this.lat<this.settings.initLat+Math.abs(this.settings.returnStepLat)?this.settings.initLat:this.lat+this.settings.returnStepLat*t),this.settings.backToHorizonCenter&&(this.lon=this.lon>this.settings.initLon-Math.abs(this.settings.returnStepLon)&&this.lon<this.settings.initLon+Math.abs(this.settings.returnStepLon)?this.settings.initLon:this.lon+this.settings.returnStepLon*n)}this.lat=Math.max(this.settings.minLat,Math.min(this.settings.maxLat,this.lat)),this.lon=Math.max(this.settings.minLon,Math.min(this.settings.maxLon,this.lon)),this.phi=e.Math.degToRad(90-this.lat),this.theta=e.Math.degToRad(this.lon),this.supportVideoTexture||this.helperCanvas.update(),this.renderer.clear()},playOnMobile:function(){this.isPlayOnMobile=!0,this.settings.autoMobileOrientation&&window.addEventListener("devicemotion",this.handleMobileOrientation.bind(this))},el:function(){return this.el_}}},Z={whichTransitionEvent:r,mobileAndTabletcheck:o,isIos:a,isRealIphone:s,fovToProjection:c,extend:h,deepCopy:d},tt=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=J(t,e,n);return Z.extend(i,{constructor:function(t,n){i.constructor.call(this,t,n),this.VRMode=!1,this.scene=new e.Scene,this.camera=new e.PerspectiveCamera(n.initFov,this.width/this.height,1,2e3),this.camera.target=new e.Vector3(0,0,0);var r="equirectangular"===this.videoType?new e.SphereGeometry(500,60,40):new e.SphereBufferGeometry(500,60,40).toNonIndexed();if("fisheye"===this.videoType){for(var o=r.attributes.normal.array,a=r.attributes.uv.array,s=0,l=o.length/3;s<l;s++){var u=o[3*s+0],c=o[3*s+1],h=o[3*s+2],d=Math.asin(Math.sqrt(u*u+h*h)/Math.sqrt(u*u+c*c+h*h))/Math.PI;c<0&&(d=1-d);var p=0==u&&0==h?0:Math.acos(u/Math.sqrt(u*u+h*h));h<0&&(p*=-1),a[2*s+0]=-.8*d*Math.cos(p)+.5,a[2*s+1]=.8*d*Math.sin(p)+.5}r.rotateX(n.rotateX),r.rotateY(n.rotateY),r.rotateZ(n.rotateZ)}r.scale(-1,1,1),this.mesh=new e.Mesh(r,new e.MeshBasicMaterial({map:this.texture})),this.scene.add(this.mesh)},enableVR:function(){if(this.VRMode=!0,"undefined"!=typeof vrHMD){var t=vrHMD.getEyeParameters("left"),n=vrHMD.getEyeParameters("right");this.eyeFOVL=t.recommendedFieldOfView,this.eyeFOVR=n.recommendedFieldOfView}this.cameraL=new e.PerspectiveCamera(this.camera.fov,this.width/2/this.height,1,2e3),this.cameraR=new e.PerspectiveCamera(this.camera.fov,this.width/2/this.height,1,2e3)},disableVR:function(){this.VRMode=!1,this.renderer.setViewport(0,0,this.width,this.height),this.renderer.setScissor(0,0,this.width,this.height)},handleResize:function(){i.handleResize.call(this),this.camera.aspect=this.width/this.height,this.camera.updateProjectionMatrix(),this.VRMode&&(this.cameraL.aspect=this.camera.aspect/2,this.cameraR.aspect=this.camera.aspect/2,this.cameraL.updateProjectionMatrix(),this.cameraR.updateProjectionMatrix())},handleMouseWheel:function(t){i.handleMouseWheel(t),t.wheelDeltaY?this.camera.fov-=.05*t.wheelDeltaY:t.wheelDelta?this.camera.fov-=.05*t.wheelDelta:t.detail&&(this.camera.fov+=1*t.detail),this.camera.fov=Math.min(this.settings.maxFov,this.camera.fov),this.camera.fov=Math.max(this.settings.minFov,this.camera.fov),this.camera.updateProjectionMatrix(),this.VRMode&&(this.cameraL.fov=this.camera.fov,this.cameraR.fov=this.camera.fov,this.cameraL.updateProjectionMatrix(),this.cameraR.updateProjectionMatrix())},render:function(){if(i.render.call(this),this.camera.target.x=500*Math.sin(this.phi)*Math.cos(this.theta),this.camera.target.y=500*Math.cos(this.phi),this.camera.target.z=500*Math.sin(this.phi)*Math.sin(this.theta),this.camera.lookAt(this.camera.target),this.VRMode){var t=this.width/2,n=this.height;if("undefined"!=typeof vrHMD)this.cameraL.projectionMatrix=Z.fovToProjection(this.eyeFOVL,!0,this.camera.near,this.camera.far),this.cameraR.projectionMatrix=Z.fovToProjection(this.eyeFOVR,!0,this.camera.near,this.camera.far);else{var r=this.lon+this.settings.VRGapDegree,o=this.lon-this.settings.VRGapDegree,a=e.Math.degToRad(r),s=e.Math.degToRad(o),l=Z.deepCopy(this.camera.target);l.x=500*Math.sin(this.phi)*Math.cos(a),l.z=500*Math.sin(this.phi)*Math.sin(a),this.cameraL.lookAt(l);var u=Z.deepCopy(this.camera.target);u.x=500*Math.sin(this.phi)*Math.cos(s),u.z=500*Math.sin(this.phi)*Math.sin(s),this.cameraR.lookAt(u)}this.renderer.setViewport(0,0,t,n),this.renderer.setScissor(0,0,t,n),this.renderer.render(this.scene,this.cameraL),this.renderer.setViewport(t,0,t,n),this.renderer.setScissor(t,0,t,n),this.renderer.render(this.scene,this.cameraR)}else this.renderer.render(this.scene,this.camera)}})},et=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=J(t,e,n);return Z.extend(i,{constructor:function(t,n){i.constructor.call(this,t,n),this.scene=new e.Scene;var r=this.width/this.height/2;this.cameraL=new e.PerspectiveCamera(n.initFov,r,1,2e3),this.cameraL.target=new e.Vector3(0,0,0),this.cameraR=new e.PerspectiveCamera(n.initFov,r,1,2e3),this.cameraR.position.set(1e3,0,0),this.cameraR.target=new e.Vector3(1e3,0,0);for(var o=new e.SphereBufferGeometry(500,60,40).toNonIndexed(),a=new e.SphereBufferGeometry(500,60,40).toNonIndexed(),s=o.attributes.uv.array,l=o.attributes.normal.array,u=0;u<l.length/3;u++)s[2*u+1]=s[2*u+1]/2;for(var c=a.attributes.uv.array,h=a.attributes.normal.array,u=0;u<h.length/3;u++)c[2*u+1]=c[2*u+1]/2+.5;o.scale(-1,1,1),a.scale(-1,1,1),this.meshL=new e.Mesh(o,new e.MeshBasicMaterial({map:this.texture})),this.meshR=new e.Mesh(a,new e.MeshBasicMaterial({map:this.texture})),this.meshR.position.set(1e3,0,0),this.scene.add(this.meshL),this.scene.add(this.meshR),n.callback&&n.callback()},handleResize:function(){i.handleResize.call(this);var t=this.width/this.height/2;this.cameraL.aspect=t,this.cameraR.aspect=t,this.cameraL.updateProjectionMatrix(),this.cameraR.updateProjectionMatrix()},handleMouseWheel:function(t){i.handleMouseWheel(t),t.wheelDeltaY?this.cameraL.fov-=.05*t.wheelDeltaY:t.wheelDelta?this.cameraL.fov-=.05*t.wheelDelta:t.detail&&(this.cameraL.fov+=1*t.detail),this.cameraL.fov=Math.min(this.settings.maxFov,this.cameraL.fov),this.cameraL.fov=Math.max(this.settings.minFov,this.cameraL.fov),this.cameraR.fov=this.cameraL.fov,this.cameraL.updateProjectionMatrix(),this.cameraR.updateProjectionMatrix()},render:function(){i.render.call(this);var t=this.width/2,e=this.height;this.cameraL.target.x=500*Math.sin(this.phi)*Math.cos(this.theta),this.cameraL.target.y=500*Math.cos(this.phi),this.cameraL.target.z=500*Math.sin(this.phi)*Math.sin(this.theta),this.cameraL.lookAt(this.cameraL.target),this.cameraR.target.x=1e3+500*Math.sin(this.phi)*Math.cos(this.theta),this.cameraR.target.y=500*Math.cos(this.phi),this.cameraR.target.z=500*Math.sin(this.phi)*Math.sin(this.theta),this.cameraR.lookAt(this.cameraR.target),this.renderer.setViewport(0,0,t,e),this.renderer.setScissor(0,0,t,e),this.renderer.render(this.scene,this.cameraL),this.renderer.setViewport(t,0,t,e),this.renderer.setScissor(t,0,t,e),this.renderer.render(this.scene,this.cameraR)}})},nt="function"==typeof W.default&&"symbol"===(0,H.default)(j.default)?function(t){return void 0===t?"undefined":(0,H.default)(t)}:function(t){return t&&"function"==typeof W.default&&t.constructor===W.default&&t!==W.default.prototype?"symbol":void 0===t?"undefined":(0,H.default)(t)},it=document.createElement("canvas");it.className="vjs-video-helper-canvas";var rt,ot=void 0===W.default?function(t){return"@"+(t||"@")+Math.random()}:W.default,at=/iPhone|iPod/i.test(navigator.userAgent)&&!matchMedia("(-webkit-video-playable-inline)").matches,st=ot(),lt=ot(),ut=ot("nativeplay"),ct=ot("nativepause"),ht=[],dt=0;C.isWhitelisted=at;var pt=Z.mobileAndTabletcheck(),ft={clickAndDrag:pt,showNotice:!0,NoticeMessage:"Please use your mouse drag and drop the video.",autoHideNotice:3e3,scrollable:!0,initFov:75,maxFov:105,minFov:51,initLat:0,initLon:-180,returnStepLat:.5,returnStepLon:2,backToVerticalCenter:!pt,backToHorizonCenter:!pt,clickToToggle:!1,minLat:-85,maxLat:85,minLon:-1/0,maxLon:1/0,videoType:"equirectangular",rotateX:0,rotateY:0,rotateZ:0,autoMobileOrientation:!1,mobileVibrationValue:Z.isIos()?.022:1,VREnable:!0,VRGapDegree:2.5,closePanorama:!1},mt=function(t,e,n){if(t.addClass("vjs-panorama"),!$.webgl)return vt(t,{NoticeMessage:$.getWebGLErrorMessage(),autoHideNotice:e.autoHideNotice}),void(e.callback&&e.callback());t.addChild("Canvas",Z.deepCopy(e));var i=t.getChild("Canvas");if(pt){var r=n.getTech(t);Z.isRealIphone()&&(r.setAttribute("playsinline",""),C(r,!0)),Z.isIos()&&M(t,n.getFullscreenToggleClickFn(t)),t.addClass("vjs-panorama-mobile-inline-video"),t.removeClass("vjs-using-native-controls"),i.playOnMobile()}e.showNotice&&t.on("playing",function(){vt(t,Z.deepCopy(e))}),e.VREnable&&"3dVideo"!==e.videoType&&t.controlBar.addChild("VRButton",{},t.controlBar.children().length-1),i.hide(),t.on("play",function(){i.show()}),t.on("fullscreenchange",function(){i.handleResize()}),e.callback&&e.callback()},vt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{NoticeMessage:""},n=t.addChild("Notice",e);e.autoHideNotice>0&&setTimeout(function(){n.addClass("vjs-video-notice-fadeOut");var t=Z.whichTransitionEvent(),e=function e(){n.hide(),n.removeClass("vjs-video-notice-fadeOut"),n.off(t,e)};n.on(t,e)},e.autoHideNotice)},gt=q.default.getComponent("Component"),yt=function(t){var e=document.createElement("div");return e.className="vjs-video-notice-label",{constructor:function(n,i){"object"==nt(i.NoticeMessage)?(e=i.NoticeMessage,i.el=i.NoticeMessage):"string"==typeof i.NoticeMessage&&(e.innerHTML=i.NoticeMessage,i.el=e),t.call(this,n,i)},el:function(){return e}}}(gt);q.default.registerComponent("Notice",q.default.extend(gt,yt));var bt=function(t){return{constructor:function(e,n){this.videoElement=n.video,this.width=n.width,this.height=n.height,it.width=this.width,it.height=this.height,it.style.display="none",n.el=it,this.context=it.getContext("2d"),this.context.drawImage(this.videoElement,0,0,this.width,this.height),t.call(this,e,n)},getContext:function(){return this.context},update:function(){this.context.drawImage(this.videoElement,0,0,this.width,this.height)},el:function(){return it}}}(gt);q.default.registerComponent("HelperCanvas",q.default.extend(gt,bt));var _t=q.default.getComponent("Button"),wt=function(t){return{constructor:function(e,n){t.call(this,e,n)},buildCSSClass:function(){return"vjs-VR-control "+t.prototype.buildCSSClass.call(this)},handleClick:function(){var t=this.player().getChild("Canvas");t.VRMode?t.disableVR():t.enableVR(),t.VRMode?this.addClass("enable"):this.removeClass("enable"),t.VRMode?this.player().trigger("VRModeOn"):this.player().trigger("VRModeOff")},controlText_:"VR"}}(_t);q.default.registerComponent("VRButton",q.default.extend(_t,wt)),q.default.plugin("panorama",function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=["equirectangular","fisheye","3dVideo"],n=function(n){var i=this;if(t.mergeOption&&(n=t.mergeOption(ft,n)),void 0===t._init||"function"!=typeof t._init)return void console.error("plugin must implement init function().");-1==e.indexOf(n.videoType)&&(n.videoType=ft.videoType),t._init(n),this.ready(function(){mt(i,n,t)})};return n.VERSION="0.1.3",n}({_init:function(t){var e="3dVideo"!==t.videoType?tt(gt,Y,{getTech:L}):et(gt,Y,{getTech:L});q.default.registerComponent("Canvas",q.default.extend(gt,e))},mergeOption:function(t,e){return q.default.mergeOptions(t,e)},getTech:L,getFullscreenToggleClickFn:R}));var Tt=function(t,e){return t.panorama(e)};e.default=Tt},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(3),o=i(r),a=n(0),s=i(a),l=n(6),u=i(l),c=n(5),h=i(c),d=n(1),p=i(d),f=p.default.getPlugin("plugin"),m={},v=p.default.getComponent("MenuItem"),g=p.default.extend(v,{constructor:function(t,e){e.selectable=!0,v.call(this,t,e),this.src=e.src,t.on("resolutionchange",p.default.bind(this,this.update))}});g.prototype.handleClick=function(t){v.prototype.handleClick.call(this,t),this.player_.currentResolution(this.options_.label),this.player_.controlBar.resolutionSwitcher.childNodes[2].innerHTML=this.options_.label},g.prototype.update=function(){var t=this.player_.currentResolution();this.selected(this.options_.label===t.label)},v.registerComponent("ResolutionMenuItem",g);var y=p.default.getComponent("MenuButton"),b=p.default.extend(y,{constructor:function(t,e){if(this.label=document.createElement("span"),e.label="Quality",y.call(this,t,e),this.el().setAttribute("aria-label","Quality"),this.addClass("vjs-button-quality"),this.controlText("Quality"),e.dynamicLabel)p.default.addClass(this.label,"vjs-resolution-button-label"),this.el().appendChild(this.label);else{var n=document.createElement("span");p.default.addClass(n,"vjs-menu-icon"),this.el().appendChild(n)}t.on("updateSources",p.default.bind(this,this.update))}});b.prototype.createItems=function(){var t=[],e=this.sources&&this.sources.label||{};for(var n in e)e.hasOwnProperty(n)&&t.push(new g(this.player_,{label:n,src:e[n],selected:n===(!!this.currentSelection&&this.currentSelection.label)}));return t},b.prototype.update=function(){return this.sources=this.player_.getGroupedSrc(),this.currentSelection=this.player_.currentResolution(),this.label.innerHTML=this.currentSelection?this.currentSelection.label:"",y.prototype.update.call(this)},b.prototype.buildCSSClass=function(){return y.prototype.buildCSSClass.call(this)+" vjs-resolution-button"},y.registerComponent("ResolutionMenuButton",b);var _=function(t){function e(t,n){function i(t,e){return t.res&&e.res?+e.res-+t.res:0}function r(t){var e={label:{},res:{},type:{}};return t.map(function(t){a(e,"label",t),a(e,"res",t),a(e,"type",t),l(e,"label",t),l(e,"res",t),l(e,"type",t)}),e}function a(t,e,n){null==t[e][n[e]]&&(t[e][n[e]]=[])}function l(t,e,n){t[e][n[e]].push(n)}function c(t,e){var n=d.default,i="";return"high"===n?(n=e[0].res,i=e[0].label):"low"!==n&&null!=n&&t.res[n]?t.res[n]&&(i=t.res[n][0].label):(n=e[e.length-1].res,i=e[e.length-1].label),{res:n,label:i,sources:t.res[n]}}(0,s.default)(this,e);var h=(0,u.default)(this,(e.__proto__||(0,o.default)(e)).call(this,t,n)),d=p.default.mergeOptions(m,n);return t.updateSrc=function(e){if(!e)return t.src();e=e.filter(function(e){try{return""!==t.canPlayType(e.type)}catch(t){return!0}}),this.currentSources=e.sort(i),this.groupedSrc=r(this.currentSources);var n=c(this.groupedSrc,this.currentSources);return this.currentResolutionState={label:n.label,sources:n.sources},t.trigger("updateSources"),t.setSourcesSanitized(n.sources,n.label),t.trigger("resolutionchange"),t},t.currentResolution=function(e,n){if(null==e)return this.currentResolutionState;if(this.groupedSrc&&this.groupedSrc.label&&this.groupedSrc.label[e]){var i=this.groupedSrc.label[e],r=t.currentTime(),o=t.paused();!o&&this.player_.options_.bigPlayButton&&this.player_.bigPlayButton.hide();var a="loadeddata";return"Youtube"!==this.player_.techName_&&"none"===this.player_.preload()&&"Flash"!==this.player_.techName_&&(a="timeupdate"),t.setSourcesSanitized(i,e,n||d.customSourcePicker).one(a,function(){t.currentTime(r),o||t.play(),t.trigger("resolutionchange")}),t}},t.getGroupedSrc=function(){return this.groupedSrc},t.setSourcesSanitized=function(e,n,i){return this.currentResolutionState={label:n,sources:e},"function"==typeof i?i(t,e,n):(t.src(e.map(function(t){return{src:t.src,type:t.type,res:t.res}})),t)},t.on("ready",function(){var e=new b(t,d);t.controlBar.resolutionSwitcher=t.controlBar.el_.insertBefore(e.el_,t.controlBar.getChild("fullscreenToggle").el_),t.controlBar.resolutionSwitcher.dispose=function(){this.parentNode.removeChild(this)},t.options_.sources.length>1&&t.updateSrc(t.options_.sources)}),h}return(0,h.default)(e,t),e}(f);p.default.registerPlugin("videoJsResolutionSwitcher",_)},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(3),o=i(r),a=n(0),s=i(a),l=n(4),u=i(l),c=n(6),h=i(c),d=n(117),p=i(d),f=n(5),m=i(f),v=n(1),g=i(v),y=g.default.getComponent("Button"),b=g.default.getComponent("Component"),_=g.default.getPlugin("plugin"),w={},T=function(t){function e(t,n){(0,s.default)(this,e);var i=(0,h.default)(this,(e.__proto__||(0,o.default)(e)).call(this,t,n));return"forward"===i.options_.direction?i.controlText(i.localize("Seek forward {{seconds}} seconds").replace("{{seconds}}",i.options_.seconds)):"back"===i.options_.direction&&i.controlText(i.localize("Seek back {{seconds}} seconds").replace("{{seconds}}",i.options_.seconds)),i}return(0,m.default)(e,t),(0,u.default)(e,[{key:"buildCSSClass",value:function(){return"vjs-seek-button skip-"+this.options_.direction+" skip-"+this.options_.seconds+" "+(0,p.default)(e.prototype.__proto__||(0,o.default)(e.prototype),"buildCSSClass",this).call(this)}},{key:"handleClick",value:function(){var t=this.player_.currentTime();"forward"===this.options_.direction?this.player_.currentTime(t+this.options_.seconds):"back"===this.options_.direction&&this.player_.currentTime(t-this.options_.seconds)}}]),e}(y);b.registerComponent("SeekButton",T);var x=function(t,e){t.addClass("vjs-seek-buttons"),e.forward&&e.forward>0&&(t.controlBar.seekForward=t.controlBar.addChild("seekButton",{direction:"forward",seconds:e.forward}),t.controlBar.el().insertBefore(t.controlBar.seekForward.el(),t.controlBar.el().firstChild.nextSibling)),e.back&&e.back>0&&(t.controlBar.seekBack=t.controlBar.addChild("seekButton",{direction:"back",seconds:e.back}),t.controlBar.el().insertBefore(t.controlBar.seekBack.el(),t.controlBar.el().firstChild.nextSibling))},E=function(t){function e(t,n){(0,s.default)(this,e);var i=(0,h.default)(this,(e.__proto__||(0,o.default)(e)).call(this,t,n));return t.on("ready",function(){x(t,g.default.mergeOptions(w,n))}),i}return(0,m.default)(e,t),e}(_);g.default.registerPlugin("seekButtons",E)},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r,r,o,a,s=n(30),l=i(s),u=n(31),c=i(u),h=n(3),d=i(h),p=n(40),f=i(p),m=n(32),v=i(m),g=n(21),y=i(g),b=n(23),_=i(b),w=n(14),T=i(w),x=n(22),E=i(x),S=n(13),A=i(S),C=n(1),k=i(C);!function t(e,n,i){function o(s,l){if(!n[s]){if(!e[s]){var u="function"==typeof r&&r;if(!l&&u)return r(s,!0);if(a)return a(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var h=n[s]={exports:{}};e[s][0].call(h.exports,function(t){var n=e[s][1][t];return o(n||t)},h,h.exports,t,e,n,i)}return n[s].exports}for(var a="function"==typeof r&&r,s=0;s<i.length;s++)o(i[s]);return o}({1:[function(t,e,n){function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,A.default)(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n.IVPAIDAdUnit=function(){function t(){i(this,t)}return r(t,[{key:"handshakeVersion",value:function(){arguments.length<=0||void 0===arguments[0]||arguments[0],arguments.length<=1||void 0===arguments[1]||arguments[1]}},{key:"initAd",value:function(t,e,n,i){arguments.length<=4||void 0===arguments[4]||arguments[4],arguments.length<=5||void 0===arguments[5]||arguments[5],arguments.length<=6||void 0===arguments[6]||arguments[6]}},{key:"resizeAd",value:function(t,e,n){arguments.length<=3||void 0===arguments[3]||arguments[3]}},{key:"startAd",value:function(){arguments.length<=0||void 0===arguments[0]||arguments[0]}},{key:"stopAd",value:function(){arguments.length<=0||void 0===arguments[0]||arguments[0]}},{key:"pauseAd",value:function(){arguments.length<=0||void 0===arguments[0]||arguments[0]}},{key:"resumeAd",value:function(){arguments.length<=0||void 0===arguments[0]||arguments[0]}},{key:"expandAd",value:function(){arguments.length<=0||void 0===arguments[0]||arguments[0]}},{key:"collapseAd",value:function(){arguments.length<=0||void 0===arguments[0]||arguments[0]}},{key:"skipAd",value:function(){arguments.length<=0||void 0===arguments[0]||arguments[0]}},{key:"getAdLinear",value:function(t){}},{key:"getAdWidth",value:function(t){}},{key:"getAdHeight",value:function(t){}},{key:"getAdExpanded",value:function(t){}},{key:"getAdSkippableState",value:function(t){}},{key:"getAdRemainingTime",value:function(t){}},{key:"getAdDuration",value:function(t){}},{key:"setAdVolume",value:function(t){arguments.length<=1||void 0===arguments[1]||arguments[1]}},{key:"getAdVolume",value:function(t){}},{key:"getAdCompanions",value:function(t){}},{key:"getAdIcons",value:function(t){}}]),t}();Object.defineProperty(o,"EVENTS",{writable:!1,configurable:!1,value:["AdLoaded","AdStarted","AdStopped","AdSkipped","AdSkippableStateChange","AdSizeChange","AdLinearChange","AdDurationChange","AdExpandedChange","AdRemainingTimeChange","AdVolumeChange","AdImpression","AdVideoStart","AdVideoFirstQuartile","AdVideoMidpoint","AdVideoThirdQuartile","AdVideoComplete","AdClickThru","AdInteraction","AdUserAcceptInvitation","AdUserMinimize","AdUserClose","AdPaused","AdPlaying","AdLog","AdError"]})},{}],2:[function(t,e,n){function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":a(e))&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":a(e)));t.prototype=(0,y.default)(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(v.default?(0,v.default)(t,e):t.__proto__=e)}var a="function"==typeof E.default&&"symbol"===(0,T.default)(_.default)?function(t){return void 0===t?"undefined":(0,T.default)(t)}:function(t){return t&&"function"==typeof E.default&&t.constructor===E.default?"symbol":void 0===t?"undefined":(0,T.default)(t)};Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,A.default)(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),l=t("./IVPAIDAdUnit").IVPAIDAdUnit,u=(0,f.default)(l.prototype).filter(function(t){return-1===["constructor"].indexOf(t)});n.VPAIDAdUnit=function(t){function e(t){i(this,e);var n=r(this,(0,d.default)(e).call(this));return n._destroyed=!1,n._flash=t,n}return o(e,t),s(e,[{key:"_destroy",value:function(){var t=this;this._destroyed=!0,u.forEach(function(e){t._flash.removeCallbackByMethodName(e)}),l.EVENTS.forEach(function(e){t._flash.offEvent(e)}),this._flash=null}},{key:"isDestroyed",value:function(){return this._destroyed}},{key:"on",value:function(t,e){this._flash.on(t,e)}},{key:"off",value:function(t,e){this._flash.off(t,e)}},{key:"handshakeVersion",value:function(){var t=arguments.length<=0||void 0===arguments[0]?"2.0":arguments[0],e=arguments.length<=1||void 0===arguments[1]?void 0:arguments[1];this._flash.callFlashMethod("handshakeVersion",[t],e)}},{key:"initAd",value:function(t,e,n,i){var r=arguments.length<=4||void 0===arguments[4]?{AdParameters:""}:arguments[4],o=arguments.length<=5||void 0===arguments[5]?{flashVars:""}:arguments[5],a=arguments.length<=6||void 0===arguments[6]?void 0:arguments[6];this._flash.setSize(t,e),r=r||{AdParameters:""},o=o||{flashVars:""},this._flash.callFlashMethod("initAd",[this._flash.getWidth(),this._flash.getHeight(),n,i,r.AdParameters||"",o.flashVars||""],a)}},{key:"resizeAd",value:function(t,e,n){var i=arguments.length<=3||void 0===arguments[3]?void 0:arguments[3];this._flash.setSize(t,e),this._flash.callFlashMethod("resizeAd",[this._flash.getWidth(),this._flash.getHeight(),n],i)}},{key:"startAd",value:function(){var t=arguments.length<=0||void 0===arguments[0]?void 0:arguments[0];this._flash.callFlashMethod("startAd",[],t)}},{key:"stopAd",value:function(){var t=arguments.length<=0||void 0===arguments[0]?void 0:arguments[0];this._flash.callFlashMethod("stopAd",[],t)}},{key:"pauseAd",value:function(){var t=arguments.length<=0||void 0===arguments[0]?void 0:arguments[0];this._flash.callFlashMethod("pauseAd",[],t)}},{key:"resumeAd",value:function(){var t=arguments.length<=0||void 0===arguments[0]?void 0:arguments[0];this._flash.callFlashMethod("resumeAd",[],t)}},{key:"expandAd",value:function(){var t=arguments.length<=0||void 0===arguments[0]?void 0:arguments[0];this._flash.callFlashMethod("expandAd",[],t)}},{key:"collapseAd",value:function(){var t=arguments.length<=0||void 0===arguments[0]?void 0:arguments[0];this._flash.callFlashMethod("collapseAd",[],t)}},{key:"skipAd",value:function(){var t=arguments.length<=0||void 0===arguments[0]?void 0:arguments[0];this._flash.callFlashMethod("skipAd",[],t)}},{key:"getAdLinear",value:function(t){this._flash.callFlashMethod("getAdLinear",[],t)}},{key:"getAdWidth",value:function(t){this._flash.callFlashMethod("getAdWidth",[],t)}},{key:"getAdHeight",value:function(t){this._flash.callFlashMethod("getAdHeight",[],t)}},{key:"getAdExpanded",value:function(t){this._flash.callFlashMethod("getAdExpanded",[],t)}},{key:"getAdSkippableState",value:function(t){this._flash.callFlashMethod("getAdSkippableState",[],t)}},{key:"getAdRemainingTime",value:function(t){this._flash.callFlashMethod("getAdRemainingTime",[],t)}},{key:"getAdDuration",value:function(t){this._flash.callFlashMethod("getAdDuration",[],t)}},{key:"setAdVolume",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?void 0:arguments[1];this._flash.callFlashMethod("setAdVolume",[t],e)}},{key:"getAdVolume",value:function(t){this._flash.callFlashMethod("getAdVolume",[],t)}},{key:"getAdCompanions",value:function(t){this._flash.callFlashMethod("getAdCompanions",[],t)}},{key:"getAdIcons",value:function(t){this._flash.callFlashMethod("getAdIcons",[],t)}}]),e}(l)},{"./IVPAIDAdUnit":1}],3:[function(t,e,n){function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(){if(this._destroyed)throw new Error("VPAIDFlashToJS is destroyed!")}function o(){this._loadLater&&(this.loadAdUnit(this._loadLater.url,this._loadLater.callback),delete this._loadLater)}function a(t,e){var n=!(arguments.length<=2||void 0===arguments[2])&&arguments[2];(0,A.default)(b,t,{writable:n,configurable:!1,value:e})}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,A.default)(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),l=t("swfobject"),u=t("./jsFlashBridge").JSFlashBridge,c=t("./VPAIDAdUnit").VPAIDAdUnit,h=t("./utils").noop,d=t("./utils").callbackTimeout,p=t("./utils").isPositiveInt,f=t("./utils").createElementWithID,m=t("./utils").unique("vpaid"),v=t("./flashTester.js").createFlashTester,g="10.1.0",y={isSupported:function(){return!0}},b=function(){function t(e,n){function r(t){return setTimeout(function(){n(new Error(t))},0),y}var a=arguments.length<=2||void 0===arguments[2]?{data:"VPAIDFlash.swf",width:800,height:400}:arguments[2],s=this,c=arguments.length<=3||void 0===arguments[3]?{wmode:"transparent",salign:"tl",align:"left",allowScriptAccess:"always",scale:"noScale",allowFullScreen:"true",quality:"high"}:arguments[3],v=arguments.length<=4||void 0===arguments[4]?{debug:!1,timeout:1e4}:arguments[4];i(this,t);var y=this;if(this._vpaidParentEl=e,this._flashID=m(),this._destroyed=!1,n=n||h,a.width=p(a.width,800),a.height=p(a.height,400),f(e,this._flashID,!0),c.movie=a.data,c.FlashVars="flashid="+this._flashID+"&handler="+u.VPAID_FLASH_HANDLER+"&debug="+v.debug+"&salign="+c.salign,!t.isSupported())return r("user don't support flash or doesn't have the minimum required version of flash "+g);if(this.el=l.createSWF(a,c,this._flashID),!this.el)return r("swfobject failed to create object in element");var b=d(v.timeout,function(t,e){o.call(s),n(t,e)},function(){n("vpaid flash load timeout "+v.timeout)});this._flash=new u(this.el,a.data,this._flashID,a.width,a.height,b)}return s(t,[{key:"destroy",value:function(){this._destroyAdUnit(),this._flash&&(this._flash.destroy(),this._flash=null),this.el=null,this._destroyed=!0}},{key:"isDestroyed",value:function(){return this._destroyed}},{key:"_destroyAdUnit",value:function(){delete this._loadLater,this._adUnitLoad&&(this._adUnitLoad=null,this._flash.removeCallback(this._adUnitLoad)),this._adUnit&&(this._adUnit._destroy(),this._adUnit=null)}},{key:"loadAdUnit",value:function(t,e){var n=this;r.call(this),this._adUnit&&this._destroyAdUnit(),this._flash.isReady()?(this._adUnitLoad=function(t,i){t||(n._adUnit=new c(n._flash)),n._adUnitLoad=null,e(t,n._adUnit)},this._flash.callFlashMethod("loadAdUnit",[t],this._adUnitLoad)):this._loadLater={url:t,callback:e}}},{key:"unloadAdUnit",value:function(){var t=arguments.length<=0||void 0===arguments[0]?void 0:arguments[0];r.call(this),this._destroyAdUnit(),this._flash.callFlashMethod("unloadAdUnit",[],t)}},{key:"getFlashID",value:function(){return r.call(this),this._flash.getFlashID()}},{key:"getFlashURL",value:function(){return r.call(this),this._flash.getFlashURL()}}]),t}();a("isSupported",function(){return l.hasFlashPlayerVersion(g)&&y.isSupported()},!0),a("runFlashTest",function(t){y=v(document.body,t)}),b.swfobject=l,e.exports=b},{"./VPAIDAdUnit":2,"./flashTester.js":4,"./jsFlashBridge":5,"./utils":8,swfobject:14}],4:[function(t,e,n){function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,A.default)(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=t("swfobject"),a="vpaid_video_flash_tester",s="vpaid_video_flash_tester_el",l=t("./jsFlashBridge").JSFlashBridge,u=t("./utils"),c=t("./registry").MultipleValuesRegistry,h=function(){function t(e){var n=this,r=arguments.length<=1||void 0===arguments[1]?{data:"VPAIDFlash.swf",width:800,height:400}:arguments[1];i(this,t),this.parentEl=u.createElementWithID(e,s),u.hideFlashEl(this.parentEl);var a={};a.movie=r.data,a.FlashVars="flashid="+s+"&handler="+l.VPAID_FLASH_HANDLER,a.allowScriptAccess="always",this.el=o.createSWF(r,a,s),this._handlers=new c,this._isSupported=!1,this.el&&(u.hideFlashEl(this.el),this._flash=new l(this.el,r.data,s,r.width,r.height,function(){n._isSupported=!0,n._handlers.get("change").forEach(function(t){setTimeout(function(){t("change",!0)},0)})}))}return r(t,[{key:"isSupported",value:function(){return this._isSupported}},{key:"on",value:function(t,e){this._handlers.add(t,e)}}]),t}();n.createFlashTester=function(t,e){return window[a]||(window[a]=new h(t,e)),window[a]}},{"./jsFlashBridge":5,"./registry":7,"./utils":8,swfobject:14}],5:[function(t,e,n){function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e,n){var i=this;setTimeout(function(){var r=i._callbacks.get(t);r&&(i._callbacks.remove(t),r(e,n))},0)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,A.default)(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=t("./utils").unique,s=t("./utils").isPositiveInt,l=t("./utils").stringEndsWith,u=t("./registry").SingleValueRegistry,c=t("./registry").MultipleValuesRegistry,h=t("./jsFlashBridgeRegistry"),d=n.JSFlashBridge=function(){function t(e,n,r,o,s,l){i(this,t),this._el=e,this._flashID=r,this._flashURL=n,this._width=o,this._height=s,this._handlers=new c,this._callbacks=new u,this._uniqueMethodIdentifier=a(this._flashID),this._ready=!1,this._handShakeHandler=l,h.addInstance(this._flashID,this)}return o(t,[{key:"on",value:function(t,e){this._handlers.add(t,e)}},{key:"off",value:function(t,e){return this._handlers.remove(t,e)}},{key:"offEvent",value:function(t){return this._handlers.removeByKey(t)}},{key:"offAll",value:function(){return this._handlers.removeAll()}},{key:"callFlashMethod",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?[]:arguments[1],n=arguments.length<=2||void 0===arguments[2]?void 0:arguments[2],i="";n&&(i=this._uniqueMethodIdentifier()+"_"+t,this._callbacks.add(i,n));try{this._el[t]([i].concat(e))}catch(t){n?r.call(this,i,t):this._trigger("AdError",t)}}},{key:"removeCallback",value:function(t){return this._callbacks.removeByValue(t)}},{key:"removeCallbackByMethodName",value:function(t){var e=this;this._callbacks.filterKeys(function(e){return l(e,t)}).forEach(function(t){e._callbacks.remove(t)})}},{key:"removeAllCallbacks",value:function(){return this._callbacks.removeAll()}},{key:"_trigger",value:function(t,e){var n=this;this._handlers.get(t).forEach(function(i){"AdClickThru"===t?i(e):setTimeout(function(){n._handlers.get(t).length>0&&i(e)},0)})}},{key:"_callCallback",value:function(t,e,n,i){if(!this._callbacks.get(e))return void(n&&""===e&&this.trigger("AdError",n));r.call(this,e,n,i)}},{key:"_handShake",value:function(t,e){this._ready=!0,this._handShakeHandler&&(this._handShakeHandler(t,e),delete this._handShakeHandler)}},{key:"getSize",value:function(){return{width:this._width,height:this._height}}},{key:"setSize",value:function(t,e){this._width=s(t,this._width),this._height=s(e,this._height),this._el.setAttribute("width",this._width),this._el.setAttribute("height",this._height)}},{key:"getWidth",value:function(){return this._width}},{key:"setWidth",value:function(t){this.setSize(t,this._height)}},{key:"getHeight",value:function(){return this._height}},{key:"setHeight",value:function(t){this.setSize(this._width,t)}},{key:"getFlashID",value:function(){return this._flashID}},{key:"getFlashURL",value:function(){return this._flashURL}},{key:"isReady",value:function(){return this._ready}},{key:"destroy",value:function(){this.offAll(),this.removeAllCallbacks(),h.removeInstanceByID(this._flashID),this._el.parentElement&&this._el.parentElement.removeChild(this._el)}}]),t}();Object.defineProperty(d,"VPAID_FLASH_HANDLER",{writable:!1,configurable:!1,value:"vpaid_video_flash_handler"}),window.vpaid_video_flash_handler=function(t,e,n,i,r,o){var a=h.getInstanceByID(t);a&&("handShake"===n?a._handShake(r,o):"event"!==e?a._callCallback(n,i,r,o):a._trigger(n,o))}},{"./jsFlashBridgeRegistry":6,"./registry":7,"./utils":8}],6:[function(t,e,n){var i=t("./registry").SingleValueRegistry,r=new i,o={};Object.defineProperty(o,"addInstance",{writable:!1,configurable:!1,value:function(t,e){r.add(t,e)}}),Object.defineProperty(o,"getInstanceByID",{writable:!1,configurable:!1,value:function(t){return r.get(t)}}),Object.defineProperty(o,"removeInstanceByID",{writable:!1,configurable:!1,value:function(t){return r.remove(t)}}),e.exports=o},{"./registry":7}],7:[function(t,e,n){function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,A.default)(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();n.MultipleValuesRegistry=function(){function t(){i(this,t),this._registries={}}return r(t,[{key:"add",value:function(t,e){this._registries[t]||(this._registries[t]=[]),-1===this._registries[t].indexOf(e)&&this._registries[t].push(e)}},{key:"get",value:function(t){return this._registries[t]||[]}},{key:"filterKeys",value:function(t){return(0,c.default)(this._registries).filter(t)}},{key:"findByValue",value:function(t){var e=this;return(0,c.default)(this._registries).filter(function(n){return-1!==e._registries[n].indexOf(t)})}},{key:"remove",value:function(t,e){if(this._registries[t]){var n=this._registries[t].indexOf(e);if(!(n<0))return this._registries[t].splice(n,1)}}},{key:"removeByKey",value:function(t){var e=this._registries[t];return delete this._registries[t],e}},{key:"removeByValue",value:function(t){var e=this;return this.findByValue(t).map(function(n){return e.remove(n,t)})}},{key:"removeAll",value:function(){var t=this._registries;return this._registries={},t}},{key:"size",value:function(){return(0,c.default)(this._registries).length}}]),t}(),n.SingleValueRegistry=function(){function t(){i(this,t),this._registries={}}return r(t,[{key:"add",value:function(t,e){this._registries[t]=e}},{key:"get",value:function(t){return this._registries[t]}},{key:"filterKeys",value:function(t){return(0,c.default)(this._registries).filter(t)}},{key:"findByValue",value:function(t){var e=this;return(0,c.default)(this._registries).filter(function(n){return e._registries[n]===t})}},{key:"remove",value:function(t){var e=this._registries[t];return delete this._registries[t],e}},{key:"removeByValue",value:function(t){var e=this;return this.findByValue(t).map(function(t){return e.remove(t)})}},{key:"removeAll",value:function(){var t=this._registries;return this._registries={},t}},{key:"size",value:function(){return(0,c.default)(this._registries).length}}]),t}()},{}],8:[function(t,e,n){function i(t){var e=-1;return function(n){return t+"_"+ ++e}}function r(){}function o(t,e,n){var i=setTimeout(function(){e=r,n()},t);return function(){clearTimeout(i),e.apply(this,arguments)}}function a(t,e){var n=!(arguments.length<=2||void 0===arguments[2])&&arguments[2],i=document.createElement("div");return i.id=e,n&&(t.innerHTML=""),t.appendChild(i),i}function s(t,e){return!isNaN(parseFloat(t))&&isFinite(t)&&t>0?t:e}function l(t,e){return c.call(t,e)}function u(t){t.style.position="absolute",t.style.left="-1px",t.style.top="-1px",t.style.width="1px",t.style.height="1px"}Object.defineProperty(n,"__esModule",{value:!0}),n.unique=i,n.noop=r,n.callbackTimeout=o,n.createElementWithID=a,n.isPositiveInt=s,n.stringEndsWith=l,n.hideFlashEl=u;var c=function(){return String.prototype.endsWith?String.prototype.endsWith:function(t,e){var n=this.toString();(void 0===e||e>n.length)&&(e=n.length),e-=t.length;var i=n.indexOf(t,e);return-1!==i&&i===e}}()},{}],9:[function(t,e,n){function i(t,e,n){}function r(t,e,n){(0,A.default)(t,e,{writable:!1,configurable:!1,value:n})}var o=["handshakeVersion","initAd","startAd","stopAd","skipAd","resizeAd","pauseAd","resumeAd","expandAd","collapseAd","subscribe","unsubscribe"],a=["AdLoaded","AdStarted","AdStopped","AdSkipped","AdSkippableStateChange","AdSizeChange","AdLinearChange","AdDurationChange","AdExpandedChange","AdRemainingTimeChange","AdVolumeChange","AdImpression","AdVideoStart","AdVideoFirstQuartile","AdVideoMidpoint","AdVideoThirdQuartile","AdVideoComplete","AdClickThru","AdInteraction","AdUserAcceptInvitation","AdUserMinimize","AdUserClose","AdPaused","AdPlaying","AdLog","AdError"],s=["getAdLinear","getAdWidth","getAdHeight","getAdExpanded","getAdSkippableState","getAdRemainingTime","getAdDuration","getAdVolume","getAdCompanions","getAdIcons"],l=["setAdVolume"];i.prototype.handshakeVersion=function(t,e){},i.prototype.initAd=function(t,e,n,i,r,o,a){},i.prototype.startAd=function(t){},i.prototype.stopAd=function(t){},i.prototype.skipAd=function(t){},i.prototype.resizeAd=function(t,e,n,i){},i.prototype.pauseAd=function(t){},i.prototype.resumeAd=function(t){},i.prototype.expandAd=function(t){},i.prototype.collapseAd=function(t){},i.prototype.subscribe=function(t,e,n){},i.prototype.unsubscribe=function(t,e){},i.prototype.getAdLinear=function(t){},i.prototype.getAdWidth=function(t){},i.prototype.getAdHeight=function(t){},i.prototype.getAdExpanded=function(t){},i.prototype.getAdSkippableState=function(t){},i.prototype.getAdRemainingTime=function(t){},i.prototype.getAdDuration=function(t){},i.prototype.getAdVolume=function(t){},i.prototype.getAdCompanions=function(t){},i.prototype.getAdIcons=function(t){},i.prototype.setAdVolume=function(t,e){},r(i,"METHODS",o),r(i,"GETTERS",s),r(i,"SETTERS",l),r(i,"EVENTS",a);var u=o.filter(function(t){return-1===["skipAd"].indexOf(t)});r(i,"checkVPAIDInterface",function(t){return u.every(function(e){return"function"==typeof t[e]})}),e.exports=i},{}],10:[function(t,e,n){function i(t,e,n,i){this._isValid=c(t),this._isValid&&(this._creative=t,this._el=e,this._videoEl=n,this._iframe=i,this._subscribers=new u,r.call(this))}function r(){if(f.forEach(function(t){this._creative.subscribe(a.bind(this,t),t)}.bind(this)),this._creative.subscribe(o.bind(this),p),this._videoEl){var t=this._iframe.contentDocument.documentElement,e=this._videoEl;t.addEventListener("click",function(n){n.target===t&&e.click()})}}function o(t,e,n){this._subscribers.triggerSync(p,{url:t,id:e,playerHandles:n})}function a(t){this._subscribers.trigger(t,Array.prototype.slice(arguments,1))}function s(t,e,n,i){t?t(n,i):n&&e.trigger(d,n)}var l=t("./IVPAIDAdUnit"),u=t("./subscriber"),c=l.checkVPAIDInterface,h=t("./utils"),d=(l.METHODS,"AdError"),p="AdClickThru",f=l.EVENTS.filter(function(t){return t!=p});i.prototype=(0,y.default)(l.prototype),i.prototype.isValidVPAIDAd=function(){return this._isValid},l.METHODS.forEach(function(t){-1===["subscribe","unsubscribe","initAd"].indexOf(t)&&(i.prototype[t]=function(){var e=l.prototype[t].length,n=Array.prototype.slice.call(arguments),i=e===n.length?n.pop():void 0;setTimeout(function(){var e,r=null;try{e=this._creative[t].apply(this._creative,n)}catch(t){r=t}s(i,this._subscribers,r,e)}.bind(this),0)})}),i.prototype.initAd=function(t,e,n,i,r,o,a){r=r||{},o=h.extend({slot:this._el,videoSlot:this._videoEl},o||{}),setTimeout(function(){var l;try{this._creative.initAd(t,e,n,i,r,o)}catch(t){l=t}s(a,this._subscribers,l)}.bind(this),0)},i.prototype.subscribe=function(t,e,n){this._subscribers.subscribe(e,t,n)},i.prototype.unsubscribe=function(t,e){this._subscribers.unsubscribe(e,t)},i.prototype.on=i.prototype.subscribe,i.prototype.off=i.prototype.unsubscribe,l.GETTERS.forEach(function(t){i.prototype[t]=function(e){setTimeout(function(){var n,i=null;try{n=this._creative[t]()}catch(t){i=t}s(e,this._subscribers,i,n)}.bind(this),0)}}),i.prototype.setAdVolume=function(t,e){setTimeout(function(){var n,i=null;try{this._creative.setAdVolume(t),n=this._creative.getAdVolume()}catch(t){i=t}i||(i=h.validate(n===t,"failed to apply volume: "+t)),s(e,this._subscribers,i,n)}.bind(this),0)},i.prototype._destroy=function(){this.stopAd(),this._subscribers.unsubscribeAll()},e.exports=i},{"./IVPAIDAdUnit":9,"./subscriber":12,"./utils":13}],11:[function(t,e,n){function i(t,e,n,i){n=n||{},this._id=p(),this._destroyed=!1,this._frameContainer=d.createElementInEl(t,"div"),this._videoEl=e,this._vpaidOptions=i||{timeout:1e4},this._templateConfig={template:n.template||m,extraOptions:n.extraOptions||{}}}function r(t){var e=this[t];e&&(e.remove(),delete this[t])}function o(){s.call(this),delete this._adUnit}function a(){s.call(this),u.call(this)}function s(){r.call(this,"_frame"),l.call(this)}function l(){this._onLoad&&(window.removeEventListener("message",this._onLoad),d.clearCallbackTimeout(this._onLoad),delete this._onLoad)}function u(){this._adUnit&&(this._adUnit.stopAd(),delete this._adUnit)}function c(){if(this._destroyed)throw new Error("VPAIDHTML5Client already destroyed!")}function h(){return window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")}var d=t("./utils"),p=d.unique("vpaidIframe"),f=t("./VPAIDAdUnit"),m='<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"></head><body style="margin:0;padding:0"><div class="ad-element"></div><script type="text/javascript" src="{{iframeURL_JS}}"><\/script><script type="text/javascript">window.parent.postMessage(\'{"event": "ready", "id": "{{iframeID}}"}\', \'{{origin}}\');<\/script></body></html>';i.prototype.destroy=function(){this._destroyed||(this._destroyed=!0,a.call(this))},i.prototype.isDestroyed=function(){return this._destroyed},i.prototype.loadAdUnit=function(t,e){function n(t){if(t.origin===h()&&JSON.parse(t.data).id===r.getID()){var n,i,a;if(r._frame.contentWindow?(a=r._frame.contentWindow.getVPAIDAd,i=d.validate("function"==typeof a,"the ad didn't return a function to create an ad")):i="the iframe is not anymore in the DOM tree",!i){var s=r._frame.contentWindow.document.querySelector(".ad-element");n=new f(a(),s,r._videoEl,r._frame),n.subscribe("AdStopped",o.bind(r)),i=d.validate(n.isValidVPAIDAd(),"the add is not fully complaint with VPAID specification")}return r._adUnit=n,l.call(r),e(i,i?null:n),!0}}function i(){e("timeout",null)}c.call(this),a.call(this);var r=this,s=d.createIframeWithContent(this._frameContainer,this._templateConfig.template,d.extend({iframeURL_JS:t,iframeID:this.getID(),origin:h()},this._templateConfig.extraOptions));this._frame=s,this._onLoad=d.callbackTimeout(this._vpaidOptions.timeout,n.bind(this),i.bind(this)),window.addEventListener("message",this._onLoad)},i.prototype.unloadAdUnit=function(){a.call(this)},i.prototype.getID=function(){return this._id},e.exports=i,window.VPAIDHTML5Client=i},{"./VPAIDAdUnit":10,"./utils":13}],12:[function(t,e,n){function i(){this._subscribers={}}i.prototype.subscribe=function(t,e,n){this.isHandlerAttached(t,e)||this.get(e).push({handler:t,context:n,eventName:e})},i.prototype.unsubscribe=function(t,e){this._subscribers[e]=this.get(e).filter(function(e){return t!==e.handler})},i.prototype.unsubscribeAll=function(){this._subscribers={}},i.prototype.trigger=function(t,e){var n=this;this.get(t).concat(this.get("*")).forEach(function(t){setTimeout(function(){n.isHandlerAttached(t.handler,t.eventName)&&t.handler.call(t.context,e)},0)})},i.prototype.triggerSync=function(t,e){this.get(t).concat(this.get("*")).forEach(function(t){t.handler.call(t.context,e)})},i.prototype.get=function(t){return this._subscribers[t]||(this._subscribers[t]=[]),this._subscribers[t]},i.prototype.isHandlerAttached=function(t,e){return this.get(e).some(function(e){return t===e.handler})},e.exports=i},{}],13:[function(t,e,n){function i(){}function r(t,e){return t?null:new Error(e)}function o(t){var e=v[t];e&&(clearTimeout(e),delete v[t])}function a(t,e,n){var r,a;return a=setTimeout(function(){e=i,delete a[r],n()},t),r=function(){e.apply(this,arguments)&&o(r)},v[r]=a,r}function s(t,e,n){var i=document.createElement(e);return n&&(i.id=n),t.appendChild(i),i}function u(t,e,n){var i=h(t,null,n.zIndex);if(p(i,d(e,n)))return i}function h(t,e,n){var i=document.createElement("iframe");return i.src=e||"about:blank",i.marginWidth="0",i.marginHeight="0",i.frameBorder="0",i.width="100%",i.height="100%",i.style.position="absolute",i.style.left="0",i.style.top="0",i.style.margin="0px",i.style.padding="0px",i.style.border="none",n&&(i.style.zIndex=n),i.setAttribute("SCROLLING","NO"),t.innerHTML="",t.appendChild(i),i}function d(t,e){return(0,c.default)(e).forEach(function(n){var i="object"===(void 0===i?"undefined":(0,T.default)(i))?(0,l.default)(e[n]):e[n];t=t.replace(new RegExp("{{"+n+"}}","g"),i)}),t}function p(t,e){var n=t.contentWindow&&t.contentWindow.document;return!!n&&(n.write(e),!0)}function f(t,e){return(0,c.default)(e).forEach(function(n){t[n]=e[n]}),t}function m(t){var e=-1;return function(){return t+"_"+ ++e}}var v={};e.exports={noop:i,validate:r,clearCallbackTimeout:o,callbackTimeout:a,createElementInEl:s,createIframeWithContent:u,createIframe:h,simpleTemplate:d,setIframeContent:p,extend:f,unique:m}},{}],14:[function(t,e,i){!function(t,r){o=r,void 0!==(a="function"==typeof o?o.call(i,n,i,e):o)&&(e.exports=a)}(0,function(){function t(){if(!H&&document.getElementsByTagName("body")[0]){try{var t,e=g("span");e.style.display="none",t=O.getElementsByTagName("body")[0].appendChild(e),t.parentNode.removeChild(t),t=null,e=null}catch(t){return}H=!0;for(var n=V.length,i=0;i<n;i++)V[i]()}}function e(t){H?t():V[V.length]=t}function n(t){if((0,T.default)(F.addEventListener)!==R)F.addEventListener("load",t,!1);else if((0,T.default)(O.addEventListener)!==R)O.addEventListener("load",t,!1);else if((0,T.default)(F.attachEvent)!==R)b(F,"onload",t);else if("function"==typeof F.onload){var e=F.onload;F.onload=function(){e(),t()}}else F.onload=t}function i(){var t=O.getElementsByTagName("body")[0],e=g(P);e.setAttribute("style","visibility: hidden;"),e.setAttribute("type",D);var n=t.appendChild(e);if(n){var i=0;!function o(){if((0,T.default)(n.GetVariable)!==R)try{var a=n.GetVariable("$version");a&&(a=a.split(" ")[1].split(","),q.pv=[y(a[0]),y(a[1]),y(a[2])])}catch(t){q.pv=[8,0,0]}else if(i<10)return i++,void setTimeout(o,10);t.removeChild(e),n=null,r()}()}else r()}function r(){var t=B.length;if(t>0)for(var e=0;e<t;e++){var n=B[e].id,i=B[e].callbackFn,r={success:!1,id:n};if(q.pv[0]>0){var u=v(n);if(u)if(!_(B[e].swfVersion)||q.wk&&q.wk<312)if(B[e].expressInstall&&a()){var c={};c.data=B[e].expressInstall,c.width=u.getAttribute("width")||"0",c.height=u.getAttribute("height")||"0",u.getAttribute("class")&&(c.styleclass=u.getAttribute("class")),u.getAttribute("align")&&(c.align=u.getAttribute("align"));for(var h={},d=u.getElementsByTagName("param"),p=d.length,f=0;f<p;f++)"movie"!==d[f].getAttribute("name").toLowerCase()&&(h[d[f].getAttribute("name")]=d[f].getAttribute("value"));s(c,h,n,i)}else l(u),i&&i(r);else x(n,!0),i&&(r.success=!0,r.ref=o(n),r.id=n,i(r))}else if(x(n,!0),i){var m=o(n);m&&(0,T.default)(m.SetVariable)!==R&&(r.success=!0,r.ref=m,r.id=m.id),i(r)}}}function o(t){var e=null,n=v(t);return n&&"OBJECT"===n.nodeName.toUpperCase()&&(e=(0,T.default)(n.SetVariable)!==R?n:n.getElementsByTagName(P)[0]||n),e}function a(){return!z&&_("6.0.65")&&(q.win||q.mac)&&!(q.wk&&q.wk<312)}function s(t,e,n,i){var r=v(n);if(n=m(n),z=!0,C=i||null,k={success:!1,id:n},r){"OBJECT"===r.nodeName.toUpperCase()?(S=u(r),A=null):(S=r,A=n),t.id=I,((0,T.default)(t.width)===R||!/%$/.test(t.width)&&y(t.width)<310)&&(t.width="310"),((0,T.default)(t.height)===R||!/%$/.test(t.height)&&y(t.height)<137)&&(t.height="137");var o=q.ie?"ActiveX":"PlugIn",a="MMredirectURL="+encodeURIComponent(F.location.toString().replace(/&/g,"%26"))+"&MMplayerType="+o+"&MMdoctitle="+encodeURIComponent(O.title.slice(0,47)+" - Flash Player Installation");if((0,T.default)(e.flashvars)!==R?e.flashvars+="&"+a:e.flashvars=a,q.ie&&4!=r.readyState){var s=g("div");n+="SWFObjectNew",s.setAttribute("id",n),r.parentNode.insertBefore(s,r),r.style.display="none",p(r)}h(t,e,n)}}function l(t){if(q.ie&&4!=t.readyState){t.style.display="none";var e=g("div");t.parentNode.insertBefore(e,t),e.parentNode.replaceChild(u(t),e),p(t)}else t.parentNode.replaceChild(u(t),t)}function u(t){var e=g("div");if(q.win&&q.ie)e.innerHTML=t.innerHTML;else{var n=t.getElementsByTagName(P)[0];if(n){var i=n.childNodes;if(i)for(var r=i.length,o=0;o<r;o++)1==i[o].nodeType&&"PARAM"===i[o].nodeName||8==i[o].nodeType||e.appendChild(i[o].cloneNode(!0))}}return e}function c(t,e){var n=g("div");return n.innerHTML="<object classid='clsid:D27CDB6E-AE6D-11cf-96B8-444553540000'><param name='movie' value='"+t+"'>"+e+"</object>",n.firstChild}function h(t,e,n){var i,r=v(n);if(n=m(n),q.wk&&q.wk<312)return i;if(r){var o,a,s,l=g(q.ie?"div":P);(0,T.default)(t.id)===R&&(t.id=n);for(s in e)e.hasOwnProperty(s)&&"movie"!==s.toLowerCase()&&d(l,s,e[s]);q.ie&&(l=c(t.data,l.innerHTML));for(o in t)t.hasOwnProperty(o)&&(a=o.toLowerCase(),"styleclass"===a?l.setAttribute("class",t[o]):"classid"!==a&&"data"!==a&&l.setAttribute(o,t[o]));q.ie?j[j.length]=t.id:(l.setAttribute("type",D),l.setAttribute("data",t.data)),r.parentNode.replaceChild(l,r),i=l}return i}function d(t,e,n){var i=g("param");i.setAttribute("name",e),i.setAttribute("value",n),t.appendChild(i)}function p(t){var e=v(t);e&&"OBJECT"===e.nodeName.toUpperCase()&&(q.ie?(e.style.display="none",function t(){if(4==e.readyState){for(var n in e)"function"==typeof e[n]&&(e[n]=null);e.parentNode.removeChild(e)}else setTimeout(t,10)}()):e.parentNode.removeChild(e))}function f(t){return t&&t.nodeType&&1===t.nodeType}function m(t){return f(t)?t.id:t}function v(t){if(f(t))return t;var e=null;try{e=O.getElementById(t)}catch(t){}return e}function g(t){return O.createElement(t)}function y(t){return parseInt(t,10)}function b(t,e,n){t.attachEvent(e,n),G[G.length]=[t,e,n]}function _(t){t+="";var e=q.pv,n=t.split(".");return n[0]=y(n[0]),n[1]=y(n[1])||0,n[2]=y(n[2])||0,e[0]>n[0]||e[0]==n[0]&&e[1]>n[1]||e[0]==n[0]&&e[1]==n[1]&&e[2]>=n[2]}function w(t,e,n,i){var r=O.getElementsByTagName("head")[0];if(r){var o="string"==typeof n?n:"screen";if(i&&(M=null,L=null),!M||L!=o){var a=g("style");a.setAttribute("type","text/css"),a.setAttribute("media",o),M=r.appendChild(a),q.ie&&(0,T.default)(O.styleSheets)!==R&&O.styleSheets.length>0&&(M=O.styleSheets[O.styleSheets.length-1]),L=o}M&&((0,T.default)(M.addRule)!==R?M.addRule(t,e):(0,T.default)(O.createTextNode)!==R&&M.appendChild(O.createTextNode(t+" {"+e+"}")))}}function x(t,e){if(W){var n=e?"visible":"hidden",i=v(t);H&&i?i.style.visibility=n:"string"==typeof t&&w("#"+t,"visibility:"+n)}}function E(t){return null!==/[\\\"<>\.;]/.exec(t)&&("undefined"==typeof encodeURIComponent?"undefined":(0,T.default)(encodeURIComponent))!==R?encodeURIComponent(t):t}var S,A,C,k,M,L,R="undefined",P="object",D="application/x-shockwave-flash",I="SWFObjectExprInst",F=window,O=document,N=navigator,U=!1,V=[],B=[],j=[],G=[],H=!1,z=!1,W=!0,X=!1,q=function(){var t=(0,T.default)(O.getElementById)!==R&&(0,T.default)(O.getElementsByTagName)!==R&&(0,T.default)(O.createElement)!==R,e=N.userAgent.toLowerCase(),n=N.platform.toLowerCase(),i=/win/.test(n?n:e),r=/mac/.test(n?n:e),o=!!/webkit/.test(e)&&parseFloat(e.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")),a="Microsoft Internet Explorer"===N.appName,s=[0,0,0],l=null;if((0,T.default)(N.plugins)!==R&&(0,T.default)(N.plugins["Shockwave Flash"])===P)(l=N.plugins["Shockwave Flash"].description)&&(0,T.default)(N.mimeTypes)!==R&&N.mimeTypes[D]&&N.mimeTypes[D].enabledPlugin&&(U=!0,a=!1,l=l.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),s[0]=y(l.replace(/^(.*)\..*$/,"$1")),s[1]=y(l.replace(/^.*\.(.*)\s.*$/,"$1")),s[2]=/[a-zA-Z]/.test(l)?y(l.replace(/^.*[a-zA-Z]+(.*)$/,"$1")):0);else if((0,T.default)(F.ActiveXObject)!==R)try{var u=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");u&&(l=u.GetVariable("$version"))&&(a=!0,l=l.split(" ")[1].split(","),s=[y(l[0]),y(l[1]),y(l[2])])}catch(t){}return{w3:t,pv:s,wk:o,ie:a,win:i,mac:r}}();!function(){q.w3&&(((0,T.default)(O.readyState)!==R&&("complete"===O.readyState||"interactive"===O.readyState)||(0,T.default)(O.readyState)===R&&(O.getElementsByTagName("body")[0]||O.body))&&t(),H||((0,T.default)(O.addEventListener)!==R&&O.addEventListener("DOMContentLoaded",t,!1),q.ie&&(O.attachEvent("onreadystatechange",function e(){"complete"===O.readyState&&(O.detachEvent("onreadystatechange",e),t())}),F==top&&function e(){if(!H){try{O.documentElement.doScroll("left")}catch(t){return void setTimeout(e,0)}t()}}()),q.wk&&function e(){if(!H)return/loaded|complete/.test(O.readyState)?void t():void setTimeout(e,0)}()))}();V[0]=function(){U?i():r()};!function(){q.ie&&window.attachEvent("onunload",function(){for(var t=G.length,e=0;e<t;e++)G[e][0].detachEvent(G[e][1],G[e][2]);for(var n=j.length,i=0;i<n;i++)p(j[i]);for(var r in q)q[r]=null;q=null;for(var o in swfobject)swfobject[o]=null;swfobject=null})}();return{registerObject:function(t,e,n,i){if(q.w3&&t&&e){var r={};r.id=t,r.swfVersion=e,r.expressInstall=n,r.callbackFn=i,B[B.length]=r,x(t,!1)}else i&&i({success:!1,id:t})},getObjectById:function(t){if(q.w3)return o(t)},embedSWF:function(t,n,i,r,o,l,u,c,d,p){var f=m(n),v={success:!1,id:f};q.w3&&!(q.wk&&q.wk<312)&&t&&n&&i&&r&&o?(x(f,!1),e(function(){i+="",r+="";var e={};if(d&&(void 0===d?"undefined":(0,T.default)(d))===P)for(var m in d)e[m]=d[m];e.data=t,e.width=i,e.height=r;var g={};if(c&&(void 0===c?"undefined":(0,T.default)(c))===P)for(var y in c)g[y]=c[y];if(u&&(void 0===u?"undefined":(0,T.default)(u))===P)for(var b in u)if(u.hasOwnProperty(b)){var w=X?encodeURIComponent(b):b,E=X?encodeURIComponent(u[b]):u[b];(0,T.default)(g.flashvars)!==R?g.flashvars+="&"+w+"="+E:g.flashvars=w+"="+E}if(_(o)){var S=h(e,g,n);e.id==f&&x(f,!0),v.success=!0,v.ref=S,v.id=S.id}else{if(l&&a())return e.data=l,void s(e,g,n,p);x(f,!0)}p&&p(v)})):p&&p(v)},switchOffAutoHideShow:function(){W=!1},enableUriEncoding:function(t){X=(void 0===t?"undefined":(0,T.default)(t))===R||t},ua:q,getFlashPlayerVersion:function(){return{major:q.pv[0],minor:q.pv[1],release:q.pv[2]}},hasFlashPlayerVersion:_,createSWF:function(t,e,n){return q.w3?h(t,e,n):void 0},showExpressInstall:function(t,e,n,i){q.w3&&a()&&s(t,e,n,i)},removeSWF:function(t){q.w3&&p(t)},createCSS:function(t,e,n,i){q.w3&&w(t,e,n,i)},addDomLoadEvent:e,addLoadEvent:n,getQueryParamValue:function(t){var e=O.location.search||O.location.hash;if(e){if(/\?/.test(e)&&(e=e.split("?")[1]),!t)return E(e);for(var n=e.split("&"),i=0;i<n.length;i++)if(n[i].substring(0,n[i].indexOf("="))==t)return E(n[i].substring(n[i].indexOf("=")+1))}return""},expressInstallCallback:function(){if(z){var t=v(I);t&&S&&(t.parentNode.replaceChild(S,t),A&&(x(A,!0),q.ie&&(S.style.display="block")),C&&C(k)),z=!1}},version:"2.3"}})},{}],15:[function(t,e,n){function i(t){if(!(this instanceof i))return new i(t);this.initialize(t)}var r=t("./InLine"),o=t("./Wrapper");i.prototype.initialize=function(t){this.id=t.attr("id"),this.sequence=t.attr("sequence"),t.inLine&&(this.inLine=new r(t.inLine)),t.wrapper&&(this.wrapper=new o(t.wrapper))},e.exports=i},{"./InLine":18,"./Wrapper":28}],16:[function(t,e,n){function i(t){if(!(this instanceof i))return new i(t);s.info("<Companion> found companion ad"),s.debug("<Companion>  companionJTree:",t),this.creativeType=a.attr(t.staticResource,"creativeType"),this.staticResource=a.keyValue(t.staticResource),s.info("<Companion>  creativeType: "+this.creativeType),s.info("<Companion>  staticResource: "+this.staticResource);var e=null;a.keyValue(t.HTMLResource)?e=a.keyValue(t.HTMLResource):a.keyValue(t.hTMLResource)&&(e=a.keyValue(t.hTMLResource)),null!==e&&s.info("<Companion> found html resource",e),this.htmlResource=e;var n=null;a.keyValue(t.IFrameResource)?n=a.keyValue(t.IFrameResource):a.keyValue(t.iFrameresource)&&(n=a.keyValue(t.iFrameresource)),null!==n&&s.info("<Companion> found iframe resource",n),this.iframeResource=n,this.id=a.attr(t,"id"),this.width=a.attr(t,"width"),this.height=a.attr(t,"height"),this.expandedWidth=a.attr(t,"expandedWidth"),this.expandedHeight=a.attr(t,"expandedHeight"),this.scalable=a.attr(t,"scalable"),this.maintainAspectRatio=a.attr(t,"maintainAspectRatio"),this.minSuggestedDuration=a.attr(t,"minSuggestedDuration"),this.apiFramework=a.attr(t,"apiFramework"),this.companionClickThrough=a.keyValue(t.companionClickThrough),this.trackingEvents=function(t){var e=[];return o.isDefined(t)&&(t=o.isArray(t)?t:[t],t.forEach(function(t){e.push(new r(t))})),e}(t.trackingEvents&&t.trackingEvents.tracking),s.info("<Companion>  companionClickThrough: "+this.companionClickThrough)}var r=t("./TrackingEvent"),o=t("../../utils/utilityFunctions"),a=t("../../utils/xml"),s=t("../../utils/consoleLogger");e.exports=i},{"../../utils/consoleLogger":41,"../../utils/utilityFunctions":47,"../../utils/xml":48,"./TrackingEvent":21}],17:[function(t,e,n){function i(t){if(!(this instanceof i))return new i(t);if(this.id=t.attr("id"),this.sequence=t.attr("sequence"),this.adId=t.attr("adId"),this.apiFramework=t.attr("apiFramework"),t.linear&&(this.linear=new r(t.linear)),t.companionAds){var e=[],n=t.companionAds&&t.companionAds.companion;a.isDefined(n)&&(n=a.isArray(n)?n:[n],n.forEach(function(t){e.push(new o(t))})),this.companionAds=e}}var r=t("./Linear"),o=t("./Companion"),a=t("../../utils/utilityFunctions");i.prototype.isSupported=function(){return!this.linear||this.linear.isSupported()},i.parseCreatives=function(t){var e,n=[];return a.isDefined(t)&&a.isDefined(t.creative)&&(e=a.isArray(t.creative)?t.creative:[t.creative],e.forEach(function(t){n.push(new i(t))})),n},e.exports=i},{"../../utils/utilityFunctions":47,"./Companion":16,"./Linear":19}],18:[function(t,e,n){function i(t){if(!(this instanceof i))return new i(t);this.adTitle=s.keyValue(t.adTitle),this.adSystem=s.keyValue(t.adSystem),this.impressions=r.parseImpressions(t.impression),this.creatives=o.parseCreatives(t.creatives),this.description=s.keyValue(t.description),this.advertiser=s.keyValue(t.advertiser),this.surveys=function(t){return t?a.transformArray(a.isArray(t)?t:[t],function(t){if(a.isNotEmptyString(t.keyValue))return{uri:t.keyValue,type:t.attr("type")}}):[]}(t.survey),this.error=s.keyValue(t.error),this.pricing=s.keyValue(t.pricing),this.extensions=t.extensions}var r=t("./vastUtil"),o=t("./Creative"),a=t("../../utils/utilityFunctions"),s=t("../../utils/xml");i.prototype.isSupported=function(){var t,e;if(0===this.creatives.length)return!1;for(t=0,e=this.creatives.length;t<e;t+=1)if(!this.creatives[t].isSupported())return!1;return!0},e.exports=i},{"../../utils/utilityFunctions":47,"../../utils/xml":48,"./Creative":17,"./vastUtil":30}],19:[function(t,e,n){function i(t){if(!(this instanceof i))return new i(t);this.duration=l.duration(u.keyValue(t.duration)),this.mediaFiles=function(t){var e=[];return s.isDefined(t)&&(t=s.isArray(t)?t:[t],t.forEach(function(t){e.push(new o(t))})),e}(t.mediaFiles&&t.mediaFiles.mediaFile),this.trackingEvents=function(t,e){var n=[];return s.isDefined(t)&&(t=s.isArray(t)?t:[t],t.forEach(function(t){n.push(new r(t,e))})),n}(t.trackingEvents&&t.trackingEvents.tracking,this.duration),this.skipoffset=l.offset(u.attr(t,"skipoffset"),this.duration),t.videoClicks&&(this.videoClicks=new a(t.videoClicks)),t.adParameters&&(this.adParameters=u.keyValue(t.adParameters),u.attr(t.adParameters,"xmlEncoded")&&(this.adParameters=u.decode(this.adParameters)))}var r=t("./TrackingEvent"),o=t("./MediaFile"),a=t("./VideoClicks"),s=t("../../utils/utilityFunctions"),l=t("./parsers"),u=t("../../utils/xml");i.prototype.isSupported=function(){var t,e;for(t=0,e=this.mediaFiles.length;t<e;t+=1)if(this.mediaFiles[t].isSupported())return!0;return!1},e.exports=i},{"../../utils/utilityFunctions":47,"../../utils/xml":48,"./MediaFile":20,"./TrackingEvent":21,"./VideoClicks":27,"./parsers":29}],20:[function(t,e,n){function i(t){if(!(this instanceof i))return new i(t);this.src=r.keyValue(t);for(var e=0;e<a.length;e++){var n=a[e];this[n]=t.attr(n)}}var r=t("../../utils/xml"),o=t("./vastUtil"),a=["delivery","type","width","height","codec","id","bitrate","minBitrate","maxBitrate","scalable","maintainAspectRatio","apiFramework"];i.prototype.isSupported=function(){return o.isVPAID(this)?!!o.findSupportedVPAIDTech(this.type):"video/x-flv"!==this.type||o.isFlashSupported()},e.exports=i},{"../../utils/xml":48,"./vastUtil":30}],21:[function(t,e,n){function i(t,e){if(!(this instanceof i))return new i(t,e);this.name=t.attr("event"),this.uri=o.keyValue(t),"progress"===this.name&&(this.offset=r.offset(t.attr("offset"),e))}var r=t("./parsers"),o=t("../../utils/xml");e.exports=i},{"../../utils/xml":48,"./parsers":29}],22:[function(t,e,n){function i(t){if(!(this instanceof i))return new i(t);var e={WRAPPER_LIMIT:5};t=t||{},this.settings=c.extend({},t,e),this.errorURLMacros=[]}var r=t("./Ad"),o=t("./VASTError"),a=t("./VASTResponse"),s=t("./vastUtil"),l=t("../../utils/async"),u=t("../../utils/http").http,c=t("../../utils/utilityFunctions"),h=t("../../utils/xml"),d=t("../../utils/consoleLogger");i.prototype.getVASTResponse=function(t,e){function n(t,e){try{var n=i._buildVASTResponse(t);e(null,n)}catch(t){e(t)}}var i=this,r=function(t,e){return t?c.isFunction(e)?void 0:new o("on VASTClient.getVASTResponse, missing callback function"):new o("on VASTClient.getVASTResponse, missing ad tag URL")}(t,e);if(r){if(c.isFunction(e))return e(r);throw r}l.waterfall([this._getVASTAd.bind(this,t),n],e)},i.prototype._getVASTAd=function(t,e){function n(t,e){var n;try{n=h.toJXONTree(t),d.debug("built JXONTree from VAST response:",n),c.isArray(n.ad)?n.ads=n.ad:n.ad?n.ads=[n.ad]:n.ads=[],e(i(n),n)}catch(t){e(new o("on VASTClient.getVASTAd.buildVastWaterfall, error parsing xml",100),null)}}function i(t){var e=h.attr(t,"version");return t.ad?e&&3!=e&&2!=e?new o('on VASTClient.getVASTAd.validateVASTTree, not supported VAST version "'+e+'"',102):null:new o("on VASTClient.getVASTAd.validateVASTTree, no Ad in VAST tree",303)}function a(t,e,n){if(e.length>=f.WRAPPER_LIMIT)return n(new o("on VASTClient.getVASTAd.getAd, players wrapper limit reached (the limit is "+f.WRAPPER_LIMIT+")",302),e);l.waterfall([function(e){c.isString(t)?p(t,e):e(null,t)},s],function(t,i){return i&&e.push(i),t?n(t,e):i.wrapper?a(i.wrapper.VASTAdTagURI,e,n):n(null,e)})}function s(t,e){try{var n=new r(t);e(u(n),n)}catch(t){e(new o("on VASTClient.getVASTAd.buildAd, error parsing xml",100),null)}}function u(t){var e=t.wrapper,n=t.inLine,i="on VASTClient.getVASTAd.validateAd, ";return n&&e?new o(i+"InLine and Wrapper both found on the same Ad",101):n||e?n&&!n.isSupported()?new o(i+"could not find MediaFile that is supported by this video player",403):e&&!e.VASTAdTagURI?new o(i+"missing 'VASTAdTagURI' in wrapper",101):null:new o(i+"nor wrapper nor inline elements found on the Ad",101)}function p(t,e){f._requestVASTXml(t,function(t,n){if(t)return e(t);try{var r=h.toJXONTree(n);e(i(r),r.ad)}catch(t){e(new o("on VASTClient.getVASTAd.requestVASTAd, error parsing xml",100))}})}var f=this;!function(t,e){var i=f._requestVASTXml.bind(f,t);l.waterfall([i,n],e)}(t,function(t,n){function i(t,n){t?(f._trackError(t,n),r.length>0?a(r.shift(),[],i):e(t,n)):e(null,n)}var r=n&&c.isArray(n.ads)?n.ads:null;if(t)return f._trackError(t,r),e(t,r);a(r.shift(),[],i)})},i.prototype._requestVASTXml=function(t,e){function n(t,n,i){if(t){var r=c.isDefined(i)?"on VASTClient.requestVastXML, HTTP request error with status '"+i+"'":"on VASTClient.requestVastXML, Error getting the the VAST XML with he passed adTagXML fn";return e(new o(r,301),null)}e(null,n)}try{c.isFunction(t)?t(n):(d.info("requesting adTagUrl: "+t),u.get(t,n,{withCredentials:!0}))}catch(t){e(t)}},i.prototype._buildVASTResponse=function(t){var e=new a;return function(t,e){e.forEach(function(e){t.addAd(e)})}(e,t),function(t){var e=t.trackingEvents.progress;if(!t.hasLinear())throw new o("on VASTClient._buildVASTResponse, Received an Ad type that is not supported",200);if(void 0===t.duration)throw new o("on VASTClient._buildVASTResponse, Missing duration field in VAST response",101);e&&e.forEach(function(t){if(!c.isNumber(t.offset))throw new o("on VASTClient._buildVASTResponse, missing or wrong offset attribute on progress tracking event",101)})}(e),e},i.prototype._trackError=function(t,e){function n(t){t.wrapper&&t.wrapper.error&&i.push(t.wrapper.error),t.inLine&&t.inLine.error&&i.push(t.inLine.error)}if(c.isArray(e)&&0!==e.length){var i=[];e.forEach(n),s.track(i,{ERRORCODE:t.code||900})}},e.exports=i},{"../../utils/async":40,"../../utils/consoleLogger":41,"../../utils/http":43,"../../utils/utilityFunctions":47,"../../utils/xml":48,"./Ad":15,"./VASTError":23,"./VASTResponse":25,"./vastUtil":30}],23:[function(t,e,n){function i(t,e){this.message="VAST Error: "+(t||""),e&&(this.code=e)}i.prototype=new Error,i.prototype.name="VAST Error",e.exports=i},{}],24:[function(t,e,n){function i(t){if(!(this instanceof i))return new i(t);this.player=t}var r=t("./VASTResponse"),o=t("./VASTError"),a=t("./VASTTracker"),s=t("./vastUtil"),l=t("../../utils/async"),u=t("../../utils/dom"),c=t("../../utils/playerUtils"),h=t("../../utils/utilityFunctions"),d=t("../../utils/consoleLogger");i.prototype.playAd=function(t,e){var n=this;return e=e||h.noop,t instanceof r?(l.waterfall([function(e){e(null,t)},this._selectAdSource.bind(this),this._createVASTTracker.bind(this),this._addClickThrough.bind(this),this._addSkipButton.bind(this),this._setupEvents.bind(this),this._playSelectedAd.bind(this)],function(t,i){t&&i&&n._trackError(t,i),e(t,i)}),this._adUnit={_src:null,type:"VAST",pauseAd:function(){n.player.pause(!0)},resumeAd:function(){n.player.play(!0)},isPaused:function(){return n.player.paused(!0)},getSrc:function(){return this._src}},this._adUnit):e(new o("On VASTIntegrator, missing required VASTResponse"))},i.prototype._selectAdSource=function(t,e){var n,i=u.getDimension(this.player.el()).width;if(t.mediaFiles.sort(function(t,e){return Math.abs(i-t.width)-Math.abs(i-e.width)}),n=this.player.selectSource(t.mediaFiles).source)return d.info("selected source: ",n),this._adUnit&&(this._adUnit._src=n),e(null,n,t);e(new o("Could not find Ad mediafile supported by this player",403),t)},i.prototype._createVASTTracker=function(t,e,n){try{n(null,t,new a(t.src,e),e)}catch(t){n(t,e)}},i.prototype._setupEvents=function(t,e,n,i){function r(){d.off("fullscreenchange",o),d.off("vast.adStart",l),d.off("pause",a),d.off("timeupdate",s),d.off("volumechange",u)}function o(){d.isFullscreen()?e.trackFullscreen():e.trackExitFullscreen()}function a(){Math.abs(d.duration()-d.currentTime())<2||(e.trackPause(),c.once(d,["play","vast.adEnd","vast.adsCancel"],function(t){"play"===t.type&&e.trackResume()}))}function s(){var t=1e3*d.currentTime();e.trackProgress(t)}function l(){e.trackImpressions(),e.trackCreativeView()}function u(){var t=d.muted();t?e.trackMute():h&&e.trackUnmute(),h=t}var h,d=this.player;return d.on("fullscreenchange",o),d.on("vast.adStart",l),d.on("pause",a),d.on("timeupdate",s),d.on("volumechange",u),c.once(d,["vast.adEnd","vast.adsCancel"],r),c.once(d,["vast.adEnd","vast.adsCancel","vast.adSkip"],function(t){"vast.adEnd"===t.type&&e.trackComplete()}),i(null,t,n)},i.prototype._addSkipButton=function(t,e,n,i){function r(t){var n=window.document.createElement("div");return u.addClass(n,"vast-skip-button"),$(n).on("tap",function(i){if(u.hasClass(n,"enabled")&&(e.trackSkip(),t.trigger("vast.adSkip")),void 0===window.Event.prototype.stopPropagation)return!1;i.stopPropagation()}),n.onclick=function(i){if(u.hasClass(n,"enabled")&&(e.trackSkip(),t.trigger("vast.adSkip")),void 0===window.Event.prototype.stopPropagation)return!1;i.stopPropagation()},n}function o(t,e,n){var i=Math.ceil(e-n.currentTime());i>0?t.innerHTML="ÙÙØ§ÛØ´ ÙÛØ¯ÛÙ "+h.toFixedDigits(i,2)+" ":u.hasClass(t,"enabled")||(u.addClass(t,"enabled"),t.innerHTML="ÙÙØ§ÛØ´ ÙÛØ¯ÛÙ")}var a,s=this;h.isNumber(n.skipoffset)&&(a=n.skipoffset/1e3,function(t,e){function n(){t.off("timeupdate",a),u.remove(i)}var i=r(t),a=o.bind(s,i,e,t);t.el().appendChild(i),t.on("timeupdate",a),c.once(t,["vast.adEnd","vast.adsCancel"],n)}(this.player,a)),i(null,t,e,n)},i.prototype._addClickThrough=function(t,e,n,i){function r(t,e,n){t.href=o(e.clickThrough,n)}function o(e,n){var i={ASSETURI:t.src,CONTENTPLAYHEAD:s.formatProgress(1e3*n.currentTime())};return e?s.parseURLMacro(e,i):"#"}function a(){l.off("timeupdate",p),u.remove(d)}var l=this.player,d=function(t,e,n){var i=window.document.createElement("a"),r=n.clickThrough;return u.addClass(i,"vast-blocker"),i.href=o(r,t),h.isString(r)&&(i.target="_blank"),i.onclick=function(n){if(t.paused())return t.play(),void 0!==window.Event.prototype.stopPropagation&&n.stopPropagation(),!1;t.pause(),e.trackClick()},i}(l,e,n),p=r.bind(this,d,n,l);return l.el().insertBefore(d,l.controlBar.el()),l.on("timeupdate",p),c.once(l,["vast.adEnd","vast.adsCancel"],a),i(null,t,e,n)},i.prototype._playSelectedAd=function(t,e,n){function i(){c.once(r,["playing","vast.adsCancel"],function(t){function i(t){"ended"===t.type&&r.duration()-r.currentTime()>3||(r.off("ended",i),r.off("vast.adsCancel",i),r.off("vast.adSkip",i),"ended"!==t.type&&"vast.adSkip"!==t.type||n(null,e))}"vast.adsCancel"!==t.type&&(d.debug("<VASTIntegrator._playSelectedAd/playAd> got playing event; triggering vast.adStart..."),r.trigger("vast.adStart"),r.on("ended",i),r.on("vast.adsCancel",i),r.on("vast.adSkip",i))}),d.debug("<VASTIntegrator._playSelectedAd/playAd> calling player.play()..."),r.play()}var r=this.player;r.preload("auto"),r.src(t),d.debug("<VASTIntegrator._playSelectedAd> waiting for durationchange to play the ad..."),c.once(r,["durationchange","error","vast.adsCancel"],function(t){"durationchange"===t.type?(d.debug("<VASTIntegrator._playSelectedAd> got durationchange; calling playAd()"),i()):"error"===t.type&&n(new o("on VASTIntegrator, Player is unable to play the Ad",400),e)})},i.prototype._trackError=function(t,e){s.track(e.errorURLMacros,{ERRORCODE:t.code||900})},e.exports=i},{"../../utils/async":40,"../../utils/consoleLogger":41,"../../utils/dom":42,"../../utils/playerUtils":45,"../../utils/utilityFunctions":47,"./VASTError":23,"./VASTResponse":25,"./VASTTracker":26,"./vastUtil":30}],25:[function(t,e,n){function i(){if(!(this instanceof i))return new i;this._linearAdded=!1,this.ads=[],this.errorURLMacros=[],this.impressions=[],this.clickTrackings=[],this.customClicks=[],this.trackingEvents={},this.mediaFiles=[],this.clickThrough=void 0,this.adTitle="",this.duration=void 0,this.skipoffset=void 0}function r(t,e){e.forEach(function(e){t.push(e)})}var o=t("./Ad"),a=t("./VideoClicks"),s=t("./Linear"),l=t("./InLine"),u=t("./Wrapper"),c=t("../../utils/utilityFunctions"),h=t("../../utils/xml");window.InLine__A=l,i.prototype.addAd=function(t){var e,n;t instanceof o&&(e=t.inLine,n=t.wrapper,this.ads.push(t),e&&this._addInLine(e),n&&this._addWrapper(n))},i.prototype._addErrorTrackUrl=function(t){var e=t instanceof h.JXONTree?h.keyValue(t):t;e&&this.errorURLMacros.push(e)},i.prototype._addImpressions=function(t){c.isArray(t)&&r(this.impressions,t)},i.prototype._addClickThrough=function(t){c.isNotEmptyString(t)&&(this.clickThrough=t)},i.prototype._addClickTrackings=function(t){c.isArray(t)&&r(this.clickTrackings,t)},i.prototype._addCustomClicks=function(t){c.isArray(t)&&r(this.customClicks,t)},i.prototype._addTrackingEvents=function(t){var e=this.trackingEvents;t&&(t=c.isArray(t)?t:[t],t.forEach(function(t){e[t.name]||(e[t.name]=[]),e[t.name].push(t)}))},i.prototype._addTitle=function(t){c.isNotEmptyString(t)&&(this.adTitle=t)},i.prototype._addDuration=function(t){c.isNumber(t)&&(this.duration=t)},i.prototype._addVideoClicks=function(t){t instanceof a&&(this._addClickThrough(t.clickThrough),this._addClickTrackings(t.clickTrackings),this._addCustomClicks(t.customClicks))},i.prototype._addMediaFiles=function(t){c.isArray(t)&&r(this.mediaFiles,t)},i.prototype._addSkipoffset=function(t){t&&(this.skipoffset=t)},i.prototype._addAdParameters=function(t){t&&(this.adParameters=t)},i.prototype._addLinear=function(t){t instanceof s&&(this._addDuration(t.duration),this._addTrackingEvents(t.trackingEvents),this._addVideoClicks(t.videoClicks),this._addMediaFiles(t.mediaFiles),this._addSkipoffset(t.skipoffset),this._addAdParameters(t.adParameters),this._linearAdded=!0)},i.prototype._addInLine=function(t){var e=this;t instanceof l&&(this._addTitle(t.adTitle),this._addErrorTrackUrl(t.error),this._addImpressions(t.impressions),t.creatives.forEach(function(t){t.linear&&e._addLinear(t.linear)}))},i.prototype._addWrapper=function(t){var e=this;t instanceof u&&(this._addErrorTrackUrl(t.error),this._addImpressions(t.impressions),t.creatives.forEach(function(t){var n=t.linear;n&&(e._addVideoClicks(n.videoClicks),e.clickThrough=void 0,e._addTrackingEvents(n.trackingEvents))}))},i.prototype.hasLinear=function(){return this._linearAdded},e.exports=i},{"../../utils/utilityFunctions":47,"../../utils/xml":48,"./Ad":15,"./InLine":18,"./Linear":19,"./VideoClicks":27,"./Wrapper":28}],26:[function(t,e,n){function i(t,e){if(!(this instanceof i))return new i(t,e);this.sanityCheck(t,e),this.initialize(t,e)}var r=t("./VASTError"),o=t("./VASTResponse"),a=t("./vastUtil"),s=t("../../utils/utilityFunctions");i.prototype.initialize=function(t,e){this.response=e,this.assetURI=t,this.progress=0,this.quartiles={firstQuartile:{tracked:!1,time:Math.round(25*e.duration)/100},midpoint:{tracked:!1,time:Math.round(50*e.duration)/100},thirdQuartile:{tracked:!1,time:Math.round(75*e.duration)/100}}},i.prototype.sanityCheck=function(t,e){if(!s.isString(t)||s.isEmptyString(t))throw new r("on VASTTracker constructor, missing required the URI of the ad asset being played");if(!(e instanceof o))throw new r("on VASTTracker constructor, missing required VAST response")},i.prototype.trackURLs=function(t,e){s.isArray(t)&&t.length>0&&(e=s.extend({ASSETURI:this.assetURI,CONTENTPLAYHEAD:a.formatProgress(this.progress)},e||{}),a.track(t,e))},i.prototype.trackEvent=function(t,e){this.trackURLs(function(t){var e;return t&&(e=[],t.forEach(function(t){e.push(t.uri)})),e}(this.response.trackingEvents[t])),e&&(this.response.trackingEvents[t]=void 0)},i.prototype.trackProgress=function(t){function e(t,e,n){a[t]&&n&&r.push({name:t,trackOnce:!!e})}function n(t,e){var n=t.time;return e>=n&&e<=n+5e3}var i=this,r=[],o=!0,a=this.response.trackingEvents;s.isNumber(t)&&(e("start",o,t>0),e("rewind",!1,function(e,n){return e>t&&Math.abs(n-e)>3e3}(this.progress,t)),function(t){function r(t,i){var r=a[t];n(r,i)&&(r.tracked=!0,e(t,o,!0))}var a=i.quartiles,s=i.quartiles.firstQuartile,l=i.quartiles.midpoint,u=i.quartiles.thirdQuartile;s.tracked?l.tracked?u.tracked||r("thirdQuartile",t):r("midpoint",t):r("firstQuartile",t)}(t),function(t){if(s.isArray(a.progress)){var e=[];a.progress.forEach(function(n){n.offset<=t?i.trackURLs([n.uri]):e.push(n)}),a.progress=e}}(t),function(){r.forEach(function(t){i.trackEvent(t.name,t.trackOnce)})}(),this.progress=t)},["rewind","fullscreen","exitFullscreen","pause","resume","mute","unmute","acceptInvitation","acceptInvitationLinear","collapse","expand"].forEach(function(t){i.prototype["track"+s.capitalize(t)]=function(){this.trackEvent(t)}}),["start","skip","close","closeLinear"].forEach(function(t){i.prototype["track"+s.capitalize(t)]=function(){this.trackEvent(t,!0)}}),["firstQuartile","midpoint","thirdQuartile"].forEach(function(t){i.prototype["track"+s.capitalize(t)]=function(){this.quartiles[t].tracked=!0,this.trackEvent(t,!0)}}),i.prototype.trackComplete=function(){this.quartiles.thirdQuartile.tracked&&this.trackEvent("complete",!0)},i.prototype.trackErrorWithCode=function(t){s.isNumber(t)&&this.trackURLs(this.response.errorURLMacros,{ERRORCODE:t})},i.prototype.trackImpressions=function(){this.trackURLs(this.response.impressions)},i.prototype.trackCreativeView=function(){this.trackEvent("creativeView")},i.prototype.trackClick=function(){this.trackURLs(this.response.clickTrackings)},e.exports=i},{"../../utils/utilityFunctions":47,"./VASTError":23,"./VASTResponse":25,"./vastUtil":30}],27:[function(t,e,n){function i(t){function e(t){var e=[];return t&&(t=r.isArray(t)?t:[t],t.forEach(function(t){e.push(o.keyValue(t))})),e}if(!(this instanceof i))return new i(t);this.clickThrough=o.keyValue(t.clickThrough),this.clickTrackings=e(t.clickTracking),this.customClicks=e(t.customClick)}var r=t("../../utils/utilityFunctions"),o=t("../../utils/xml");e.exports=i},{"../../utils/utilityFunctions":47,"../../utils/xml":48}],28:[function(t,e,n){function i(t){if(!(this instanceof i))return new i(t);this.adSystem=s.keyValue(t.adSystem),this.impressions=r.parseImpressions(t.impression),this.VASTAdTagURI=s.keyValue(t.vASTAdTagURI),this.creatives=o.parseCreatives(t.creatives),this.error=s.keyValue(t.error),this.extensions=t.extensions,this.followAdditionalWrappers=!a.isDefined(s.attr(t,"followAdditionalWrappers"))||s.attr(t,"followAdditionalWrappers"),this.allowMultipleAds=s.attr(t,"allowMultipleAds"),this.fallbackOnNoAd=s.attr(t,"fallbackOnNoAd")}var r=t("./vastUtil"),o=t("./Creative"),a=t("../../utils/utilityFunctions"),s=t("../../utils/xml");e.exports=i},{"../../utils/utilityFunctions":47,"../../utils/xml":48,"./Creative":17,"./vastUtil":30}],29:[function(t,e,n){var i=t("../../utils/utilityFunctions"),r=/(\d\d):(\d\d):(\d\d)(\.(\d\d\d))?/,o={duration:function(t){var e,n;return i.isString(t)&&(e=t.match(r))&&(n=function(t){return 60*parseInt(t,10)*60*1e3}(e[1])+function(t){return 60*parseInt(t,10)*1e3}(e[2])+function(t){return 1e3*parseInt(t,10)}(e[3])+parseInt(e[5]||0)),isNaN(n)?null:n},offset:function(t,e){function n(t,e){return t*e/100}return function(t){return/^\d+(\.\d+)?%$/g.test(t)}(t)?function(t,e){return e?n(e,parseFloat(t.replace("%",""))):null}(t,e):o.duration(t)}};e.exports=o},{"../../utils/utilityFunctions":47}],30:[function(t,e,n){var i=t("../../utils/utilityFunctions"),r=t("../vpaid/VPAIDHTML5Tech"),o=t("../vpaid/VPAIDFlashTech"),a=t("VPAIDFLASHClient/js/VPAIDFLASHClient"),s={track:function(t,e){var n=s.parseURLMacros(t,e),i=[];return n.forEach(function(t){var e=new Image;e.src=t,i.push(e)}),i},parseURLMacros:function(t,e){var n=[];return e=e||{},e.CACHEBUSTING||(e.CACHEBUSTING=Math.round(1e10*Math.random())),t.forEach(function(t){n.push(s._parseURLMacro(t,e))}),n},parseURLMacro:function(t,e){return e=e||{},e.CACHEBUSTING||(e.CACHEBUSTING=Math.round(1e10*Math.random())),s._parseURLMacro(t,e)},_parseURLMacro:function(t,e){return e=e||{},i.forEach(e,function(e,n){t=t.replace(new RegExp("\\["+n+"\\]","gm"),e)}),t},parseDuration:function(t){var e,n,r=/(\d\d):(\d\d):(\d\d)(\.(\d\d\d))?/;return i.isString(t)&&(e=t.match(r))&&(n=function(t){return 60*parseInt(t,10)*60*1e3}(e[1])+function(t){return 60*parseInt(t,10)*1e3}(e[2])+function(t){return 1e3*parseInt(t,10)}(e[3])+parseInt(e[5]||0)),isNaN(n)?null:n},parseImpressions:function(t){return t?(t=i.isArray(t)?t:[t],i.transformArray(t,function(t){if(i.isNotEmptyString(t.keyValue))return t.keyValue})):[]},formatProgress:function(t){var e,n,r,o;return e=t/36e5,e=Math.floor(e),n=t/6e4%60,n=Math.floor(n),r=t/1e3%60,r=Math.floor(r),o=t%1e3,i.toFixedDigits(e,2)+":"+i.toFixedDigits(n,2)+":"+i.toFixedDigits(r,2)+"."+i.toFixedDigits(o,3)},parseOffset:function(t,e){function n(t,e){return t*e/100}return function(t){return/^\d+(\.\d+)?%$/g.test(t)}(t)?function(t,e){return e?n(e,parseFloat(t.replace("%",""))):null}(t,e):s.parseDuration(t)},VPAID_techs:[o,r],isVPAID:function(t){return!!t&&"VPAID"===t.apiFramework},findSupportedVPAIDTech:function(t){var e,n,i;for(e=0,n=this.VPAID_techs.length;e<n;e+=1)if(i=this.VPAID_techs[e],i.supports(t))return i;return null},isFlashSupported:function(){return a.isSupported()},runFlashSupportCheck:function(t){a.runFlashTest({data:t})}};e.exports=s},{"../../utils/utilityFunctions":47,"../vpaid/VPAIDFlashTech":32,"../vpaid/VPAIDHTML5Tech":33,"VPAIDFLASHClient/js/VPAIDFLASHClient":3}],31:[function(t,e,n){function i(t,e){if(!(this instanceof i))return new i(t,e);!function(t,e){if(!t||!i.checkVPAIDInterface(t))throw new r("on VPAIDAdUnitWrapper, the passed VPAID adUnit does not fully implement the VPAID interface");if(!o.isObject(e))throw new r("on VPAIDAdUnitWrapper, expected options hash  but got '"+e+"'");if(!("responseTimeout"in e&&o.isNumber(e.responseTimeout)))throw new r("on VPAIDAdUnitWrapper, expected responseTimeout in options")}(t,e),this.options=o.extend({},e),this._adUnit=t}var r=t("../vast/VASTError"),o=t("../../utils/utilityFunctions");i.checkVPAIDInterface=function(t){for(var e=["handshakeVersion","initAd","startAd","stopAd","resizeAd","pauseAd","expandAd","collapseAd"],n=0,i=e.length;n<i;n++)if(!t||!o.isFunction(t[e[n]]))return!1;return function(t){return o.isFunction(t.subscribe)||o.isFunction(t.addEventListener)||o.isFunction(t.on)}(t)&&function(t){return o.isFunction(t.unsubscribe)||o.isFunction(t.removeEventListener)||o.isFunction(t.off)}(t)},i.prototype.adUnitAsyncCall=function(){var t,e=o.arrayLikeObjToArray(arguments),n=e.shift(),i=e.pop();!function(t,e,n){if(!o.isString(t)||!o.isFunction(n[t]))throw new r("on VPAIDAdUnitWrapper.adUnitAsyncCall, invalid method name");if(!o.isFunction(e))throw new r("on VPAIDAdUnitWrapper.adUnitAsyncCall, missing callback")}(n,i,this._adUnit),e.push(function(){return function(){t&&clearTimeout(t),i.apply(this,arguments)}}()),this._adUnit[n].apply(this._adUnit,e),t=setTimeout(function(){t=null,i(new r("on VPAIDAdUnitWrapper, timeout while waiting for a response on call '"+n+"'")),i=o.noop},this.options.responseTimeout)},i.prototype.on=function(t,e){(this._adUnit.addEventListener||this._adUnit.subscribe||this._adUnit.on).call(this._adUnit,t,e)},i.prototype.off=function(t,e){(this._adUnit.removeEventListener||this._adUnit.unsubscribe||this._adUnit.off).call(this._adUnit,t,e)},i.prototype.waitForEvent=function(t,e,n){function i(){var t=o.arrayLikeObjToArray(arguments);a&&(clearTimeout(a),a=null),t.unshift(null),e.apply(n,t)}var a;!function(t,e){if(!o.isString(t))throw new r("on VPAIDAdUnitWrapper.waitForEvent, missing evt name");if(!o.isFunction(e))throw new r("on VPAIDAdUnitWrapper.waitForEvent, missing callback")}(t,e),n=n||null,this.on(t,i),a=setTimeout(function(){e(new r("on VPAIDAdUnitWrapper.waitForEvent, timeout while waiting for event '"+t+"'")),a=null,e=o.noop},this.options.responseTimeout)},i.prototype.handshakeVersion=function(t,e){this.adUnitAsyncCall("handshakeVersion",t,e)},i.prototype.initAd=function(t,e,n,i,r,o){this.waitForEvent("AdLoaded",o),this._adUnit.initAd(t,e,n,i,r)},i.prototype.resizeAd=function(t,e,n,i){this.adUnitAsyncCall("resizeAd",t,e,n,i)},i.prototype.startAd=function(t){this.waitForEvent("AdStarted",t),this._adUnit.startAd()},i.prototype.stopAd=function(t){this.waitForEvent("AdStopped",t),this._adUnit.stopAd()},i.prototype.pauseAd=function(t){this.waitForEvent("AdPaused",t),this._adUnit.pauseAd()},i.prototype.resumeAd=function(t){this.waitForEvent("AdPlaying",t),this._adUnit.resumeAd()},i.prototype.expandAd=function(t){this.waitForEvent("AdExpandedChange",t),this._adUnit.expandAd()},i.prototype.collapseAd=function(t){this.waitForEvent("AdExpandedChange",t),this._adUnit.collapseAd()},i.prototype.skipAd=function(t){this.waitForEvent("AdSkipped",t),this._adUnit.skipAd()},["adLinear","adWidth","adHeight","adExpanded","adSkippableState","adRemainingTime","adDuration","adVolume","adCompanions","adIcons"].forEach(function(t){var e="get"+o.capitalize(t);i.prototype[e]=function(t){this.adUnitAsyncCall(e,t)}}),i.prototype.setAdVolume=function(t,e){this.adUnitAsyncCall("setAdVolume",t,e)},e.exports=i},{"../../utils/utilityFunctions":47,"../vast/VASTError":23}],32:[function(t,e,n){function i(t,e){if(!(this instanceof i))return new i(t);!function(t){if(!t||!s.isString(t.src))throw new o("on VPAIDFlashTech, invalid MediaFile")}(t),this.name="vpaid-flash",this.mediaFile=t,this.containerEl=null,this.vpaidFlashClient=null,this.settings=e}var r=t("../../utils/mimetypes"),o=t("../vast/VASTError"),a=t("VPAIDFLASHClient/js/VPAIDFLASHClient"),s=t("../../utils/utilityFunctions"),l=t("../../utils/dom"),u=t("../../utils/consoleLogger");i.VPAIDFLASHClient=a,i.supports=function(t){return r.flash.indexOf(t)>-1&&i.VPAIDFLASHClient.isSupported()},i.prototype.loadAdUnit=function(t,e,n){var r=this,a=this.settings&&this.settings.vpaidFlashLoaderPath?{data:this.settings.vpaidFlashLoaderPath}:void 0;!function(t,e){if(!l.isDomElement(t))throw new o("on VPAIDFlashTech.loadAdUnit, invalid dom container element");if(!s.isFunction(e))throw new o("on VPAIDFlashTech.loadAdUnit, missing valid callback")}(t,n),this.containerEl=t,u.debug("<VPAIDFlashTech.loadAdUnit> loading VPAIDFLASHClient with opts:",a),this.vpaidFlashClient=new i.VPAIDFLASHClient(t,function(t){if(t)return n(t);u.info("<VPAIDFlashTech.loadAdUnit> calling VPAIDFLASHClient.loadAdUnit(); that.mediaFile:",r.mediaFile),r.vpaidFlashClient.loadAdUnit(r.mediaFile.src,n)},a)},i.prototype.unloadAdUnit=function(){if(this.vpaidFlashClient){try{this.vpaidFlashClient.destroy()}catch(t){u.error("VAST ERROR: trying to unload the VPAID adunit")}this.vpaidFlashClient=null}this.containerEl&&(l.remove(this.containerEl),this.containerEl=null)},e.exports=i},{"../../utils/consoleLogger":41,"../../utils/dom":42,"../../utils/mimetypes":44,"../../utils/utilityFunctions":47,"../vast/VASTError":23,"VPAIDFLASHClient/js/VPAIDFLASHClient":3}],33:[function(t,e,n){function i(t){if(!(this instanceof i))return new i(t);!function(t){if(!t||!s.isString(t.src))throw new o(i.INVALID_MEDIA_FILE)}(t),this.name="vpaid-html5",this.containerEl=null,this.videoEl=null,this.vpaidHTMLClient=null,this.mediaFile=t}var r=t("../../utils/mimetypes"),o=t("../vast/VASTError"),a=t("VPAIDHTML5Client/js/VPAIDHTML5Client"),s=t("../../utils/utilityFunctions"),l=t("../../utils/dom"),u=t("../../utils/consoleLogger");i.VPAIDHTML5Client=a,i.supports=function(t){return!s.isOldIE()&&r.html5.indexOf(t)>-1},i.prototype.loadAdUnit=function(t,e,n){!function(t,e,n){if(!l.isDomElement(t))throw new o(i.INVALID_DOM_CONTAINER_EL);if(!l.isDomElement(e)||"video"!==e.tagName.toLowerCase())throw new o(i.INVALID_DOM_CONTAINER_EL);if(!s.isFunction(n))throw new o(i.MISSING_CALLBACK)}(t,e,n),this.containerEl=t,this.videoEl=e,this.vpaidHTMLClient=new i.VPAIDHTML5Client(t,e,{}),this.vpaidHTMLClient.loadAdUnit(this.mediaFile.src,n)},i.prototype.unloadAdUnit=function(){if(this.vpaidHTMLClient){try{this.vpaidHTMLClient.destroy()}catch(t){u.error("VAST ERROR: trying to unload the VPAID adunit")}this.vpaidHTMLClient=null}this.containerEl&&(l.remove(this.containerEl),this.containerEl=null)};var c="on VPAIDHTML5Tech";i.INVALID_MEDIA_FILE=c+", invalid MediaFile",i.INVALID_DOM_CONTAINER_EL=c+", invalid container HtmlElement",i.INVALID_DOM_VIDEO_EL=c+", invalid HTMLVideoElement",i.MISSING_CALLBACK=c+", missing valid callback",e.exports=i},{"../../utils/consoleLogger":41,"../../utils/dom":42,"../../utils/mimetypes":44,"../../utils/utilityFunctions":47,"../vast/VASTError":23,"VPAIDHTML5Client/js/VPAIDHTML5Client":11}],34:[function(t,e,n){function i(t,e){if(!(this instanceof i))return new i(t);this.VIEW_MODE={NORMAL:"normal",FULLSCREEN:"fullscreen",THUMBNAIL:"thumbnail"},this.player=t,this.containerEl=function(){var e=document.createElement("div");return p.addClass(e,"VPAID-container"),t.el().insertBefore(e,t.controlBar.el()),e}(),this.options={responseTimeout:5e3,VPAID_VERSION:"2.0"},this.settings=e}function r(t,e,n){var i=t.el().querySelector(".vjs-tech"),r=p.getDimension(i),a=t.isFullscreen()?n.FULLSCREEN:n.NORMAL;e.resizeAd(r.width,r.height,a,o)}function o(t){t&&v.error("ERROR: "+t.message,t)}var a=t("../../utils/mimetypes"),s=t("../vast/VASTError"),l=t("../vast/VASTResponse"),u=t("../vast/VASTTracker"),c=t("../vast/vastUtil"),h=t("./VPAIDAdUnitWrapper"),d=t("../../utils/async"),p=t("../../utils/dom"),f=t("../../utils/playerUtils"),m=t("../../utils/utilityFunctions"),v=t("../../utils/consoleLogger");i.prototype.playAd=function(t,e){function n(t,n,i){t&&i&&o._trackError(i,t.code),a.trigger("vpaid.adEnd"),e(t,i)}function i(){a.trigger("vpaid.adEnd")}function r(){u&&u.unloadAdUnit(),p.removeClass(a.el(),"vjs-vpaid-ad")}if(!(t instanceof l))return e(new s("on VASTIntegrator.playAd, missing required VASTResponse"));var o=this,a=this.player;v.debug("<VPAIDIntegrator.playAd> looking for supported tech...");var u=this._findSupportedTech(t,this.settings);if(e=e||m.noop,this._adUnit=null,p.addClass(a.el(),"vjs-vpaid-ad"),a.on("vast.adsCancel",i),a.one("vpaid.adEnd",function(){a.off("vast.adsCancel",i),r()}),u)v.info("<VPAIDIntegrator.playAd> found tech: ",u),d.waterfall([function(e){e(null,u,t)},this._loadAdUnit.bind(this),this._playAdUnit.bind(this),this._finishPlaying.bind(this)],n),this._adUnit={_paused:!0,type:"VPAID",pauseAd:function(){a.trigger("vpaid.pauseAd"),a.pause(!0)},resumeAd:function(){a.trigger("vpaid.resumeAd")},isPaused:function(){return this._paused},getSrc:function(){return u.mediaFile}};else{v.debug("<VPAIDIntegrator.playAd> could not find suitable tech");n(new s("on VPAIDIntegrator.playAd, could not find a supported mediaFile",403),this._adUnit,t)}return this._adUnit},i.prototype._findSupportedTech=function(t,e){if(!(t instanceof l))return null;var n,i,r,o,s=t.mediaFiles.filter(c.isVPAID),u=e&&e.preferredTech,h=[];for(n=0,i=s.length;n<i;n+=1)if(r=s[n],o=c.findSupportedVPAIDTech(r.type)){if(!!u&&(r.type===u||a[u]&&a[u].indexOf(r.type)>-1))return new o(r,e);h.push({mediaFile:r,tech:o})}if(h.length){var d=h[0];return new d.tech(d.mediaFile,e)}return null},i.prototype._createVPAIDAdUnitWrapper=function(t,e,n){return new h(t,{src:e,responseTimeout:n})},i.prototype._loadAdUnit=function(t,e,n){var i=this,r=this.player,o=r.el().querySelector(".vjs-tech"),a=this.settings.responseTimeout||this.options.responseTimeout;t.loadAdUnit(this.containerEl,o,function(o,s){if(o)return n(o,s,e);try{var l=i._createVPAIDAdUnitWrapper(s,t.mediaFile.src,a),u="vjs-"+t.name+"-ad";p.addClass(r.el(),u),r.one("vpaid.adEnd",function(){p.removeClass(r.el(),u)}),n(null,l,e)}catch(t){n(t,s,e)}})},i.prototype._playAdUnit=function(t,e,n){d.waterfall([function(n){n(null,t,e)},this._handshake.bind(this),this._initAd.bind(this),this._setupEvents.bind(this),this._addSkipButton.bind(this),this._linkPlayerControls.bind(this),this._startAd.bind(this)],n)},i.prototype._handshake=function(t,e,n){function i(t){var e=r(t);return e>=1&&e<=2}function r(t){var e=t.split(".");return parseInt(e[0],10)}t.handshakeVersion(this.options.VPAID_VERSION,function(r,o){return r?n(r,t,e):o&&i(o)?n(null,t,e):n(new s('on VPAIDIntegrator._handshake, unsupported version "'+o+'"'),t,e)})},i.prototype._initAd=function(t,e,n){var i=this.player.el().querySelector(".vjs-tech"),r=p.getDimension(i);t.initAd(r.width,r.height,this.VIEW_MODE.NORMAL,-1,{AdParameters:e.adParameters||""},function(i){n(i,t,e)})},i.prototype._createVASTTracker=function(t,e){return new u(t,e)},i.prototype._setupEvents=function(t,e,n){function i(){d._adUnit&&d._adUnit.isPaused()&&(d._adUnit._paused=!1),h.trigger("play")}function o(){d._adUnit&&(d._adUnit._paused=!0),h.trigger("pause")}function a(){t.pauseAd(m.noop)}function s(){t.resumeAd(m.noop)}var l=t.options.src,u=this._createVASTTracker(l,e),h=this.player,d=this;t.on("AdSkipped",function(){h.trigger("vpaid.AdSkipped"),u.trackSkip()}),t.on("AdImpression",function(){h.trigger("vpaid.AdImpression"),u.trackImpressions()}),t.on("AdStarted",function(){h.trigger("vpaid.AdStarted"),u.trackCreativeView(),i()}),t.on("AdVideoStart",function(){h.trigger("vpaid.AdVideoStart"),u.trackStart(),i()}),t.on("AdPlaying",function(){h.trigger("vpaid.AdPlaying"),u.trackResume(),i()}),t.on("AdPaused",function(){h.trigger("vpaid.AdPaused"),u.trackPause(),o()}),t.on("AdVideoFirstQuartile",function(){h.trigger("vpaid.AdVideoFirstQuartile"),u.trackFirstQuartile()}),t.on("AdVideoMidpoint",function(){h.trigger("vpaid.AdVideoMidpoint"),u.trackMidpoint()}),t.on("AdVideoThirdQuartile",function(){h.trigger("vpaid.AdVideoThirdQuartile"),u.trackThirdQuartile()}),t.on("AdVideoComplete",function(){h.trigger("vpaid.AdVideoComplete"),u.trackComplete()}),t.on("AdClickThru",function(n){h.trigger("vpaid.AdClickThru");var i=n.url,r=n.playerHandles,o=m.isNotEmptyString(i)?i:function(e){var n={ASSETURI:t.options.src,CONTENTPLAYHEAD:0};return e?c.parseURLMacro(e,n):null}(e.clickThrough);u.trackClick(),r&&o&&window.open(o,"_blank")}),t.on("AdUserAcceptInvitation",function(){h.trigger("vpaid.AdUserAcceptInvitation"),u.trackAcceptInvitation(),u.trackAcceptInvitationLinear()}),t.on("AdUserClose",function(){h.trigger("vpaid.AdUserClose"),u.trackClose(),u.trackCloseLinear()}),t.on("AdUserMinimize",function(){h.trigger("vpaid.AdUserMinimize"),u.trackCollapse()}),t.on("AdError",function(){h.trigger("vpaid.AdError"),u.trackErrorWithCode(901)}),t.on("AdVolumeChange",function(){h.trigger("vpaid.AdVolumeChange");var e=h.volume();t.getAdVolume(function(t,n){e!==n&&(0===n&&e>0&&u.trackMute(),n>0&&0===e&&u.trackUnmute(),h.volume(n))})});var f=r.bind(this,h,t,this.VIEW_MODE),v=m.throttle(f,100),g=this.settings.autoResize;g&&(p.addEventListener(window,"resize",v),p.addEventListener(window,"orientationchange",v)),h.on("vast.resize",f),h.on("vpaid.pauseAd",a),h.on("vpaid.resumeAd",s),h.one("vpaid.adEnd",function(){h.off("vast.resize",f),h.off("vpaid.pauseAd",a),h.off("vpaid.resumeAd",s),g&&(p.removeEventListener(window,"resize",v),p.removeEventListener(window,"orientationchange",v))}),n(null,t,e)},i.prototype._addSkipButton=function(t,e,n){function i(){l.trigger("vpaid.AdSkippableStateChange"),t.getAdSkippableState(function(t,e){e?s||r(l):o()})}function r(t){return s=a(),t.el().appendChild(s),s}function o(){p.remove(s),s=null}function a(){var e=window.document.createElement("div");return p.addClass(e,"vast-skip-button"),e.innerHTML="05",e.onclick=function(e){if(t.skipAd(m.noop),void 0===window.Event.prototype.stopPropagation)return!1;e.stopPropagation()},e}var s,l=this.player;if(t.on("AdSkippableStateChange",i),f.once(l,["vast.adEnd","vast.adsCancel"],o),n(null,t,e),window.videovastForce){var u=function(t){var t=parseInt(t);return t<10?"0"+t:t},c=r(l),h=e.skipoffset/1e3,d=function e(){$(c).text("ÙÙØ§ÛØ´ ÙÛØ¯ÛÙ "+u(h-parseInt(l.currentTime()))).removeClass("enabled"),parseInt(l.currentTime())>h&&($(c).text("ÙÙØ§ÛØ´ ÙÛØ¯ÛÙ").addClass("enabled"),l.off("timeupdate",e),$(c).on("tap",function(e){if(l.currentTime(1e6),t.skipAd(m.noop),void 0===window.Event.prototype.stopPropagation)return!1;e.stopPropagation()}),c.onclick=function(e){if(l.currentTime(1e6),t.skipAd(m.noop),void 0===window.Event.prototype.stopPropagation)return!1;e.stopPropagation()})};l.on("timeupdate",d)}},i.prototype._linkPlayerControls=function(t,e,n){var i=this;!function(t,e){function n(){var n=t.muted()?0:t.volume();e.setAdVolume(n,o)}function i(){t.trigger("vpaid.AdVolumeChange");var n=t.volume();e.getAdVolume(function(e,i){e?o(e):n!==i&&t.volume(i)})}t.on("volumechange",n),e.on("AdVolumeChange",i),t.one("vpaid.adEnd",function(){t.off("volumechange",n)})}(this.player,t),function(t,e,n){var o=r.bind(i,t,e,n);t.on("fullscreenchange",o),t.one("vpaid.adEnd",function(){t.off("fullscreenchange",o)})}(this.player,t,this.VIEW_MODE),n(null,t,e)},i.prototype._startAd=function(t,e,n){var i=this.player;t.startAd(function(r){r||i.trigger("vast.adStart"),n(r,t,e)})},i.prototype._finishPlaying=function(t,e,n){function i(i){n(i,t,e)}var r=this.player;t.on("AdStopped",function(){r.trigger("vpaid.AdStopped"),i(null)}),t.on("AdError",function(t){var e=t?t.message:"on VPAIDIntegrator, error while waiting for the adUnit to finish playing";i(new s(e))})},i.prototype._trackError=function(t,e){c.track(t.errorURLMacros,{ERRORCODE:e||901})},e.exports=i},{"../../utils/async":40,"../../utils/consoleLogger":41,"../../utils/dom":42,"../../utils/mimetypes":44,"../../utils/playerUtils":45,"../../utils/utilityFunctions":47,"../vast/VASTError":23,"../vast/VASTResponse":25,"../vast/VASTTracker":26,"../vast/vastUtil":30,"./VPAIDAdUnitWrapper":31}],35:[function(t,e,n){var i=t("../../utils/dom"),r=document.createElement("div");r.className="vjs-ads-label vjs-control vjs-label-hidden",r.innerHTML="ØªØ¨ÙÛØº";var o=function(t){return{init:function(e,n){n.el=r,t.call(this,e,n),setTimeout(function(){var t=e.controlBar&&(e.controlBar.getChild("timerControls")||e.controlBar.getChild("currentTimeDisplay"));t&&e.controlBar.el().insertBefore(r,t.el()),i.removeClass(r,"vjs-label-hidden")},0)},el:function(){return r}}};e.exports=o},{"../../utils/dom":42}],36:[function(t,e,n){var i=k.default.getComponent("Component"),r=t("./ads-label")(i);k.default.registerComponent("AdsLabel",k.default.extend(i,r))},{"./ads-label":35}],37:[function(t,e,n){var i=document.createElement("div"),r=function(t){return{init:function(e,n){n.el=i,t.call(this,e,n);var r=e.getChild("posterImage");setTimeout(function(){r&&e&&e.el()&&e.el().insertBefore(i,r.el())},0)},el:function(){return i}}};e.exports=r},{}],38:[function(t,e,n){var i=k.default.getComponent("Component"),r=t("./black-poster")(i);k.default.registerComponent("BlackPoster",k.default.extend(i,r))},{"./black-poster":37}],39:[function(t,e,n){var i=t("../ads/vast/VASTClient"),r=t("../ads/vast/VASTError"),o=t("../ads/vast/vastUtil"),a=t("../ads/vast/VASTIntegrator"),s=t("../ads/vpaid/VPAIDIntegrator"),u=t("../utils/async"),c=t("../utils/dom"),h=t("../utils/playerUtils"),d=t("../utils/utilityFunctions"),p=t("../utils/consoleLogger");e.exports=function(t){function e(){function t(){_.vast&&_.vast.adUnit&&(_.vast.adUnit=null)}function e(){n(),b&&(h.restorePlayerSnapshot(_,b),b=null)}function n(){h.once(_,["playing","vast.reset","vast.firstPlay"],function(t){"playing"===t.type&&(_.trigger("vast.contentStart"),h.once(_,["ended","vast.reset","vast.firstPlay"],function(t){"ended"===t.type&&_.trigger("vast.contentEnd")}))})}function i(t){if(E.adsEnabled)return t(null);t(new r("Ads are not enabled"))}function o(t){a()?(b=h.getPlayerSnapshot(_),_.pause(),l(),_.paused()?t(null):h.once(_,["playing"],function(){_.pause(),t(null)})):t(new r("video content has been playing before preroll ad"))}function a(){return!d.isIPhone()||_.currentTime()<=E.iosPrerollCancelTimeout}function s(t){function e(){n&&(clearTimeout(n),n=null)}var n;T=!1,n=setTimeout(function(){g(new r("timeout while waiting for the video to start playing",402))},E.adCancelTimeout),h.once(_,["vast.adStart","vast.adsCancel"],e),t(null)}function l(){c.addClass(_.el(),"vjs-vast-ad-loading"),h.once(_,["vast.adStart","vast.adsCancel"],p)}function p(){setTimeout(function(){c.removeClass(_.el(),"vjs-vast-ad-loading")},100)}h.once(_,["vast.adsCancel","vast.adEnd"],function(){t(),e()}),u.waterfall([i,o,s,f],function(t,e){t?g(t,e):_.trigger("vast.adEnd")})}function n(){_.trigger("vast.adsCancel"),T=!0}function f(t){u.waterfall([m,v],t)}function m(t){w.getVASTResponse(E.adTagUrl?E.adTagUrl():E.adTagXML,t)}function v(t,e){function n(){o||_.controlBar.getChild("AdsLabel")||_.controlBar.addChild("AdsLabel")}function i(){_.controlBar.removeChild("AdsLabel"),o=!0}if(!T){var r=y(t)?new s(_,E):new a(_),o=!1;h.once(_,["vast.adStart","vast.adsCancel"],function(t){"vast.adStart"===t.type&&n()}),h.once(_,["vast.adEnd","vast.adsCancel"],i),d.isIDevice()&&function(){function t(){_.duration()-r>i&&(_.pause(!0),_.play(!0),_.currentTime(r))}function e(){var t=_.currentTime();Math.abs(t-r)>i?(o+=1,o>=2&&_.pause(!0),_.currentTime(r)):r=t}function n(){_.off("timeupdate",e),_.off("ended",t)}var i=3,r=0,o=0;_.on("timeupdate",e),_.on("ended",t),h.once(_,["vast.adEnd","vast.adsCancel","vast.adError"],n)}();var u=JSON.parse(t.adParameters);u.videoSources&&u.videoSources[0]&&(u.videoSources[0].file=u.cdnHost+function(t){var e;return $.each(t,function(t,n){"video/mp4"==n.mime&&(e=n.file)}),e}(u.videoSources),$.each(u.videoSources,function(t,e){e.file=u.videoSources[0].file,e.mime="video/mp4",e.codecs="Theora"}),t.adParameters=(0,l.default)(u),window.videovastForce=!0),t.skipoffset=5e3,_.vast.vastResponse=t,p.debug("calling adIntegrator.playAd() with vastResponse:",t),_.vast.adUnit=r.playAd(t,e)}}function g(t,e){_.trigger({type:"vast.adError",error:t}),n(),p.error("AD ERROR:",t.message,t,e)}function y(t){var e,n,i=t.mediaFiles;for(e=0,n=i.length;e<n;e++)if(o.isVPAID(i[e]))return!0;return!1}var b,_=this,w=new i,T=!1,x={timeout:500,iosPrerollCancelTimeout:2e3,adCancelTimeout:3e3,playAdAlways:!1,adsEnabled:!0,autoResize:!0,vpaidFlashLoaderPath:"/VPAIDFlash.swf",verbosity:0},E=d.extend({},x,t||{});return d.isUndefined(E.adTagUrl)&&d.isDefined(E.url)&&(E.adTagUrl=E.url),d.isString(E.adTagUrl)&&(E.adTagUrl=d.echoFn(E.adTagUrl)),d.isDefined(E.adTagXML)&&!d.isFunction(E.adTagXML)?g(new r("on VideoJS VAST plugin, the passed adTagXML option does not contain a function")):d.isDefined(E.adTagUrl)||d.isFunction(E.adTagXML)?(p.setVerbosity(E.verbosity),o.runFlashSupportCheck(E.vpaidFlashLoaderPath),h.prepareForAds(_),E.playAdAlways&&_.on("vast.contentEnd",function(){setTimeout(function(){_.trigger("vast.reset")},0)}),_.on("vast.firstPlay",e),_.on("vast.reset",function(){b=null,n()}),_.vast={isEnabled:function(){return E.adsEnabled},enable:function(){E.adsEnabled=!0},disable:function(){E.adsEnabled=!1}},_.vast):g(new r("on VideoJS VAST plugin, missing adTagUrl on options object"))}},{"../ads/vast/VASTClient":22,"../ads/vast/VASTError":23,"../ads/vast/VASTIntegrator":24,"../ads/vast/vastUtil":30,"../ads/vpaid/VPAIDIntegrator":34,"../utils/async":40,"../utils/consoleLogger":41,"../utils/dom":42,"../utils/playerUtils":45,"../utils/utilityFunctions":47}],40:[function(t,e,n){var i=t("./utilityFunctions"),r={};r.setImmediate=function(t){setTimeout(t,0)},r.iterator=function(t){return function e(n){var i=function e(){return t.length&&t[n].apply(null,arguments),e.next()};return i.next=function(){return n<t.length-1?e(n+1):null},i}(0)},r.waterfall=function(t,e){if(e=e||function(){},!i.isArray(t)){var n=new Error("First argument to waterfall must be an array of functions");return e(n)}if(!t.length)return e();!function t(n){return function(i){if(i)e.apply(null,arguments),e=function(){};else{var o=Array.prototype.slice.call(arguments,1),a=n.next();a?o.push(t(a)):o.push(e),r.setImmediate(function(){n.apply(null,o)})}}}(r.iterator(t))()},r.when=function(t,e){if(!i.isFunction(e))throw new Error("async.when error: missing callback argument");var n=i.isFunction(t)?t:function(){return!!t};return function(){var t=i.arrayLikeObjToArray(arguments),r=t.pop();return n.apply(null,t)?e.apply(this,arguments):(t.unshift(null),r.apply(null,t))}},e.exports=r},{"./utilityFunctions":47}],41:[function(t,e,n){function i(t){c=t}function r(t,e){e.length>0&&"string"==typeof e[0]&&(e[0]=h+e[0]),t.apply?t.apply(console,Array.prototype.slice.call(e)):t(Array.prototype.slice.call(e))}function o(){c<4||(void 0===console.debug?r(console.log,arguments):r(console.debug,arguments))}function a(){c<3||r(console.log,arguments)}function s(){c<2||r(console.info,arguments)}function l(){c<1||r(console.warn,arguments)}function u(){r(console.error,arguments)}var c=0,h="[videojs-vast-vpaid] ",d={setVerbosity:i,debug:o,log:a,info:s,warn:l,error:u};"undefined"!=typeof console&&console.log||(d.debug=function(){},d.log=function(){},d.info=function(){},d.warn=function(){},d.error=function(){}),e.exports=d},{}],42:[function(t,e,n){var i=t("./utilityFunctions"),r={};r.isVisible=function(t){return"hidden"!==window.getComputedStyle(t).visibility},r.isHidden=function(t){return"none"===window.getComputedStyle(t).display},r.isShown=function(t){return!r.isHidden(t)},r.hide=function(t){t.__prev_style_display_=t.style.display,t.style.display="none"},r.show=function(t){r.isHidden(t)&&(t.style.display=t.__prev_style_display_),t.__prev_style_display_=void 0},r.hasClass=function(t,e){var n,r,o;if(i.isNotEmptyString(e)){if(t.classList)return t.classList.contains(e);for(n=i.isString(t.getAttribute("class"))?t.getAttribute("class").split(/\s+/):[],e=e||"",r=0,o=n.length;r<o;r+=1)if(n[r]===e)return!0}return!1},r.addClass=function(t,e){var n;if(i.isNotEmptyString(e)){if(t.classList)return t.classList.add(e);n=i.isString(t.getAttribute("class"))?t.getAttribute("class").split(/\s+/):[],i.isString(e)&&i.isNotEmptyString(e.replace(/\s+/,""))&&(n.push(e),t.setAttribute("class",n.join(" ")))}},r.removeClass=function(t,e){var n;if(i.isNotEmptyString(e)){if(t.classList)return t.classList.remove(e);n=i.isString(t.getAttribute("class"))?t.getAttribute("class").split(/\s+/):[];var r,o,a=[];if(i.isString(e)&&i.isNotEmptyString(e.replace(/\s+/,""))){for(r=0,o=n.length;r<o;r+=1)e!==n[r]&&a.push(n[r]);t.setAttribute("class",a.join(" "))}}},r.addEventListener=function(t,e,n){return i.isArray(t)?void i.forEach(t,function(t){r.addEventListener(t,e,n)}):i.isArray(e)?void i.forEach(e,function(e){r.addEventListener(t,e,n)}):void(t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent&&t.attachEvent("on"+e,n))},r.removeEventListener=function(t,e,n){return i.isArray(t)?void i.forEach(t,function(t){r.removeEventListener(t,e,n)}):i.isArray(e)?void i.forEach(e,function(e){r.removeEventListener(t,e,n)}):void(t.removeEventListener?t.removeEventListener(e,n,!1):t.detachEvent?t.detachEvent("on"+e,n):t["on"+e]=null)},r.dispatchEvent=function(t,e){t.dispatchEvent?t.dispatchEvent(e):t.fireEvent("on"+e.eventType,e)},r.isDescendant=function(t,e){for(var n=e.parentNode;null!==n;){if(n===t)return!0;n=n.parentNode}return!1},r.getTextContent=function(t){return t.textContent||t.text},r.prependChild=function(t,e){return e.parentNode&&e.parentNode.removeChild(e),t.insertBefore(e,t.firstChild)},r.remove=function(t){t&&t.parentNode&&t.parentNode.removeChild(t)},r.isDomElement=function(t){return t instanceof Element},r.click=function(t,e){r.addEventListener(t,"click",e)},r.once=function(t,e,n){function i(){n.apply(null,arguments),r.removeEventListener(t,e,i)}r.addEventListener(t,e,i)},r.getDimension=function(t){var e;return!i.isOldIE()&&t.getBoundingClientRect?(e=t.getBoundingClientRect(),{width:e.width,height:e.height}):{width:t.offsetWidth,height:t.offsetHeight}},e.exports=r},{"./utilityFunctions":47}],43:[function(t,e,n){function i(t){this.message="HttpRequest Error: "+(t||"")}function r(t){if(!s.isFunction(t))throw new i("Missing XMLHttpRequest factory method");this.createXhr=t}function o(){var t=new XMLHttpRequest;return"withCredentials"in t||(t=new XDomainRequest),t}var a=t("./urlUtils"),s=t("./utilityFunctions");i.prototype=new Error,i.prototype.name="HttpRequest Error",r.prototype.run=function(t,e,n,r){function o(){n(-1,null,null,"")}!function(t,e,n){if(!s.isString(t)||s.isEmptyString(t))throw new i("Invalid url '"+t+"'");if(!s.isFunction(e))throw new i("Invalid handler '"+e+"' for the http request");if(s.isDefined(n)&&!s.isObject(n))throw new i("Invalid options map '"+n+"'")}(e,n,r);var l,u,c=this.createXhr();r=r||{},l=s.isNumber(r.timeout)?r.timeout:0,c.open(t,a.urlParts(e).href,!0),r.headers&&function(t,e){s.forEach(e,function(e,n){s.isDefined(e)&&t.setRequestHeader(n,e)})}(c,r.headers),r.withCredentials&&(c.withCredentials=!0),c.onload=function(){var t,e,i;c.getAllResponseHeaders||(c.getAllResponseHeaders=function(){return null}),c.status||(c.status=200),s.isDefined(u)&&(clearTimeout(u),u=void 0),t=c.statusText||"",e="response"in c?c.response:c.responseText,i=1223===c.status?204:c.status,n(i,e,c.getAllResponseHeaders(),t)},c.onerror=o,c.onabort=o,c.send(),l>0&&(u=setTimeout(function(){c&&c.abort()},l))},r.prototype.get=function(t,e,n){function r(t,n,r,a){o(t)?e(null,n,t,r,a):e(new i(a),n,t,r,a)}function o(t){return 200<=t&&t<300}this.run("GET",t,r,n)};var l=new r(o);e.exports={http:l,HttpRequest:r,HttpRequestError:i,createXhr:o}},{"./urlUtils":46,"./utilityFunctions":47}],44:[function(t,e,n){e.exports={html5:["text/javascript","text/javascript1.0","text/javascript1.2","text/javascript1.4","text/jscript","application/javascript","application/x-javascript","text/ecmascript","text/ecmascript1.0","text/ecmascript1.2","text/ecmascript1.4","text/livescript","application/ecmascript","application/x-ecmascript"],flash:["application/x-shockwave-flash"]}},{}],45:[function(t,e,n){var i=t("./dom"),r=t("./utilityFunctions"),o={};o.getPlayerSnapshot=function(t){var e=t.el().querySelector(".vjs-tech"),n={ended:t.ended(),src:t.currentSrc(),currentTime:t.currentTime(),type:t.currentType(),playing:!t.paused(),suppressedTracks:function(t){var e=t.remoteTextTracks?t.remoteTextTracks():[];e&&r.isArray(e.tracks_)&&(e=e.tracks_),r.isArray(e)||(e=[]);var n=[];return e.forEach(function(t){n.push({track:t,mode:t.mode}),t.mode="disabled"}),n}(t)};return e&&(n.nativePoster=e.poster,n.style=e.getAttribute("style")),n},o.restorePlayerSnapshot=function(t,e){function n(){e.suppressedTracks.forEach(function(t){t.track.mode=t.mode})}function i(){if(!o.isReadyToResume(t)&&a--)setTimeout(i,50);else try{t.currentTime()!==e.currentTime?(e.playing&&t.one("seeked",function(){t.play()}),t.currentTime(e.currentTime)):e.playing&&t.play()}catch(t){k.default.log.warn("Failed to resume the content after an advertisement",t)}}var r=t.el().querySelector(".vjs-tech"),a=20;e.nativePoster&&(r.poster=e.nativePoster),"style"in e&&r.setAttribute("style",e.style||""),!function(t,e){return t.src()?t.src()!==e.src:t.currentSrc()!==e.src}(t,e)?(n(),e.playing&&t.play()):(t.one("contentloadedmetadata",n),t.one("canplay",i),function(){var e=setTimeout(function(){t.trigger("canplay")},1e3);t.one("canplay",function(){clearTimeout(e)})}(),t.src({src:e.src,type:e.type}),t.load())},o.isReadyToResume=function(t){return t.readyState()>1||(void 0===t.seekable()||t.seekable().length>0)},o.prepareForAds=function(t){function e(){return t.vast&&t.vast.adUnit}function n(){a()&&(m=!1,t.trigger("vast.firstPlay"))}function o(){m=!0,f.show(),l()}function a(){return m}function s(){return{muted:t.muted(),volume:t.volume()}}function l(){p&&(t.currentTime(0),u(p),p=null)}function u(e){r.isObject(e)&&(t.volume(e.volume),t.muted(e.muted))}function c(){i.hasClass(f.el(),"vjs-hidden")||f.hide()}function h(){i.addClass(t.el(),"vjs-ad-playing")}function d(){i.removeClass(t.el(),"vjs-ad-playing")}var p,f=t.addChild("blackPoster"),m=!0;!function(){var n=t.play;t.play=function(i){var o=this;return a()?function(){r.isIPhone()||(p=s(),t.muted(!0)),n.apply(o,arguments)}():function(i){e()&&!i?t.vast.adUnit.resumeAd():n.apply(o,arguments)}(i),this};var i=t.pause;t.pause=function(n){return e()&&!n?t.vast.adUnit.pauseAd():i.apply(this,arguments),this};var o=t.paused;t.paused=function(n){return e()&&!n?t.vast.adUnit.isPaused():o.apply(this,arguments)}}(),t.on("play",n),t.on("vast.reset",o),t.on("vast.firstPlay",l),t.on("error",c),t.on("vast.adStart",c),t.on("vast.adsCancel",c),t.on("vast.adError",c),t.on("vast.adStart",h),t.on("vast.adEnd",d),t.on("vast.adsCancel",d)},o.removeNativePoster=function(t){var e=t.el().querySelector(".vjs-tech");e&&e.removeAttribute("poster")},o.once=function(t,e,n){function i(){n.apply(null,arguments),e.forEach(function(e){t.off(e,i)})}e.forEach(function(e){t.on(e,i)})},e.exports=o},{"./dom":42,"./utilityFunctions":47}],46:[function(t,e,n){function i(t){var e=t;return l&&(s.setAttribute("href",e),e=s.href),s.setAttribute("href",e),{href:s.href,protocol:s.protocol?s.protocol.replace(/:$/,""):"",host:s.host,search:s.search?s.search.replace(/^\?/,""):"",hash:s.hash?s.hash.replace(/^#/,""):"",hostname:s.hostname,port:a.isNotEmptyString(s.port)?s.port:80,pathname:"/"===s.pathname.charAt(0)?s.pathname:"/"+s.pathname}}function r(t,e){var n,i;return e=a.isFunction(e)?e:function(){return!0},t=t.trim().replace(/^\?/,""),n=t.split("&"),i={},a.forEach(n,function(t){var n,r,o;""!==t&&(n=t.split("="),r=n[0],o=n[1],e(r,o)&&(i[r]=o))}),i}function o(t){var e=[];return a.forEach(t,function(t,n){e.push(n+"="+t)}),e.join("&")}var a=t("./utilityFunctions"),s=document.createElement("a"),l=document.documentMode;e.exports={urlParts:i,queryStringToObj:r,objToQueryString:o}},{"./utilityFunctions":47}],47:[function(t,e,n){function i(){}function r(t){return null===t}function o(t){return void 0!==t}function a(t){return void 0===t}function s(t){return"object"===(void 0===t?"undefined":(0,T.default)(t))}function l(t){return"function"==typeof t}function u(t){return"number"==typeof t}function c(t){return j.isObject(t)&&t.window===t}function h(t){return"[object Array]"===Object.prototype.toString.call(t)}function d(t){if(null===t||j.isWindow(t)||j.isFunction(t)||j.isUndefined(t))return!1;var e=t.length;return!(t.nodeType!==N||!e)||(j.isString(t)||j.isArray(t)||0===e||"number"==typeof e&&e>0&&e-1 in t)}function p(t){return"string"==typeof t}function f(t){return j.isString(t)&&0===t.length}function m(t){return j.isString(t)&&0!==t.length}function v(t){return Array.prototype.slice.call(t)}function g(t,e,n){var i,r;if(t)if(l(t))for(i in t)"prototype"===i||"length"===i||"name"===i||t.hasOwnProperty&&!t.hasOwnProperty(i)||e.call(n,t[i],i,t);else if(h(t)){var o="object"!==(void 0===t?"undefined":(0,T.default)(t));for(i=0,r=t.length;i<r;i++)(o||i in t)&&e.call(n,t[i],i,t)}else if(t.forEach&&t.forEach!==g)t.forEach(e,n,t);else for(i in t)t.hasOwnProperty(i)&&e.call(n,t[i],i,t);return t}function y(t,e){return e=e||"_",t.replace(U,function(t,n){return(n?e:"")+t.toLowerCase()})}function b(t){return!!j.isString(t)&&V.test(t.trim())}function _(t){var e,n,i;for(n=1;n<arguments.length;n++){e=arguments[n];for(i in e)e.hasOwnProperty(i)&&(s(t[i])&&!r(t[i])&&s(e[i])?t[i]=_({},t[i],e[i]):t[i]=e[i])}return t}function w(t){return t.charAt(0).toUpperCase()+t.slice(1)}function x(t){return t.charAt(0).toLowerCase()+t.slice(1)}function E(t,e){var n=[];return t.forEach(function(t,i){var r=e(t,i);j.isDefined(r)&&n.push(r)}),n}function S(t,e){var n=t+"";if(e=j.isNumber(e)?e:0,t=j.isNumber(t)?t:parseInt(t,10),j.isNumber(t)&&!isNaN(t)){for(n=t+"";n.length<e;)n="0"+n;return n}return"NaN"}function A(t,e){var n=(new Date).getTime()-(e+1);return function(){var i=(new Date).getTime();i-n>=e&&(n=i,t.apply(this,arguments))}}function C(t,e){var n;return function(){n&&clearTimeout(n),n=setTimeout(function(){t.apply(this,arguments),n=void 0},e)}}function k(t,e,n){for(var i=e(t),r=0;r<i.length;r++){if(n(i[r]))return i[r];var o=k(i[r],e,n);if(o)return o}}function M(t){return function(){return t}}function L(t){return j.isNumber(t)&&(t+=""),!!j.isString(t)&&B.test(t.trim())}function R(){var t=j.getInternetExplorerVersion(navigator);return-1!==t&&t<10}function P(t){var e=-1;if("Microsoft Internet Explorer"==t.appName){var n=t.userAgent,i=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),r=i.exec(n);null!==r&&(e=parseFloat(r[1]))}return e}function D(){return/iP(hone|ad)/.test(j._UA)}function I(){return/iP(hone|ad|od)|Android|Windows Phone/.test(j._UA)}function F(){return/iP(hone|od)/.test(j._UA)}function O(){return/Android/.test(j._UA)}var N=1,U=/[A-Z]/g,V=/^[a-z0-9!#$%&'*+\/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)+$/i,B=/^([\+-]?\d{4}(?!\d{2}\b))((-?)((0[1-9]|1[0-2])(\3([12]\d|0[1-9]|3[01]))?|W([0-4]\d|5[0-2])(-?[1-7])?|(00[1-9]|0[1-9]\d|[12]\d{2}|3([0-5]\d|6[1-6])))([T\s]((([01]\d|2[0-3])((:?)[0-5]\d)?|24\:?00)([\.,]\d+(?!:))?)?(\17[0-5]\d([\.,]\d+)?)?([zZ]|([\+-])([01]\d|2[0-3]):?([0-5]\d)?)?)?)?$/,j={_UA:navigator.userAgent,noop:i,isNull:r,isDefined:o,isUndefined:a,isObject:s,isFunction:l,isNumber:u,isWindow:c,isArray:h,isArrayLike:d,isString:p,isEmptyString:f,isNotEmptyString:m,arrayLikeObjToArray:v,forEach:g,snake_case:y,isValidEmail:b,extend:_,capitalize:w,decapitalize:x,transformArray:E,toFixedDigits:S,throttle:A,debounce:C,treeSearch:k,echoFn:M,isISO8601:L,isOldIE:R,getInternetExplorerVersion:P,isIDevice:D,isMobile:I,isIPhone:F,isAndroid:O};e.exports=j},{}],48:[function(t,e,n){var i=t("./utilityFunctions"),r={};r.strToXMLDoc=function(t){function e(t){try{var e=new DOMParser,n=e.parseFromString("INVALID","text/xml"),i=n.getElementsByTagName("parsererror")[0].namespaceURI;return"http://www.w3.org/1999/xhtml"===i?t.getElementsByTagName("parsererror").length>0:t.getElementsByTagNameNS(i,"parsererror").length>0}catch(t){}}if(void 0===window.DOMParser){var n=new ActiveXObject("Microsoft.XMLDOM");return n.async=!1,n.loadXML(t),n}return function(t){var n,r=new DOMParser;try{if(n=r.parseFromString(t,"application/xml"),e(n)||i.isEmptyString(t))throw new Error}catch(e){throw new Error("xml.strToXMLDOC: Error parsing the string: '"+t+"'")}return n}(t)},r.parseText=function(t){return/^\s*$/.test(t)?null:/^(?:true|false)$/i.test(t)?"true"===t.toLowerCase():isFinite(t)?parseFloat(t):i.isISO8601(t)?new Date(t):t.trim()},r.JXONTree=function(t){var e=r.parseText;if(t.documentElement)return new r.JXONTree(t.documentElement);if(t.hasChildNodes()){for(var n,o,a,s="",l=0;l<t.childNodes.length;l++)n=t.childNodes.item(l),3==(n.nodeType-1|1)?s+=3===n.nodeType?n.nodeValue.trim():n.nodeValue:1!==n.nodeType||n.prefix||(o=i.decapitalize(n.nodeName),a=new r.JXONTree(n),this.hasOwnProperty(o)?(this[o].constructor!==Array&&(this[o]=[this[o]]),this[o].push(a)):this[o]=a);s&&(this.keyValue=e(s))}if(void 0===t.hasAttributes?t.attributes.length>0:t.hasAttributes())for(var u,c=0;c<t.attributes.length;c++)u=t.attributes.item(c),this["@"+i.decapitalize(u.name)]=e(u.value.trim())},r.JXONTree.prototype.attr=function(t){return this["@"+i.decapitalize(t)]},r.toJXONTree=function(t){var e=r.strToXMLDoc(t);return new r.JXONTree(e)},r.keyValue=function(t){if(t)return t.keyValue},r.attr=function(t,e){if(t)return t["@"+i.decapitalize(e)]},r.encode=function(t){if(i.isString(t))return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")},r.decode=function(t){if(i.isString(t))return t.replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&")},e.exports=r},{"./utilityFunctions":47}],49:[function(t,e,n){t("./plugin/components/ads-label_5"),t("./plugin/components/black-poster_5");var i=t("./plugin/videojs.vast.vpaid");k.default.plugin("vastAdformClient",i)},{"./plugin/components/ads-label_5":36,"./plugin/components/black-poster_5":38,"./plugin/videojs.vast.vpaid":39}]},{},[49])},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r,r,o,a,s=n(30),l=i(s),u=n(31),c=i(u),h=n(3),d=i(h),p=n(40),f=i(p),m=n(32),v=i(m),g=n(21),y=i(g),b=n(23),_=i(b),w=n(14),T=i(w),x=n(22),E=i(x),S=n(13),A=i(S),C=n(1),k=i(C);!function t(e,n,i){function o(s,l){if(!n[s]){if(!e[s]){var u="function"==typeof r&&r;if(!l&&u)return r(s,!0);if(a)return a(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var h=n[s]={exports:{}};e[s][0].call(h.exports,function(t){var n=e[s][1][t];return o(n||t)},h,h.exports,t,e,n,i)}return n[s].exports}for(var a="function"==typeof r&&r,s=0;s<i.length;s++)o(i[s]);return o}({1:[function(t,e,n){function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,A.default)(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n.IVPAIDAdUnit=function(){function t(){i(this,t)}return r(t,[{key:"handshakeVersion",value:function(){arguments.length<=0||void 0===arguments[0]||arguments[0],arguments.length<=1||void 0===arguments[1]||arguments[1]}},{key:"initAd",value:function(t,e,n,i){arguments.length<=4||void 0===arguments[4]||arguments[4],arguments.length<=5||void 0===arguments[5]||arguments[5],arguments.length<=6||void 0===arguments[6]||arguments[6]}},{key:"resizeAd",value:function(t,e,n){arguments.length<=3||void 0===arguments[3]||arguments[3]}},{key:"startAd",value:function(){arguments.length<=0||void 0===arguments[0]||arguments[0]}},{key:"stopAd",value:function(){arguments.length<=0||void 0===arguments[0]||arguments[0]}},{key:"pauseAd",value:function(){arguments.length<=0||void 0===arguments[0]||arguments[0]}},{key:"resumeAd",value:function(){arguments.length<=0||void 0===arguments[0]||arguments[0]}},{key:"expandAd",value:function(){arguments.length<=0||void 0===arguments[0]||arguments[0]}},{key:"collapseAd",value:function(){arguments.length<=0||void 0===arguments[0]||arguments[0]}},{key:"skipAd",value:function(){arguments.length<=0||void 0===arguments[0]||arguments[0]}},{key:"getAdLinear",value:function(t){}},{key:"getAdWidth",value:function(t){}},{key:"getAdHeight",value:function(t){}},{key:"getAdExpanded",value:function(t){}},{key:"getAdSkippableState",value:function(t){}},{key:"getAdRemainingTime",value:function(t){}},{key:"getAdDuration",value:function(t){}},{key:"setAdVolume",value:function(t){arguments.length<=1||void 0===arguments[1]||arguments[1]}},{key:"getAdVolume",value:function(t){}},{key:"getAdCompanions",value:function(t){}},{key:"getAdIcons",value:function(t){}}]),t}();Object.defineProperty(o,"EVENTS",{writable:!1,configurable:!1,value:["AdLoaded","AdStarted","AdStopped","AdSkipped","AdSkippableStateChange","AdSizeChange","AdLinearChange","AdDurationChange","AdExpandedChange","AdRemainingTimeChange","AdVolumeChange","AdImpression","AdVideoStart","AdVideoFirstQuartile","AdVideoMidpoint","AdVideoThirdQuartile","AdVideoComplete","AdClickThru","AdInteraction","AdUserAcceptInvitation","AdUserMinimize","AdUserClose","AdPaused","AdPlaying","AdLog","AdError"]})},{}],2:[function(t,e,n){function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":a(e))&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":a(e)));t.prototype=(0,y.default)(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(v.default?(0,v.default)(t,e):t.__proto__=e)}var a="function"==typeof E.default&&"symbol"===(0,T.default)(_.default)?function(t){return void 0===t?"undefined":(0,T.default)(t)}:function(t){return t&&"function"==typeof E.default&&t.constructor===E.default?"symbol":void 0===t?"undefined":(0,T.default)(t)};Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,A.default)(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),l=t("./IVPAIDAdUnit").IVPAIDAdUnit,u=(0,f.default)(l.prototype).filter(function(t){return-1===["constructor"].indexOf(t)});n.VPAIDAdUnit=function(t){function e(t){i(this,e);var n=r(this,(0,d.default)(e).call(this));return n._destroyed=!1,n._flash=t,n}return o(e,t),s(e,[{key:"_destroy",value:function(){var t=this;this._destroyed=!0,u.forEach(function(e){t._flash.removeCallbackByMethodName(e)}),l.EVENTS.forEach(function(e){t._flash.offEvent(e)}),this._flash=null}},{key:"isDestroyed",value:function(){return this._destroyed}},{key:"on",value:function(t,e){this._flash.on(t,e)}},{key:"off",value:function(t,e){this._flash.off(t,e)}},{key:"handshakeVersion",value:function(){var t=arguments.length<=0||void 0===arguments[0]?"2.0":arguments[0],e=arguments.length<=1||void 0===arguments[1]?void 0:arguments[1];this._flash.callFlashMethod("handshakeVersion",[t],e)}},{key:"initAd",value:function(t,e,n,i){var r=arguments.length<=4||void 0===arguments[4]?{AdParameters:""}:arguments[4],o=arguments.length<=5||void 0===arguments[5]?{flashVars:""}:arguments[5],a=arguments.length<=6||void 0===arguments[6]?void 0:arguments[6];this._flash.setSize(t,e),r=r||{AdParameters:""},o=o||{flashVars:""},this._flash.callFlashMethod("initAd",[this._flash.getWidth(),this._flash.getHeight(),n,i,r.AdParameters||"",o.flashVars||""],a)}},{key:"resizeAd",value:function(t,e,n){var i=arguments.length<=3||void 0===arguments[3]?void 0:arguments[3];this._flash.setSize(t,e),this._flash.callFlashMethod("resizeAd",[this._flash.getWidth(),this._flash.getHeight(),n],i)}},{key:"startAd",value:function(){var t=arguments.length<=0||void 0===arguments[0]?void 0:arguments[0];this._flash.callFlashMethod("startAd",[],t)}},{key:"stopAd",value:function(){var t=arguments.length<=0||void 0===arguments[0]?void 0:arguments[0];this._flash.callFlashMethod("stopAd",[],t)}},{key:"pauseAd",value:function(){var t=arguments.length<=0||void 0===arguments[0]?void 0:arguments[0];this._flash.callFlashMethod("pauseAd",[],t)}},{key:"resumeAd",value:function(){var t=arguments.length<=0||void 0===arguments[0]?void 0:arguments[0];this._flash.callFlashMethod("resumeAd",[],t)}},{key:"expandAd",value:function(){var t=arguments.length<=0||void 0===arguments[0]?void 0:arguments[0];this._flash.callFlashMethod("expandAd",[],t)}},{key:"collapseAd",value:function(){var t=arguments.length<=0||void 0===arguments[0]?void 0:arguments[0];this._flash.callFlashMethod("collapseAd",[],t)}},{key:"skipAd",value:function(){var t=arguments.length<=0||void 0===arguments[0]?void 0:arguments[0];this._flash.callFlashMethod("skipAd",[],t)}},{key:"getAdLinear",value:function(t){this._flash.callFlashMethod("getAdLinear",[],t)}},{key:"getAdWidth",value:function(t){this._flash.callFlashMethod("getAdWidth",[],t)}},{key:"getAdHeight",value:function(t){this._flash.callFlashMethod("getAdHeight",[],t)}},{key:"getAdExpanded",value:function(t){this._flash.callFlashMethod("getAdExpanded",[],t)}},{key:"getAdSkippableState",value:function(t){this._flash.callFlashMethod("getAdSkippableState",[],t)}},{key:"getAdRemainingTime",value:function(t){this._flash.callFlashMethod("getAdRemainingTime",[],t)}},{key:"getAdDuration",value:function(t){this._flash.callFlashMethod("getAdDuration",[],t)}},{key:"setAdVolume",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?void 0:arguments[1];this._flash.callFlashMethod("setAdVolume",[t],e)}},{key:"getAdVolume",value:function(t){this._flash.callFlashMethod("getAdVolume",[],t)}},{key:"getAdCompanions",value:function(t){this._flash.callFlashMethod("getAdCompanions",[],t)}},{key:"getAdIcons",value:function(t){this._flash.callFlashMethod("getAdIcons",[],t)}}]),e}(l)},{"./IVPAIDAdUnit":1}],3:[function(t,e,n){function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(){if(this._destroyed)throw new Error("VPAIDFlashToJS is destroyed!")}function o(){this._loadLater&&(this.loadAdUnit(this._loadLater.url,this._loadLater.callback),delete this._loadLater)}function a(t,e){var n=!(arguments.length<=2||void 0===arguments[2])&&arguments[2];(0,A.default)(b,t,{writable:n,configurable:!1,value:e})}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,A.default)(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),l=t("swfobject"),u=t("./jsFlashBridge").JSFlashBridge,c=t("./VPAIDAdUnit").VPAIDAdUnit,h=t("./utils").noop,d=t("./utils").callbackTimeout,p=t("./utils").isPositiveInt,f=t("./utils").createElementWithID,m=t("./utils").unique("vpaid"),v=t("./flashTester.js").createFlashTester,g="10.1.0",y={isSupported:function(){return!0}},b=function(){function t(e,n){function r(t){return setTimeout(function(){n(new Error(t))},0),y}var a=arguments.length<=2||void 0===arguments[2]?{data:"VPAIDFlash.swf",width:800,height:400}:arguments[2],s=this,c=arguments.length<=3||void 0===arguments[3]?{wmode:"transparent",salign:"tl",align:"left",allowScriptAccess:"always",scale:"noScale",allowFullScreen:"true",quality:"high"}:arguments[3],v=arguments.length<=4||void 0===arguments[4]?{debug:!1,timeout:1e4}:arguments[4];i(this,t);var y=this;if(this._vpaidParentEl=e,this._flashID=m(),this._destroyed=!1,n=n||h,a.width=p(a.width,800),a.height=p(a.height,400),f(e,this._flashID,!0),c.movie=a.data,c.FlashVars="flashid="+this._flashID+"&handler="+u.VPAID_FLASH_HANDLER+"&debug="+v.debug+"&salign="+c.salign,!t.isSupported())return r("user don't support flash or doesn't have the minimum required version of flash "+g);if(this.el=l.createSWF(a,c,this._flashID),!this.el)return r("swfobject failed to create object in element");var b=d(v.timeout,function(t,e){o.call(s),n(t,e)},function(){n("vpaid flash load timeout "+v.timeout)});this._flash=new u(this.el,a.data,this._flashID,a.width,a.height,b)}return s(t,[{key:"destroy",value:function(){this._destroyAdUnit(),this._flash&&(this._flash.destroy(),this._flash=null),this.el=null,this._destroyed=!0}},{key:"isDestroyed",value:function(){return this._destroyed}},{key:"_destroyAdUnit",value:function(){delete this._loadLater,this._adUnitLoad&&(this._adUnitLoad=null,this._flash.removeCallback(this._adUnitLoad)),this._adUnit&&(this._adUnit._destroy(),this._adUnit=null)}},{key:"loadAdUnit",value:function(t,e){var n=this;r.call(this),this._adUnit&&this._destroyAdUnit(),this._flash.isReady()?(this._adUnitLoad=function(t,i){t||(n._adUnit=new c(n._flash)),n._adUnitLoad=null,e(t,n._adUnit)},this._flash.callFlashMethod("loadAdUnit",[t],this._adUnitLoad)):this._loadLater={url:t,callback:e}}},{key:"unloadAdUnit",value:function(){var t=arguments.length<=0||void 0===arguments[0]?void 0:arguments[0];r.call(this),this._destroyAdUnit(),this._flash.callFlashMethod("unloadAdUnit",[],t)}},{key:"getFlashID",value:function(){return r.call(this),this._flash.getFlashID()}},{key:"getFlashURL",value:function(){return r.call(this),this._flash.getFlashURL()}}]),t}();a("isSupported",function(){return l.hasFlashPlayerVersion(g)&&y.isSupported()},!0),a("runFlashTest",function(t){y=v(document.body,t)}),b.swfobject=l,e.exports=b},{"./VPAIDAdUnit":2,"./flashTester.js":4,"./jsFlashBridge":5,"./utils":8,swfobject:14}],4:[function(t,e,n){function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,A.default)(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=t("swfobject"),a="vpaid_video_flash_tester",s="vpaid_video_flash_tester_el",l=t("./jsFlashBridge").JSFlashBridge,u=t("./utils"),c=t("./registry").MultipleValuesRegistry,h=function(){function t(e){var n=this,r=arguments.length<=1||void 0===arguments[1]?{data:"VPAIDFlash.swf",width:800,height:400}:arguments[1];i(this,t),this.parentEl=u.createElementWithID(e,s),u.hideFlashEl(this.parentEl);var a={};a.movie=r.data,a.FlashVars="flashid="+s+"&handler="+l.VPAID_FLASH_HANDLER,a.allowScriptAccess="always",this.el=o.createSWF(r,a,s),this._handlers=new c,this._isSupported=!1,this.el&&(u.hideFlashEl(this.el),this._flash=new l(this.el,r.data,s,r.width,r.height,function(){n._isSupported=!0,n._handlers.get("change").forEach(function(t){setTimeout(function(){t("change",!0)},0)})}))}return r(t,[{key:"isSupported",value:function(){return this._isSupported}},{key:"on",value:function(t,e){this._handlers.add(t,e)}}]),t}();n.createFlashTester=function(t,e){return window[a]||(window[a]=new h(t,e)),window[a]}},{"./jsFlashBridge":5,"./registry":7,"./utils":8,swfobject:14}],5:[function(t,e,n){function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e,n){var i=this;setTimeout(function(){var r=i._callbacks.get(t);r&&(i._callbacks.remove(t),r(e,n))},0)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,A.default)(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=t("./utils").unique,s=t("./utils").isPositiveInt,l=t("./utils").stringEndsWith,u=t("./registry").SingleValueRegistry,c=t("./registry").MultipleValuesRegistry,h=t("./jsFlashBridgeRegistry"),d=n.JSFlashBridge=function(){function t(e,n,r,o,s,l){i(this,t),this._el=e,this._flashID=r,this._flashURL=n,this._width=o,this._height=s,this._handlers=new c,this._callbacks=new u,this._uniqueMethodIdentifier=a(this._flashID),this._ready=!1,this._handShakeHandler=l,h.addInstance(this._flashID,this)}return o(t,[{key:"on",value:function(t,e){this._handlers.add(t,e)}},{key:"off",value:function(t,e){return this._handlers.remove(t,e)}},{key:"offEvent",value:function(t){return this._handlers.removeByKey(t)}},{key:"offAll",value:function(){return this._handlers.removeAll()}},{key:"callFlashMethod",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?[]:arguments[1],n=arguments.length<=2||void 0===arguments[2]?void 0:arguments[2],i="";n&&(i=this._uniqueMethodIdentifier()+"_"+t,this._callbacks.add(i,n));try{this._el[t]([i].concat(e))}catch(t){n?r.call(this,i,t):this._trigger("AdError",t)}}},{key:"removeCallback",value:function(t){return this._callbacks.removeByValue(t)}},{key:"removeCallbackByMethodName",value:function(t){var e=this;this._callbacks.filterKeys(function(e){return l(e,t)}).forEach(function(t){e._callbacks.remove(t)})}},{key:"removeAllCallbacks",value:function(){return this._callbacks.removeAll()}},{key:"_trigger",value:function(t,e){var n=this;this._handlers.get(t).forEach(function(i){"AdClickThru"===t?i(e):setTimeout(function(){n._handlers.get(t).length>0&&i(e)},0)})}},{key:"_callCallback",value:function(t,e,n,i){if(!this._callbacks.get(e))return void(n&&""===e&&this.trigger("AdError",n));r.call(this,e,n,i)}},{key:"_handShake",value:function(t,e){this._ready=!0,this._handShakeHandler&&(this._handShakeHandler(t,e),delete this._handShakeHandler)}},{key:"getSize",value:function(){return{width:this._width,height:this._height}}},{key:"setSize",value:function(t,e){this._width=s(t,this._width),this._height=s(e,this._height),this._el.setAttribute("width",this._width),this._el.setAttribute("height",this._height)}},{key:"getWidth",value:function(){return this._width}},{key:"setWidth",value:function(t){this.setSize(t,this._height)}},{key:"getHeight",value:function(){return this._height}},{key:"setHeight",value:function(t){this.setSize(this._width,t)}},{key:"getFlashID",value:function(){return this._flashID}},{key:"getFlashURL",value:function(){return this._flashURL}},{key:"isReady",value:function(){return this._ready}},{key:"destroy",value:function(){this.offAll(),this.removeAllCallbacks(),h.removeInstanceByID(this._flashID),this._el.parentElement&&this._el.parentElement.removeChild(this._el)}}]),t}();Object.defineProperty(d,"VPAID_FLASH_HANDLER",{writable:!1,configurable:!1,value:"vpaid_video_flash_handler"}),window.vpaid_video_flash_handler=function(t,e,n,i,r,o){var a=h.getInstanceByID(t);a&&("handShake"===n?a._handShake(r,o):"event"!==e?a._callCallback(n,i,r,o):a._trigger(n,o))}},{"./jsFlashBridgeRegistry":6,"./registry":7,"./utils":8}],6:[function(t,e,n){var i=t("./registry").SingleValueRegistry,r=new i,o={};Object.defineProperty(o,"addInstance",{writable:!1,configurable:!1,value:function(t,e){r.add(t,e)}}),Object.defineProperty(o,"getInstanceByID",{writable:!1,configurable:!1,value:function(t){return r.get(t)}}),Object.defineProperty(o,"removeInstanceByID",{writable:!1,configurable:!1,value:function(t){return r.remove(t)}}),e.exports=o},{"./registry":7}],7:[function(t,e,n){function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,A.default)(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();n.MultipleValuesRegistry=function(){function t(){i(this,t),this._registries={}}return r(t,[{key:"add",value:function(t,e){this._registries[t]||(this._registries[t]=[]),-1===this._registries[t].indexOf(e)&&this._registries[t].push(e)}},{key:"get",value:function(t){return this._registries[t]||[]}},{key:"filterKeys",value:function(t){return(0,c.default)(this._registries).filter(t)}},{key:"findByValue",value:function(t){var e=this;return(0,c.default)(this._registries).filter(function(n){return-1!==e._registries[n].indexOf(t)})}},{key:"remove",value:function(t,e){if(this._registries[t]){var n=this._registries[t].indexOf(e);if(!(n<0))return this._registries[t].splice(n,1)}}},{key:"removeByKey",value:function(t){var e=this._registries[t];return delete this._registries[t],e}},{key:"removeByValue",value:function(t){var e=this;return this.findByValue(t).map(function(n){return e.remove(n,t)})}},{key:"removeAll",value:function(){var t=this._registries;return this._registries={},t}},{key:"size",value:function(){return(0,c.default)(this._registries).length}}]),t}(),n.SingleValueRegistry=function(){function t(){i(this,t),this._registries={}}return r(t,[{key:"add",value:function(t,e){this._registries[t]=e}},{key:"get",value:function(t){return this._registries[t]}},{key:"filterKeys",value:function(t){return(0,c.default)(this._registries).filter(t)}},{key:"findByValue",value:function(t){var e=this;return(0,c.default)(this._registries).filter(function(n){return e._registries[n]===t})}},{key:"remove",value:function(t){var e=this._registries[t];return delete this._registries[t],e}},{key:"removeByValue",value:function(t){var e=this;return this.findByValue(t).map(function(t){return e.remove(t)})}},{key:"removeAll",value:function(){var t=this._registries;return this._registries={},t}},{key:"size",value:function(){return(0,c.default)(this._registries).length}}]),t}()},{}],8:[function(t,e,n){function i(t){var e=-1;return function(n){return t+"_"+ ++e}}function r(){}function o(t,e,n){var i=setTimeout(function(){e=r,n()},t);return function(){clearTimeout(i),e.apply(this,arguments)}}function a(t,e){var n=!(arguments.length<=2||void 0===arguments[2])&&arguments[2],i=document.createElement("div");return i.id=e,n&&(t.innerHTML=""),t.appendChild(i),i}function s(t,e){return!isNaN(parseFloat(t))&&isFinite(t)&&t>0?t:e}function l(t,e){return c.call(t,e)}function u(t){t.style.position="absolute",t.style.left="-1px",t.style.top="-1px",t.style.width="1px",t.style.height="1px"}Object.defineProperty(n,"__esModule",{value:!0}),n.unique=i,n.noop=r,n.callbackTimeout=o,n.createElementWithID=a,n.isPositiveInt=s,n.stringEndsWith=l,n.hideFlashEl=u;var c=function(){return String.prototype.endsWith?String.prototype.endsWith:function(t,e){var n=this.toString();(void 0===e||e>n.length)&&(e=n.length),e-=t.length;var i=n.indexOf(t,e);return-1!==i&&i===e}}()},{}],9:[function(t,e,n){function i(t,e,n){}function r(t,e,n){(0,A.default)(t,e,{writable:!1,configurable:!1,value:n})}var o=["handshakeVersion","initAd","startAd","stopAd","skipAd","resizeAd","pauseAd","resumeAd","expandAd","collapseAd","subscribe","unsubscribe"],a=["AdLoaded","AdStarted","AdStopped","AdSkipped","AdSkippableStateChange","AdSizeChange","AdLinearChange","AdDurationChange","AdExpandedChange","AdRemainingTimeChange","AdVolumeChange","AdImpression","AdVideoStart","AdVideoFirstQuartile","AdVideoMidpoint","AdVideoThirdQuartile","AdVideoComplete","AdClickThru","AdInteraction","AdUserAcceptInvitation","AdUserMinimize","AdUserClose","AdPaused","AdPlaying","AdLog","AdError"],s=["getAdLinear","getAdWidth","getAdHeight","getAdExpanded","getAdSkippableState","getAdRemainingTime","getAdDuration","getAdVolume","getAdCompanions","getAdIcons"],l=["setAdVolume"];i.prototype.handshakeVersion=function(t,e){},i.prototype.initAd=function(t,e,n,i,r,o,a){},i.prototype.startAd=function(t){},i.prototype.stopAd=function(t){},i.prototype.skipAd=function(t){},i.prototype.resizeAd=function(t,e,n,i){},i.prototype.pauseAd=function(t){},i.prototype.resumeAd=function(t){},i.prototype.expandAd=function(t){},i.prototype.collapseAd=function(t){},i.prototype.subscribe=function(t,e,n){},i.prototype.unsubscribe=function(t,e){},i.prototype.getAdLinear=function(t){},i.prototype.getAdWidth=function(t){},i.prototype.getAdHeight=function(t){},i.prototype.getAdExpanded=function(t){},i.prototype.getAdSkippableState=function(t){},i.prototype.getAdRemainingTime=function(t){},i.prototype.getAdDuration=function(t){},i.prototype.getAdVolume=function(t){},i.prototype.getAdCompanions=function(t){},i.prototype.getAdIcons=function(t){},i.prototype.setAdVolume=function(t,e){},r(i,"METHODS",o),r(i,"GETTERS",s),r(i,"SETTERS",l),r(i,"EVENTS",a);var u=o.filter(function(t){return-1===["skipAd"].indexOf(t)});r(i,"checkVPAIDInterface",function(t){return u.every(function(e){return"function"==typeof t[e]})}),e.exports=i},{}],10:[function(t,e,n){function i(t,e,n,i){this._isValid=c(t),this._isValid&&(this._creative=t,this._el=e,this._videoEl=n,this._iframe=i,this._subscribers=new u,r.call(this))}function r(){if(f.forEach(function(t){this._creative.subscribe(a.bind(this,t),t)}.bind(this)),this._creative.subscribe(o.bind(this),p),this._videoEl){var t=this._iframe.contentDocument.documentElement,e=this._videoEl;t.addEventListener("click",function(n){n.target===t&&e.click()})}}function o(t,e,n){this._subscribers.triggerSync(p,{url:t,id:e,playerHandles:n})}function a(t){this._subscribers.trigger(t,Array.prototype.slice(arguments,1))}function s(t,e,n,i){t?t(n,i):n&&e.trigger(d,n)}var l=t("./IVPAIDAdUnit"),u=t("./subscriber"),c=l.checkVPAIDInterface,h=t("./utils"),d=(l.METHODS,"AdError"),p="AdClickThru",f=l.EVENTS.filter(function(t){return t!=p});i.prototype=(0,y.default)(l.prototype),i.prototype.isValidVPAIDAd=function(){return this._isValid},l.METHODS.forEach(function(t){-1===["subscribe","unsubscribe","initAd"].indexOf(t)&&(i.prototype[t]=function(){var e=l.prototype[t].length,n=Array.prototype.slice.call(arguments),i=e===n.length?n.pop():void 0;setTimeout(function(){var e,r=null;try{e=this._creative[t].apply(this._creative,n)}catch(t){r=t}s(i,this._subscribers,r,e)}.bind(this),0)})}),i.prototype.initAd=function(t,e,n,i,r,o,a){r=r||{},o=h.extend({slot:this._el,videoSlot:this._videoEl},o||{}),setTimeout(function(){var l;try{this._creative.initAd(t,e,n,i,r,o)}catch(t){l=t}s(a,this._subscribers,l)}.bind(this),0)},i.prototype.subscribe=function(t,e,n){this._subscribers.subscribe(e,t,n)},i.prototype.unsubscribe=function(t,e){this._subscribers.unsubscribe(e,t)},i.prototype.on=i.prototype.subscribe,i.prototype.off=i.prototype.unsubscribe,l.GETTERS.forEach(function(t){i.prototype[t]=function(e){setTimeout(function(){var n,i=null;try{n=this._creative[t]()}catch(t){i=t}s(e,this._subscribers,i,n)}.bind(this),0)}}),i.prototype.setAdVolume=function(t,e){setTimeout(function(){var n,i=null;try{this._creative.setAdVolume(t),n=this._creative.getAdVolume()}catch(t){i=t}i||(i=h.validate(n===t,"failed to apply volume: "+t)),s(e,this._subscribers,i,n)}.bind(this),0)},i.prototype._destroy=function(){this.stopAd(),this._subscribers.unsubscribeAll()},e.exports=i},{"./IVPAIDAdUnit":9,"./subscriber":12,"./utils":13}],11:[function(t,e,n){function i(t,e,n,i){n=n||{},this._id=p(),this._destroyed=!1,this._frameContainer=d.createElementInEl(t,"div"),this._videoEl=e,this._vpaidOptions=i||{timeout:1e4},this._templateConfig={template:n.template||m,extraOptions:n.extraOptions||{}}}function r(t){var e=this[t];e&&(e.remove(),delete this[t])}function o(){s.call(this),delete this._adUnit}function a(){s.call(this),u.call(this)}function s(){r.call(this,"_frame"),l.call(this)}function l(){this._onLoad&&(window.removeEventListener("message",this._onLoad),d.clearCallbackTimeout(this._onLoad),delete this._onLoad)}function u(){this._adUnit&&(this._adUnit.stopAd(),delete this._adUnit)}function c(){if(this._destroyed)throw new Error("VPAIDHTML5Client already destroyed!")}function h(){return window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")}var d=t("./utils"),p=d.unique("vpaidIframe"),f=t("./VPAIDAdUnit"),m='<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"></head><body style="margin:0;padding:0"><div class="ad-element"></div><script type="text/javascript" src="{{iframeURL_JS}}"><\/script><script type="text/javascript">window.parent.postMessage(\'{"event": "ready", "id": "{{iframeID}}"}\', \'{{origin}}\');<\/script></body></html>';i.prototype.destroy=function(){this._destroyed||(this._destroyed=!0,a.call(this))},i.prototype.isDestroyed=function(){return this._destroyed},i.prototype.loadAdUnit=function(t,e){function n(t){if(t.origin===h()&&JSON.parse(t.data).id===r.getID()){var n,i,a;if(r._frame.contentWindow?(a=r._frame.contentWindow.getVPAIDAd,i=d.validate("function"==typeof a,"the ad didn't return a function to create an ad")):i="the iframe is not anymore in the DOM tree",!i){var s=r._frame.contentWindow.document.querySelector(".ad-element");n=new f(a(),s,r._videoEl,r._frame),n.subscribe("AdStopped",o.bind(r)),i=d.validate(n.isValidVPAIDAd(),"the add is not fully complaint with VPAID specification")}return r._adUnit=n,l.call(r),e(i,i?null:n),!0}}function i(){e("timeout",null)}c.call(this),a.call(this);var r=this,s=d.createIframeWithContent(this._frameContainer,this._templateConfig.template,d.extend({iframeURL_JS:t,iframeID:this.getID(),origin:h()},this._templateConfig.extraOptions));this._frame=s,this._onLoad=d.callbackTimeout(this._vpaidOptions.timeout,n.bind(this),i.bind(this)),window.addEventListener("message",this._onLoad)},i.prototype.unloadAdUnit=function(){a.call(this)},i.prototype.getID=function(){return this._id},e.exports=i,window.VPAIDHTML5Client=i},{"./VPAIDAdUnit":10,"./utils":13}],12:[function(t,e,n){function i(){this._subscribers={}}i.prototype.subscribe=function(t,e,n){this.isHandlerAttached(t,e)||this.get(e).push({handler:t,context:n,eventName:e})},i.prototype.unsubscribe=function(t,e){this._subscribers[e]=this.get(e).filter(function(e){return t!==e.handler})},i.prototype.unsubscribeAll=function(){this._subscribers={}},i.prototype.trigger=function(t,e){var n=this;this.get(t).concat(this.get("*")).forEach(function(t){setTimeout(function(){n.isHandlerAttached(t.handler,t.eventName)&&t.handler.call(t.context,e)},0)})},i.prototype.triggerSync=function(t,e){this.get(t).concat(this.get("*")).forEach(function(t){t.handler.call(t.context,e)})},i.prototype.get=function(t){return this._subscribers[t]||(this._subscribers[t]=[]),this._subscribers[t]},i.prototype.isHandlerAttached=function(t,e){return this.get(e).some(function(e){return t===e.handler})},e.exports=i},{}],13:[function(t,e,n){function i(){}function r(t,e){return t?null:new Error(e)}function o(t){var e=v[t];e&&(clearTimeout(e),delete v[t])}function a(t,e,n){var r,a;return a=setTimeout(function(){e=i,delete a[r],n()},t),r=function(){e.apply(this,arguments)&&o(r)},v[r]=a,r}function s(t,e,n){var i=document.createElement(e);return n&&(i.id=n),t.appendChild(i),i}function u(t,e,n){var i=h(t,null,n.zIndex);if(p(i,d(e,n)))return i}function h(t,e,n){var i=document.createElement("iframe");return i.src=e||"about:blank",i.marginWidth="0",i.marginHeight="0",i.frameBorder="0",i.width="100%",i.height="100%",i.style.position="absolute",i.style.left="0",i.style.top="0",i.style.margin="0px",i.style.padding="0px",i.style.border="none",n&&(i.style.zIndex=n),i.setAttribute("SCROLLING","NO"),t.innerHTML="",t.appendChild(i),i}function d(t,e){return(0,c.default)(e).forEach(function(n){var i="object"===(void 0===i?"undefined":(0,T.default)(i))?(0,l.default)(e[n]):e[n];t=t.replace(new RegExp("{{"+n+"}}","g"),i)}),t}function p(t,e){var n=t.contentWindow&&t.contentWindow.document;return!!n&&(n.write(e),!0)}function f(t,e){return(0,c.default)(e).forEach(function(n){t[n]=e[n]}),t}function m(t){var e=-1;return function(){return t+"_"+ ++e}}var v={};e.exports={noop:i,validate:r,clearCallbackTimeout:o,callbackTimeout:a,createElementInEl:s,createIframeWithContent:u,createIframe:h,simpleTemplate:d,setIframeContent:p,extend:f,unique:m}},{}],14:[function(t,e,i){!function(t,r){o=r,void 0!==(a="function"==typeof o?o.call(i,n,i,e):o)&&(e.exports=a)}(0,function(){function t(){if(!H&&document.getElementsByTagName("body")[0]){try{var t,e=g("span");e.style.display="none",t=O.getElementsByTagName("body")[0].appendChild(e),t.parentNode.removeChild(t),t=null,e=null}catch(t){return}H=!0;for(var n=V.length,i=0;i<n;i++)V[i]()}}function e(t){H?t():V[V.length]=t}function n(t){if((0,T.default)(F.addEventListener)!==R)F.addEventListener("load",t,!1);else if((0,T.default)(O.addEventListener)!==R)O.addEventListener("load",t,!1);else if((0,T.default)(F.attachEvent)!==R)b(F,"onload",t);else if("function"==typeof F.onload){var e=F.onload;F.onload=function(){e(),t()}}else F.onload=t}function i(){var t=O.getElementsByTagName("body")[0],e=g(P);e.setAttribute("style","visibility: hidden;"),e.setAttribute("type",D);var n=t.appendChild(e);if(n){var i=0;!function o(){if((0,T.default)(n.GetVariable)!==R)try{var a=n.GetVariable("$version");a&&(a=a.split(" ")[1].split(","),q.pv=[y(a[0]),y(a[1]),y(a[2])])}catch(t){q.pv=[8,0,0]}else if(i<10)return i++,void setTimeout(o,10);t.removeChild(e),n=null,r()}()}else r()}function r(){var t=B.length;if(t>0)for(var e=0;e<t;e++){var n=B[e].id,i=B[e].callbackFn,r={success:!1,id:n};if(q.pv[0]>0){var u=v(n);if(u)if(!_(B[e].swfVersion)||q.wk&&q.wk<312)if(B[e].expressInstall&&a()){var c={};c.data=B[e].expressInstall,c.width=u.getAttribute("width")||"0",c.height=u.getAttribute("height")||"0",u.getAttribute("class")&&(c.styleclass=u.getAttribute("class")),u.getAttribute("align")&&(c.align=u.getAttribute("align"));for(var h={},d=u.getElementsByTagName("param"),p=d.length,f=0;f<p;f++)"movie"!==d[f].getAttribute("name").toLowerCase()&&(h[d[f].getAttribute("name")]=d[f].getAttribute("value"));s(c,h,n,i)}else l(u),i&&i(r);else x(n,!0),i&&(r.success=!0,r.ref=o(n),r.id=n,i(r))}else if(x(n,!0),i){var m=o(n);m&&(0,T.default)(m.SetVariable)!==R&&(r.success=!0,r.ref=m,r.id=m.id),i(r)}}}function o(t){var e=null,n=v(t);return n&&"OBJECT"===n.nodeName.toUpperCase()&&(e=(0,T.default)(n.SetVariable)!==R?n:n.getElementsByTagName(P)[0]||n),e}function a(){return!z&&_("6.0.65")&&(q.win||q.mac)&&!(q.wk&&q.wk<312)}function s(t,e,n,i){var r=v(n);if(n=m(n),z=!0,C=i||null,k={success:!1,id:n},r){"OBJECT"===r.nodeName.toUpperCase()?(S=u(r),A=null):(S=r,A=n),t.id=I,((0,T.default)(t.width)===R||!/%$/.test(t.width)&&y(t.width)<310)&&(t.width="310"),((0,T.default)(t.height)===R||!/%$/.test(t.height)&&y(t.height)<137)&&(t.height="137");var o=q.ie?"ActiveX":"PlugIn",a="MMredirectURL="+encodeURIComponent(F.location.toString().replace(/&/g,"%26"))+"&MMplayerType="+o+"&MMdoctitle="+encodeURIComponent(O.title.slice(0,47)+" - Flash Player Installation");if((0,T.default)(e.flashvars)!==R?e.flashvars+="&"+a:e.flashvars=a,q.ie&&4!=r.readyState){var s=g("div");n+="SWFObjectNew",s.setAttribute("id",n),r.parentNode.insertBefore(s,r),r.style.display="none",p(r)}h(t,e,n)}}function l(t){if(q.ie&&4!=t.readyState){t.style.display="none";var e=g("div");t.parentNode.insertBefore(e,t),e.parentNode.replaceChild(u(t),e),p(t)}else t.parentNode.replaceChild(u(t),t)}function u(t){var e=g("div");if(q.win&&q.ie)e.innerHTML=t.innerHTML;else{var n=t.getElementsByTagName(P)[0];if(n){var i=n.childNodes;if(i)for(var r=i.length,o=0;o<r;o++)1==i[o].nodeType&&"PARAM"===i[o].nodeName||8==i[o].nodeType||e.appendChild(i[o].cloneNode(!0))}}return e}function c(t,e){var n=g("div");return n.innerHTML="<object classid='clsid:D27CDB6E-AE6D-11cf-96B8-444553540000'><param name='movie' value='"+t+"'>"+e+"</object>",n.firstChild}function h(t,e,n){var i,r=v(n);if(n=m(n),q.wk&&q.wk<312)return i;if(r){var o,a,s,l=g(q.ie?"div":P);(0,T.default)(t.id)===R&&(t.id=n);for(s in e)e.hasOwnProperty(s)&&"movie"!==s.toLowerCase()&&d(l,s,e[s]);q.ie&&(l=c(t.data,l.innerHTML));for(o in t)t.hasOwnProperty(o)&&(a=o.toLowerCase(),"styleclass"===a?l.setAttribute("class",t[o]):"classid"!==a&&"data"!==a&&l.setAttribute(o,t[o]));q.ie?j[j.length]=t.id:(l.setAttribute("type",D),l.setAttribute("data",t.data)),r.parentNode.replaceChild(l,r),i=l}return i}function d(t,e,n){var i=g("param");i.setAttribute("name",e),i.setAttribute("value",n),t.appendChild(i)}function p(t){var e=v(t);e&&"OBJECT"===e.nodeName.toUpperCase()&&(q.ie?(e.style.display="none",function t(){if(4==e.readyState){for(var n in e)"function"==typeof e[n]&&(e[n]=null);e.parentNode.removeChild(e)}else setTimeout(t,10)}()):e.parentNode.removeChild(e))}function f(t){return t&&t.nodeType&&1===t.nodeType}function m(t){return f(t)?t.id:t}function v(t){if(f(t))return t;var e=null;try{e=O.getElementById(t)}catch(t){}return e}function g(t){return O.createElement(t)}function y(t){return parseInt(t,10)}function b(t,e,n){t.attachEvent(e,n),G[G.length]=[t,e,n]}function _(t){t+="";var e=q.pv,n=t.split(".");return n[0]=y(n[0]),n[1]=y(n[1])||0,n[2]=y(n[2])||0,e[0]>n[0]||e[0]==n[0]&&e[1]>n[1]||e[0]==n[0]&&e[1]==n[1]&&e[2]>=n[2]}function w(t,e,n,i){var r=O.getElementsByTagName("head")[0];if(r){var o="string"==typeof n?n:"screen";if(i&&(M=null,L=null),!M||L!=o){var a=g("style");a.setAttribute("type","text/css"),a.setAttribute("media",o),M=r.appendChild(a),q.ie&&(0,T.default)(O.styleSheets)!==R&&O.styleSheets.length>0&&(M=O.styleSheets[O.styleSheets.length-1]),L=o}M&&((0,T.default)(M.addRule)!==R?M.addRule(t,e):(0,T.default)(O.createTextNode)!==R&&M.appendChild(O.createTextNode(t+" {"+e+"}")))}}function x(t,e){if(W){var n=e?"visible":"hidden",i=v(t);H&&i?i.style.visibility=n:"string"==typeof t&&w("#"+t,"visibility:"+n)}}function E(t){return null!==/[\\\"<>\.;]/.exec(t)&&("undefined"==typeof encodeURIComponent?"undefined":(0,T.default)(encodeURIComponent))!==R?encodeURIComponent(t):t}var S,A,C,k,M,L,R="undefined",P="object",D="application/x-shockwave-flash",I="SWFObjectExprInst",F=window,O=document,N=navigator,U=!1,V=[],B=[],j=[],G=[],H=!1,z=!1,W=!0,X=!1,q=function(){var t=(0,T.default)(O.getElementById)!==R&&(0,T.default)(O.getElementsByTagName)!==R&&(0,T.default)(O.createElement)!==R,e=N.userAgent.toLowerCase(),n=N.platform.toLowerCase(),i=/win/.test(n?n:e),r=/mac/.test(n?n:e),o=!!/webkit/.test(e)&&parseFloat(e.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")),a="Microsoft Internet Explorer"===N.appName,s=[0,0,0],l=null;if((0,T.default)(N.plugins)!==R&&(0,T.default)(N.plugins["Shockwave Flash"])===P)(l=N.plugins["Shockwave Flash"].description)&&(0,T.default)(N.mimeTypes)!==R&&N.mimeTypes[D]&&N.mimeTypes[D].enabledPlugin&&(U=!0,a=!1,l=l.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),s[0]=y(l.replace(/^(.*)\..*$/,"$1")),s[1]=y(l.replace(/^.*\.(.*)\s.*$/,"$1")),s[2]=/[a-zA-Z]/.test(l)?y(l.replace(/^.*[a-zA-Z]+(.*)$/,"$1")):0);else if((0,T.default)(F.ActiveXObject)!==R)try{var u=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");u&&(l=u.GetVariable("$version"))&&(a=!0,l=l.split(" ")[1].split(","),s=[y(l[0]),y(l[1]),y(l[2])])}catch(t){}return{w3:t,pv:s,wk:o,ie:a,win:i,mac:r}}();!function(){q.w3&&(((0,T.default)(O.readyState)!==R&&("complete"===O.readyState||"interactive"===O.readyState)||(0,T.default)(O.readyState)===R&&(O.getElementsByTagName("body")[0]||O.body))&&t(),H||((0,T.default)(O.addEventListener)!==R&&O.addEventListener("DOMContentLoaded",t,!1),q.ie&&(O.attachEvent("onreadystatechange",function e(){"complete"===O.readyState&&(O.detachEvent("onreadystatechange",e),t())}),F==top&&function e(){if(!H){try{O.documentElement.doScroll("left")}catch(t){return void setTimeout(e,0)}t()}}()),q.wk&&function e(){if(!H)return/loaded|complete/.test(O.readyState)?void t():void setTimeout(e,0)}()))}();V[0]=function(){U?i():r()};!function(){q.ie&&window.attachEvent("onunload",function(){for(var t=G.length,e=0;e<t;e++)G[e][0].detachEvent(G[e][1],G[e][2]);for(var n=j.length,i=0;i<n;i++)p(j[i]);for(var r in q)q[r]=null;q=null;for(var o in swfobject)swfobject[o]=null;swfobject=null})}();return{registerObject:function(t,e,n,i){if(q.w3&&t&&e){var r={};r.id=t,r.swfVersion=e,r.expressInstall=n,r.callbackFn=i,B[B.length]=r,x(t,!1)}else i&&i({success:!1,id:t})},getObjectById:function(t){if(q.w3)return o(t)},embedSWF:function(t,n,i,r,o,l,u,c,d,p){var f=m(n),v={success:!1,id:f};q.w3&&!(q.wk&&q.wk<312)&&t&&n&&i&&r&&o?(x(f,!1),e(function(){i+="",r+="";var e={};if(d&&(void 0===d?"undefined":(0,T.default)(d))===P)for(var m in d)e[m]=d[m];e.data=t,e.width=i,e.height=r;var g={};if(c&&(void 0===c?"undefined":(0,T.default)(c))===P)for(var y in c)g[y]=c[y];if(u&&(void 0===u?"undefined":(0,T.default)(u))===P)for(var b in u)if(u.hasOwnProperty(b)){var w=X?encodeURIComponent(b):b,E=X?encodeURIComponent(u[b]):u[b];(0,T.default)(g.flashvars)!==R?g.flashvars+="&"+w+"="+E:g.flashvars=w+"="+E}if(_(o)){var S=h(e,g,n);e.id==f&&x(f,!0),v.success=!0,v.ref=S,v.id=S.id}else{if(l&&a())return e.data=l,void s(e,g,n,p);x(f,!0)}p&&p(v)})):p&&p(v)},switchOffAutoHideShow:function(){W=!1},enableUriEncoding:function(t){X=(void 0===t?"undefined":(0,T.default)(t))===R||t},ua:q,getFlashPlayerVersion:function(){return{major:q.pv[0],minor:q.pv[1],release:q.pv[2]}},hasFlashPlayerVersion:_,createSWF:function(t,e,n){return q.w3?h(t,e,n):void 0},showExpressInstall:function(t,e,n,i){q.w3&&a()&&s(t,e,n,i)},removeSWF:function(t){q.w3&&p(t)},createCSS:function(t,e,n,i){q.w3&&w(t,e,n,i)},addDomLoadEvent:e,addLoadEvent:n,getQueryParamValue:function(t){var e=O.location.search||O.location.hash;if(e){if(/\?/.test(e)&&(e=e.split("?")[1]),!t)return E(e);for(var n=e.split("&"),i=0;i<n.length;i++)if(n[i].substring(0,n[i].indexOf("="))==t)return E(n[i].substring(n[i].indexOf("=")+1))}return""},expressInstallCallback:function(){if(z){var t=v(I);t&&S&&(t.parentNode.replaceChild(S,t),A&&(x(A,!0),q.ie&&(S.style.display="block")),C&&C(k)),z=!1}},version:"2.3"}})},{}],15:[function(t,e,n){function i(t){if(!(this instanceof i))return new i(t);this.initialize(t)}var r=t("./InLine"),o=t("./Wrapper");i.prototype.initialize=function(t){this.id=t.attr("id"),this.sequence=t.attr("sequence"),t.inLine&&(this.inLine=new r(t.inLine)),t.wrapper&&(this.wrapper=new o(t.wrapper))},e.exports=i},{"./InLine":18,"./Wrapper":28}],16:[function(t,e,n){function i(t){if(!(this instanceof i))return new i(t);s.info("<Companion> found companion ad"),s.debug("<Companion>  companionJTree:",t),this.creativeType=a.attr(t.staticResource,"creativeType"),this.staticResource=a.keyValue(t.staticResource),s.info("<Companion>  creativeType: "+this.creativeType),s.info("<Companion>  staticResource: "+this.staticResource);var e=null;a.keyValue(t.HTMLResource)?e=a.keyValue(t.HTMLResource):a.keyValue(t.hTMLResource)&&(e=a.keyValue(t.hTMLResource)),null!==e&&s.info("<Companion> found html resource",e),this.htmlResource=e;var n=null;a.keyValue(t.IFrameResource)?n=a.keyValue(t.IFrameResource):a.keyValue(t.iFrameresource)&&(n=a.keyValue(t.iFrameresource)),null!==n&&s.info("<Companion> found iframe resource",n),this.iframeResource=n,this.id=a.attr(t,"id"),this.width=a.attr(t,"width"),this.height=a.attr(t,"height"),this.expandedWidth=a.attr(t,"expandedWidth"),this.expandedHeight=a.attr(t,"expandedHeight"),this.scalable=a.attr(t,"scalable"),this.maintainAspectRatio=a.attr(t,"maintainAspectRatio"),this.minSuggestedDuration=a.attr(t,"minSuggestedDuration"),this.apiFramework=a.attr(t,"apiFramework"),this.companionClickThrough=a.keyValue(t.companionClickThrough),this.trackingEvents=function(t){var e=[];return o.isDefined(t)&&(t=o.isArray(t)?t:[t],t.forEach(function(t){e.push(new r(t))})),e}(t.trackingEvents&&t.trackingEvents.tracking),s.info("<Companion>  companionClickThrough: "+this.companionClickThrough)}var r=t("./TrackingEvent"),o=t("../../utils/utilityFunctions"),a=t("../../utils/xml"),s=t("../../utils/consoleLogger");e.exports=i},{"../../utils/consoleLogger":41,"../../utils/utilityFunctions":47,"../../utils/xml":48,"./TrackingEvent":21}],17:[function(t,e,n){function i(t){if(!(this instanceof i))return new i(t);if(this.id=t.attr("id"),this.sequence=t.attr("sequence"),this.adId=t.attr("adId"),this.apiFramework=t.attr("apiFramework"),t.linear&&(this.linear=new r(t.linear)),t.companionAds){var e=[],n=t.companionAds&&t.companionAds.companion;a.isDefined(n)&&(n=a.isArray(n)?n:[n],n.forEach(function(t){e.push(new o(t))})),this.companionAds=e}}var r=t("./Linear"),o=t("./Companion"),a=t("../../utils/utilityFunctions");i.prototype.isSupported=function(){return!this.linear||this.linear.isSupported()},i.parseCreatives=function(t){var e,n=[];return a.isDefined(t)&&a.isDefined(t.creative)&&(e=a.isArray(t.creative)?t.creative:[t.creative],e.forEach(function(t){n.push(new i(t))})),n},e.exports=i},{"../../utils/utilityFunctions":47,"./Companion":16,"./Linear":19}],18:[function(t,e,n){function i(t){if(!(this instanceof i))return new i(t);this.adTitle=s.keyValue(t.adTitle),this.adSystem=s.keyValue(t.adSystem),this.impressions=r.parseImpressions(t.impression),this.creatives=o.parseCreatives(t.creatives),this.description=s.keyValue(t.description),this.advertiser=s.keyValue(t.advertiser),this.surveys=function(t){return t?a.transformArray(a.isArray(t)?t:[t],function(t){if(a.isNotEmptyString(t.keyValue))return{uri:t.keyValue,type:t.attr("type")}}):[]}(t.survey),this.error=s.keyValue(t.error),this.pricing=s.keyValue(t.pricing),this.extensions=t.extensions}var r=t("./vastUtil"),o=t("./Creative"),a=t("../../utils/utilityFunctions"),s=t("../../utils/xml");i.prototype.isSupported=function(){var t,e;if(0===this.creatives.length)return!1;for(t=0,e=this.creatives.length;t<e;t+=1)if(!this.creatives[t].isSupported())return!1;return!0},e.exports=i},{"../../utils/utilityFunctions":47,"../../utils/xml":48,"./Creative":17,"./vastUtil":30}],19:[function(t,e,n){function i(t){if(!(this instanceof i))return new i(t);this.duration=l.duration(u.keyValue(t.duration)),this.mediaFiles=function(t){var e=[];return s.isDefined(t)&&(t=s.isArray(t)?t:[t],t.forEach(function(t){e.push(new o(t))})),e}(t.mediaFiles&&t.mediaFiles.mediaFile),this.trackingEvents=function(t,e){var n=[];return s.isDefined(t)&&(t=s.isArray(t)?t:[t],t.forEach(function(t){n.push(new r(t,e))})),n}(t.trackingEvents&&t.trackingEvents.tracking,this.duration),this.skipoffset=l.offset(u.attr(t,"skipoffset"),this.duration),t.videoClicks&&(this.videoClicks=new a(t.videoClicks)),t.adParameters&&(this.adParameters=u.keyValue(t.adParameters),u.attr(t.adParameters,"xmlEncoded")&&(this.adParameters=u.decode(this.adParameters)))}var r=t("./TrackingEvent"),o=t("./MediaFile"),a=t("./VideoClicks"),s=t("../../utils/utilityFunctions"),l=t("./parsers"),u=t("../../utils/xml");i.prototype.isSupported=function(){var t,e;for(t=0,e=this.mediaFiles.length;t<e;t+=1)if(this.mediaFiles[t].isSupported())return!0;return!1},e.exports=i},{"../../utils/utilityFunctions":47,"../../utils/xml":48,"./MediaFile":20,"./TrackingEvent":21,"./VideoClicks":27,"./parsers":29}],20:[function(t,e,n){function i(t){if(!(this instanceof i))return new i(t);this.src=r.keyValue(t);for(var e=0;e<a.length;e++){var n=a[e];this[n]=t.attr(n)}}var r=t("../../utils/xml"),o=t("./vastUtil"),a=["delivery","type","width","height","codec","id","bitrate","minBitrate","maxBitrate","scalable","maintainAspectRatio","apiFramework"];i.prototype.isSupported=function(){return o.isVPAID(this)?!!o.findSupportedVPAIDTech(this.type):"video/x-flv"!==this.type||o.isFlashSupported()},e.exports=i},{"../../utils/xml":48,"./vastUtil":30}],21:[function(t,e,n){function i(t,e){if(!(this instanceof i))return new i(t,e);this.name=t.attr("event"),this.uri=o.keyValue(t),"progress"===this.name&&(this.offset=r.offset(t.attr("offset"),e))}var r=t("./parsers"),o=t("../../utils/xml");e.exports=i},{"../../utils/xml":48,"./parsers":29}],22:[function(t,e,n){function i(t){if(!(this instanceof i))return new i(t);var e={WRAPPER_LIMIT:5};t=t||{},this.settings=c.extend({},t,e),this.errorURLMacros=[]}var r=t("./Ad"),o=t("./VASTError"),a=t("./VASTResponse"),s=t("./vastUtil"),l=t("../../utils/async"),u=t("../../utils/http").http,c=t("../../utils/utilityFunctions"),h=t("../../utils/xml"),d=t("../../utils/consoleLogger");i.prototype.getVASTResponse=function(t,e){function n(t,e){try{var n=i._buildVASTResponse(t);e(null,n)}catch(t){e(t)}}var i=this,r=function(t,e){return t?c.isFunction(e)?void 0:new o("on VASTClient.getVASTResponse, missing callback function"):new o("on VASTClient.getVASTResponse, missing ad tag URL")}(t,e);if(r){if(c.isFunction(e))return e(r);throw r}l.waterfall([this._getVASTAd.bind(this,t),n],e)},i.prototype._getVASTAd=function(t,e){function n(t,e){var n;try{n=h.toJXONTree(t),d.debug("built JXONTree from VAST response:",n),c.isArray(n.ad)?n.ads=n.ad:n.ad?n.ads=[n.ad]:n.ads=[],e(i(n),n)}catch(t){e(new o("on VASTClient.getVASTAd.buildVastWaterfall, error parsing xml",100),null)}}function i(t){var e=h.attr(t,"version");return t.ad?e&&3!=e&&2!=e?new o('on VASTClient.getVASTAd.validateVASTTree, not supported VAST version "'+e+'"',102):null:new o("on VASTClient.getVASTAd.validateVASTTree, no Ad in VAST tree",303)}function a(t,e,n){if(e.length>=f.WRAPPER_LIMIT)return n(new o("on VASTClient.getVASTAd.getAd, players wrapper limit reached (the limit is "+f.WRAPPER_LIMIT+")",302),e);l.waterfall([function(e){c.isString(t)?p(t,e):e(null,t)},s],function(t,i){return i&&e.push(i),t?n(t,e):i.wrapper?a(i.wrapper.VASTAdTagURI,e,n):n(null,e)})}function s(t,e){try{var n=new r(t);e(u(n),n)}catch(t){e(new o("on VASTClient.getVASTAd.buildAd, error parsing xml",100),null)}}function u(t){var e=t.wrapper,n=t.inLine,i="on VASTClient.getVASTAd.validateAd, ";return n&&e?new o(i+"InLine and Wrapper both found on the same Ad",101):n||e?n&&!n.isSupported()?new o(i+"could not find MediaFile that is supported by this video player",403):e&&!e.VASTAdTagURI?new o(i+"missing 'VASTAdTagURI' in wrapper",101):null:new o(i+"nor wrapper nor inline elements found on the Ad",101)}function p(t,e){f._requestVASTXml(t,function(t,n){if(t)return e(t);try{var r=h.toJXONTree(n);e(i(r),r.ad)}catch(t){e(new o("on VASTClient.getVASTAd.requestVASTAd, error parsing xml",100))}})}var f=this;!function(t,e){var i=f._requestVASTXml.bind(f,t);l.waterfall([i,n],e)}(t,function(t,n){function i(t,n){t?(f._trackError(t,n),r.length>0?a(r.shift(),[],i):e(t,n)):e(null,n)}var r=n&&c.isArray(n.ads)?n.ads:null;if(t)return f._trackError(t,r),e(t,r);a(r.shift(),[],i)})},i.prototype._requestVASTXml=function(t,e){function n(t,n,i){if(t){var r=c.isDefined(i)?"on VASTClient.requestVastXML, HTTP request error with status '"+i+"'":"on VASTClient.requestVastXML, Error getting the the VAST XML with he passed adTagXML fn";return e(new o(r,301),null)}e(null,n)}try{c.isFunction(t)?t(n):(d.info("requesting adTagUrl: "+t),u.get(t,n,{withCredentials:!1}))}catch(t){e(t)}},i.prototype._buildVASTResponse=function(t){var e=new a;return function(t,e){e.forEach(function(e){t.addAd(e)})}(e,t),function(t){var e=t.trackingEvents.progress;if(!t.hasLinear())throw new o("on VASTClient._buildVASTResponse, Received an Ad type that is not supported",200);if(void 0===t.duration)throw new o("on VASTClient._buildVASTResponse, Missing duration field in VAST response",101);e&&e.forEach(function(t){if(!c.isNumber(t.offset))throw new o("on VASTClient._buildVASTResponse, missing or wrong offset attribute on progress tracking event",101)})}(e),e},i.prototype._trackError=function(t,e){function n(t){t.wrapper&&t.wrapper.error&&i.push(t.wrapper.error),t.inLine&&t.inLine.error&&i.push(t.inLine.error)}if(c.isArray(e)&&0!==e.length){var i=[];e.forEach(n),s.track(i,{ERRORCODE:t.code||900})}},e.exports=i},{"../../utils/async":40,"../../utils/consoleLogger":41,"../../utils/http":43,"../../utils/utilityFunctions":47,"../../utils/xml":48,"./Ad":15,"./VASTError":23,"./VASTResponse":25,"./vastUtil":30}],23:[function(t,e,n){function i(t,e){this.message="VAST Error: "+(t||""),e&&(this.code=e)}i.prototype=new Error,i.prototype.name="VAST Error",e.exports=i},{}],24:[function(t,e,n){function i(t){if(!(this instanceof i))return new i(t);this.player=t}var r=t("./VASTResponse"),o=t("./VASTError"),a=t("./VASTTracker"),s=t("./vastUtil"),l=t("../../utils/async"),u=t("../../utils/dom"),c=t("../../utils/playerUtils"),h=t("../../utils/utilityFunctions"),d=t("../../utils/consoleLogger");i.prototype.playAd=function(t,e){var n=this;return e=e||h.noop,t instanceof r?(l.waterfall([function(e){e(null,t)},this._selectAdSource.bind(this),this._createVASTTracker.bind(this),this._addClickThrough.bind(this),this._addSkipButton.bind(this),this._setupEvents.bind(this),this._playSelectedAd.bind(this)],function(t,i){t&&i&&n._trackError(t,i),e(t,i)}),this._adUnit={_src:null,type:"VAST",pauseAd:function(){n.player.pause(!0)},resumeAd:function(){n.player.play(!0)},isPaused:function(){return n.player.paused(!0)},getSrc:function(){return this._src}},this._adUnit):e(new o("On VASTIntegrator, missing required VASTResponse"))},i.prototype._selectAdSource=function(t,e){var n,i=u.getDimension(this.player.el()).width;if(t.mediaFiles.sort(function(t,e){return Math.abs(i-t.width)-Math.abs(i-e.width)}),n=this.player.selectSource(t.mediaFiles).source)return d.info("selected source: ",n),this._adUnit&&(this._adUnit._src=n),e(null,n,t);e(new o("Could not find Ad mediafile supported by this player",403),t)},i.prototype._createVASTTracker=function(t,e,n){try{n(null,t,new a(t.src,e),e)}catch(t){n(t,e)}},i.prototype._setupEvents=function(t,e,n,i){function r(){d.off("fullscreenchange",o),d.off("vast.adStart",l),d.off("pause",a),d.off("timeupdate",s),d.off("volumechange",u)}function o(){d.isFullscreen()?e.trackFullscreen():e.trackExitFullscreen()}function a(){Math.abs(d.duration()-d.currentTime())<2||(e.trackPause(),c.once(d,["play","vast.adEnd","vast.adsCancel"],function(t){"play"===t.type&&e.trackResume()}))}function s(){var t=1e3*d.currentTime();e.trackProgress(t)}function l(){e.trackImpressions(),e.trackCreativeView()}function u(){var t=d.muted();t?e.trackMute():h&&e.trackUnmute(),h=t}var h,d=this.player;return d.on("fullscreenchange",o),d.on("vast.adStart",l),d.on("pause",a),d.on("timeupdate",s),d.on("volumechange",u),c.once(d,["vast.adEnd","vast.adsCancel"],r),c.once(d,["vast.adEnd","vast.adsCancel","vast.adSkip"],function(t){"vast.adEnd"===t.type&&e.trackComplete()}),i(null,t,n)},i.prototype._addSkipButton=function(t,e,n,i){function r(t){var n=window.document.createElement("div");return u.addClass(n,"vast-skip-button"),n.onclick=function(i){if(u.hasClass(n,"enabled")&&(e.trackSkip(),t.trigger("vast.adSkip")),void 0===window.Event.prototype.stopPropagation)return!1;i.stopPropagation()},n}function o(t,e,n){var i=Math.ceil(e-n.currentTime());i>0?t.innerHTML="ÙÙØ§ÛØ´ ÙÛØ¯ÛÙ "+h.toFixedDigits(i,2)+" ":u.hasClass(t,"enabled")||(u.addClass(t,"enabled"),t.innerHTML="ÙÙØ§ÛØ´ ÙÛØ¯ÛÙ")}var a,s=this;h.isNumber(n.skipoffset)&&(a=n.skipoffset/1e3,function(t,e){function n(){t.off("timeupdate",a),u.remove(i)}var i=r(t),a=o.bind(s,i,e,t);t.el().appendChild(i),t.on("timeupdate",a),c.once(t,["vast.adEnd","vast.adsCancel"],n)}(this.player,a)),i(null,t,e,n)},i.prototype._addClickThrough=function(t,e,n,i){function r(t,e,n){t.href=o(e.clickThrough,n)}function o(e,n){var i={ASSETURI:t.src,CONTENTPLAYHEAD:s.formatProgress(1e3*n.currentTime())};return e?s.parseURLMacro(e,i):"#"}function a(){l.off("timeupdate",p),u.remove(d)}var l=this.player,d=function(t,e,n){var i=window.document.createElement("a"),r=n.clickThrough;return u.addClass(i,"vast-blocker"),i.href=o(r,t),h.isString(r)&&(i.target="_blank"),i.onclick=function(n){if(t.paused())return t.play(),void 0!==window.Event.prototype.stopPropagation&&n.stopPropagation(),!1;t.pause(),e.trackClick()},i}(l,e,n),p=r.bind(this,d,n,l);return l.el().insertBefore(d,l.controlBar.el()),l.on("timeupdate",p),c.once(l,["vast.adEnd","vast.adsCancel"],a),i(null,t,e,n)},i.prototype._playSelectedAd=function(t,e,n){function i(){c.once(r,["playing","vast.adsCancel"],function(t){function i(t){"ended"===t.type&&r.duration()-r.currentTime()>3||(r.off("ended",i),r.off("vast.adsCancel",i),r.off("vast.adSkip",i),"ended"!==t.type&&"vast.adSkip"!==t.type||n(null,e))}"vast.adsCancel"!==t.type&&(d.debug("<VASTIntegrator._playSelectedAd/playAd> got playing event; triggering vast.adStart..."),r.trigger("vast.adStart"),r.on("ended",i),r.on("vast.adsCancel",i),r.on("vast.adSkip",i))}),d.debug("<VASTIntegrator._playSelectedAd/playAd> calling player.play()..."),r.play()}var r=this.player;r.preload("auto"),r.src(t),d.debug("<VASTIntegrator._playSelectedAd> waiting for durationchange to play the ad..."),c.once(r,["durationchange","error","vast.adsCancel"],function(t){"durationchange"===t.type?(d.debug("<VASTIntegrator._playSelectedAd> got durationchange; calling playAd()"),i()):"error"===t.type&&n(new o("on VASTIntegrator, Player is unable to play the Ad",400),e)})},i.prototype._trackError=function(t,e){s.track(e.errorURLMacros,{ERRORCODE:t.code||900})},e.exports=i},{"../../utils/async":40,"../../utils/consoleLogger":41,"../../utils/dom":42,"../../utils/playerUtils":45,"../../utils/utilityFunctions":47,"./VASTError":23,"./VASTResponse":25,"./VASTTracker":26,"./vastUtil":30}],25:[function(t,e,n){function i(){if(!(this instanceof i))return new i;this._linearAdded=!1,this.ads=[],this.errorURLMacros=[],this.impressions=[],this.clickTrackings=[],this.customClicks=[],this.trackingEvents={},this.mediaFiles=[],this.clickThrough=void 0,this.adTitle="",this.duration=void 0,this.skipoffset=void 0}function r(t,e){e.forEach(function(e){t.push(e)})}var o=t("./Ad"),a=t("./VideoClicks"),s=t("./Linear"),l=t("./InLine"),u=t("./Wrapper"),c=t("../../utils/utilityFunctions"),h=t("../../utils/xml");window.InLine__A=l,i.prototype.addAd=function(t){var e,n;t instanceof o&&(e=t.inLine,n=t.wrapper,this.ads.push(t),e&&this._addInLine(e),n&&this._addWrapper(n))},i.prototype._addErrorTrackUrl=function(t){var e=t instanceof h.JXONTree?h.keyValue(t):t;e&&this.errorURLMacros.push(e)},i.prototype._addImpressions=function(t){c.isArray(t)&&r(this.impressions,t)},i.prototype._addClickThrough=function(t){c.isNotEmptyString(t)&&(this.clickThrough=t)},i.prototype._addClickTrackings=function(t){c.isArray(t)&&r(this.clickTrackings,t)},i.prototype._addCustomClicks=function(t){c.isArray(t)&&r(this.customClicks,t)},i.prototype._addTrackingEvents=function(t){var e=this.trackingEvents;t&&(t=c.isArray(t)?t:[t],t.forEach(function(t){e[t.name]||(e[t.name]=[]),e[t.name].push(t)}))},i.prototype._addTitle=function(t){c.isNotEmptyString(t)&&(this.adTitle=t)},i.prototype._addDuration=function(t){c.isNumber(t)&&(this.duration=t)},i.prototype._addVideoClicks=function(t){t instanceof a&&(this._addClickThrough(t.clickThrough),this._addClickTrackings(t.clickTrackings),this._addCustomClicks(t.customClicks))},i.prototype._addMediaFiles=function(t){c.isArray(t)&&r(this.mediaFiles,t)},i.prototype._addSkipoffset=function(t){t&&(this.skipoffset=t)},i.prototype._addAdParameters=function(t){t&&(this.adParameters=t)},i.prototype._addLinear=function(t){t instanceof s&&(this._addDuration(t.duration),this._addTrackingEvents(t.trackingEvents),this._addVideoClicks(t.videoClicks),this._addMediaFiles(t.mediaFiles),this._addSkipoffset(t.skipoffset),this._addAdParameters(t.adParameters),this._linearAdded=!0)},i.prototype._addInLine=function(t){var e=this;t instanceof l&&(this._addTitle(t.adTitle),this._addErrorTrackUrl(t.error),this._addImpressions(t.impressions),t.creatives.forEach(function(t){t.linear&&e._addLinear(t.linear)}))},i.prototype._addWrapper=function(t){var e=this;t instanceof u&&(this._addErrorTrackUrl(t.error),this._addImpressions(t.impressions),t.creatives.forEach(function(t){var n=t.linear;n&&(e._addVideoClicks(n.videoClicks),e.clickThrough=void 0,e._addTrackingEvents(n.trackingEvents))}))},i.prototype.hasLinear=function(){return this._linearAdded},e.exports=i},{"../../utils/utilityFunctions":47,"../../utils/xml":48,"./Ad":15,"./InLine":18,"./Linear":19,"./VideoClicks":27,"./Wrapper":28}],26:[function(t,e,n){function i(t,e){if(!(this instanceof i))return new i(t,e);this.sanityCheck(t,e),this.initialize(t,e)}var r=t("./VASTError"),o=t("./VASTResponse"),a=t("./vastUtil"),s=t("../../utils/utilityFunctions");i.prototype.initialize=function(t,e){this.response=e,this.assetURI=t,this.progress=0,this.quartiles={firstQuartile:{tracked:!1,time:Math.round(25*e.duration)/100},midpoint:{tracked:!1,time:Math.round(50*e.duration)/100},thirdQuartile:{tracked:!1,time:Math.round(75*e.duration)/100}}},i.prototype.sanityCheck=function(t,e){if(!s.isString(t)||s.isEmptyString(t))throw new r("on VASTTracker constructor, missing required the URI of the ad asset being played");if(!(e instanceof o))throw new r("on VASTTracker constructor, missing required VAST response")},i.prototype.trackURLs=function(t,e){s.isArray(t)&&t.length>0&&(e=s.extend({ASSETURI:this.assetURI,CONTENTPLAYHEAD:a.formatProgress(this.progress)},e||{}),a.track(t,e))},i.prototype.trackEvent=function(t,e){this.trackURLs(function(t){var e;return t&&(e=[],t.forEach(function(t){e.push(t.uri)})),e}(this.response.trackingEvents[t])),e&&(this.response.trackingEvents[t]=void 0)},i.prototype.trackProgress=function(t){function e(t,e,n){a[t]&&n&&r.push({name:t,trackOnce:!!e})}function n(t,e){var n=t.time;return e>=n&&e<=n+5e3}var i=this,r=[],o=!0,a=this.response.trackingEvents;s.isNumber(t)&&(e("start",o,t>0),e("rewind",!1,function(e,n){return e>t&&Math.abs(n-e)>3e3}(this.progress,t)),function(t){function r(t,i){var r=a[t];n(r,i)&&(r.tracked=!0,e(t,o,!0))}var a=i.quartiles,s=i.quartiles.firstQuartile,l=i.quartiles.midpoint,u=i.quartiles.thirdQuartile;s.tracked?l.tracked?u.tracked||r("thirdQuartile",t):r("midpoint",t):r("firstQuartile",t)}(t),function(t){if(s.isArray(a.progress)){var e=[];a.progress.forEach(function(n){n.offset<=t?i.trackURLs([n.uri]):e.push(n)}),a.progress=e}}(t),function(){r.forEach(function(t){i.trackEvent(t.name,t.trackOnce)})}(),this.progress=t)},["rewind","fullscreen","exitFullscreen","pause","resume","mute","unmute","acceptInvitation","acceptInvitationLinear","collapse","expand"].forEach(function(t){i.prototype["track"+s.capitalize(t)]=function(){this.trackEvent(t)}}),["start","skip","close","closeLinear"].forEach(function(t){i.prototype["track"+s.capitalize(t)]=function(){this.trackEvent(t,!0)}}),["firstQuartile","midpoint","thirdQuartile"].forEach(function(t){i.prototype["track"+s.capitalize(t)]=function(){this.quartiles[t].tracked=!0,this.trackEvent(t,!0)}}),i.prototype.trackComplete=function(){this.quartiles.thirdQuartile.tracked&&this.trackEvent("complete",!0)},i.prototype.trackErrorWithCode=function(t){s.isNumber(t)&&this.trackURLs(this.response.errorURLMacros,{ERRORCODE:t})},i.prototype.trackImpressions=function(){this.trackURLs(this.response.impressions)},i.prototype.trackCreativeView=function(){this.trackEvent("creativeView")},i.prototype.trackClick=function(){this.trackURLs(this.response.clickTrackings)},e.exports=i},{"../../utils/utilityFunctions":47,"./VASTError":23,"./VASTResponse":25,"./vastUtil":30}],27:[function(t,e,n){function i(t){function e(t){var e=[];return t&&(t=r.isArray(t)?t:[t],t.forEach(function(t){e.push(o.keyValue(t))})),e}if(!(this instanceof i))return new i(t);this.clickThrough=o.keyValue(t.clickThrough),this.clickTrackings=e(t.clickTracking),this.customClicks=e(t.customClick)}var r=t("../../utils/utilityFunctions"),o=t("../../utils/xml");e.exports=i},{"../../utils/utilityFunctions":47,"../../utils/xml":48}],28:[function(t,e,n){function i(t){if(!(this instanceof i))return new i(t);this.adSystem=s.keyValue(t.adSystem),this.impressions=r.parseImpressions(t.impression),this.VASTAdTagURI=s.keyValue(t.vASTAdTagURI),this.creatives=o.parseCreatives(t.creatives),this.error=s.keyValue(t.error),this.extensions=t.extensions,this.followAdditionalWrappers=!a.isDefined(s.attr(t,"followAdditionalWrappers"))||s.attr(t,"followAdditionalWrappers"),this.allowMultipleAds=s.attr(t,"allowMultipleAds"),this.fallbackOnNoAd=s.attr(t,"fallbackOnNoAd")}var r=t("./vastUtil"),o=t("./Creative"),a=t("../../utils/utilityFunctions"),s=t("../../utils/xml");e.exports=i},{"../../utils/utilityFunctions":47,"../../utils/xml":48,"./Creative":17,"./vastUtil":30}],29:[function(t,e,n){var i=t("../../utils/utilityFunctions"),r=/(\d\d):(\d\d):(\d\d)(\.(\d\d\d))?/,o={duration:function(t){var e,n;return i.isString(t)&&(e=t.match(r))&&(n=function(t){return 60*parseInt(t,10)*60*1e3}(e[1])+function(t){return 60*parseInt(t,10)*1e3}(e[2])+function(t){return 1e3*parseInt(t,10)}(e[3])+parseInt(e[5]||0)),isNaN(n)?null:n},offset:function(t,e){function n(t,e){return t*e/100}return function(t){return/^\d+(\.\d+)?%$/g.test(t)}(t)?function(t,e){return e?n(e,parseFloat(t.replace("%",""))):null}(t,e):o.duration(t)}};e.exports=o},{"../../utils/utilityFunctions":47}],30:[function(t,e,n){var i=t("../../utils/utilityFunctions"),r=t("../vpaid/VPAIDHTML5Tech"),o=t("../vpaid/VPAIDFlashTech"),a=t("VPAIDFLASHClient/js/VPAIDFLASHClient"),s={track:function(t,e){var n=s.parseURLMacros(t,e),i=[];return n.forEach(function(t){var e=new Image;e.src=t,i.push(e)}),i},parseURLMacros:function(t,e){var n=[];return e=e||{},e.CACHEBUSTING||(e.CACHEBUSTING=Math.round(1e10*Math.random())),t.forEach(function(t){n.push(s._parseURLMacro(t,e))}),n},parseURLMacro:function(t,e){return e=e||{},e.CACHEBUSTING||(e.CACHEBUSTING=Math.round(1e10*Math.random())),s._parseURLMacro(t,e)},_parseURLMacro:function(t,e){return e=e||{},i.forEach(e,function(e,n){t=t.replace(new RegExp("\\["+n+"\\]","gm"),e)}),t},parseDuration:function(t){var e,n,r=/(\d\d):(\d\d):(\d\d)(\.(\d\d\d))?/;return i.isString(t)&&(e=t.match(r))&&(n=function(t){return 60*parseInt(t,10)*60*1e3}(e[1])+function(t){return 60*parseInt(t,10)*1e3}(e[2])+function(t){return 1e3*parseInt(t,10)}(e[3])+parseInt(e[5]||0)),isNaN(n)?null:n},parseImpressions:function(t){return t?(t=i.isArray(t)?t:[t],i.transformArray(t,function(t){if(i.isNotEmptyString(t.keyValue))return t.keyValue})):[]},formatProgress:function(t){var e,n,r,o;return e=t/36e5,e=Math.floor(e),n=t/6e4%60,n=Math.floor(n),r=t/1e3%60,r=Math.floor(r),o=t%1e3,i.toFixedDigits(e,2)+":"+i.toFixedDigits(n,2)+":"+i.toFixedDigits(r,2)+"."+i.toFixedDigits(o,3)},parseOffset:function(t,e){function n(t,e){return t*e/100}return function(t){return/^\d+(\.\d+)?%$/g.test(t)}(t)?function(t,e){return e?n(e,parseFloat(t.replace("%",""))):null}(t,e):s.parseDuration(t)},VPAID_techs:[o,r],isVPAID:function(t){return!!t&&"VPAID"===t.apiFramework},findSupportedVPAIDTech:function(t){var e,n,i;for(e=0,n=this.VPAID_techs.length;e<n;e+=1)if(i=this.VPAID_techs[e],i.supports(t))return i;return null},isFlashSupported:function(){return a.isSupported()},runFlashSupportCheck:function(t){a.runFlashTest({data:t})}};e.exports=s},{"../../utils/utilityFunctions":47,"../vpaid/VPAIDFlashTech":32,"../vpaid/VPAIDHTML5Tech":33,"VPAIDFLASHClient/js/VPAIDFLASHClient":3}],31:[function(t,e,n){function i(t,e){if(!(this instanceof i))return new i(t,e);!function(t,e){if(!t||!i.checkVPAIDInterface(t))throw new r("on VPAIDAdUnitWrapper, the passed VPAID adUnit does not fully implement the VPAID interface");if(!o.isObject(e))throw new r("on VPAIDAdUnitWrapper, expected options hash  but got '"+e+"'");if(!("responseTimeout"in e&&o.isNumber(e.responseTimeout)))throw new r("on VPAIDAdUnitWrapper, expected responseTimeout in options")}(t,e),this.options=o.extend({},e),this._adUnit=t}var r=t("../vast/VASTError"),o=t("../../utils/utilityFunctions");i.checkVPAIDInterface=function(t){for(var e=["handshakeVersion","initAd","startAd","stopAd","resizeAd","pauseAd","expandAd","collapseAd"],n=0,i=e.length;n<i;n++)if(!t||!o.isFunction(t[e[n]]))return!1;return function(t){return o.isFunction(t.subscribe)||o.isFunction(t.addEventListener)||o.isFunction(t.on)}(t)&&function(t){return o.isFunction(t.unsubscribe)||o.isFunction(t.removeEventListener)||o.isFunction(t.off)}(t)},i.prototype.adUnitAsyncCall=function(){var t,e=o.arrayLikeObjToArray(arguments),n=e.shift(),i=e.pop();!function(t,e,n){if(!o.isString(t)||!o.isFunction(n[t]))throw new r("on VPAIDAdUnitWrapper.adUnitAsyncCall, invalid method name");if(!o.isFunction(e))throw new r("on VPAIDAdUnitWrapper.adUnitAsyncCall, missing callback")}(n,i,this._adUnit),e.push(function(){return function(){t&&clearTimeout(t),i.apply(this,arguments)}}()),this._adUnit[n].apply(this._adUnit,e),t=setTimeout(function(){t=null,i(new r("on VPAIDAdUnitWrapper, timeout while waiting for a response on call '"+n+"'")),i=o.noop},this.options.responseTimeout)},i.prototype.on=function(t,e){(this._adUnit.addEventListener||this._adUnit.subscribe||this._adUnit.on).call(this._adUnit,t,e)},i.prototype.off=function(t,e){(this._adUnit.removeEventListener||this._adUnit.unsubscribe||this._adUnit.off).call(this._adUnit,t,e)},i.prototype.waitForEvent=function(t,e,n){function i(){var t=o.arrayLikeObjToArray(arguments);a&&(clearTimeout(a),a=null),t.unshift(null),e.apply(n,t)}var a;!function(t,e){if(!o.isString(t))throw new r("on VPAIDAdUnitWrapper.waitForEvent, missing evt name");if(!o.isFunction(e))throw new r("on VPAIDAdUnitWrapper.waitForEvent, missing callback")}(t,e),n=n||null,this.on(t,i),a=setTimeout(function(){e(new r("on VPAIDAdUnitWrapper.waitForEvent, timeout while waiting for event '"+t+"'")),a=null,e=o.noop},this.options.responseTimeout)},i.prototype.handshakeVersion=function(t,e){this.adUnitAsyncCall("handshakeVersion",t,e)},i.prototype.initAd=function(t,e,n,i,r,o){this.waitForEvent("AdLoaded",o),this._adUnit.initAd(t,e,n,i,r)},i.prototype.resizeAd=function(t,e,n,i){this.adUnitAsyncCall("resizeAd",t,e,n,i)},i.prototype.startAd=function(t){this.waitForEvent("AdStarted",t),this._adUnit.startAd()},i.prototype.stopAd=function(t){this.waitForEvent("AdStopped",t),this._adUnit.stopAd()},i.prototype.pauseAd=function(t){this.waitForEvent("AdPaused",t),this._adUnit.pauseAd()},i.prototype.resumeAd=function(t){this.waitForEvent("AdPlaying",t),this._adUnit.resumeAd()},i.prototype.expandAd=function(t){this.waitForEvent("AdExpandedChange",t),this._adUnit.expandAd()},i.prototype.collapseAd=function(t){this.waitForEvent("AdExpandedChange",t),this._adUnit.collapseAd()},i.prototype.skipAd=function(t){this.waitForEvent("AdSkipped",t),this._adUnit.skipAd()},["adLinear","adWidth","adHeight","adExpanded","adSkippableState","adRemainingTime","adDuration","adVolume","adCompanions","adIcons"].forEach(function(t){var e="get"+o.capitalize(t);i.prototype[e]=function(t){this.adUnitAsyncCall(e,t)}}),i.prototype.setAdVolume=function(t,e){this.adUnitAsyncCall("setAdVolume",t,e)},e.exports=i},{"../../utils/utilityFunctions":47,"../vast/VASTError":23}],32:[function(t,e,n){function i(t,e){if(!(this instanceof i))return new i(t);!function(t){if(!t||!s.isString(t.src))throw new o("on VPAIDFlashTech, invalid MediaFile")}(t),this.name="vpaid-flash",this.mediaFile=t,this.containerEl=null,this.vpaidFlashClient=null,this.settings=e}var r=t("../../utils/mimetypes"),o=t("../vast/VASTError"),a=t("VPAIDFLASHClient/js/VPAIDFLASHClient"),s=t("../../utils/utilityFunctions"),l=t("../../utils/dom"),u=t("../../utils/consoleLogger");i.VPAIDFLASHClient=a,i.supports=function(t){return r.flash.indexOf(t)>-1&&i.VPAIDFLASHClient.isSupported()},i.prototype.loadAdUnit=function(t,e,n){var r=this,a=this.settings&&this.settings.vpaidFlashLoaderPath?{data:this.settings.vpaidFlashLoaderPath}:void 0;!function(t,e){if(!l.isDomElement(t))throw new o("on VPAIDFlashTech.loadAdUnit, invalid dom container element");if(!s.isFunction(e))throw new o("on VPAIDFlashTech.loadAdUnit, missing valid callback")}(t,n),this.containerEl=t,u.debug("<VPAIDFlashTech.loadAdUnit> loading VPAIDFLASHClient with opts:",a),this.vpaidFlashClient=new i.VPAIDFLASHClient(t,function(t){if(t)return n(t);u.info("<VPAIDFlashTech.loadAdUnit> calling VPAIDFLASHClient.loadAdUnit(); that.mediaFile:",r.mediaFile),r.vpaidFlashClient.loadAdUnit(r.mediaFile.src,n)},a)},i.prototype.unloadAdUnit=function(){if(this.vpaidFlashClient){try{this.vpaidFlashClient.destroy()}catch(t){u.error("VAST ERROR: trying to unload the VPAID adunit")}this.vpaidFlashClient=null}this.containerEl&&(l.remove(this.containerEl),this.containerEl=null)},e.exports=i},{"../../utils/consoleLogger":41,"../../utils/dom":42,"../../utils/mimetypes":44,"../../utils/utilityFunctions":47,"../vast/VASTError":23,"VPAIDFLASHClient/js/VPAIDFLASHClient":3}],33:[function(t,e,n){function i(t){if(!(this instanceof i))return new i(t);!function(t){if(!t||!s.isString(t.src))throw new o(i.INVALID_MEDIA_FILE)}(t),this.name="vpaid-html5",this.containerEl=null,this.videoEl=null,this.vpaidHTMLClient=null,this.mediaFile=t}var r=t("../../utils/mimetypes"),o=t("../vast/VASTError"),a=t("VPAIDHTML5Client/js/VPAIDHTML5Client"),s=t("../../utils/utilityFunctions"),l=t("../../utils/dom"),u=t("../../utils/consoleLogger");i.VPAIDHTML5Client=a,i.supports=function(t){return!s.isOldIE()&&r.html5.indexOf(t)>-1},i.prototype.loadAdUnit=function(t,e,n){!function(t,e,n){if(!l.isDomElement(t))throw new o(i.INVALID_DOM_CONTAINER_EL);if(!l.isDomElement(e)||"video"!==e.tagName.toLowerCase())throw new o(i.INVALID_DOM_CONTAINER_EL);if(!s.isFunction(n))throw new o(i.MISSING_CALLBACK)}(t,e,n),this.containerEl=t,this.videoEl=e,this.vpaidHTMLClient=new i.VPAIDHTML5Client(t,e,{}),this.vpaidHTMLClient.loadAdUnit(this.mediaFile.src,n)},i.prototype.unloadAdUnit=function(){if(this.vpaidHTMLClient){try{this.vpaidHTMLClient.destroy()}catch(t){u.error("VAST ERROR: trying to unload the VPAID adunit")}this.vpaidHTMLClient=null}this.containerEl&&(l.remove(this.containerEl),this.containerEl=null)};var c="on VPAIDHTML5Tech";i.INVALID_MEDIA_FILE=c+", invalid MediaFile",i.INVALID_DOM_CONTAINER_EL=c+", invalid container HtmlElement",i.INVALID_DOM_VIDEO_EL=c+", invalid HTMLVideoElement",i.MISSING_CALLBACK=c+", missing valid callback",e.exports=i},{"../../utils/consoleLogger":41,"../../utils/dom":42,"../../utils/mimetypes":44,"../../utils/utilityFunctions":47,"../vast/VASTError":23,"VPAIDHTML5Client/js/VPAIDHTML5Client":11}],34:[function(t,e,n){function i(t,e){if(!(this instanceof i))return new i(t);this.VIEW_MODE={NORMAL:"normal",FULLSCREEN:"fullscreen",THUMBNAIL:"thumbnail"},this.player=t,this.containerEl=function(){var e=document.createElement("div");return p.addClass(e,"VPAID-container"),t.el().insertBefore(e,t.controlBar.el()),e}(),this.options={responseTimeout:5e3,VPAID_VERSION:"2.0"},this.settings=e}function r(t,e,n){var i=t.el().querySelector(".vjs-tech"),r=p.getDimension(i),a=t.isFullscreen()?n.FULLSCREEN:n.NORMAL;e.resizeAd(r.width,r.height,a,o)}function o(t){t&&v.error("ERROR: "+t.message,t)}var a=t("../../utils/mimetypes"),s=t("../vast/VASTError"),l=t("../vast/VASTResponse"),u=t("../vast/VASTTracker"),c=t("../vast/vastUtil"),h=t("./VPAIDAdUnitWrapper"),d=t("../../utils/async"),p=t("../../utils/dom"),f=t("../../utils/playerUtils"),m=t("../../utils/utilityFunctions"),v=t("../../utils/consoleLogger");i.prototype.playAd=function(t,e){function n(t,n,i){t&&i&&o._trackError(i,t.code),a.trigger("vpaid.adEnd"),e(t,i)}function i(){a.trigger("vpaid.adEnd")}function r(){u&&u.unloadAdUnit(),p.removeClass(a.el(),"vjs-vpaid-ad")}if(!(t instanceof l))return e(new s("on VASTIntegrator.playAd, missing required VASTResponse"));var o=this,a=this.player;v.debug("<VPAIDIntegrator.playAd> looking for supported tech...");var u=this._findSupportedTech(t,this.settings);if(e=e||m.noop,this._adUnit=null,p.addClass(a.el(),"vjs-vpaid-ad"),a.on("vast.adsCancel",i),a.one("vpaid.adEnd",function(){a.off("vast.adsCancel",i),r()}),u)v.info("<VPAIDIntegrator.playAd> found tech: ",u),d.waterfall([function(e){e(null,u,t)},this._loadAdUnit.bind(this),this._playAdUnit.bind(this),this._finishPlaying.bind(this)],n),this._adUnit={_paused:!0,type:"VPAID",pauseAd:function(){a.trigger("vpaid.pauseAd"),a.pause(!0)},resumeAd:function(){a.trigger("vpaid.resumeAd")},isPaused:function(){return this._paused},getSrc:function(){return u.mediaFile}};else{v.debug("<VPAIDIntegrator.playAd> could not find suitable tech");n(new s("on VPAIDIntegrator.playAd, could not find a supported mediaFile",403),this._adUnit,t)}return this._adUnit},i.prototype._findSupportedTech=function(t,e){if(!(t instanceof l))return null;var n,i,r,o,s=t.mediaFiles.filter(c.isVPAID),u=e&&e.preferredTech,h=[];for(n=0,i=s.length;n<i;n+=1)if(r=s[n],o=c.findSupportedVPAIDTech(r.type)){if(!!u&&(r.type===u||a[u]&&a[u].indexOf(r.type)>-1))return new o(r,e);h.push({mediaFile:r,tech:o})}if(h.length){var d=h[0];return new d.tech(d.mediaFile,e)}return null},i.prototype._createVPAIDAdUnitWrapper=function(t,e,n){return new h(t,{src:e,responseTimeout:n})},i.prototype._loadAdUnit=function(t,e,n){var i=this,r=this.player,o=r.el().querySelector(".vjs-tech"),a=this.settings.responseTimeout||this.options.responseTimeout;t.loadAdUnit(this.containerEl,o,function(o,s){if(o)return n(o,s,e);try{var l=i._createVPAIDAdUnitWrapper(s,t.mediaFile.src,a),u="vjs-"+t.name+"-ad";p.addClass(r.el(),u),r.one("vpaid.adEnd",function(){p.removeClass(r.el(),u)}),n(null,l,e)}catch(t){n(t,s,e)}})},i.prototype._playAdUnit=function(t,e,n){d.waterfall([function(n){n(null,t,e)},this._handshake.bind(this),this._initAd.bind(this),this._setupEvents.bind(this),this._addSkipButton.bind(this),this._linkPlayerControls.bind(this),this._startAd.bind(this)],n)},i.prototype._handshake=function(t,e,n){function i(t){var e=r(t);return e>=1&&e<=2}function r(t){var e=t.split(".");return parseInt(e[0],10)}t.handshakeVersion(this.options.VPAID_VERSION,function(r,o){return r?n(r,t,e):o&&i(o)?n(null,t,e):n(new s('on VPAIDIntegrator._handshake, unsupported version "'+o+'"'),t,e)})},i.prototype._initAd=function(t,e,n){var i=this.player.el().querySelector(".vjs-tech"),r=p.getDimension(i);t.initAd(r.width,r.height,this.VIEW_MODE.NORMAL,-1,{AdParameters:e.adParameters||""},function(i){n(i,t,e)})},i.prototype._createVASTTracker=function(t,e){return new u(t,e)},i.prototype._setupEvents=function(t,e,n){function i(){d._adUnit&&d._adUnit.isPaused()&&(d._adUnit._paused=!1),h.trigger("play")}function o(){d._adUnit&&(d._adUnit._paused=!0),h.trigger("pause")}function a(){t.pauseAd(m.noop)}function s(){t.resumeAd(m.noop)}var l=t.options.src,u=this._createVASTTracker(l,e),h=this.player,d=this;t.on("AdSkipped",function(){h.trigger("vpaid.AdSkipped"),u.trackSkip()}),t.on("AdImpression",function(){h.trigger("vpaid.AdImpression"),u.trackImpressions()}),t.on("AdStarted",function(){h.trigger("vpaid.AdStarted"),u.trackCreativeView(),i()}),t.on("AdVideoStart",function(){h.trigger("vpaid.AdVideoStart"),u.trackStart(),i()}),t.on("AdPlaying",function(){h.trigger("vpaid.AdPlaying"),u.trackResume(),i()}),t.on("AdPaused",function(){h.trigger("vpaid.AdPaused"),u.trackPause(),o()}),t.on("AdVideoFirstQuartile",function(){h.trigger("vpaid.AdVideoFirstQuartile"),u.trackFirstQuartile()}),t.on("AdVideoMidpoint",function(){h.trigger("vpaid.AdVideoMidpoint"),u.trackMidpoint()}),t.on("AdVideoThirdQuartile",function(){h.trigger("vpaid.AdVideoThirdQuartile"),u.trackThirdQuartile()}),t.on("AdVideoComplete",function(){h.trigger("vpaid.AdVideoComplete"),u.trackComplete()}),t.on("AdClickThru",function(n){h.trigger("vpaid.AdClickThru");var i=n.url,r=n.playerHandles,o=m.isNotEmptyString(i)?i:function(e){var n={ASSETURI:t.options.src,CONTENTPLAYHEAD:0};return e?c.parseURLMacro(e,n):null}(e.clickThrough);u.trackClick(),r&&o&&window.open(o,"_blank")}),t.on("AdUserAcceptInvitation",function(){h.trigger("vpaid.AdUserAcceptInvitation"),u.trackAcceptInvitation(),u.trackAcceptInvitationLinear()}),t.on("AdUserClose",function(){h.trigger("vpaid.AdUserClose"),u.trackClose(),u.trackCloseLinear()}),t.on("AdUserMinimize",function(){h.trigger("vpaid.AdUserMinimize"),u.trackCollapse()}),t.on("AdError",function(){h.trigger("vpaid.AdError"),u.trackErrorWithCode(901)}),t.on("AdVolumeChange",function(){h.trigger("vpaid.AdVolumeChange");var e=h.volume();t.getAdVolume(function(t,n){e!==n&&(0===n&&e>0&&u.trackMute(),n>0&&0===e&&u.trackUnmute(),h.volume(n))})});var f=r.bind(this,h,t,this.VIEW_MODE),v=m.throttle(f,100),g=this.settings.autoResize;g&&(p.addEventListener(window,"resize",v),p.addEventListener(window,"orientationchange",v)),h.on("vast.resize",f),h.on("vpaid.pauseAd",a),h.on("vpaid.resumeAd",s),h.one("vpaid.adEnd",function(){h.off("vast.resize",f),h.off("vpaid.pauseAd",a),h.off("vpaid.resumeAd",s),g&&(p.removeEventListener(window,"resize",v),p.removeEventListener(window,"orientationchange",v))}),n(null,t,e)},i.prototype._addSkipButton=function(t,e,n){function i(){l.trigger("vpaid.AdSkippableStateChange"),t.getAdSkippableState(function(t,e){e?s||r(l):o()})}function r(t){s=a(),t.el().appendChild(s)}function o(){p.remove(s),s=null}function a(){var e=window.document.createElement("div");return p.addClass(e,"vast-skip-button"),p.addClass(e,"enabled"),e.innerHTML="ÙÙØ§ÛØ´ ÙÛØ¯ÛÙ",e.onclick=function(e){if(t.skipAd(m.noop),void 0===window.Event.prototype.stopPropagation)return!1;e.stopPropagation()},e}var s,l=this.player;t.on("AdSkippableStateChange",i),f.once(l,["vast.adEnd","vast.adsCancel"],o),n(null,t,e)},i.prototype._linkPlayerControls=function(t,e,n){var i=this;!function(t,e){function n(){var n=t.muted()?0:t.volume();e.setAdVolume(n,o)}function i(){t.trigger("vpaid.AdVolumeChange");var n=t.volume();e.getAdVolume(function(e,i){e?o(e):n!==i&&t.volume(i)})}t.on("volumechange",n),e.on("AdVolumeChange",i),t.one("vpaid.adEnd",function(){t.off("volumechange",n)})}(this.player,t),function(t,e,n){var o=r.bind(i,t,e,n);t.on("fullscreenchange",o),t.one("vpaid.adEnd",function(){t.off("fullscreenchange",o)})}(this.player,t,this.VIEW_MODE),n(null,t,e)},i.prototype._startAd=function(t,e,n){var i=this.player;t.startAd(function(r){r||i.trigger("vast.adStart"),n(r,t,e)})},i.prototype._finishPlaying=function(t,e,n){function i(i){n(i,t,e)}var r=this.player;t.on("AdStopped",function(){r.trigger("vpaid.AdStopped"),i(null)}),t.on("AdError",function(t){var e=t?t.message:"on VPAIDIntegrator, error while waiting for the adUnit to finish playing";i(new s(e))})},i.prototype._trackError=function(t,e){c.track(t.errorURLMacros,{ERRORCODE:e||901})},e.exports=i},{"../../utils/async":40,"../../utils/consoleLogger":41,"../../utils/dom":42,"../../utils/mimetypes":44,"../../utils/playerUtils":45,"../../utils/utilityFunctions":47,"../vast/VASTError":23,"../vast/VASTResponse":25,"../vast/VASTTracker":26,"../vast/vastUtil":30,"./VPAIDAdUnitWrapper":31}],35:[function(t,e,n){var i=t("../../utils/dom"),r=document.createElement("div");r.className="vjs-ads-label vjs-control vjs-label-hidden",r.innerHTML="Advertisement";var o=function(t){return{init:function(e,n){n.el=r,t.call(this,e,n),setTimeout(function(){var t=e.controlBar&&(e.controlBar.getChild("timerControls")||e.controlBar.getChild("currentTimeDisplay"));t&&e.controlBar.el().insertBefore(r,t.el()),i.removeClass(r,"vjs-label-hidden")},0)},el:function(){return r}}};e.exports=o},{"../../utils/dom":42}],36:[function(t,e,n){var i=k.default.getComponent("Component"),r=t("./ads-label")(i);k.default.registerComponent("AdsLabel",k.default.extend(i,r))},{"./ads-label":35}],37:[function(t,e,n){var i=document.createElement("div"),r=function(t){return{init:function(e,n){n.el=i,i.className="vjs-black-poster",t.call(this,e,n);var r=e.getChild("posterImage");setTimeout(function(){r&&e&&e.el()&&e.el().insertBefore(i,r.el())},0)},el:function(){return i}}};e.exports=r},{}],38:[function(t,e,n){var i=k.default.getComponent("Component"),r=t("./black-poster")(i);k.default.registerComponent("BlackPoster",k.default.extend(i,r))},{"./black-poster":37}],39:[function(t,e,n){var i=t("../ads/vast/VASTClient"),r=t("../ads/vast/VASTError"),o=t("../ads/vast/vastUtil"),a=t("../ads/vast/VASTIntegrator"),s=t("../ads/vpaid/VPAIDIntegrator"),l=t("../utils/async"),u=t("../utils/dom"),c=t("../utils/playerUtils"),h=t("../utils/utilityFunctions"),d=t("../utils/consoleLogger");e.exports=function(t){function e(){function t(){b.vast&&b.vast.adUnit&&(b.vast.adUnit=null)}function e(){n(),y&&(c.restorePlayerSnapshot(b,y),y=null)}function n(){c.once(b,["playing","vast.reset","vast.firstPlay"],function(t){"playing"===t.type&&(b.trigger("vast.contentStart"),c.once(b,["ended","vast.reset","vast.firstPlay"],function(t){"ended"===t.type&&b.trigger("vast.contentEnd")}))})}function i(t){if(x.adsEnabled)return t(null);t(new r("Ads are not enabled"))}function o(t){a()?(y=c.getPlayerSnapshot(b),b.pause(),d(),b.paused()?t(null):c.once(b,["playing"],function(){b.pause(),t(null)})):t(new r("video content has been playing before preroll ad"))}function a(){return!h.isIPhone()||b.currentTime()<=x.iosPrerollCancelTimeout}function s(t){function e(){n&&(clearTimeout(n),n=null)}var n;w=!1,n=setTimeout(function(){v(new r("timeout while waiting for the video to start playing",402))},x.adCancelTimeout),c.once(b,["vast.adStart","vast.adsCancel"],e),t(null)}function d(){u.addClass(b.el(),"vjs-vast-ad-loading"),c.once(b,["vast.adStart","vast.adsCancel"],f)}function f(){setTimeout(function(){u.removeClass(b.el(),"vjs-vast-ad-loading")},100)}c.removeNativePoster(b),c.once(b,["vast.adsCancel","vast.adEnd"],function(){t(),e()}),l.waterfall([i,o,s,p],function(t,e){t?v(t,e):b.trigger("vast.adEnd")})}function n(){b.trigger("vast.adsCancel"),w=!0}function p(t){l.waterfall([f,m],t)}function f(t){_.getVASTResponse(x.adTagUrl?x.adTagUrl():x.adTagXML,function(e,n){e||b.trigger({type:"vast.adDataLoaded",response:n}),t&&t.apply(this,arguments)})}function m(t,e){function n(){o||b.controlBar.getChild("AdsLabel")||b.controlBar.addChild("AdsLabel")}function i(){b.controlBar.removeChild("AdsLabel"),o=!0}if(!w){var r=g(t)?new s(b,x):new a(b),o=!1;c.once(b,["vast.adStart","vast.adsCancel"],function(t){"vast.adStart"===t.type&&n()}),c.once(b,["vast.adEnd","vast.adsCancel"],i),h.isIDevice()&&function(){function t(){b.duration()-r>i&&(b.pause(!0),b.play(!0),b.currentTime(r))}function e(){var t=b.currentTime();Math.abs(t-r)>i?(o+=1,o>=2&&b.pause(!0),b.currentTime(r)):r=t}function n(){b.off("timeupdate",e),b.off("ended",t)}var i=3,r=0,o=0;b.on("timeupdate",e),b.on("ended",t),c.once(b,["vast.adEnd","vast.adsCancel","vast.adError"],n)}(),b.vast.vastResponse=t,d.debug("calling adIntegrator.playAd() with vastResponse:",t),b.vast.adUnit=r.playAd(t,e)}}function v(t,e){b.trigger({type:"vast.adError",error:t}),n(),d.error("AD ERROR:",t.message,t,e)}function g(t){var e,n,i=t.mediaFiles;for(e=0,n=i.length;e<n;e++)if(o.isVPAID(i[e]))return!0;return!1}var y,b=this,_=new i,w=!1,T={timeout:500,iosPrerollCancelTimeout:2e3,adCancelTimeout:3e3,playAdAlways:!1,adsEnabled:!0,autoResize:!0,vpaidFlashLoaderPath:"/VPAIDFlash.swf",verbosity:0},x=h.extend({},T,t||{});return h.isUndefined(x.adTagUrl)&&h.isDefined(x.url)&&(x.adTagUrl=x.url),h.isString(x.adTagUrl)&&(x.adTagUrl=h.echoFn(x.adTagUrl)),h.isDefined(x.adTagXML)&&!h.isFunction(x.adTagXML)?v(new r("on VideoJS VAST plugin, the passed adTagXML option does not contain a function")):h.isDefined(x.adTagUrl)||h.isFunction(x.adTagXML)?(d.setVerbosity(x.verbosity),o.runFlashSupportCheck(x.vpaidFlashLoaderPath),c.prepareForAds(b),x.playAdAlways&&b.on("vast.contentEnd",function(){setTimeout(function(){b.trigger("vast.reset")},0)}),b.on("vast.firstPlay",e),b.on("vast.reset",function(){y=null,n()}),b.vast={isEnabled:function(){return x.adsEnabled},enable:function(){x.adsEnabled=!0},disable:function(){x.adsEnabled=!1}},b.vast):v(new r("on VideoJS VAST plugin, missing adTagUrl on options object"))}},{"../ads/vast/VASTClient":22,"../ads/vast/VASTError":23,"../ads/vast/VASTIntegrator":24,"../ads/vast/vastUtil":30,"../ads/vpaid/VPAIDIntegrator":34,"../utils/async":40,"../utils/consoleLogger":41,"../utils/dom":42,"../utils/playerUtils":45,"../utils/utilityFunctions":47}],40:[function(t,e,n){var i=t("./utilityFunctions"),r={};r.setImmediate=function(t){setTimeout(t,0)},r.iterator=function(t){return function e(n){var i=function e(){return t.length&&t[n].apply(null,arguments),e.next()};return i.next=function(){return n<t.length-1?e(n+1):null},i}(0)},r.waterfall=function(t,e){if(e=e||function(){},!i.isArray(t)){var n=new Error("First argument to waterfall must be an array of functions");return e(n)}if(!t.length)return e();!function t(n){return function(i){if(i)e.apply(null,arguments),e=function(){};else{var o=Array.prototype.slice.call(arguments,1),a=n.next();a?o.push(t(a)):o.push(e),r.setImmediate(function(){n.apply(null,o)})}}}(r.iterator(t))()},r.when=function(t,e){if(!i.isFunction(e))throw new Error("async.when error: missing callback argument");var n=i.isFunction(t)?t:function(){return!!t};return function(){var t=i.arrayLikeObjToArray(arguments),r=t.pop();return n.apply(null,t)?e.apply(this,arguments):(t.unshift(null),r.apply(null,t))}},e.exports=r},{"./utilityFunctions":47}],41:[function(t,e,n){function i(t){c=t}function r(t,e){e.length>0&&"string"==typeof e[0]&&(e[0]=h+e[0]),t.apply?t.apply(console,Array.prototype.slice.call(e)):t(Array.prototype.slice.call(e))}function o(){c<4||(void 0===console.debug?r(console.log,arguments):r(console.debug,arguments))}function a(){c<3||r(console.log,arguments)}function s(){c<2||r(console.info,arguments)}function l(){c<1||r(console.warn,arguments)}function u(){r(console.error,arguments)}var c=0,h="[videojs-vast-vpaid] ",d={setVerbosity:i,debug:o,log:a,info:s,warn:l,error:u};"undefined"!=typeof console&&console.log||(d.debug=function(){},d.log=function(){},d.info=function(){},d.warn=function(){},d.error=function(){}),e.exports=d},{}],42:[function(t,e,n){var i=t("./utilityFunctions"),r={};r.isVisible=function(t){return"hidden"!==window.getComputedStyle(t).visibility},r.isHidden=function(t){return"none"===window.getComputedStyle(t).display},r.isShown=function(t){return!r.isHidden(t)},r.hide=function(t){t.__prev_style_display_=t.style.display,t.style.display="none"},r.show=function(t){r.isHidden(t)&&(t.style.display=t.__prev_style_display_),t.__prev_style_display_=void 0},r.hasClass=function(t,e){var n,r,o;if(i.isNotEmptyString(e)){if(t.classList)return t.classList.contains(e);for(n=i.isString(t.getAttribute("class"))?t.getAttribute("class").split(/\s+/):[],e=e||"",r=0,o=n.length;r<o;r+=1)if(n[r]===e)return!0}return!1},r.addClass=function(t,e){var n;if(i.isNotEmptyString(e)){if(t.classList)return t.classList.add(e);n=i.isString(t.getAttribute("class"))?t.getAttribute("class").split(/\s+/):[],i.isString(e)&&i.isNotEmptyString(e.replace(/\s+/,""))&&(n.push(e),t.setAttribute("class",n.join(" ")))}},r.removeClass=function(t,e){var n;if(i.isNotEmptyString(e)){if(t.classList)return t.classList.remove(e);n=i.isString(t.getAttribute("class"))?t.getAttribute("class").split(/\s+/):[];var r,o,a=[];if(i.isString(e)&&i.isNotEmptyString(e.replace(/\s+/,""))){for(r=0,o=n.length;r<o;r+=1)e!==n[r]&&a.push(n[r]);t.setAttribute("class",a.join(" "))}}},r.addEventListener=function(t,e,n){return i.isArray(t)?void i.forEach(t,function(t){r.addEventListener(t,e,n)}):i.isArray(e)?void i.forEach(e,function(e){r.addEventListener(t,e,n)}):void(t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent&&t.attachEvent("on"+e,n))},r.removeEventListener=function(t,e,n){return i.isArray(t)?void i.forEach(t,function(t){r.removeEventListener(t,e,n)}):i.isArray(e)?void i.forEach(e,function(e){r.removeEventListener(t,e,n)}):void(t.removeEventListener?t.removeEventListener(e,n,!1):t.detachEvent?t.detachEvent("on"+e,n):t["on"+e]=null)},r.dispatchEvent=function(t,e){t.dispatchEvent?t.dispatchEvent(e):t.fireEvent("on"+e.eventType,e)},r.isDescendant=function(t,e){for(var n=e.parentNode;null!==n;){if(n===t)return!0;n=n.parentNode}return!1},r.getTextContent=function(t){return t.textContent||t.text},r.prependChild=function(t,e){return e.parentNode&&e.parentNode.removeChild(e),t.insertBefore(e,t.firstChild)},r.remove=function(t){t&&t.parentNode&&t.parentNode.removeChild(t)},r.isDomElement=function(t){return t instanceof Element},r.click=function(t,e){r.addEventListener(t,"click",e)},r.once=function(t,e,n){function i(){n.apply(null,arguments),r.removeEventListener(t,e,i)}r.addEventListener(t,e,i)},r.getDimension=function(t){var e;return!i.isOldIE()&&t.getBoundingClientRect?(e=t.getBoundingClientRect(),{width:e.width,height:e.height}):{width:t.offsetWidth,height:t.offsetHeight}},e.exports=r},{"./utilityFunctions":47}],43:[function(t,e,n){function i(t){this.message="HttpRequest Error: "+(t||"")}function r(t){if(!s.isFunction(t))throw new i("Missing XMLHttpRequest factory method");this.createXhr=t}function o(){var t=new XMLHttpRequest;return"withCredentials"in t||(t=new XDomainRequest),t}var a=t("./urlUtils"),s=t("./utilityFunctions");i.prototype=new Error,i.prototype.name="HttpRequest Error",r.prototype.run=function(t,e,n,r){function o(){n(-1,null,null,"")}!function(t,e,n){if(!s.isString(t)||s.isEmptyString(t))throw new i("Invalid url '"+t+"'");if(!s.isFunction(e))throw new i("Invalid handler '"+e+"' for the http request");if(s.isDefined(n)&&!s.isObject(n))throw new i("Invalid options map '"+n+"'")}(e,n,r);var l,u,c=this.createXhr();r=r||{},l=s.isNumber(r.timeout)?r.timeout:0,c.open(t,a.urlParts(e).href,!0),r.headers&&function(t,e){s.forEach(e,function(e,n){s.isDefined(e)&&t.setRequestHeader(n,e)})}(c,r.headers),r.withCredentials&&(c.withCredentials=!1),c.onload=function(){var t,e,i;c.getAllResponseHeaders||(c.getAllResponseHeaders=function(){return null}),c.status||(c.status=200),s.isDefined(u)&&(clearTimeout(u),u=void 0),t=c.statusText||"",e="response"in c?c.response:c.responseText,i=1223===c.status?204:c.status,n(i,e,c.getAllResponseHeaders(),t)},c.onerror=o,c.onabort=o,c.send(),l>0&&(u=setTimeout(function(){c&&c.abort()},l))},r.prototype.get=function(t,e,n){function r(t,n,r,a){o(t)?e(null,n,t,r,a):e(new i(a),n,t,r,a)}function o(t){return 200<=t&&t<300}this.run("GET",t,r,n)};var l=new r(o);e.exports={http:l,HttpRequest:r,HttpRequestError:i,createXhr:o}},{"./urlUtils":46,"./utilityFunctions":47}],44:[function(t,e,n){e.exports={html5:["text/javascript","text/javascript1.0","text/javascript1.2","text/javascript1.4","text/jscript","application/javascript","application/x-javascript","text/ecmascript","text/ecmascript1.0","text/ecmascript1.2","text/ecmascript1.4","text/livescript","application/ecmascript","application/x-ecmascript"],flash:["application/x-shockwave-flash"]}},{}],45:[function(t,e,n){var i=t("./dom"),r=t("./utilityFunctions"),o={};o.getPlayerSnapshot=function(t){var e=t.el().querySelector(".vjs-tech"),n={ended:t.ended(),src:t.currentSrc(),currentTime:t.currentTime(),type:t.currentType(),playing:!t.paused(),suppressedTracks:function(t){var e=t.remoteTextTracks?t.remoteTextTracks():[];e&&r.isArray(e.tracks_)&&(e=e.tracks_),r.isArray(e)||(e=[]);var n=[];return e.forEach(function(t){n.push({track:t,mode:t.mode}),t.mode="disabled"}),n}(t)};return e&&(n.nativePoster=e.poster,n.style=e.getAttribute("style")),n},o.restorePlayerSnapshot=function(t,e){function n(){e.suppressedTracks.forEach(function(t){t.track.mode=t.mode})}function i(){if(!o.isReadyToResume(t)&&a--)setTimeout(i,50);else try{t.currentTime()!==e.currentTime?(e.playing&&t.one("seeked",function(){t.play()}),t.currentTime(e.currentTime)):e.playing&&t.play()}catch(t){k.default.log.warn("Failed to resume the content after an advertisement",t)}}var r=t.el().querySelector(".vjs-tech"),a=20;e.nativePoster&&(r.poster=e.nativePoster),"style"in e&&r.setAttribute("style",e.style||""),!function(t,e){return t.src()?t.src()!==e.src:t.currentSrc()!==e.src}(t,e)?(n(),e.playing&&t.play()):(t.one("contentloadedmetadata",n),t.one("canplay",i),function(){var e=setTimeout(function(){t.trigger("canplay")},1e3);t.one("canplay",function(){clearTimeout(e)})}(),t.src({src:e.src,type:e.type}),t.load())},o.isReadyToResume=function(t){return t.readyState()>1||(void 0===t.seekable()||t.seekable().length>0)},o.prepareForAds=function(t){function e(){return t.vast&&t.vast.adUnit}function n(){a()&&(m=!1,t.trigger("vast.firstPlay"))}function o(){m=!0,f.show(),l()}function a(){return m}function s(){return{muted:t.muted(),volume:t.volume()}}function l(){p&&(t.currentTime(0),u(p),p=null)}function u(e){r.isObject(e)&&(t.volume(e.volume),t.muted(e.muted))}function c(){i.hasClass(f.el(),"vjs-hidden")||f.hide()}function h(){i.addClass(t.el(),"vjs-ad-playing")}function d(){i.removeClass(t.el(),"vjs-ad-playing")}var p,f=t.addChild("blackPoster"),m=!0;!function(){var n=t.play;t.play=function(i){var o=this;return a()?function(){r.isIPhone()||(p=s(),t.muted(!0)),n.apply(o,arguments)}():function(i){e()&&!i?t.vast.adUnit.resumeAd():n.apply(o,arguments)}(i),this};var i=t.pause;t.pause=function(n){return e()&&!n?t.vast.adUnit.pauseAd():i.apply(this,arguments),this};var o=t.paused;t.paused=function(n){return e()&&!n?t.vast.adUnit.isPaused():o.apply(this,arguments)}}(),t.on("play",n),t.on("vast.reset",o),t.on("vast.firstPlay",l),t.on("error",c),t.on("vast.adStart",c),t.on("vast.adsCancel",c),t.on("vast.adError",c),t.on("vast.adStart",h),t.on("vast.adEnd",d),t.on("vast.adsCancel",d)},o.removeNativePoster=function(t){var e=t.el().querySelector(".vjs-tech");e&&e.removeAttribute("poster")},o.once=function(t,e,n){function i(){n.apply(null,arguments),e.forEach(function(e){t.off(e,i)})}e.forEach(function(e){t.on(e,i)})},e.exports=o},{"./dom":42,"./utilityFunctions":47}],46:[function(t,e,n){function i(t){var e=t;return l&&(s.setAttribute("href",e),e=s.href),s.setAttribute("href",e),{href:s.href,protocol:s.protocol?s.protocol.replace(/:$/,""):"",host:s.host,search:s.search?s.search.replace(/^\?/,""):"",hash:s.hash?s.hash.replace(/^#/,""):"",hostname:s.hostname,port:a.isNotEmptyString(s.port)?s.port:80,pathname:"/"===s.pathname.charAt(0)?s.pathname:"/"+s.pathname}}function r(t,e){var n,i;return e=a.isFunction(e)?e:function(){return!0},t=t.trim().replace(/^\?/,""),n=t.split("&"),i={},a.forEach(n,function(t){var n,r,o;""!==t&&(n=t.split("="),r=n[0],o=n[1],e(r,o)&&(i[r]=o))}),i}function o(t){var e=[];return a.forEach(t,function(t,n){e.push(n+"="+t)}),e.join("&")}var a=t("./utilityFunctions"),s=document.createElement("a"),l=document.documentMode;e.exports={urlParts:i,queryStringToObj:r,objToQueryString:o}},{"./utilityFunctions":47}],47:[function(t,e,n){function i(){}function r(t){return null===t}function o(t){return void 0!==t}function a(t){return void 0===t}function s(t){return"object"===(void 0===t?"undefined":(0,T.default)(t))}function l(t){return"function"==typeof t}function u(t){return"number"==typeof t}function c(t){return j.isObject(t)&&t.window===t}function h(t){return"[object Array]"===Object.prototype.toString.call(t)}function d(t){if(null===t||j.isWindow(t)||j.isFunction(t)||j.isUndefined(t))return!1;var e=t.length;return!(t.nodeType!==N||!e)||(j.isString(t)||j.isArray(t)||0===e||"number"==typeof e&&e>0&&e-1 in t)}function p(t){return"string"==typeof t}function f(t){return j.isString(t)&&0===t.length}function m(t){return j.isString(t)&&0!==t.length}function v(t){return Array.prototype.slice.call(t)}function g(t,e,n){var i,r;if(t)if(l(t))for(i in t)"prototype"===i||"length"===i||"name"===i||t.hasOwnProperty&&!t.hasOwnProperty(i)||e.call(n,t[i],i,t);else if(h(t)){var o="object"!==(void 0===t?"undefined":(0,T.default)(t));for(i=0,r=t.length;i<r;i++)(o||i in t)&&e.call(n,t[i],i,t)}else if(t.forEach&&t.forEach!==g)t.forEach(e,n,t);else for(i in t)t.hasOwnProperty(i)&&e.call(n,t[i],i,t);return t}function y(t,e){return e=e||"_",t.replace(U,function(t,n){return(n?e:"")+t.toLowerCase()})}function b(t){return!!j.isString(t)&&V.test(t.trim())}function _(t){var e,n,i;for(n=1;n<arguments.length;n++){e=arguments[n];for(i in e)e.hasOwnProperty(i)&&(s(t[i])&&!r(t[i])&&s(e[i])?t[i]=_({},t[i],e[i]):t[i]=e[i])}return t}function w(t){return t.charAt(0).toUpperCase()+t.slice(1)}function x(t){return t.charAt(0).toLowerCase()+t.slice(1)}function E(t,e){var n=[];return t.forEach(function(t,i){var r=e(t,i);j.isDefined(r)&&n.push(r)}),n}function S(t,e){var n=t+"";if(e=j.isNumber(e)?e:0,t=j.isNumber(t)?t:parseInt(t,10),j.isNumber(t)&&!isNaN(t)){for(n=t+"";n.length<e;)n="0"+n;return n}return"NaN"}function A(t,e){var n=(new Date).getTime()-(e+1);return function(){var i=(new Date).getTime();i-n>=e&&(n=i,t.apply(this,arguments))}}function C(t,e){var n;return function(){n&&clearTimeout(n),n=setTimeout(function(){t.apply(this,arguments),n=void 0},e)}}function k(t,e,n){for(var i=e(t),r=0;r<i.length;r++){if(n(i[r]))return i[r];var o=k(i[r],e,n);if(o)return o}}function M(t){return function(){return t}}function L(t){return j.isNumber(t)&&(t+=""),!!j.isString(t)&&B.test(t.trim())}function R(){var t=j.getInternetExplorerVersion(navigator);return-1!==t&&t<10}function P(t){var e=-1;if("Microsoft Internet Explorer"==t.appName){var n=t.userAgent,i=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),r=i.exec(n);null!==r&&(e=parseFloat(r[1]))}return e}function D(){return/iP(hone|ad)/.test(j._UA)}function I(){return/iP(hone|ad|od)|Android|Windows Phone/.test(j._UA)}function F(){return/iP(hone|od)/.test(j._UA)}function O(){return/Android/.test(j._UA)}var N=1,U=/[A-Z]/g,V=/^[a-z0-9!#$%&'*+\/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)+$/i,B=/^([\+-]?\d{4}(?!\d{2}\b))((-?)((0[1-9]|1[0-2])(\3([12]\d|0[1-9]|3[01]))?|W([0-4]\d|5[0-2])(-?[1-7])?|(00[1-9]|0[1-9]\d|[12]\d{2}|3([0-5]\d|6[1-6])))([T\s]((([01]\d|2[0-3])((:?)[0-5]\d)?|24\:?00)([\.,]\d+(?!:))?)?(\17[0-5]\d([\.,]\d+)?)?([zZ]|([\+-])([01]\d|2[0-3]):?([0-5]\d)?)?)?)?$/,j={_UA:navigator.userAgent,noop:i,isNull:r,isDefined:o,isUndefined:a,isObject:s,isFunction:l,isNumber:u,isWindow:c,isArray:h,isArrayLike:d,isString:p,isEmptyString:f,isNotEmptyString:m,arrayLikeObjToArray:v,forEach:g,snake_case:y,isValidEmail:b,extend:_,capitalize:w,decapitalize:x,transformArray:E,toFixedDigits:S,throttle:A,debounce:C,treeSearch:k,echoFn:M,isISO8601:L,isOldIE:R,getInternetExplorerVersion:P,isIDevice:D,isMobile:I,isIPhone:F,isAndroid:O};e.exports=j},{}],48:[function(t,e,n){var i=t("./utilityFunctions"),r={};r.strToXMLDoc=function(t){function e(t){try{var e=new DOMParser,n=e.parseFromString("INVALID","text/xml"),i=n.getElementsByTagName("parsererror")[0].namespaceURI;return"http://www.w3.org/1999/xhtml"===i?t.getElementsByTagName("parsererror").length>0:t.getElementsByTagNameNS(i,"parsererror").length>0}catch(t){}}if(void 0===window.DOMParser){var n=new ActiveXObject("Microsoft.XMLDOM");return n.async=!1,n.loadXML(t),n}return function(t){var n,r=new DOMParser;try{if(n=r.parseFromString(t,"application/xml"),e(n)||i.isEmptyString(t))throw new Error}catch(e){throw new Error("xml.strToXMLDOC: Error parsing the string: '"+t+"'")}return n}(t)},r.parseText=function(t){return/^\s*$/.test(t)?null:/^(?:true|false)$/i.test(t)?"true"===t.toLowerCase():isFinite(t)?parseFloat(t):i.isISO8601(t)?new Date(t):t.trim()},r.JXONTree=function(t){var e=r.parseText;if(t.documentElement)return new r.JXONTree(t.documentElement);if(t.hasChildNodes()){for(var n,o,a,s="",l=0;l<t.childNodes.length;l++)n=t.childNodes.item(l),3==(n.nodeType-1|1)?s+=3===n.nodeType?n.nodeValue.trim():n.nodeValue:1!==n.nodeType||n.prefix||(o=i.decapitalize(n.nodeName),a=new r.JXONTree(n),this.hasOwnProperty(o)?(this[o].constructor!==Array&&(this[o]=[this[o]]),this[o].push(a)):this[o]=a);s&&(this.keyValue=e(s))}if(void 0===t.hasAttributes?t.attributes.length>0:t.hasAttributes())for(var u,c=0;c<t.attributes.length;c++)u=t.attributes.item(c),this["@"+i.decapitalize(u.name)]=e(u.value.trim())},r.JXONTree.prototype.attr=function(t){return this["@"+i.decapitalize(t)]},r.toJXONTree=function(t){var e=r.strToXMLDoc(t);return new r.JXONTree(e)},r.keyValue=function(t){if(t)return t.keyValue},r.attr=function(t,e){if(t)return t["@"+i.decapitalize(e)]},r.encode=function(t){if(i.isString(t))return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")},r.decode=function(t){if(i.isString(t))return t.replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&")},e.exports=r},{"./utilityFunctions":47}],49:[function(t,e,n){t("./plugin/components/ads-label_5"),t("./plugin/components/black-poster_5");var i=t("./plugin/videojs.vast.vpaid");k.default.plugin("vastVideoBoomClient",i)},{"./plugin/components/ads-label_5":36,"./plugin/components/black-poster_5":38,"./plugin/videojs.vast.vpaid":39}]},{},[49])},function(t,e,n){"use strict";(function(i){function r(t){return t&&t.__esModule?t:{default:t}}var o,a,s=n(39),l=r(s),u=n(55),c=r(u),h=n(13),d=r(h),p=n(40),f=r(p),m=n(30),v=r(m),g=n(54),y=r(g),b=n(31),_=r(b),w=n(32),T=r(w),x=n(21),E=r(x),S=n(23),A=r(S),C=n(22),k=r(C),M=n(114),L=r(M),R=n(14),P=r(R);!function(i,r){"object"===(0,P.default)(e)&&void 0!==t?t.exports=r():(o=r,void 0!==(a="function"==typeof o?o.call(e,n,e,t):o)&&(t.exports=a))}(0,function(){function t(t,e){return e={exports:{}},t(e,e.exports),e.exports}function e(t,e){cn(t).forEach(function(n){return e(t[n],n)})}function n(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return cn(t).reduce(function(n,i){return e(n,t[i],i)},n)}function r(t){for(var n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return y.default?y.default.apply(Object,[t].concat(i)):(i.forEach(function(n){n&&e(n,function(e,n){t[n]=e})}),t)}function o(t){return!!t&&"object"===(void 0===t?"undefined":rn(t))}function a(t){return o(t)&&"[object Object]"===un.call(t)&&t.constructor===Object}function s(t){return t.replace(/\n\r?\s*/g,"")}function u(t,e){if(!t||!e)return"";if("function"==typeof ke.getComputedStyle){var n=ke.getComputedStyle(t);return n?n[e]:""}return t.currentStyle[e]||""}function h(t){return"string"==typeof t&&/\S/.test(t)}function p(t){if(/\s/.test(t))throw new Error("class has illegal whitespace characters")}function m(t){return new RegExp("(^|\\s)"+t+"($|\\s)")}function g(){return De===ke.document&&void 0!==De.createElement}function b(t){return o(t)&&1===t.nodeType}function w(){try{return ke.parent!==ke.self}catch(t){return!0}}function x(t){return function(e,n){if(!h(e))return De[t](null);h(n)&&(n=De.querySelector(n));var i=b(n)?n:De;return i[t]&&i[t](e)}}function S(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments[3],r=De.createElement(t);return(0,f.default)(e).forEach(function(t){var n=e[t];-1!==t.indexOf("aria-")||"role"===t||"type"===t?(mn.warn(vn(gn,t,n)),r.setAttribute(t,n)):"textContent"===t?C(r,n):r[t]=n}),(0,f.default)(n).forEach(function(t){r.setAttribute(t,n[t])}),i&&Y(r,i),r}function C(t,e){return void 0===t.textContent?t.innerText=e:t.textContent=e,t}function M(t,e){e.firstChild?e.insertBefore(t,e.firstChild):e.appendChild(t)}function R(t,e){return p(e),t.classList?t.classList.contains(e):m(e).test(t.className)}function D(t,e){return t.classList?t.classList.add(e):R(t,e)||(t.className=(t.className+" "+e).trim()),t}function I(t,e){return t.classList?t.classList.remove(e):(p(e),t.className=t.className.split(/\s+/).filter(function(t){return t!==e}).join(" ")),t}function F(t,e,n){var i=R(t,e);if("function"==typeof n&&(n=n(t,e)),"boolean"!=typeof n&&(n=!i),n!==i)return n?D(t,e):I(t,e),t}function O(t,e){(0,f.default)(e).forEach(function(n){var i=e[n];null===i||void 0===i||!1===i?t.removeAttribute(n):t.setAttribute(n,!0===i?"":i)})}function N(t){var e={};if(t&&t.attributes&&t.attributes.length>0)for(var n=t.attributes,i=n.length-1;i>=0;i--){var r=n[i].name,o=n[i].value;"boolean"!=typeof t[r]&&-1===",autoplay,controls,playsinline,loop,muted,default,defaultMuted,".indexOf(","+r+",")||(o=null!==o),e[r]=o}return e}function U(t,e){return t.getAttribute(e)}function V(t,e,n){t.setAttribute(e,n)}function B(t,e){t.removeAttribute(e)}function j(){De.body.focus(),De.onselectstart=function(){return!1}}function G(){De.onselectstart=function(){return!0}}function H(t){if(t&&t.getBoundingClientRect&&t.parentNode){var e=t.getBoundingClientRect(),n={};return["bottom","height","left","right","top","width"].forEach(function(t){void 0!==e[t]&&(n[t]=e[t])}),n.height||(n.height=parseFloat(u(t,"height"))),n.width||(n.width=parseFloat(u(t,"width"))),n}}function z(t){var e=void 0;if(t.getBoundingClientRect&&t.parentNode&&(e=t.getBoundingClientRect()),!e)return{left:0,top:0};var n=De.documentElement,i=De.body,r=n.clientLeft||i.clientLeft||0,o=ke.pageXOffset||i.scrollLeft,a=e.left+o-r,s=n.clientTop||i.clientTop||0,l=ke.pageYOffset||i.scrollTop,u=e.top+l-s;return{left:Math.round(a),top:Math.round(u)}}function W(t,e){var n={},i=z(t),r=t.offsetWidth,o=t.offsetHeight,a=i.top,s=i.left,l=e.pageY,u=e.pageX;return e.changedTouches&&(u=e.changedTouches[0].pageX,l=e.changedTouches[0].pageY),n.y=Math.max(0,Math.min(1,(a-l+o)/o)),n.x=Math.max(0,Math.min(1,(u-s)/r)),n}function X(t){return o(t)&&3===t.nodeType}function q(t){for(;t.firstChild;)t.removeChild(t.firstChild);return t}function K(t){return"function"==typeof t&&(t=t()),(Array.isArray(t)?t:[t]).map(function(t){return"function"==typeof t&&(t=t()),b(t)||X(t)?t:"string"==typeof t&&/\S/.test(t)?De.createTextNode(t):void 0}).filter(function(t){return t})}function Y(t,e){return K(e).forEach(function(e){return t.appendChild(e)}),t}function $(t,e){return Y(q(t),e)}function Q(t){return void 0===t.button&&void 0===t.buttons||(0===t.button&&void 0===t.buttons||(9===Qe||0===t.button&&1===t.buttons))}function J(){return wn++}function Z(t){var e=t[xn];return e||(e=t[xn]=J()),Tn[e]||(Tn[e]={}),Tn[e]}function tt(t){var e=t[xn];return!!e&&!!(0,f.default)(Tn[e]).length}function et(t){var e=t[xn];if(e){delete Tn[e];try{delete t[xn]}catch(e){t.removeAttribute?t.removeAttribute(xn):t[xn]=null}}}function nt(t,e){var n=Z(t);0===n.handlers[e].length&&(delete n.handlers[e],t.removeEventListener?t.removeEventListener(e,n.dispatcher,!1):t.detachEvent&&t.detachEvent("on"+e,n.dispatcher)),(0,f.default)(n.handlers).length<=0&&(delete n.handlers,delete n.dispatcher,delete n.disabled),0===(0,f.default)(n).length&&et(t)}function it(t,e,n,i){n.forEach(function(n){t(e,n,i)})}function rt(t){function e(){return!0}function n(){return!1}if(!t||!t.isPropagationStopped){var i=t||ke.event;t={};for(var r in i)"layerX"!==r&&"layerY"!==r&&"keyLocation"!==r&&"webkitMovementX"!==r&&"webkitMovementY"!==r&&("returnValue"===r&&i.preventDefault||(t[r]=i[r]));if(t.target||(t.target=t.srcElement||De),t.relatedTarget||(t.relatedTarget=t.fromElement===t.target?t.toElement:t.fromElement),t.preventDefault=function(){i.preventDefault&&i.preventDefault(),t.returnValue=!1,i.returnValue=!1,t.defaultPrevented=!0},t.defaultPrevented=!1,t.stopPropagation=function(){i.stopPropagation&&i.stopPropagation(),t.cancelBubble=!0,i.cancelBubble=!0,t.isPropagationStopped=e},t.isPropagationStopped=n,t.stopImmediatePropagation=function(){i.stopImmediatePropagation&&i.stopImmediatePropagation(),t.isImmediatePropagationStopped=e,t.stopPropagation()},t.isImmediatePropagationStopped=n,null!==t.clientX&&void 0!==t.clientX){var o=De.documentElement,a=De.body;t.pageX=t.clientX+(o&&o.scrollLeft||a&&a.scrollLeft||0)-(o&&o.clientLeft||a&&a.clientLeft||0),t.pageY=t.clientY+(o&&o.scrollTop||a&&a.scrollTop||0)-(o&&o.clientTop||a&&a.clientTop||0)}t.which=t.charCode||t.keyCode,null!==t.button&&void 0!==t.button&&(t.button=1&t.button?0:4&t.button?1:2&t.button?2:0)}return t}function ot(t,e,n){if(Array.isArray(e))return it(ot,t,e,n);var i=Z(t);if(i.handlers||(i.handlers={}),i.handlers[e]||(i.handlers[e]=[]),n.guid||(n.guid=J()),i.handlers[e].push(n),i.dispatcher||(i.disabled=!1,i.dispatcher=function(e,n){if(!i.disabled){e=rt(e);var r=i.handlers[e.type];if(r)for(var o=r.slice(0),a=0,s=o.length;a<s&&!e.isImmediatePropagationStopped();a++)try{o[a].call(t,e,n)}catch(t){mn.error(t)}}}),1===i.handlers[e].length)if(t.addEventListener){var r=!1;En&&Sn.indexOf(e)>-1&&(r={passive:!0}),t.addEventListener(e,i.dispatcher,r)}else t.attachEvent&&t.attachEvent("on"+e,i.dispatcher)}function at(t,e,n){if(tt(t)){var i=Z(t);if(i.handlers){if(Array.isArray(e))return it(at,t,e,n);var r=function(t,e){i.handlers[e]=[],nt(t,e)};if(void 0!==e){var o=i.handlers[e];if(o){if(!n)return void r(t,e);if(n.guid)for(var a=0;a<o.length;a++)o[a].guid===n.guid&&o.splice(a--,1);nt(t,e)}}else for(var s in i.handlers)Object.prototype.hasOwnProperty.call(i.handlers||{},s)&&r(t,s)}}}function st(t,e,n){var i=tt(t)?Z(t):{},r=t.parentNode||t.ownerDocument;if("string"==typeof e?e={type:e,target:t}:e.target||(e.target=t),e=rt(e),i.dispatcher&&i.dispatcher.call(t,e,n),r&&!e.isPropagationStopped()&&!0===e.bubbles)st.call(null,r,e,n);else if(!r&&!e.defaultPrevented){var o=Z(e.target);e.target[e.type]&&(o.disabled=!0,"function"==typeof e.target[e.type]&&e.target[e.type](),o.disabled=!1)}return!e.defaultPrevented}function lt(t,e,n){if(Array.isArray(e))return it(lt,t,e,n);var i=function i(){at(t,e,i),n.apply(this,arguments)};i.guid=n.guid=n.guid||J(),ot(t,e,i)}function ut(t,e){e&&(kn=e),ke.setTimeout(Mn,t)}function ct(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.eventBusKey;if(n){if(!t[n].nodeName)throw new Error('The eventBusKey "'+n+'" does not refer to an element.');t.eventBusEl_=t[n]}else t.eventBusEl_=S("span",{className:"vjs-event-bus"});return r(t,Hn),t.on("dispose",function(){t.off(),ke.setTimeout(function(){t.eventBusEl_=null},0)}),t}function ht(t,e){return r(t,zn),t.state=r({},t.state,e),"function"==typeof t.handleStateChanged&&On(t)&&t.on("statechanged",t.handleStateChanged),t}function dt(t){return"string"!=typeof t?t:t.charAt(0).toUpperCase()+t.slice(1)}function pt(t,e){return dt(t)===dt(e)}function ft(){for(var t={},n=arguments.length,i=Array(n),r=0;r<n;r++)i[r]=arguments[r];return i.forEach(function(n){n&&e(n,function(e,n){if(!a(e))return void(t[n]=e);a(t[n])||(t[n]={}),t[n]=ft(t[n],e)})}),t}function mt(t,e,n){if("number"!=typeof e||e<0||e>n)throw new Error("Failed to execute '"+t+"' on 'TimeRanges': The index provided ("+e+") is non-numeric or out of bounds (0-"+n+").")}function vt(t,e,n,i){return mt(t,i,n.length-1),n[i][e]}function gt(t){return void 0===t||0===t.length?{length:0,start:function(){throw new Error("This TimeRanges object is empty")},end:function(){throw new Error("This TimeRanges object is empty")}}:{length:t.length,start:vt.bind(null,"start",0,t),end:vt.bind(null,"end",1,t)}}function yt(t,e){return Array.isArray(t)?gt(t):void 0===t||void 0===e?gt():gt([[t,e]])}function bt(t,e){var n=0,i=void 0,r=void 0;if(!e)return 0;t&&t.length||(t=yt(0,0));for(var o=0;o<t.length;o++)i=t.start(o),r=t.end(o),r>e&&(r=e),n+=r-i;return n/e}function _t(t){if(t instanceof _t)return t;"number"==typeof t?this.code=t:"string"==typeof t?this.message=t:o(t)&&("number"==typeof t.code&&(this.code=t.code),r(this,t)),this.message||(this.message=_t.defaultMessages[this.code]||"")}function wt(t,e){var n,i=null;try{n=JSON.parse(t,e)}catch(t){i=t}return[i,n]}function Tt(t){return void 0!==t&&null!==t&&"function"==typeof t.then}function xt(t){Tt(t)&&t.then(null,function(t){})}function Et(t){var e=Ai.call(t);return"[object Function]"===e||"function"==typeof t&&"[object RegExp]"!==e||"undefined"!=typeof window&&(t===window.setTimeout||t===window.alert||t===window.confirm||t===window.prompt)}function St(t,e,n){if(!Si(e))throw new TypeError("iterator must be a function");arguments.length<3&&(n=this),"[object Array]"===Mi.call(t)?At(t,e,n):"string"==typeof t?Ct(t,e,n):kt(t,e,n)}function At(t,e,n){for(var i=0,r=t.length;i<r;i++)Li.call(t,i)&&e.call(n,t[i],i,t)}function Ct(t,e,n){for(var i=0,r=t.length;i<r;i++)e.call(n,t.charAt(i),i,t)}function kt(t,e,n){for(var i in t)Li.call(t,i)&&e.call(n,t[i],i,t)}function Mt(){for(var t={},e=0;e<arguments.length;e++){var n=arguments[e];for(var i in n)Ii.call(n,i)&&(t[i]=n[i])}return t}function Lt(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}function Rt(t,e,n){var i=t;return Si(e)?(n=e,"string"==typeof t&&(i={uri:t})):i=Di(e,{uri:t}),i.callback=n,i}function Pt(t,e,n){return e=Rt(t,e,n),Dt(e)}function Dt(t){function e(){4===s.readyState&&setTimeout(r,0)}function n(){var t=void 0;if(t=s.response?s.response:s.responseText||It(s),g)try{t=JSON.parse(t)}catch(t){}return t}function i(t){return clearTimeout(c),t instanceof Error||(t=new Error(""+(t||"Unknown XMLHttpRequest Error"))),t.statusCode=0,a(t,y)}function r(){if(!u){var e;clearTimeout(c),e=t.useXDR&&void 0===s.status?200:1223===s.status?204:s.status;var i=y,r=null;return 0!==e?(i={body:n(),statusCode:e,method:d,headers:{},url:h,rawRequest:s},s.getAllResponseHeaders&&(i.headers=Pi(s.getAllResponseHeaders()))):r=new Error("Internal XMLHttpRequest Error"),a(r,i,i.body)}}if(void 0===t.callback)throw new Error("callback argument missing");var o=!1,a=function(e,n,i){o||(o=!0,t.callback(e,n,i))},s=t.xhr||null;s||(s=t.cors||t.useXDR?new Pt.XDomainRequest:new Pt.XMLHttpRequest);var l,u,c,h=s.url=t.uri||t.url,d=s.method=t.method||"GET",p=t.body||t.data,f=s.headers=t.headers||{},m=!!t.sync,g=!1,y={body:void 0,headers:{},statusCode:0,method:d,url:h,rawRequest:s};if("json"in t&&!1!==t.json&&(g=!0,f.accept||f.Accept||(f.Accept="application/json"),"GET"!==d&&"HEAD"!==d&&(f["content-type"]||f["Content-Type"]||(f["Content-Type"]="application/json"),p=(0,v.default)(!0===t.json?p:t.json))),s.onreadystatechange=e,s.onload=r,s.onerror=i,s.onprogress=function(){},s.onabort=function(){u=!0},s.ontimeout=i,s.open(d,h,!m,t.username,t.password),m||(s.withCredentials=!!t.withCredentials),!m&&t.timeout>0&&(c=setTimeout(function(){if(!u){u=!0,s.abort("timeout");var t=new Error("XMLHttpRequest timeout");t.code="ETIMEDOUT",i(t)}},t.timeout)),s.setRequestHeader)for(l in f)f.hasOwnProperty(l)&&s.setRequestHeader(l,f[l]);else if(t.headers&&!Lt(t.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in t&&(s.responseType=t.responseType),"beforeSend"in t&&"function"==typeof t.beforeSend&&t.beforeSend(s),s.send(p||null),s}function It(t){if("document"===t.responseType)return t.responseXML;var e=t.responseXML&&"parsererror"===t.responseXML.documentElement.nodeName;return""!==t.responseType||e?null:t.responseXML}function Ft(){}function Ot(t,e){this.name="ParsingError",this.code=t.code,this.message=e||t.message}function Nt(t){function e(t,e,n,i){return 3600*(0|t)+60*(0|e)+(0|n)+(0|i)/1e3}var n=t.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return n?n[3]?e(n[1],n[2],n[3].replace(":",""),n[4]):n[1]>59?e(n[1],n[2],0,n[4]):e(0,n[1],n[2],n[4]):null}function Ut(){this.values=qi(null)}function Vt(t,e,n,i){var r=i?t.split(i):[t];for(var o in r)if("string"==typeof r[o]){var a=r[o].split(n);if(2===a.length){var s=a[0],l=a[1];e(s,l)}}}function Bt(t,e,n){function i(){var e=Nt(t);if(null===e)throw new Ot(Ot.Errors.BadTimeStamp,"Malformed timestamp: "+o);return t=t.replace(/^[^\sa-zA-Z-]+/,""),e}function r(){t=t.replace(/^\s+/,"")}var o=t;if(r(),e.startTime=i(),r(),"--\x3e"!==t.substr(0,3))throw new Ot(Ot.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '--\x3e'): "+o);t=t.substr(3),r(),e.endTime=i(),r(),function(t,e){var i=new Ut;Vt(t,function(t,e){switch(t){case"region":for(var r=n.length-1;r>=0;r--)if(n[r].id===e){i.set(t,n[r].region);break}break;case"vertical":i.alt(t,e,["rl","lr"]);break;case"line":var o=e.split(","),a=o[0];i.integer(t,a),i.percent(t,a)&&i.set("snapToLines",!1),i.alt(t,a,["auto"]),2===o.length&&i.alt("lineAlign",o[1],["start","middle","end"]);break;case"position":o=e.split(","),i.percent(t,o[0]),2===o.length&&i.alt("positionAlign",o[1],["start","middle","end"]);break;case"size":i.percent(t,e);break;case"align":i.alt(t,e,["start","middle","end","left","right"])}},/:/,/\s/),e.region=i.get("region",null),e.vertical=i.get("vertical",""),e.line=i.get("line","auto"),e.lineAlign=i.get("lineAlign","start"),e.snapToLines=i.get("snapToLines",!0),e.size=i.get("size",100),e.align=i.get("align","middle"),e.position=i.get("position",{start:0,left:0,middle:50,end:100,right:100},e.align),e.positionAlign=i.get("positionAlign",{start:"start",left:"start",middle:"middle",end:"end",right:"end"},e.align)}(t,e)}function jt(t,e){function n(t){return Ki[t]}for(var i,r=t.document.createElement("div"),o=r,a=[];null!==(i=function(){if(!e)return null;var t=e.match(/^([^<]*)(<[^>]*>?)?/);return function(t){return e=e.substr(t.length),t}(t[1]?t[1]:t[2])}());)if("<"!==i[0])o.appendChild(t.document.createTextNode(function(t){for(;u=t.match(/&(amp|lt|gt|lrm|rlm|nbsp);/);)t=t.replace(u[0],n);return t}(i)));else{if("/"===i[1]){a.length&&a[a.length-1]===i.substr(2).replace(">","")&&(a.pop(),o=o.parentNode);continue}var s,l=Nt(i.substr(1,i.length-2));if(l){s=t.document.createProcessingInstruction("timestamp",l),o.appendChild(s);continue}var u=i.match(/^<([^.\s\/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!u)continue;if(!(s=function(e,n){var i=Yi[e];if(!i)return null;var r=t.document.createElement(i);r.localName=i;var o=$i[e];return o&&n&&(r[o]=n.trim()),r}(u[1],u[3])))continue;if(!function(t,e){return!Qi[e.localName]||Qi[e.localName]===t.localName}(o,s))continue;u[2]&&(s.className=u[2].substr(1).replace("."," ")),a.push(u[1]),o.appendChild(s),o=s}return r}function Gt(t){for(var e=0;e<Ji.length;e++){var n=Ji[e];if(t>=n[0]&&t<=n[1])return!0}return!1}function Ht(t){function e(t,e){for(var n=e.childNodes.length-1;n>=0;n--)t.push(e.childNodes[n])}function n(t){if(!t||!t.length)return null;var i=t.pop(),r=i.textContent||i.innerText;if(r){var o=r.match(/^.*(\n|\r)/);return o?(t.length=0,o[0]):r}return"ruby"===i.tagName?n(t):i.childNodes?(e(t,i),n(t)):void 0}var i,r=[],o="";if(!t||!t.childNodes)return"ltr";for(e(r,t);o=n(r);)for(var a=0;a<o.length;a++)if(i=o.charCodeAt(a),Gt(i))return"rtl";return"ltr"}function zt(t){if("number"==typeof t.line&&(t.snapToLines||t.line>=0&&t.line<=100))return t.line;if(!t.track||!t.track.textTrackList||!t.track.textTrackList.mediaElement)return-1;for(var e=t.track,n=e.textTrackList,i=0,r=0;r<n.length&&n[r]!==e;r++)"showing"===n[r].mode&&i++;return-1*++i}function Wt(){}function Xt(t,e,n){var i=/MSIE\s8\.0/.test(navigator.userAgent),r="rgba(255, 255, 255, 1)",o="rgba(0, 0, 0, 0.8)";i&&(r="rgb(255, 255, 255)",o="rgb(0, 0, 0)"),Wt.call(this),this.cue=e,this.cueDiv=jt(t,e.text);var a={color:r,backgroundColor:o,position:"relative",left:0,right:0,top:0,bottom:0,display:"inline"};i||(a.writingMode=""===e.vertical?"horizontal-tb":"lr"===e.vertical?"vertical-lr":"vertical-rl",a.unicodeBidi="plaintext"),this.applyStyles(a,this.cueDiv),this.div=t.document.createElement("div"),a={textAlign:"middle"===e.align?"center":e.align,font:n.font,whiteSpace:"pre-line",position:"absolute"},i||(a.direction=Ht(this.cueDiv),a.writingMode=""===e.vertical?"horizontal-tb":"lr"===e.vertical?"vertical-lr":"vertical-rl".stylesunicodeBidi="plaintext"),this.applyStyles(a),this.div.appendChild(this.cueDiv);var s=0;switch(e.positionAlign){case"start":s=e.position;break;case"middle":s=e.position-e.size/2;break;case"end":s=e.position-e.size}""===e.vertical?this.applyStyles({left:this.formatStyle(s,"%"),width:this.formatStyle(e.size,"%")}):this.applyStyles({top:this.formatStyle(s,"%"),height:this.formatStyle(e.size,"%")}),this.move=function(t){this.applyStyles({top:this.formatStyle(t.top,"px"),bottom:this.formatStyle(t.bottom,"px"),left:this.formatStyle(t.left,"px"),right:this.formatStyle(t.right,"px"),height:this.formatStyle(t.height,"px"),width:this.formatStyle(t.width,"px")})}}function qt(t){var e,n,i,r,o=/MSIE\s8\.0/.test(navigator.userAgent);if(t.div){n=t.div.offsetHeight,i=t.div.offsetWidth,r=t.div.offsetTop;var a=(a=t.div.childNodes)&&(a=a[0])&&a.getClientRects&&a.getClientRects();t=t.div.getBoundingClientRect(),e=a?Math.max(a[0]&&a[0].height||0,t.height/a.length):0}this.left=t.left,this.right=t.right,this.top=t.top||r,this.height=t.height||n,this.bottom=t.bottom||r+(t.height||n),this.width=t.width||i,this.lineHeight=void 0!==e?e:t.lineHeight,o&&!this.lineHeight&&(this.lineHeight=13)}function Kt(t,e,n,i){var r=new qt(e),o=e.cue,a=zt(o),s=[];if(o.snapToLines){var l;switch(o.vertical){case"":s=["+y","-y"],l="height";break;case"rl":s=["+x","-x"],l="width";break;case"lr":s=["-x","+x"],l="width"}var u=r.lineHeight,c=u*Math.round(a),h=n[l]+u,d=s[0];Math.abs(c)>h&&(c=c<0?-1:1,c*=Math.ceil(h/u)*u),a<0&&(c+=""===o.vertical?n.height:n.width,s=s.reverse()),r.move(d,c)}else{var p=r.lineHeight/n.height*100;switch(o.lineAlign){case"middle":a-=p/2;break;case"end":a-=p}switch(o.vertical){case"":e.applyStyles({top:e.formatStyle(a,"%")});break;case"rl":e.applyStyles({left:e.formatStyle(a,"%")});break;case"lr":e.applyStyles({right:e.formatStyle(a,"%")})}s=["+y","-x","+x","-y"],r=new qt(e)}var f=function(t,e){for(var r,o=new qt(t),a=1,s=0;s<e.length;s++){for(;t.overlapsOppositeAxis(n,e[s])||t.within(n)&&t.overlapsAny(i);)t.move(e[s]);if(t.within(n))return t;var l=t.intersectPercentage(n);a>l&&(r=new qt(t),a=l),t=new qt(o)}return r||o}(r,s);e.move(f.toCSSCompatValues(n))}function Yt(){}function $t(t){return"string"==typeof t&&(!!er[t.toLowerCase()]&&t.toLowerCase())}function Qt(t){return"string"==typeof t&&(!!nr[t.toLowerCase()]&&t.toLowerCase())}function Jt(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)t[i]=n[i]}return t}function Zt(t,e,n){var i=this,r=/MSIE\s8\.0/.test(navigator.userAgent),o={};r?i=document.createElement("custom"):o.enumerable=!0,i.hasBeenReset=!1;var a="",s=!1,l=t,u=e,c=n,h=null,d="",p=!0,f="auto",m="start",v=50,g="middle",y=50,b="middle";if(Object.defineProperty(i,"id",Jt({},o,{get:function(){return a},set:function(t){a=""+t}})),Object.defineProperty(i,"pauseOnExit",Jt({},o,{get:function(){return s},set:function(t){s=!!t}})),Object.defineProperty(i,"startTime",Jt({},o,{get:function(){return l},set:function(t){if("number"!=typeof t)throw new TypeError("Start time must be set to a number.");l=t,this.hasBeenReset=!0}})),Object.defineProperty(i,"endTime",Jt({},o,{get:function(){return u},set:function(t){if("number"!=typeof t)throw new TypeError("End time must be set to a number.");u=t,this.hasBeenReset=!0}})),Object.defineProperty(i,"text",Jt({},o,{get:function(){return c},set:function(t){c=""+t,this.hasBeenReset=!0}})),Object.defineProperty(i,"region",Jt({},o,{get:function(){return h},set:function(t){h=t,this.hasBeenReset=!0}})),Object.defineProperty(i,"vertical",Jt({},o,{get:function(){return d},set:function(t){var e=$t(t);if(!1===e)throw new SyntaxError("An invalid or illegal string was specified.");d=e,this.hasBeenReset=!0}})),Object.defineProperty(i,"snapToLines",Jt({},o,{get:function(){return p},set:function(t){p=!!t,this.hasBeenReset=!0}})),Object.defineProperty(i,"line",Jt({},o,{get:function(){return f},set:function(t){if("number"!=typeof t&&t!==tr)throw new SyntaxError("An invalid number or illegal string was specified.");f=t,this.hasBeenReset=!0}})),Object.defineProperty(i,"lineAlign",Jt({},o,{get:function(){return m},set:function(t){var e=Qt(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");m=e,this.hasBeenReset=!0}})),Object.defineProperty(i,"position",Jt({},o,{get:function(){return v},set:function(t){if(t<0||t>100)throw new Error("Position must be between 0 and 100.");v=t,this.hasBeenReset=!0}})),Object.defineProperty(i,"positionAlign",Jt({},o,{get:function(){return g},set:function(t){var e=Qt(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");g=e,this.hasBeenReset=!0}})),Object.defineProperty(i,"size",Jt({},o,{get:function(){return y},set:function(t){if(t<0||t>100)throw new Error("Size must be between 0 and 100.");y=t,this.hasBeenReset=!0}})),Object.defineProperty(i,"align",Jt({},o,{get:function(){return b},set:function(t){var e=Qt(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");b=e,this.hasBeenReset=!0}})),i.displayState=void 0,r)return i}function te(t){return"string"==typeof t&&(!!rr[t.toLowerCase()]&&t.toLowerCase())}function ee(t){return"number"==typeof t&&t>=0&&t<=100}function ne(){var t=100,e=3,n=0,i=100,r=0,o=100,a="";(0,c.default)(this,{width:{enumerable:!0,get:function(){return t},set:function(e){if(!ee(e))throw new Error("Width must be between 0 and 100.");t=e}},lines:{enumerable:!0,get:function(){return e},set:function(t){if("number"!=typeof t)throw new TypeError("Lines must be set to a number.");e=t}},regionAnchorY:{enumerable:!0,get:function(){return i},set:function(t){if(!ee(t))throw new Error("RegionAnchorX must be between 0 and 100.");i=t}},regionAnchorX:{enumerable:!0,get:function(){return n},set:function(t){if(!ee(t))throw new Error("RegionAnchorY must be between 0 and 100.");n=t}},viewportAnchorY:{enumerable:!0,get:function(){return o},set:function(t){if(!ee(t))throw new Error("ViewportAnchorY must be between 0 and 100.");o=t}},viewportAnchorX:{enumerable:!0,get:function(){return r},set:function(t){if(!ee(t))throw new Error("ViewportAnchorX must be between 0 and 100.");r=t}},scroll:{enumerable:!0,get:function(){return a},set:function(t){var e=te(t);if(!1===e)throw new SyntaxError("An invalid or illegal string was specified.");a=e}}})}function ie(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=t.textTracks();r.kind=e,n&&(r.label=n),i&&(r.language=i),r.tech=t;var a=new Xi.text.TrackClass(r);return o.addTrack(a),a}function re(t,e){lr[t]=lr[t]||[],lr[t].push(e)}function oe(t,e,n){t.setTimeout(function(){return fe(e,lr[e.type],n,t)},1)}function ae(t,e){t.forEach(function(t){return t.setTech&&t.setTech(e)})}function se(t,e,n){return t.reduceRight(ce(n),e[n]())}function le(t,e,n,i){return e[n](t.reduce(ce(n),i))}function ue(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r="call"+dt(n),o=t.reduce(ce(r),i),a=o===cr,s=a?null:e[n](o);return he(t,n,s,a),s}function ce(t){return function(e,n){return e===cr?cr:n[t]?n[t](e):e}}function he(t,e,n,i){for(var r=t.length-1;r>=0;r--){var o=t[r];o[e]&&o[e](i,n)}}function de(t){ur[t.id()]=null}function pe(t,e){var n=ur[t.id()],i=null;if(void 0===n||null===n)return i=e(t),ur[t.id()]=[[e,i]],i;for(var r=0;r<n.length;r++){var o=n[r],a=o[0],s=o[1];a===e&&(i=s)}return null===i&&(i=e(t),n.push([e,i])),i}function fe(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments[2],i=arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=e[0],l=e.slice(1);if("string"==typeof s)fe(t,lr[s],n,i,o,a);else if(s){var u=pe(i,s);u.setSource(r({},t),function(e,r){if(e)return fe(t,l,n,i,o,a);o.push(u),fe(r,t.type===r.type?l:lr[r.type],n,i,o,a)})}else l.length?fe(t,l,n,i,o,a):a?n(t,o):fe(t,lr["*"],n,i,o,!0)}function me(t){var e=Ti(t.src),n=fr[e.toLowerCase()];return!t.type&&n&&(t.type=n),t}function ve(t,e){return"rgba("+parseInt(t[1]+t[1],16)+","+parseInt(t[2]+t[2],16)+","+parseInt(t[3]+t[3],16)+","+e+")"}function ge(t,e,n){try{t.style[e]=n}catch(t){return}}function ye(t){Cr=t}function be(){Cr=Ar}function _e(t,e){if(e&&(t=e(t)),t&&"none"!==t)return t}function we(t,e){return _e(t.options[t.options.selectedIndex].value,e)}function Te(t,e,n){if(e)for(var i=0;i<t.options.length;i++)if(_e(t.options[i].value,n)===e){t.selectedIndex=i;break}}function xe(t,e,n){var i=xe.getPlayer(t);if(i)return e&&mn.warn('Player "'+t+'" is already initialised. Options will not be applied.'),n&&i.ready(n),i;var r="string"==typeof t?yn("#"+ta(t)):t;if(!b(r))throw new TypeError("The element or ID supplied is not valid. (videojs)");De.body.contains(r)||mn.warn("The element supplied is not included in the DOM"),e=e||{},xe.hooks("beforesetup").forEach(function(t){var n=t(r,ft(e));if(!o(n)||Array.isArray(n))return void mn.error("please return an object in beforesetup hooks");e=ft(e,n)});var a=Wn.getComponent("Player");return i=new a(r,e,n),xe.hooks("setup").forEach(function(t){return t(i)}),i}var Ee,Se="6.8.0",Ae="undefined"!=typeof window?window:void 0!==i?i:"undefined"!=typeof self?self:{};Ee="undefined"!=typeof window?window:void 0!==Ae?Ae:"undefined"!=typeof self?self:{};var Ce,ke=Ee,Me={},Le=(L.default||Object)({default:Me}),Re=Le&&Me||Le,Pe=void 0!==Ae?Ae:"undefined"!=typeof window?window:{};"undefined"!=typeof document?Ce=document:(Ce=Pe["__GLOBAL_DOCUMENT_CACHE@4"])||(Ce=Pe["__GLOBAL_DOCUMENT_CACHE@4"]=Re);var De=Ce,Ie=ke.navigator&&ke.navigator.userAgent||"",Fe=/AppleWebKit\/([\d.]+)/i.exec(Ie),Oe=Fe?parseFloat(Fe.pop()):null,Ne=/iPad/i.test(Ie),Ue=/iPhone/i.test(Ie)&&!Ne,Ve=/iPod/i.test(Ie),Be=Ue||Ne||Ve,je=function(){var t=Ie.match(/OS (\d+)_/i);return t&&t[1]?t[1]:null}(),Ge=/Android/i.test(Ie),He=function(){var t=Ie.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!t)return null;var e=t[1]&&parseFloat(t[1]),n=t[2]&&parseFloat(t[2]);return e&&n?parseFloat(t[1]+"."+t[2]):e||null}(),ze=Ge&&/webkit/i.test(Ie)&&He<2.3,We=Ge&&He<5&&Oe<537,Xe=/Firefox/i.test(Ie),qe=/Edge/i.test(Ie),Ke=!qe&&/Chrome/i.test(Ie),Ye=function(){var t=Ie.match(/Chrome\/(\d+)/);return t&&t[1]?parseFloat(t[1]):null}(),$e=/MSIE\s8\.0/.test(Ie),Qe=function(){var t=/MSIE\s(\d+)\.\d/.exec(Ie),e=t&&parseFloat(t[1]);return!e&&/Trident\/7.0/i.test(Ie)&&/rv:11.0/.test(Ie)&&(e=11),e}(),Je=/Safari/i.test(Ie)&&!Ke&&!Ge&&!qe,Ze=Je||Be,tn=g()&&("ontouchstart"in ke||ke.DocumentTouch&&ke.document instanceof ke.DocumentTouch),en=g()&&"backgroundSize"in ke.document.createElement("video").style,nn=(L.default||Object)({IS_IPAD:Ne,IS_IPHONE:Ue,IS_IPOD:Ve,IS_IOS:Be,IOS_VERSION:je,IS_ANDROID:Ge,ANDROID_VERSION:He,IS_OLD_ANDROID:ze,IS_NATIVE_ANDROID:We,IS_FIREFOX:Xe,IS_EDGE:qe,IS_CHROME:Ke,CHROME_VERSION:Ye,IS_IE8:$e,IE_VERSION:Qe,IS_SAFARI:Je,IS_ANY_SAFARI:Ze,TOUCH_ENABLED:tn,BACKGROUND_SIZE_SUPPORTED:en}),rn="function"==typeof k.default&&"symbol"===(0,P.default)(A.default)?function(t){return void 0===t?"undefined":(0,P.default)(t)}:function(t){return t&&"function"==typeof k.default&&t.constructor===k.default&&t!==k.default.prototype?"symbol":void 0===t?"undefined":(0,P.default)(t)},on=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},an=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":(0,P.default)(e)));t.prototype=(0,E.default)(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(T.default?(0,T.default)(t,e):t.__proto__=e)},sn=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":(0,P.default)(e))&&"function"!=typeof e?t:e},ln=function(t,e){return t.raw=e,t},un=Object.prototype.toString,cn=function(t){return o(t)?(0,_.default)(t):[]},hn=void 0,dn="info",pn=[],fn=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:!!Qe&&Qe<11,i=hn.levels[dn],r=new RegExp("^("+i+")$");if("log"!==t&&e.unshift(t.toUpperCase()+":"),pn&&pn.push([].concat(e)),e.unshift("VIDEOJS:"),ke.console){var a=ke.console[t];a||"debug"!==t||(a=ke.console.info||ke.console.log),a&&i&&r.test(t)&&(n&&(e=e.map(function(t){if(o(t)||Array.isArray(t))try{return(0,v.default)(t)}catch(e){return String(t)}return String(t)}).join(" ")),a.apply?a[Array.isArray(e)?"apply":"call"](ke.console,e):a(e))}};hn=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];fn("log",e)},hn.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:dn},hn.level=function(t){if("string"==typeof t){if(!hn.levels.hasOwnProperty(t))throw new Error('"'+t+'" in not a valid log level');dn=t}return dn},hn.history=function(){return pn?[].concat(pn):[]},hn.history.clear=function(){pn&&(pn.length=0)},hn.history.disable=function(){null!==pn&&(pn.length=0,pn=null)},hn.history.enable=function(){null===pn&&(pn=[])},hn.error=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return fn("error",e)},hn.warn=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return fn("warn",e)},hn.debug=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return fn("debug",e)};var mn=hn,vn=function(t){for(var e="",n=0;n<arguments.length;n++)e+=s(t[n])+(arguments[n+1]||"");return e},gn=ln(["Setting attributes in the second argument of createEl()\n                has been deprecated. Use the third argument instead.\n                createEl(type, properties, attributes). Attempting to set "," to ","."],["Setting attributes in the second argument of createEl()\n                has been deprecated. Use the third argument instead.\n                createEl(type, properties, attributes). Attempting to set "," to ","."]),yn=x("querySelector"),bn=x("querySelectorAll"),_n=(L.default||Object)({isReal:g,isEl:b,isInFrame:w,createEl:S,textContent:C,prependTo:M,hasClass:R,addClass:D,removeClass:I,toggleClass:F,setAttributes:O,getAttributes:N,getAttribute:U,setAttribute:V,removeAttribute:B,blockTextSelection:j,unblockTextSelection:G,getBoundingClientRect:H,findPosition:z,getPointerPosition:W,isTextNode:X,emptyEl:q,normalizeContent:K,appendContent:Y,insertContent:$,isSingleLeftClick:Q,$:yn,$$:bn}),wn=1,Tn={},xn="vdata"+(new Date).getTime(),En=!1;!function(){try{var t=Object.defineProperty({},"passive",{get:function(){En=!0}});ke.addEventListener("test",null,t),ke.removeEventListener("test",null,t)}catch(t){}}();var Sn=["touchstart","touchmove"],An=(L.default||Object)({fixEvent:rt,on:ot,off:at,trigger:st,one:lt}),Cn=!1,kn=void 0,Mn=function(){if(g()){var t=De.getElementsByTagName("video"),e=De.getElementsByTagName("audio"),n=De.getElementsByTagName("video-js"),i=[];if(t&&t.length>0)for(var r=0,o=t.length;r<o;r++)i.push(t[r]);if(e&&e.length>0)for(var a=0,s=e.length;a<s;a++)i.push(e[a]);if(n&&n.length>0)for(var l=0,u=n.length;l<u;l++)i.push(n[l]);if(i&&i.length>0)for(var c=0,h=i.length;c<h;c++){var d=i[c];if(!d||!d.getAttribute){ut(1);break}if(void 0===d.player){var p=d.getAttribute("data-setup");null!==p&&kn(d)}}else Cn||ut(1)}};g()&&"complete"===De.readyState?Cn=!0:lt(ke,"load",function(){Cn=!0});var Ln=function(t){var e=De.createElement("style");return e.className=t,e},Rn=function(t,e){t.styleSheet?t.styleSheet.cssText=e:t.textContent=e},Pn=function(t,e,n){e.guid||(e.guid=J());var i=function(){return e.apply(t,arguments)};return i.guid=n?n+"_"+e.guid:e.guid,i},Dn=function(t,e){var n=Date.now();return function(){var i=Date.now();i-n>=e&&(t.apply(void 0,arguments),n=i)}},In=function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ke,r=void 0;return function(){var o=this,a=arguments,s=function(){r=null,s=null,n||t.apply(o,a)};!r&&n&&t.apply(o,a),i.clearTimeout(r),r=i.setTimeout(s,e)}},Fn=function(){};Fn.prototype.allowedEvents_={},Fn.prototype.on=function(t,e){var n=this.addEventListener;this.addEventListener=function(){},ot(this,t,e),this.addEventListener=n},Fn.prototype.addEventListener=Fn.prototype.on,Fn.prototype.off=function(t,e){at(this,t,e)},Fn.prototype.removeEventListener=Fn.prototype.off,Fn.prototype.one=function(t,e){var n=this.addEventListener;this.addEventListener=function(){},lt(this,t,e),this.addEventListener=n},Fn.prototype.trigger=function(t){var e=t.type||t;"string"==typeof t&&(t={type:e}),t=rt(t),this.allowedEvents_[e]&&this["on"+e]&&this["on"+e](t),st(this,t)},Fn.prototype.dispatchEvent=Fn.prototype.trigger;var On=function(t){return t instanceof Fn||!!t.eventBusEl_&&["on","one","off","trigger"].every(function(e){return"function"==typeof t[e]})},Nn=function(t){return"string"==typeof t&&/\S/.test(t)||Array.isArray(t)&&!!t.length},Un=function(t){if(!t.nodeName&&!On(t))throw new Error("Invalid target; must be a DOM node or evented object.")},Vn=function(t){if(!Nn(t))throw new Error("Invalid event type; must be a non-empty string or array.")},Bn=function(t){if("function"!=typeof t)throw new Error("Invalid listener; must be a function.")},jn=function(t,e){var n=e.length<3||e[0]===t||e[0]===t.eventBusEl_,i=void 0,r=void 0,o=void 0;return n?(i=t.eventBusEl_,e.length>=3&&e.shift(),r=e[0],o=e[1]):(i=e[0],r=e[1],o=e[2]),Un(i),Vn(r),Bn(o),o=Pn(t,o),{isTargetingSelf:n,target:i,type:r,listener:o}},Gn=function(t,e,n,i){Un(t),t.nodeName?An[e](t,n,i):t[e](n,i)},Hn={on:function(){for(var t=this,e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var r=jn(this,n),o=r.isTargetingSelf,a=r.target,s=r.type,l=r.listener;if(Gn(a,"on",s,l),!o){var u=function(){return t.off(a,s,l)};u.guid=l.guid;var c=function(){return t.off("dispose",u)};c.guid=l.guid,Gn(this,"on","dispose",u),Gn(a,"on","dispose",c)}},one:function(){for(var t=this,e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var r=jn(this,n),o=r.isTargetingSelf,a=r.target,s=r.type,l=r.listener;if(o)Gn(a,"one",s,l);else{var u=function e(){for(var n=arguments.length,i=Array(n),r=0;r<n;r++)i[r]=arguments[r];t.off(a,s,e),l.apply(null,i)};u.guid=l.guid,Gn(a,"one",s,u)}},off:function(t,e,n){if(!t||Nn(t))at(this.eventBusEl_,t,e);else{var i=t,r=e;Un(i),Vn(r),Bn(n),n=Pn(this,n),this.off("dispose",n),i.nodeName?(at(i,r,n),at(i,"dispose",n)):On(i)&&(i.off(r,n),i.off("dispose",n))}},trigger:function(t,e){return st(this.eventBusEl_,t,e)}},zn={state:{},setState:function(t){var n=this;"function"==typeof t&&(t=t());var i=void 0;return e(t,function(t,e){n.state[e]!==t&&(i=i||{},i[e]={from:n.state[e],to:t}),n.state[e]=t}),i&&On(this)&&this.trigger({changes:i,type:"statechanged"}),i}},Wn=function(){function t(e,n,i){if(on(this,t),!e&&this.play?this.player_=e=this:this.player_=e,this.options_=ft({},this.options_),n=this.options_=ft(this.options_,n),this.id_=n.id||n.el&&n.el.id,!this.id_){var r=e&&e.id&&e.id()||"no_player";this.id_=r+"_component_"+J()}this.name_=n.name||null,n.el?this.el_=n.el:!1!==n.createEl&&(this.el_=this.createEl()),!1!==n.evented&&ct(this,{eventBusKey:this.el_?"el_":null}),ht(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},this.childNameIndex_={},!1!==n.initChildren&&this.initChildren(),this.ready(i),!1!==n.reportTouchActivity&&this.enableTouchActivity()}return t.prototype.dispose=function(){if(this.trigger({type:"dispose",bubbles:!1}),this.children_)for(var t=this.children_.length-1;t>=0;t--)this.children_[t].dispose&&this.children_[t].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.el_&&(this.el_.parentNode&&this.el_.parentNode.removeChild(this.el_),et(this.el_),this.el_=null),this.player_=null},t.prototype.player=function(){return this.player_},t.prototype.options=function(t){return mn.warn("this.options() has been deprecated and will be moved to the constructor in 6.0"),t?(this.options_=ft(this.options_,t),this.options_):this.options_},t.prototype.el=function(){return this.el_},t.prototype.createEl=function(t,e,n){return S(t,e,n)},t.prototype.localize=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,i=this.player_.language&&this.player_.language(),r=this.player_.languages&&this.player_.languages(),o=r&&r[i],a=i&&i.split("-")[0],s=r&&r[a],l=n;return o&&o[t]?l=o[t]:s&&s[t]&&(l=s[t]),e&&(l=l.replace(/\{(\d+)\}/g,function(t,n){var i=e[n-1],r=i;return void 0===i&&(r=t),r})),l},t.prototype.contentEl=function(){return this.contentEl_||this.el_},t.prototype.id=function(){return this.id_},t.prototype.name=function(){return this.name_},t.prototype.children=function(){return this.children_},t.prototype.getChildById=function(t){return this.childIndex_[t]},t.prototype.getChild=function(t){if(t)return t=dt(t),this.childNameIndex_[t]},t.prototype.addChild=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.children_.length,r=void 0,o=void 0;if("string"==typeof e){o=dt(e);var a=n.componentClass||o;n.name=o;var s=t.getComponent(a);if(!s)throw new Error("Component "+a+" does not exist");if("function"!=typeof s)return null;r=new s(this.player_||this,n)}else r=e;if(this.children_.splice(i,0,r),"function"==typeof r.id&&(this.childIndex_[r.id()]=r),o=o||r.name&&dt(r.name()),o&&(this.childNameIndex_[o]=r),"function"==typeof r.el&&r.el()){var l=this.contentEl().children,u=l[i]||null;this.contentEl().insertBefore(r.el(),u)}return r},t.prototype.removeChild=function(t){if("string"==typeof t&&(t=this.getChild(t)),t&&this.children_){for(var e=!1,n=this.children_.length-1;n>=0;n--)if(this.children_[n]===t){e=!0,this.children_.splice(n,1);break}if(e){this.childIndex_[t.id()]=null,this.childNameIndex_[t.name()]=null;var i=t.el();i&&i.parentNode===this.contentEl()&&this.contentEl().removeChild(t.el())}}},t.prototype.initChildren=function(){var e=this,n=this.options_.children;if(n){var i=this.options_,r=function(t){var n=t.name,r=t.opts;if(void 0!==i[n]&&(r=i[n]),!1!==r){!0===r&&(r={}),r.playerOptions=e.options_.playerOptions;var o=e.addChild(n,r);o&&(e[n]=o)}},o=void 0,a=t.getComponent("Tech");o=Array.isArray(n)?n:(0,_.default)(n),o.concat((0,_.default)(this.options_).filter(function(t){return!o.some(function(e){return"string"==typeof e?t===e:t===e.name})})).map(function(t){var i=void 0,r=void 0;return"string"==typeof t?(i=t,r=n[i]||e.options_[i]||{}):(i=t.name,r=t),{name:i,opts:r}}).filter(function(e){var n=t.getComponent(e.opts.componentClass||dt(e.name));return n&&!a.isTech(n)}).forEach(r)}},t.prototype.buildCSSClass=function(){return""},t.prototype.ready=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t)return this.isReady_?void(e?t.call(this):this.setTimeout(t,1)):(this.readyQueue_=this.readyQueue_||[],void this.readyQueue_.push(t))},t.prototype.triggerReady=function(){this.isReady_=!0,this.setTimeout(function(){var t=this.readyQueue_;this.readyQueue_=[],t&&t.length>0&&t.forEach(function(t){t.call(this)},this),this.trigger("ready")},1)},t.prototype.$=function(t,e){return yn(t,e||this.contentEl())},t.prototype.$$=function(t,e){return bn(t,e||this.contentEl())},t.prototype.hasClass=function(t){return R(this.el_,t)},t.prototype.addClass=function(t){D(this.el_,t)},t.prototype.removeClass=function(t){I(this.el_,t)},t.prototype.toggleClass=function(t,e){F(this.el_,t,e)},t.prototype.show=function(){this.removeClass("vjs-hidden")},t.prototype.hide=function(){this.addClass("vjs-hidden")},t.prototype.lockShowing=function(){this.addClass("vjs-lock-showing")},t.prototype.unlockShowing=function(){this.removeClass("vjs-lock-showing")},t.prototype.getAttribute=function(t){return U(this.el_,t)},t.prototype.setAttribute=function(t,e){V(this.el_,t,e)},t.prototype.removeAttribute=function(t){B(this.el_,t)},t.prototype.width=function(t,e){return this.dimension("width",t,e)},t.prototype.height=function(t,e){return this.dimension("height",t,e)},t.prototype.dimensions=function(t,e){this.width(t,!0),this.height(e)},t.prototype.dimension=function(t,e,n){if(void 0!==e)return null!==e&&e===e||(e=0),-1!==(""+e).indexOf("%")||-1!==(""+e).indexOf("px")?this.el_.style[t]=e:this.el_.style[t]="auto"===e?"":e+"px",void(n||this.trigger("componentresize"));if(!this.el_)return 0;var i=this.el_.style[t],r=i.indexOf("px");return-1!==r?parseInt(i.slice(0,r),10):parseInt(this.el_["offset"+dt(t)],10)},t.prototype.currentDimension=function(t){var e=0;if("width"!==t&&"height"!==t)throw new Error("currentDimension only accepts width or height value");if("function"==typeof ke.getComputedStyle){var n=ke.getComputedStyle(this.el_);e=n.getPropertyValue(t)||n[t]}if(0===(e=parseFloat(e))){var i="offset"+dt(t);e=this.el_[i]}return e},t.prototype.currentDimensions=function(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}},t.prototype.currentWidth=function(){return this.currentDimension("width")},t.prototype.currentHeight=function(){return this.currentDimension("height")},t.prototype.focus=function(){this.el_.focus()},t.prototype.blur=function(){this.el_.blur()},t.prototype.emitTapEvents=function(){var t=0,e=null,n=void 0;this.on("touchstart",function(i){1===i.touches.length&&(e={pageX:i.touches[0].pageX,pageY:i.touches[0].pageY},t=(new Date).getTime(),n=!0)}),this.on("touchmove",function(t){if(t.touches.length>1)n=!1;else if(e){var i=t.touches[0].pageX-e.pageX,r=t.touches[0].pageY-e.pageY,o=Math.sqrt(i*i+r*r);o>10&&(n=!1)}});var i=function(){n=!1};this.on("touchleave",i),this.on("touchcancel",i),this.on("touchend",function(i){if(e=null,!0===n){(new Date).getTime()-t<200&&(i.preventDefault(),this.trigger("tap"))}})},t.prototype.enableTouchActivity=function(){if(this.player()&&this.player().reportUserActivity){var t=Pn(this.player(),this.player().reportUserActivity),e=void 0;this.on("touchstart",function(){t(),this.clearInterval(e),e=this.setInterval(t,250)});var n=function(n){t(),this.clearInterval(e)};this.on("touchmove",t),this.on("touchend",n),this.on("touchcancel",n)}},t.prototype.setTimeout=function(t,e){var n=this;t=Pn(this,t);var i=ke.setTimeout(t,e),r=function(){return n.clearTimeout(i)};return r.guid="vjs-timeout-"+i,this.on("dispose",r),i},t.prototype.clearTimeout=function(t){ke.clearTimeout(t);var e=function(){};return e.guid="vjs-timeout-"+t,this.off("dispose",e),t},t.prototype.setInterval=function(t,e){var n=this;t=Pn(this,t);var i=ke.setInterval(t,e),r=function(){return n.clearInterval(i)};return r.guid="vjs-interval-"+i,this.on("dispose",r),i},t.prototype.clearInterval=function(t){ke.clearInterval(t);var e=function(){};return e.guid="vjs-interval-"+t,this.off("dispose",e),t},t.prototype.requestAnimationFrame=function(t){var e=this;if(this.supportsRaf_){t=Pn(this,t);var n=ke.requestAnimationFrame(t),i=function(){return e.cancelAnimationFrame(n)};return i.guid="vjs-raf-"+n,this.on("dispose",i),n}return this.setTimeout(t,1e3/60)},t.prototype.cancelAnimationFrame=function(t){if(this.supportsRaf_){ke.cancelAnimationFrame(t);var e=function(){};return e.guid="vjs-raf-"+t,this.off("dispose",e),t}return this.clearTimeout(t)},t.registerComponent=function(e,n){if("string"!=typeof e||!e)throw new Error('Illegal component name, "'+e+'"; must be a non-empty string.');var i=t.getComponent("Tech"),r=i&&i.isTech(n),o=t===n||t.prototype.isPrototypeOf(n.prototype);if(r||!o){var a=void 0;throw a=r?"techs must be registered using Tech.registerTech()":"must be a Component subclass",new Error('Illegal component, "'+e+'"; '+a+".")}e=dt(e),t.components_||(t.components_={});var s=t.getComponent("Player");if("Player"===e&&s&&s.players){var l=s.players,u=(0,_.default)(l);if(l&&u.length>0&&u.map(function(t){return l[t]}).every(Boolean))throw new Error("Can not register Player component after player has been created.")}return t.components_[e]=n,n},t.getComponent=function(e){if(e)return e=dt(e),t.components_&&t.components_[e]?t.components_[e]:void 0},t}();Wn.prototype.supportsRaf_="function"==typeof ke.requestAnimationFrame&&"function"==typeof ke.cancelAnimationFrame,Wn.registerComponent("Component",Wn);for(var Xn={},qn=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],Kn=qn[0],Yn=void 0,$n=0;$n<qn.length;$n++)if(qn[$n][1]in De){Yn=qn[$n];break}if(Yn)for(var Qn=0;Qn<Yn.length;Qn++)Xn[Kn[Qn]]=Yn[Qn];_t.prototype.code=0,_t.prototype.message="",_t.prototype.status=null,_t.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],_t.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(var Jn=0;Jn<_t.errorTypes.length;Jn++)_t[_t.errorTypes[Jn]]=Jn,_t.prototype[_t.errorTypes[Jn]]=Jn;var Zn=wt,ti=function(t){return["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce(function(e,n,i){return t[n]&&(e[n]=t[n]),e},{cues:t.cues&&Array.prototype.map.call(t.cues,function(t){return{startTime:t.startTime,endTime:t.endTime,text:t.text,id:t.id}})})},ei=function(t){var e=t.$$("track"),n=Array.prototype.map.call(e,function(t){return t.track});return Array.prototype.map.call(e,function(t){var e=ti(t.track);return t.src&&(e.src=t.src),e}).concat(Array.prototype.filter.call(t.textTracks(),function(t){return-1===n.indexOf(t)}).map(ti))},ni=function(t,e){return t.forEach(function(t){var n=e.addRemoteTextTrack(t).track;!t.src&&t.cues&&t.cues.forEach(function(t){return n.addCue(t)})}),e.textTracks()},ii={textTracksToJson:ei,jsonToTextTracks:ni,trackToJson_:ti},ri="vjs-modal-dialog",oi=function(t){function e(n,i){on(this,e);var r=sn(this,t.call(this,n,i));return r.opened_=r.hasBeenOpened_=r.hasBeenFilled_=!1,r.closeable(!r.options_.uncloseable),r.content(r.options_.content),r.contentEl_=S("div",{className:ri+"-content"},{role:"document"}),r.descEl_=S("p",{className:ri+"-description vjs-control-text",id:r.el().getAttribute("aria-describedby")}),C(r.descEl_,r.description()),r.el_.appendChild(r.descEl_),r.el_.appendChild(r.contentEl_),r}return an(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":this.id()+"_description","aria-hidden":"true","aria-label":this.label(),role:"dialog"})},e.prototype.dispose=function(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,t.prototype.dispose.call(this)},e.prototype.buildCSSClass=function(){return ri+" vjs-hidden "+t.prototype.buildCSSClass.call(this)},e.prototype.handleKeyPress=function(t){27===t.which&&this.closeable()&&this.close()},e.prototype.label=function(){return this.localize(this.options_.label||"Modal Window")},e.prototype.description=function(){var t=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(t+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),t},e.prototype.open=function(){if(!this.opened_){var t=this.player();this.trigger("beforemodalopen"),this.opened_=!0,(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_)&&this.fill(),this.wasPlaying_=!t.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&t.pause(),this.closeable()&&this.on(this.el_.ownerDocument,"keydown",Pn(this,this.handleKeyPress)),this.hadControls_=t.controls(),t.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0}},e.prototype.opened=function(t){return"boolean"==typeof t&&this[t?"open":"close"](),this.opened_},e.prototype.close=function(){if(this.opened_){var t=this.player();this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&t.play(),this.closeable()&&this.off(this.el_.ownerDocument,"keydown",Pn(this,this.handleKeyPress)),this.hadControls_&&t.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger("modalclose"),this.conditionalBlur_(),this.options_.temporary&&this.dispose()}},e.prototype.closeable=function(t){if("boolean"==typeof t){var e=this.closeable_=!!t,n=this.getChild("closeButton");if(e&&!n){var i=this.contentEl_;this.contentEl_=this.el_,n=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=i,this.on(n,"close",this.close)}!e&&n&&(this.off(n,"close",this.close),this.removeChild(n),n.dispose())}return this.closeable_},e.prototype.fill=function(){this.fillWith(this.content())},e.prototype.fillWith=function(t){var e=this.contentEl(),n=e.parentNode,i=e.nextSibling;this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,n.removeChild(e),this.empty(),$(e,t),this.trigger("modalfill"),i?n.insertBefore(e,i):n.appendChild(e);var r=this.getChild("closeButton");r&&n.appendChild(r.el_)},e.prototype.empty=function(){this.trigger("beforemodalempty"),q(this.contentEl()),this.trigger("modalempty")},e.prototype.content=function(t){return void 0!==t&&(this.content_=t),this.content_},e.prototype.conditionalFocus_=function(){var t=De.activeElement,e=this.player_.el_;this.previouslyActiveEl_=null,(e.contains(t)||e===t)&&(this.previouslyActiveEl_=t,this.focus(),this.on(De,"keydown",this.handleKeyDown))},e.prototype.conditionalBlur_=function(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null),this.off(De,"keydown",this.handleKeyDown)},e.prototype.handleKeyDown=function(t){if(9===t.which){for(var e=this.focusableEls_(),n=this.el_.querySelector(":focus"),i=void 0,r=0;r<e.length;r++)if(n===e[r]){i=r;break}De.activeElement===this.el_&&(i=0),t.shiftKey&&0===i?(e[e.length-1].focus(),t.preventDefault()):t.shiftKey||i!==e.length-1||(e[0].focus(),t.preventDefault())}},e.prototype.focusableEls_=function(){var t=this.el_.querySelectorAll("*");return Array.prototype.filter.call(t,function(t){return(t instanceof ke.HTMLAnchorElement||t instanceof ke.HTMLAreaElement)&&t.hasAttribute("href")||(t instanceof ke.HTMLInputElement||t instanceof ke.HTMLSelectElement||t instanceof ke.HTMLTextAreaElement||t instanceof ke.HTMLButtonElement)&&!t.hasAttribute("disabled")||t instanceof ke.HTMLIFrameElement||t instanceof ke.HTMLObjectElement||t instanceof ke.HTMLEmbedElement||t.hasAttribute("tabindex")&&-1!==t.getAttribute("tabindex")||t.hasAttribute("contenteditable")})},e}(Wn);oi.prototype.options_={pauseOnOpen:!0,temporary:!0},Wn.registerComponent("ModalDialog",oi);var ai=function(t){function e(){var n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;on(this,e);var o=sn(this,t.call(this));if(!r&&(r=o,$e)){r=De.createElement("custom");for(var a in e.prototype)"constructor"!==a&&(r[a]=e.prototype[a])}r.tracks_=[],Object.defineProperty(r,"length",{get:function(){return this.tracks_.length}});for(var s=0;s<i.length;s++)r.addTrack(i[s]);return n=r,sn(o,n)}return an(e,t),e.prototype.addTrack=function(t){var e=this.tracks_.length;""+e in this||(0,d.default)(this,e,{get:function(){return this.tracks_[e]}}),-1===this.tracks_.indexOf(t)&&(this.tracks_.push(t),this.trigger({track:t,type:"addtrack"}))},e.prototype.removeTrack=function(t){for(var e=void 0,n=0,i=this.length;n<i;n++)if(this[n]===t){e=this[n],e.off&&e.off(),this.tracks_.splice(n,1);break}e&&this.trigger({track:e,type:"removetrack"})},e.prototype.getTrackById=function(t){for(var e=null,n=0,i=this.length;n<i;n++){var r=this[n];if(r.id===t){e=r;break}}return e},e}(Fn);ai.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack"};for(var si in ai.prototype.allowedEvents_)ai.prototype["on"+si]=null;var li=function(t,e){for(var n=0;n<t.length;n++)(0,_.default)(t[n]).length&&e.id!==t[n].id&&(t[n].enabled=!1)},ui=function(t){function e(){var n,i,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];on(this,e);for(var o=void 0,a=r.length-1;a>=0;a--)if(r[a].enabled){li(r,r[a]);break}if($e){o=De.createElement("custom");for(var s in ai.prototype)"constructor"!==s&&(o[s]=ai.prototype[s]);for(var l in e.prototype)"constructor"!==l&&(o[l]=e.prototype[l])}return o=n=sn(this,t.call(this,r,o)),o.changing_=!1,i=o,sn(n,i)}return an(e,t),e.prototype.addTrack=function(e){var n=this;e.enabled&&li(this,e),t.prototype.addTrack.call(this,e),e.addEventListener&&e.addEventListener("enabledchange",function(){n.changing_||(n.changing_=!0,li(n,e),n.changing_=!1,n.trigger("change"))})},e}(ai),ci=function(t,e){for(var n=0;n<t.length;n++)(0,_.default)(t[n]).length&&e.id!==t[n].id&&(t[n].selected=!1)},hi=function(t){function e(){var n,i,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];on(this,e);for(var o=void 0,a=r.length-1;a>=0;a--)if(r[a].selected){ci(r,r[a]);break}if($e){o=De.createElement("custom");for(var s in ai.prototype)"constructor"!==s&&(o[s]=ai.prototype[s]);for(var l in e.prototype)"constructor"!==l&&(o[l]=e.prototype[l])}return o=n=sn(this,t.call(this,r,o)),o.changing_=!1,Object.defineProperty(o,"selectedIndex",{get:function(){for(var t=0;t<this.length;t++)if(this[t].selected)return t;return-1},set:function(){}}),i=o,sn(n,i)}return an(e,t),e.prototype.addTrack=function(e){var n=this;e.selected&&ci(this,e),t.prototype.addTrack.call(this,e),e.addEventListener&&e.addEventListener("selectedchange",function(){n.changing_||(n.changing_=!0,ci(n,e),n.changing_=!1,n.trigger("change"))})},e}(ai),di=function(t){function e(){var n,i,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];on(this,e);var o=void 0;if($e){o=De.createElement("custom");for(var a in ai.prototype)"constructor"!==a&&(o[a]=ai.prototype[a]);for(var s in e.prototype)"constructor"!==s&&(o[s]=e.prototype[s])}return o=n=sn(this,t.call(this,r,o)),i=o,sn(n,i)}return an(e,t),e.prototype.addTrack=function(e){t.prototype.addTrack.call(this,e),e.addEventListener("modechange",Pn(this,function(){this.trigger("change")})),-1===["metadata","chapters"].indexOf(e.kind)&&e.addEventListener("modechange",Pn(this,function(){this.trigger("selectedlanguagechange")}))},e}(ai),pi=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];on(this,t);var n=this;if($e){n=De.createElement("custom");for(var i in t.prototype)"constructor"!==i&&(n[i]=t.prototype[i])}n.trackElements_=[],Object.defineProperty(n,"length",{get:function(){return this.trackElements_.length}});for(var r=0,o=e.length;r<o;r++)n.addTrackElement_(e[r]);if($e)return n}return t.prototype.addTrackElement_=function(t){var e=this.trackElements_.length;""+e in this||(0,d.default)(this,e,{get:function(){return this.trackElements_[e]}}),-1===this.trackElements_.indexOf(t)&&this.trackElements_.push(t)},t.prototype.getTrackElementByTrack_=function(t){for(var e=void 0,n=0,i=this.trackElements_.length;n<i;n++)if(t===this.trackElements_[n].track){e=this.trackElements_[n];break}return e},t.prototype.removeTrackElement_=function(t){for(var e=0,n=this.trackElements_.length;e<n;e++)if(t===this.trackElements_[e]){this.trackElements_.splice(e,1);break}},t}(),fi=function(){function t(e){on(this,t);var n=this;if($e){n=De.createElement("custom");for(var i in t.prototype)"constructor"!==i&&(n[i]=t.prototype[i])}if(t.prototype.setCues_.call(n,e),Object.defineProperty(n,"length",{get:function(){return this.length_}}),$e)return n}return t.prototype.setCues_=function(t){var e=this.length||0,n=0,i=t.length;this.cues_=t,this.length_=t.length;var r=function(t){""+t in this||(0,d.default)(this,""+t,{get:function(){return this.cues_[t]}})};if(e<i)for(n=e;n<i;n++)r.call(this,n)},t.prototype.getCueById=function(t){for(var e=null,n=0,i=this.length;n<i;n++){var r=this[n];if(r.id===t){e=r;break}}return e},t}(),mi={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},vi={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},gi={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},yi={disabled:"disabled",hidden:"hidden",showing:"showing"},bi=function(t){function e(){var n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};on(this,e);var r=sn(this,t.call(this)),o=r;if($e){o=De.createElement("custom");for(var a in e.prototype)"constructor"!==a&&(o[a]=e.prototype[a])}var s={id:i.id||"vjs_track_"+J(),kind:i.kind||"",label:i.label||"",language:i.language||""};for(var l in s)!function(t){(0,d.default)(o,t,{get:function(){return s[t]},set:function(){}})}(l);return n=o,sn(r,n)}return an(e,t),e}(Fn),_i=function(t){var e=["protocol","hostname","port","pathname","search","hash","host"],n=De.createElement("a");n.href=t;var i=""===n.host&&"file:"!==n.protocol,r=void 0;i&&(r=De.createElement("div"),r.innerHTML='<a href="'+t+'"></a>',n=r.firstChild,r.setAttribute("style","display:none; position:absolute;"),De.body.appendChild(r));for(var o={},a=0;a<e.length;a++)o[e[a]]=n[e[a]];return"http:"===o.protocol&&(o.host=o.host.replace(/:80$/,"")),"https:"===o.protocol&&(o.host=o.host.replace(/:443$/,"")),o.protocol||(o.protocol=ke.location.protocol),i&&De.body.removeChild(r),o},wi=function(t){if(!t.match(/^https?:\/\//)){var e=De.createElement("div");e.innerHTML='<a href="'+t+'">x</a>',t=e.firstChild.href}return t},Ti=function(t){if("string"==typeof t){var e=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/i,n=e.exec(t);if(n)return n.pop().toLowerCase()}return""},xi=function(t){var e=ke.location,n=_i(t);return(":"===n.protocol?e.protocol:n.protocol)+n.host!==e.protocol+e.host},Ei=(L.default||Object)({parseUrl:_i,getAbsoluteURL:wi,getFileExtension:Ti,isCrossOrigin:xi}),Si=Et,Ai=Object.prototype.toString,Ci=t(function(t,e){function n(t){return t.replace(/^\s*|\s*$/g,"")}e=t.exports=n,e.left=function(t){return t.replace(/^\s*/,"")},e.right=function(t){return t.replace(/\s*$/,"")}}),ki=St,Mi=Object.prototype.toString,Li=Object.prototype.hasOwnProperty,Ri=function(t){return"[object Array]"===Object.prototype.toString.call(t)},Pi=function(t){if(!t)return{};var e={};return ki(Ci(t).split("\n"),function(t){var n=t.indexOf(":"),i=Ci(t.slice(0,n)).toLowerCase(),r=Ci(t.slice(n+1));void 0===e[i]?e[i]=r:Ri(e[i])?e[i].push(r):e[i]=[e[i],r]}),e},Di=Mt,Ii=Object.prototype.hasOwnProperty,Fi=Pt;Pt.XMLHttpRequest=ke.XMLHttpRequest||Ft,Pt.XDomainRequest="withCredentials"in new Pt.XMLHttpRequest?Pt.XMLHttpRequest:ke.XDomainRequest,function(t,e){for(var n=0;n<t.length;n++)e(t[n])}(["get","put","post","patch","head","delete"],function(t){Pt["delete"===t?"del":t]=function(e,n,i){return n=Rt(e,n,i),n.method=t.toUpperCase(),Dt(n)}});var Oi=function(t,e){var n=new ke.WebVTT.Parser(ke,ke.vttjs,ke.WebVTT.StringDecoder()),i=[];n.oncue=function(t){e.addCue(t)},n.onparsingerror=function(t){i.push(t)},n.onflush=function(){e.trigger({type:"loadeddata",target:e})},n.parse(t),i.length>0&&(ke.console&&ke.console.groupCollapsed&&ke.console.groupCollapsed("Text Track parsing errors for "+e.src),i.forEach(function(t){return mn.error(t)}),ke.console&&ke.console.groupEnd&&ke.console.groupEnd()),n.flush()},Ni=function(t,e){var n={uri:t},i=xi(t);i&&(n.cors=i),Fi(n,Pn(this,function(t,n,i){if(t)return mn.error(t,n);if(e.loaded_=!0,"function"!=typeof ke.WebVTT){if(e.tech_){var r=function(){return Oi(i,e)};e.tech_.on("vttjsloaded",r),e.tech_.on("vttjserror",function(){mn.error("vttjs failed to load, stopping trying to process "+e.src),e.tech_.off("vttjsloaded",r)})}}else Oi(i,e)}))},Ui=function(t){function e(){var n,i,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(on(this,e),!r.tech)throw new Error("A tech was not provided.");var o=ft(r,{kind:gi[r.kind]||"subtitles",language:r.language||r.srclang||""}),a=yi[o.mode]||"disabled",s=o.default;"metadata"!==o.kind&&"chapters"!==o.kind||(a="hidden");var l=n=sn(this,t.call(this,o));if(l.tech_=o.tech,$e)for(var u in e.prototype)"constructor"!==u&&(l[u]=e.prototype[u]);l.cues_=[],l.activeCues_=[];var c=new fi(l.cues_),h=new fi(l.activeCues_),d=!1,p=Pn(l,function(){this.activeCues,d&&(this.trigger("cuechange"),d=!1)});return"disabled"!==a&&l.tech_.ready(function(){l.tech_.on("timeupdate",p)},!0),Object.defineProperty(l,"default",{get:function(){return s},set:function(){}}),Object.defineProperty(l,"mode",{get:function(){return a},set:function(t){var e=this;yi[t]&&(a=t,"showing"===a&&this.tech_.ready(function(){e.tech_.on("timeupdate",p)},!0),this.trigger("modechange"))}}),Object.defineProperty(l,"cues",{get:function(){return this.loaded_?c:null},set:function(){}}),Object.defineProperty(l,"activeCues",{get:function(){if(!this.loaded_)return null;if(0===this.cues.length)return h;for(var t=this.tech_.currentTime(),e=[],n=0,i=this.cues.length;n<i;n++){var r=this.cues[n];r.startTime<=t&&r.endTime>=t?e.push(r):r.startTime===r.endTime&&r.startTime<=t&&r.startTime+.5>=t&&e.push(r)}if(d=!1,e.length!==this.activeCues_.length)d=!0;else for(var o=0;o<e.length;o++)-1===this.activeCues_.indexOf(e[o])&&(d=!0);return this.activeCues_=e,h.setCues_(this.activeCues_),h},set:function(){}}),o.src?(l.src=o.src,Ni(o.src,l)):l.loaded_=!0,i=l,sn(n,i)}return an(e,t),e.prototype.addCue=function(t){var e=t;if(ke.vttjs&&!(t instanceof ke.vttjs.VTTCue)){e=new ke.vttjs.VTTCue(t.startTime,t.endTime,t.text);for(var n in t)n in e||(e[n]=t[n]);e.id=t.id,e.originalCue_=t}for(var i=this.tech_.textTracks(),r=0;r<i.length;r++)i[r]!==this&&i[r].removeCue(e);this.cues_.push(e),this.cues.setCues_(this.cues_)},e.prototype.removeCue=function(t){for(var e=this.cues_.length;e--;){var n=this.cues_[e];if(n===t||n.originalCue_&&n.originalCue_===t){this.cues_.splice(e,1),this.cues.setCues_(this.cues_);break}}},e}(bi);Ui.prototype.allowedEvents_={cuechange:"cuechange"};var Vi=function(t){function e(){var n,i,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};on(this,e);var o=ft(r,{kind:vi[r.kind]||""}),a=n=sn(this,t.call(this,o)),s=!1;if($e)for(var l in e.prototype)"constructor"!==l&&(a[l]=e.prototype[l]);return Object.defineProperty(a,"enabled",{get:function(){return s},set:function(t){"boolean"==typeof t&&t!==s&&(s=t,this.trigger("enabledchange"))}}),o.enabled&&(a.enabled=o.enabled),a.loaded_=!0,i=a,sn(n,i)}return an(e,t),e}(bi),Bi=function(t){function e(){var n,i,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};on(this,e);var o=ft(r,{kind:mi[r.kind]||""}),a=n=sn(this,t.call(this,o)),s=!1;if($e)for(var l in e.prototype)"constructor"!==l&&(a[l]=e.prototype[l]);return Object.defineProperty(a,"selected",{get:function(){return s},set:function(t){"boolean"==typeof t&&t!==s&&(s=t,this.trigger("selectedchange"))}}),o.selected&&(a.selected=o.selected),i=a,sn(n,i)}return an(e,t),e}(bi),ji=0,Gi=2,Hi=function(t){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};on(this,e);var i=sn(this,t.call(this)),r=void 0,o=i;if($e){o=De.createElement("custom");for(var a in e.prototype)"constructor"!==a&&(o[a]=e.prototype[a])}var s=new Ui(n);if(o.kind=s.kind,o.src=s.src,o.srclang=s.language,o.label=s.label,o.default=s.default,Object.defineProperty(o,"readyState",{get:function(){return r}}),Object.defineProperty(o,"track",{get:function(){return s}}),r=ji,s.addEventListener("loadeddata",function(){r=Gi,o.trigger({type:"load",target:o})}),$e){var l;return l=o,sn(i,l)}return i}return an(e,t),e}(Fn);Hi.prototype.allowedEvents_={load:"load"},Hi.NONE=ji,Hi.LOADING=1,Hi.LOADED=Gi,Hi.ERROR=3;var zi={audio:{ListClass:ui,TrackClass:Vi,capitalName:"Audio"},video:{ListClass:hi,TrackClass:Bi,capitalName:"Video"},text:{ListClass:di,TrackClass:Ui,capitalName:"Text"}};(0,_.default)(zi).forEach(function(t){zi[t].getterName=t+"Tracks",zi[t].privateName=t+"Tracks_"});var Wi={remoteText:{ListClass:di,TrackClass:Ui,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:pi,TrackClass:Hi,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}},Xi=ft(zi,Wi);Wi.names=(0,_.default)(Wi),zi.names=(0,_.default)(zi),Xi.names=[].concat(Wi.names).concat(zi.names);var qi=E.default||function(){function t(){}return function(e){if(1!==arguments.length)throw new Error("Object.create shim only accepts one parameter.");return t.prototype=e,new t}}();Ot.prototype=qi(Error.prototype),Ot.prototype.constructor=Ot,Ot.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},Ut.prototype={set:function(t,e){this.get(t)||""===e||(this.values[t]=e)},get:function(t,e,n){return n?this.has(t)?this.values[t]:e[n]:this.has(t)?this.values[t]:e},has:function(t){return t in this.values},alt:function(t,e,n){for(var i=0;i<n.length;++i)if(e===n[i]){this.set(t,e);break}},integer:function(t,e){/^-?\d+$/.test(e)&&this.set(t,parseInt(e,10))},percent:function(t,e){return!!(e.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(e=parseFloat(e))>=0&&e<=100)&&(this.set(t,e),!0)}};var Ki={"&amp;":"&","&lt;":"<","&gt;":">","&lrm;":"â","&rlm;":"â","&nbsp;":"Â "},Yi={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},$i={v:"title",lang:"lang"},Qi={rt:"ruby"},Ji=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];Wt.prototype.applyStyles=function(t,e){e=e||this.div;for(var n in t)t.hasOwnProperty(n)&&(e.style[n]=t[n])},Wt.prototype.formatStyle=function(t,e){return 0===t?0:t+e},Xt.prototype=qi(Wt.prototype),Xt.prototype.constructor=Xt,qt.prototype.move=function(t,e){switch(e=void 0!==e?e:this.lineHeight,t){case"+x":this.left+=e,this.right+=e;break;case"-x":this.left-=e,this.right-=e;break;case"+y":this.top+=e,this.bottom+=e;break;case"-y":this.top-=e,this.bottom-=e}},qt.prototype.overlaps=function(t){return this.left<t.right&&this.right>t.left&&this.top<t.bottom&&this.bottom>t.top},qt.prototype.overlapsAny=function(t){for(var e=0;e<t.length;e++)if(this.overlaps(t[e]))return!0;return!1},qt.prototype.within=function(t){return this.top>=t.top&&this.bottom<=t.bottom&&this.left>=t.left&&this.right<=t.right},qt.prototype.overlapsOppositeAxis=function(t,e){switch(e){case"+x":return this.left<t.left;case"-x":return this.right>t.right;case"+y":return this.top<t.top;case"-y":return this.bottom>t.bottom}},qt.prototype.intersectPercentage=function(t){return Math.max(0,Math.min(this.right,t.right)-Math.max(this.left,t.left))*Math.max(0,Math.min(this.bottom,t.bottom)-Math.max(this.top,t.top))/(this.height*this.width)},qt.prototype.toCSSCompatValues=function(t){return{top:this.top-t.top,bottom:t.bottom-this.bottom,left:this.left-t.left,right:t.right-this.right,height:this.height,width:this.width}},qt.getSimpleBoxPosition=function(t){var e=t.div?t.div.offsetHeight:t.tagName?t.offsetHeight:0,n=t.div?t.div.offsetWidth:t.tagName?t.offsetWidth:0,i=t.div?t.div.offsetTop:t.tagName?t.offsetTop:0;return t=t.div?t.div.getBoundingClientRect():t.tagName?t.getBoundingClientRect():t,{left:t.left,right:t.right,top:t.top||i,height:t.height||e,bottom:t.bottom||i+(t.height||e),width:t.width||n}},Yt.StringDecoder=function(){return{decode:function(t){if(!t)return"";if("string"!=typeof t)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(t))}}},Yt.convertCueToDOMTree=function(t,e){return t&&e?jt(t,e):null};Yt.processCues=function(t,e,n){if(!t||!e||!n)return null;for(;n.firstChild;)n.removeChild(n.firstChild);var i=t.document.createElement("div");if(i.style.position="absolute",i.style.left="0",i.style.right="0",i.style.top="0",i.style.bottom="0",i.style.margin="1.5%",n.appendChild(i),function(t){for(var e=0;e<t.length;e++)if(t[e].hasBeenReset||!t[e].displayState)return!0;return!1}(e)){var r=[],o=qt.getSimpleBoxPosition(i),a=Math.round(.05*o.height*100)/100,s={font:a+"px sans-serif"};!function(){for(var n,a,l=0;l<e.length;l++)a=e[l],n=new Xt(t,a,s),i.appendChild(n.div),Kt(t,n,o,r),a.displayState=n.div,r.push(qt.getSimpleBoxPosition(n))}()}else for(var l=0;l<e.length;l++)i.appendChild(e[l].displayState)},Yt.Parser=function(t,e,n){n||(n=e,e={}),e||(e={}),this.window=t,this.vttjs=e,this.state="INITIAL",this.buffer="",this.decoder=n||new TextDecoder("utf8"),this.regionList=[]},Yt.Parser.prototype={reportOrThrowError:function(t){if(!(t instanceof Ot))throw t;this.onparsingerror&&this.onparsingerror(t)},parse:function(t){function e(){for(var t=r.buffer,e=0;e<t.length&&"\r"!==t[e]&&"\n"!==t[e];)++e;var n=t.substr(0,e);return"\r"===t[e]&&++e,"\n"===t[e]&&++e,r.buffer=t.substr(e),n}function n(t){var e=new Ut;if(Vt(t,function(t,n){switch(t){case"id":e.set(t,n);break;case"width":e.percent(t,n);break;case"lines":e.integer(t,n);break;case"regionanchor":case"viewportanchor":var i=n.split(",");if(2!==i.length)break;var r=new Ut;if(r.percent("x",i[0]),r.percent("y",i[1]),!r.has("x")||!r.has("y"))break;e.set(t+"X",r.get("x")),e.set(t+"Y",r.get("y"));break;case"scroll":e.alt(t,n,["up"])}},/=/,/\s/),e.has("id")){var n=new(r.vttjs.VTTRegion||r.window.VTTRegion);n.width=e.get("width",100),n.lines=e.get("lines",3),n.regionAnchorX=e.get("regionanchorX",0),n.regionAnchorY=e.get("regionanchorY",100),n.viewportAnchorX=e.get("viewportanchorX",0),n.viewportAnchorY=e.get("viewportanchorY",100),n.scroll=e.get("scroll",""),r.onregion&&r.onregion(n),r.regionList.push({id:e.get("id"),region:n})}}function i(t){var e=new Ut;Vt(t,function(t,n){switch(t){case"MPEGT":e.integer(t+"S",n);break;case"LOCA":e.set(t+"L",Nt(n))}},/[^\d]:/,/,/),r.ontimestampmap&&r.ontimestampmap({MPEGTS:e.get("MPEGTS"),LOCAL:e.get("LOCAL")})}var r=this;t&&(r.buffer+=r.decoder.decode(t,{stream:!0}));try{var o;if("INITIAL"===r.state){if(!/\r\n|\n/.test(r.buffer))return this;o=e();var a=o.match(/^WEBVTT([ \t].*)?$/);if(!a||!a[0])throw new Ot(Ot.Errors.BadSignature);r.state="HEADER"}for(var s=!1;r.buffer;){if(!/\r\n|\n/.test(r.buffer))return this;switch(s?s=!1:o=e(),r.state){case"HEADER":/:/.test(o)?function(t){t.match(/X-TIMESTAMP-MAP/)?Vt(t,function(t,e){switch(t){case"X-TIMESTAMP-MAP":i(e)}},/=/):Vt(t,function(t,e){switch(t){case"Region":n(e)}},/:/)}(o):o||(r.state="ID");continue;case"NOTE":o||(r.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(o)){r.state="NOTE";break}if(!o)continue;if(r.cue=new(r.vttjs.VTTCue||r.window.VTTCue)(0,0,""),r.state="CUE",-1===o.indexOf("--\x3e")){r.cue.id=o;continue}case"CUE":try{Bt(o,r.cue,r.regionList)}catch(t){r.reportOrThrowError(t),r.cue=null,r.state="BADCUE";continue}r.state="CUETEXT";continue;case"CUETEXT":var l=-1!==o.indexOf("--\x3e");if(!o||l&&(s=!0)){r.oncue&&r.oncue(r.cue),r.cue=null,r.state="ID";continue}r.cue.text&&(r.cue.text+="\n"),r.cue.text+=o;continue;case"BADCUE":o||(r.state="ID");continue}}}catch(t){r.reportOrThrowError(t),"CUETEXT"===r.state&&r.cue&&r.oncue&&r.oncue(r.cue),r.cue=null,r.state="INITIAL"===r.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var t=this;try{if(t.buffer+=t.decoder.decode(),(t.cue||"HEADER"===t.state)&&(t.buffer+="\n\n",t.parse()),"INITIAL"===t.state)throw new Ot(Ot.Errors.BadSignature)}catch(e){t.reportOrThrowError(e)}return t.onflush&&t.onflush(),this}};var Zi=Yt,tr="auto",er={"":!0,lr:!0,rl:!0},nr={start:!0,middle:!0,end:!0,left:!0,right:!0};Zt.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)};var ir=Zt,rr={"":!0,up:!0},or=ne,ar=t(function(t){var e=t.exports={WebVTT:Zi,VTTCue:ir,VTTRegion:or};ke.vttjs=e,ke.WebVTT=e.WebVTT;var n=e.VTTCue,i=e.VTTRegion,r=ke.VTTCue,o=ke.VTTRegion;e.shim=function(){ke.VTTCue=n,ke.VTTRegion=i},e.restore=function(){ke.VTTCue=r,ke.VTTRegion=o},ke.VTTCue||e.shim()}),sr=function(t){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};on(this,e),n.reportTouchActivity=!1;var r=sn(this,t.call(this,null,n,i));return r.hasStarted_=!1,r.on("playing",function(){this.hasStarted_=!0}),r.on("loadstart",function(){this.hasStarted_=!1}),Xi.names.forEach(function(t){var e=Xi[t];n&&n[e.getterName]&&(r[e.privateName]=n[e.getterName])}),r.featuresProgressEvents||r.manualProgressOn(),r.featuresTimeupdateEvents||r.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach(function(t){!1===n["native"+t+"Tracks"]&&(r["featuresNative"+t+"Tracks"]=!1)}),!1===n.nativeCaptions||!1===n.nativeTextTracks?r.featuresNativeTextTracks=!1:!0!==n.nativeCaptions&&!0!==n.nativeTextTracks||(r.featuresNativeTextTracks=!0),r.featuresNativeTextTracks||r.emulateTextTracks(),r.autoRemoteTextTracks_=new Xi.text.ListClass,r.initTrackListeners(),n.nativeControlsForTouch||r.emitTapEvents(),r.constructor&&(r.name_=r.constructor.name||"Unknown Tech"),r}return an(e,t),e.prototype.triggerSourceset=function(t){var e=this;this.isReady_||this.one("ready",function(){return e.setTimeout(function(){return e.triggerSourceset(t)},1)}),this.trigger({src:t,type:"sourceset"})},e.prototype.manualProgressOn=function(){this.on("durationchange",this.onDurationChange),this.manualProgress=!0,this.one("ready",this.trackProgress)},e.prototype.manualProgressOff=function(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange)},e.prototype.trackProgress=function(t){this.stopTrackingProgress(),this.progressInterval=this.setInterval(Pn(this,function(){var t=this.bufferedPercent();this.bufferedPercent_!==t&&this.trigger("progress"),this.bufferedPercent_=t,1===t&&this.stopTrackingProgress()}),500)},e.prototype.onDurationChange=function(t){this.duration_=this.duration()},e.prototype.buffered=function(){return yt(0,0)},e.prototype.bufferedPercent=function(){return bt(this.buffered(),this.duration_)},e.prototype.stopTrackingProgress=function(){this.clearInterval(this.progressInterval)},e.prototype.manualTimeUpdatesOn=function(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime),this.on("pause",this.stopTrackingCurrentTime)},e.prototype.manualTimeUpdatesOff=function(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime),this.off("pause",this.stopTrackingCurrentTime)},e.prototype.trackCurrentTime=function(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},250)},e.prototype.stopTrackingCurrentTime=function(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},e.prototype.dispose=function(){this.clearTracks(zi.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),t.prototype.dispose.call(this)},e.prototype.clearTracks=function(t){var e=this;t=[].concat(t),t.forEach(function(t){for(var n=e[t+"Tracks"]()||[],i=n.length;i--;){var r=n[i];"text"===t&&e.removeRemoteTextTrack(r),n.removeTrack(r)}})},e.prototype.cleanupAutoTextTracks=function(){for(var t=this.autoRemoteTextTracks_||[],e=t.length;e--;){var n=t[e];this.removeRemoteTextTrack(n)}},e.prototype.reset=function(){},e.prototype.error=function(t){return void 0!==t&&(this.error_=new _t(t),this.trigger("error")),this.error_},e.prototype.played=function(){return this.hasStarted_?yt(0,0):yt()},e.prototype.setCurrentTime=function(){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},e.prototype.initTrackListeners=function(){var t=this;zi.names.forEach(function(e){var n=zi[e],i=function(){t.trigger(e+"trackchange")},r=t[n.getterName]();r.addEventListener("removetrack",i),r.addEventListener("addtrack",i),t.on("dispose",function(){r.removeEventListener("removetrack",i),r.removeEventListener("addtrack",i)})})},e.prototype.addWebVttScript_=function(){var t=this;if(!ke.WebVTT)if(De.body.contains(this.el())){if(!this.options_["vtt.js"]&&a(ar)&&(0,_.default)(ar).length>0)return void this.trigger("vttjsloaded");var e=De.createElement("script");e.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.12.4/vtt.min.js",e.onload=function(){t.trigger("vttjsloaded")},e.onerror=function(){t.trigger("vttjserror")},this.on("dispose",function(){e.onload=null,e.onerror=null}),ke.WebVTT=!0,this.el().parentNode.appendChild(e)}else this.ready(this.addWebVttScript_)},e.prototype.emulateTextTracks=function(){var t=this,e=this.textTracks(),n=this.remoteTextTracks(),i=function(t){return e.addTrack(t.track)},r=function(t){return e.removeTrack(t.track)};n.on("addtrack",i),n.on("removetrack",r),this.addWebVttScript_();var o=function(){return t.trigger("texttrackchange")},a=function(){o();for(var t=0;t<e.length;t++){var n=e[t];n.removeEventListener("cuechange",o),"showing"===n.mode&&n.addEventListener("cuechange",o)}};a(),e.addEventListener("change",a),e.addEventListener("addtrack",a),e.addEventListener("removetrack",a),this.on("dispose",function(){n.off("addtrack",i),n.off("removetrack",r),e.removeEventListener("change",a),e.removeEventListener("addtrack",a),e.removeEventListener("removetrack",a);for(var t=0;t<e.length;t++){e[t].removeEventListener("cuechange",o)}})},e.prototype.addTextTrack=function(t,e,n){if(!t)throw new Error("TextTrack kind is required but was not provided");return ie(this,t,e,n)},e.prototype.createRemoteTextTrack=function(t){var e=ft(t,{tech:this});return new Wi.remoteTextEl.TrackClass(e)},e.prototype.addRemoteTextTrack=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments[1],i=this.createRemoteTextTrack(e);return!0!==n&&!1!==n&&(mn.warn('Calling addRemoteTextTrack without explicitly setting the "manualCleanup" parameter to `true` is deprecated and default to `false` in future version of video.js'),n=!0),this.remoteTextTrackEls().addTrackElement_(i),this.remoteTextTracks().addTrack(i.track),!0!==n&&this.ready(function(){return t.autoRemoteTextTracks_.addTrack(i.track)}),i},e.prototype.removeRemoteTextTrack=function(t){var e=this.remoteTextTrackEls().getTrackElementByTrack_(t);this.remoteTextTrackEls().removeTrackElement_(e),this.remoteTextTracks().removeTrack(t),this.autoRemoteTextTracks_.removeTrack(t)},e.prototype.getVideoPlaybackQuality=function(){return{}},e.prototype.setPoster=function(){},e.prototype.playsinline=function(){},e.prototype.setPlaysinline=function(){},e.prototype.canPlayType=function(){return""},e.canPlayType=function(){return""},e.canPlaySource=function(t,n){return e.canPlayType(t.type)},e.isTech=function(t){return t.prototype instanceof e||t instanceof e||t===e},e.registerTech=function(t,n){if(e.techs_||(e.techs_={}),!e.isTech(n))throw new Error("Tech "+t+" must be a Tech");if(!e.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(!e.canPlaySource)throw new Error("Techs must have a static canPlaySource method on them");return t=dt(t),e.techs_[t]=n,"Tech"!==t&&e.defaultTechOrder_.push(t),n},e.getTech=function(t){if(t)return t=dt(t),e.techs_&&e.techs_[t]?e.techs_[t]:ke&&ke.videojs&&ke.videojs[t]?(mn.warn("The "+t+" tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)"),ke.videojs[t]):void 0},e}(Wn);Xi.names.forEach(function(t){var e=Xi[t];sr.prototype[e.getterName]=function(){return this[e.privateName]=this[e.privateName]||new e.ListClass,this[e.privateName]}}),sr.prototype.featuresVolumeControl=!0,sr.prototype.featuresFullscreenResize=!1,sr.prototype.featuresPlaybackRate=!1,sr.prototype.featuresProgressEvents=!1,sr.prototype.featuresSourceset=!1,sr.prototype.featuresTimeupdateEvents=!1,sr.prototype.featuresNativeTextTracks=!1,sr.withSourceHandlers=function(t){t.registerSourceHandler=function(e,n){var i=t.sourceHandlers;i||(i=t.sourceHandlers=[]),void 0===n&&(n=i.length),i.splice(n,0,e)},t.canPlayType=function(e){for(var n=t.sourceHandlers||[],i=void 0,r=0;r<n.length;r++)if(i=n[r].canPlayType(e))return i;return""},t.selectSourceHandler=function(e,n){for(var i=t.sourceHandlers||[],r=0;r<i.length;r++)if(i[r].canHandleSource(e,n))return i[r];return null},t.canPlaySource=function(e,n){var i=t.selectSourceHandler(e,n);return i?i.canHandleSource(e,n):""},["seekable","duration"].forEach(function(t){var e=this[t];"function"==typeof e&&(this[t]=function(){return this.sourceHandler_&&this.sourceHandler_[t]?this.sourceHandler_[t].apply(this.sourceHandler_,arguments):e.apply(this,arguments)})},t.prototype),t.prototype.setSource=function(e){var n=t.selectSourceHandler(e,this.options_);n||(t.nativeSourceHandler?n=t.nativeSourceHandler:mn.error("No source hander found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler),n!==t.nativeSourceHandler&&(this.currentSource_=e),this.sourceHandler_=n.handleSource(e,this,this.options_),this.on("dispose",this.disposeSourceHandler)},t.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}},Wn.registerComponent("Tech",sr),sr.registerTech("Tech",sr),sr.defaultTechOrder_=[];var lr={},ur={},cr={},hr={buffered:1,currentTime:1,duration:1,seekable:1,played:1,paused:1},dr={setCurrentTime:1},pr={play:1,pause:1},fr={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",mp3:"audio/mpeg",aac:"audio/aac",oga:"audio/ogg",m3u8:"application/x-mpegURL"},mr=function t(e){if(Array.isArray(e)){var n=[];e.forEach(function(e){e=t(e),Array.isArray(e)?n=n.concat(e):o(e)&&n.push(e)}),e=n}else e="string"==typeof e&&e.trim()?[me({src:e})]:o(e)&&"string"==typeof e.src&&e.src&&e.src.trim()?[me(e)]:[];return e},vr=function(t){function e(n,i,r){on(this,e);var o=ft({createEl:!1},i),a=sn(this,t.call(this,n,o,r));if(i.playerOptions.sources&&0!==i.playerOptions.sources.length)n.src(i.playerOptions.sources);else for(var s=0,l=i.playerOptions.techOrder;s<l.length;s++){var u=dt(l[s]),c=sr.getTech(u);if(u||(c=Wn.getComponent(u)),c&&c.isSupported()){n.loadTech_(u);break}}return a}return an(e,t),e}(Wn);Wn.registerComponent("MediaLoader",vr);var gr=function(t){function e(n,i){on(this,e);var r=sn(this,t.call(this,n,i));return r.emitTapEvents(),r.enable(),r}return an(e,t),e.prototype.createEl=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n=r({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"></span>',className:this.buildCSSClass(),tabIndex:0},n),"button"===e&&mn.error("Creating a ClickableComponent with an HTML element of "+e+" is not supported; use a Button instead."),i=r({role:"button","aria-live":"polite"},i),this.tabIndex_=n.tabIndex;var o=t.prototype.createEl.call(this,e,n,i);return this.createControlTextEl(o),o},e.prototype.dispose=function(){this.controlTextEl_=null,t.prototype.dispose.call(this)},e.prototype.createControlTextEl=function(t){return this.controlTextEl_=S("span",{className:"vjs-control-text"}),t&&t.appendChild(this.controlTextEl_),this.controlText(this.controlText_,t),this.controlTextEl_},e.prototype.controlText=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.el();if(void 0===t)return this.controlText_||"Need Text";var n=this.localize(t);this.controlText_=t,C(this.controlTextEl_,n),this.nonIconControl||e.setAttribute("title",n)},e.prototype.buildCSSClass=function(){return"vjs-control vjs-button "+t.prototype.buildCSSClass.call(this)},e.prototype.enable=function(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),void 0!==this.tabIndex_&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick),this.on("focus",this.handleFocus),this.on("blur",this.handleBlur))},e.prototype.disable=function(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),void 0!==this.tabIndex_&&this.el_.removeAttribute("tabIndex"),this.off(["tap","click"],this.handleClick),this.off("focus",this.handleFocus),this.off("blur",this.handleBlur)},e.prototype.handleClick=function(t){},e.prototype.handleFocus=function(t){ot(De,"keydown",Pn(this,this.handleKeyPress))},e.prototype.handleKeyPress=function(e){32===e.which||13===e.which?(e.preventDefault(),this.trigger("click")):t.prototype.handleKeyPress&&t.prototype.handleKeyPress.call(this,e)},e.prototype.handleBlur=function(t){at(De,"keydown",Pn(this,this.handleKeyPress))},e}(Wn);Wn.registerComponent("ClickableComponent",gr);var yr=function(t){function e(n,i){on(this,e);var r=sn(this,t.call(this,n,i));return r.update(),n.on("posterchange",Pn(r,r.update)),r}return an(e,t),e.prototype.dispose=function(){this.player().off("posterchange",this.update),t.prototype.dispose.call(this)},e.prototype.createEl=function(){var t=S("div",{className:"vjs-poster",tabIndex:-1});return en||(this.fallbackImg_=S("img"),t.appendChild(this.fallbackImg_)),t},e.prototype.update=function(t){var e=this.player().poster();this.setSrc(e),e?this.show():this.hide()},e.prototype.setSrc=function(t){if(this.fallbackImg_)this.fallbackImg_.src=t;else{var e="";t&&(e='url("'+t+'")'),this.el_.style.backgroundImage=e}},e.prototype.handleClick=function(t){this.player_.controls()&&(this.player_.paused()?this.player_.play():this.player_.pause())},e}(gr);Wn.registerComponent("PosterImage",yr);var br={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'},_r=function(t){function e(n,i,r){on(this,e);var o=sn(this,t.call(this,n,i,r));return n.on("loadstart",Pn(o,o.toggleDisplay)),n.on("texttrackchange",Pn(o,o.updateDisplay)),n.on("loadstart",Pn(o,o.preselectTrack)),n.ready(Pn(o,function(){if(n.tech_&&n.tech_.featuresNativeTextTracks)return void this.hide();n.on("fullscreenchange",Pn(this,this.updateDisplay));for(var t=this.options_.playerOptions.tracks||[],e=0;e<t.length;e++)this.player_.addRemoteTextTrack(t[e],!0);this.preselectTrack()})),o}return an(e,t),e.prototype.preselectTrack=function(){for(var t={captions:1,subtitles:1},e=this.player_.textTracks(),n=this.player_.cache_.selectedLanguage,i=void 0,r=void 0,o=void 0,a=0;a<e.length;a++){var s=e[a];n&&n.enabled&&n.language===s.language?s.kind===n.kind?o=s:o||(o=s):n&&!n.enabled?(o=null,i=null,r=null):s.default&&("descriptions"!==s.kind||i?s.kind in t&&!r&&(r=s):i=s)}o?o.mode="showing":r?r.mode="showing":i&&(i.mode="showing")},e.prototype.toggleDisplay=function(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()},e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"},{"aria-live":"off","aria-atomic":"true"})},e.prototype.clearDisplay=function(){"function"==typeof ke.WebVTT&&ke.WebVTT.processCues(ke,[],this.el_)},e.prototype.updateDisplay=function(){var t=this.player_.textTracks();this.clearDisplay();for(var e=null,n=null,i=t.length;i--;){var r=t[i];"showing"===r.mode&&("descriptions"===r.kind?e=r:n=r)}n?("off"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","off"),this.updateForTrack(n)):e&&("assertive"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","assertive"),this.updateForTrack(e))},e.prototype.updateForTrack=function(t){if("function"==typeof ke.WebVTT&&t.activeCues){for(var e=[],n=0;n<t.activeCues.length;n++)e.push(t.activeCues[n]);if(ke.WebVTT.processCues(ke,e,this.el_),this.player_.textTrackSettings)for(var i=this.player_.textTrackSettings.getValues(),r=e.length;r--;){var o=e[r];if(o){var a=o.displayState;if(i.color&&(a.firstChild.style.color=i.color),i.textOpacity&&ge(a.firstChild,"color",ve(i.color||"#fff",i.textOpacity)),i.backgroundColor&&(a.firstChild.style.backgroundColor=i.backgroundColor),i.backgroundOpacity&&ge(a.firstChild,"backgroundColor",ve(i.backgroundColor||"#000",i.backgroundOpacity)),i.windowColor&&(i.windowOpacity?ge(a,"backgroundColor",ve(i.windowColor,i.windowOpacity)):a.style.backgroundColor=i.windowColor),i.edgeStyle&&("dropshadow"===i.edgeStyle?a.firstChild.style.textShadow="2px 2px 3px #222, 2px 2px 4px #222, 2px 2px 5px #222":"raised"===i.edgeStyle?a.firstChild.style.textShadow="1px 1px #222, 2px 2px #222, 3px 3px #222":"depressed"===i.edgeStyle?a.firstChild.style.textShadow="1px 1px #ccc, 0 1px #ccc, -1px -1px #222, 0 -1px #222":"uniform"===i.edgeStyle&&(a.firstChild.style.textShadow="0 0 4px #222, 0 0 4px #222, 0 0 4px #222, 0 0 4px #222")),i.fontPercent&&1!==i.fontPercent){var s=ke.parseFloat(a.style.fontSize);a.style.fontSize=s*i.fontPercent+"px",a.style.height="auto",a.style.top="auto",a.style.bottom="2px"}i.fontFamily&&"default"!==i.fontFamily&&("small-caps"===i.fontFamily?a.firstChild.style.fontVariant="small-caps":a.firstChild.style.fontFamily=br[i.fontFamily])}}}},e}(Wn);Wn.registerComponent("TextTrackDisplay",_r);var wr=function(t){function e(){return on(this,e),sn(this,t.apply(this,arguments))}return an(e,t),e.prototype.createEl=function(){var e=this.player_.isAudio(),n=this.localize(e?"Audio Player":"Video Player"),i=S("span",{className:"vjs-control-text",innerHTML:this.localize("{1} is loading.",[n])}),r=t.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner",dir:"ltr"});return r.appendChild(i),r},e}(Wn);Wn.registerComponent("LoadingSpinner",wr);var Tr=function(t){function e(){return on(this,e),sn(this,t.apply(this,arguments))}return an(e,t),e.prototype.createEl=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t="button",e=r({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"></span>',className:this.buildCSSClass()},e),n=r({type:"button","aria-live":"polite"},n);var i=Wn.prototype.createEl.call(this,t,e,n);return this.createControlTextEl(i),i},e.prototype.addChild=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.constructor.name;return mn.warn("Adding an actionable (user controllable) child to a Button ("+n+") is not supported; use a ClickableComponent instead."),Wn.prototype.addChild.call(this,t,e)},e.prototype.enable=function(){t.prototype.enable.call(this),this.el_.removeAttribute("disabled")},e.prototype.disable=function(){t.prototype.disable.call(this),this.el_.setAttribute("disabled","disabled")},e.prototype.handleKeyPress=function(e){32!==e.which&&13!==e.which&&t.prototype.handleKeyPress.call(this,e)},e}(gr);Wn.registerComponent("Button",Tr);var xr=function(t){function e(n,i){on(this,e);var r=sn(this,t.call(this,n,i));return r.mouseused_=!1,r.on("mousedown",r.handleMouseDown),r}return an(e,t),e.prototype.buildCSSClass=function(){return"vjs-big-play-button"},e.prototype.handleClick=function(t){hn("BigPlayButton.prototype.handleClick"),hn(this.player_);var e=this.player_.play();if(!(this.mouseused_&&t.clientX&&t.clientY)){var n=this.player_.getChild("controlBar"),i=n&&n.getChild("playToggle");if(!i)return void this.player_.focus();var r=function(){return i.focus()};Tt(e)?e.then(r,function(){}):this.setTimeout(r,1)}},e.prototype.handleKeyPress=function(e){this.mouseused_=!1,t.prototype.handleKeyPress.call(this,e)},e.prototype.handleMouseDown=function(t){this.mouseused_=!0},e}(Tr);xr.prototype.controlText_="Play Video",Wn.registerComponent("BigPlayButton",xr);var Er=function(t){function e(n,i){on(this,e);var r=sn(this,t.call(this,n,i));return r.controlText(i&&i.controlText||r.localize("Close")),r}return an(e,t),e.prototype.buildCSSClass=function(){return"vjs-close-button "+t.prototype.buildCSSClass.call(this)},e.prototype.handleClick=function(t){this.trigger({type:"close",bubbles:!1})},e}(Tr);Wn.registerComponent("CloseButton",Er);var Sr=function(t){function e(n,i){on(this,e);var r=sn(this,t.call(this,n,i));return r.on(n,"play",r.handlePlay),r.on(n,"pause",r.handlePause),r.on(n,"ended",r.handleEnded),r}return an(e,t),e.prototype.buildCSSClass=function(){return"vjs-play-control "+t.prototype.buildCSSClass.call(this)},e.prototype.handleClick=function(t){this.player_.paused()?this.player_.play():this.player_.pause()},e.prototype.handleSeeked=function(t){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(t):this.handlePlay(t)},e.prototype.handlePlay=function(t){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.controlText("Pause")},e.prototype.handlePause=function(t){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.controlText("Play")},e.prototype.handleEnded=function(t){this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.controlText("Replay"),this.one(this.player_,"seeked",this.handleSeeked)},e}(Tr);Sr.prototype.controlText_="Play",Wn.registerComponent("PlayToggle",Sr);var Ar=function(t,e){t=t<0?0:t;var n=Math.floor(t%60),i=Math.floor(t/60%60),r=Math.floor(t/3600),o=Math.floor(e/60%60),a=Math.floor(e/3600);return(isNaN(t)||t===1/0)&&(r=i=n="-"),r=r>0||a>0?r+":":"",i=((r||o>=10)&&i<10?"0"+i:i)+":",n=n<10?"0"+n:n,r+i+n},Cr=Ar,kr=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return Cr(t,e)},Mr=function(t){function e(n,i){on(this,e);var r=sn(this,t.call(this,n,i));return r.throttledUpdateContent=Dn(Pn(r,r.updateContent),25),r.on(n,"timeupdate",r.throttledUpdateContent),r}return an(e,t),e.prototype.createEl=function(e){var n=this.buildCSSClass(),i=t.prototype.createEl.call(this,"div",{className:n+" vjs-time-control vjs-control"});return this.contentEl_=S("div",{className:n+"-display"},{"aria-live":"off"},S("span",{className:"vjs-control-text",textContent:this.localize(this.controlText_)})),this.updateTextNode_(),i.appendChild(this.contentEl_),i},e.prototype.dispose=function(){this.contentEl_=null,this.textNode_=null,t.prototype.dispose.call(this)},e.prototype.updateTextNode_=function(){if(this.contentEl_){for(;this.contentEl_.firstChild;)this.contentEl_.removeChild(this.contentEl_.firstChild);this.textNode_=De.createTextNode(this.formattedTime_||"0:00"),this.contentEl_.appendChild(this.textNode_)}},e.prototype.formatTime_=function(t){return kr(t)},e.prototype.updateFormattedTime_=function(t){var e=this.formatTime_(t);e!==this.formattedTime_&&(this.formattedTime_=e,this.requestAnimationFrame(this.updateTextNode_))},e.prototype.updateContent=function(t){},e}(Wn);Mr.prototype.controlText_="Time",Wn.registerComponent("TimeDisplay",Mr);var Lr=function(t){function e(n,i){on(this,e);var r=sn(this,t.call(this,n,i));return r.on(n,"ended",r.handleEnded),r}return an(e,t),e.prototype.buildCSSClass=function(){return"vjs-current-time"},e.prototype.updateContent=function(t){var e=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();this.updateFormattedTime_(e)},e.prototype.handleEnded=function(t){this.player_.duration()&&this.updateFormattedTime_(this.player_.duration())},e}(Mr);Lr.prototype.controlText_="Current Time",Wn.registerComponent("CurrentTimeDisplay",Lr);var Rr=function(t){function e(n,i){on(this,e);var r=sn(this,t.call(this,n,i));return r.on(n,"durationchange",r.updateContent),r.on(n,"loadedmetadata",r.throttledUpdateContent),r}return an(e,t),e.prototype.buildCSSClass=function(){return"vjs-duration"},e.prototype.updateContent=function(t){var e=this.player_.duration();e&&this.duration_!==e&&(this.duration_=e,this.updateFormattedTime_(e))},e}(Mr);Rr.prototype.controlText_="Duration Time",Wn.registerComponent("DurationDisplay",Rr);var Pr=function(t){function e(){return on(this,e),sn(this,t.apply(this,arguments))}return an(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-time-control vjs-time-divider",innerHTML:"<div><span>/</span></div>"})},e}(Wn);Wn.registerComponent("TimeDivider",Pr);var Dr=function(t){function e(n,i){on(this,e);var r=sn(this,t.call(this,n,i));return r.on(n,"durationchange",r.throttledUpdateContent),r.on(n,"ended",r.handleEnded),r}return an(e,t),e.prototype.buildCSSClass=function(){return"vjs-remaining-time"},e.prototype.formatTime_=function(e){return"-"+t.prototype.formatTime_.call(this,e)},e.prototype.updateContent=function(t){this.player_.duration()&&(this.player_.remainingTimeDisplay?this.updateFormattedTime_(this.player_.remainingTimeDisplay()):this.updateFormattedTime_(this.player_.remainingTime()))},e.prototype.handleEnded=function(t){this.player_.duration()&&this.updateFormattedTime_(0)},e}(Mr);Dr.prototype.controlText_="Remaining Time",Wn.registerComponent("RemainingTimeDisplay",Dr);var Ir=function(t){function e(n,i){on(this,e);var r=sn(this,t.call(this,n,i));return r.updateShowing(),r.on(r.player(),"durationchange",r.updateShowing),r}return an(e,t),e.prototype.createEl=function(){var e=t.prototype.createEl.call(this,"div",{className:"vjs-live-control vjs-control"});return this.contentEl_=S("div",{className:"vjs-live-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Stream Type")+"</span>"+this.localize("LIVE")},{"aria-live":"off"}),e.appendChild(this.contentEl_),e},e.prototype.dispose=function(){this.contentEl_=null,t.prototype.dispose.call(this)},e.prototype.updateShowing=function(t){this.player().duration()===1/0?this.show():this.hide()},e}(Wn);Wn.registerComponent("LiveDisplay",Ir);var Fr=function(t){function e(n,i){on(this,e);var r=sn(this,t.call(this,n,i));return r.bar=r.getChild(r.options_.barName),r.vertical(!!r.options_.vertical),r.enable(),r}return an(e,t),e.prototype.enabled=function(){return this.enabled_},e.prototype.enable=function(){this.enabled()||(this.on("mousedown",this.handleMouseDown),this.on("touchstart",this.handleMouseDown),this.on("focus",this.handleFocus),this.on("blur",this.handleBlur),this.on("click",this.handleClick),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)},e.prototype.disable=function(){if(this.enabled()){var t=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown),this.off("touchstart",this.handleMouseDown),this.off("focus",this.handleFocus),this.off("blur",this.handleBlur),this.off("click",this.handleClick),this.off(this.player_,"controlsvisible",this.update),this.off(t,"mousemove",this.handleMouseMove),this.off(t,"mouseup",this.handleMouseUp),this.off(t,"touchmove",this.handleMouseMove),this.off(t,"touchend",this.handleMouseUp),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1}},e.prototype.createEl=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.className=n.className+" vjs-slider",n=r({tabIndex:0},n),i=r({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},i),t.prototype.createEl.call(this,e,n,i)},e.prototype.handleMouseDown=function(t){var e=this.bar.el_.ownerDocument;t.preventDefault(),j(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(e,"mousemove",this.handleMouseMove),this.on(e,"mouseup",this.handleMouseUp),this.on(e,"touchmove",this.handleMouseMove),this.on(e,"touchend",this.handleMouseUp),this.handleMouseMove(t)},e.prototype.handleMouseMove=function(t){},e.prototype.handleMouseUp=function(){var t=this.bar.el_.ownerDocument;G(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(t,"mousemove",this.handleMouseMove),this.off(t,"mouseup",this.handleMouseUp),this.off(t,"touchmove",this.handleMouseMove),this.off(t,"touchend",this.handleMouseUp),this.update()},e.prototype.update=function(){if(this.el_){var t=this.getPercent(),e=this.bar;if(e){("number"!=typeof t||t!==t||t<0||t===1/0)&&(t=0);var n=(100*t).toFixed(2)+"%",i=e.el().style;return this.vertical()?i.height=n:i.width=n,t}}},e.prototype.calculateDistance=function(t){var e=W(this.el_,t);return this.vertical()?e.y:e.x},e.prototype.handleFocus=function(){this.on(this.bar.el_.ownerDocument,"keydown",this.handleKeyPress)},e.prototype.handleKeyPress=function(t){37===t.which||40===t.which?(t.preventDefault(),this.stepBack()):38!==t.which&&39!==t.which||(t.preventDefault(),this.stepForward())},e.prototype.handleBlur=function(){this.off(this.bar.el_.ownerDocument,"keydown",this.handleKeyPress)},e.prototype.handleClick=function(t){t.stopImmediatePropagation(),t.preventDefault()},e.prototype.vertical=function(t){if(void 0===t)return this.vertical_||!1;this.vertical_=!!t,this.vertical_?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal")},e}(Wn);Wn.registerComponent("Slider",Fr);var Or=function(t){function e(n,i){on(this,e);var r=sn(this,t.call(this,n,i));return r.partEls_=[],r.on(n,"progress",r.update),r}return an(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-load-progress",innerHTML:'<span class="vjs-control-text"><span>'+this.localize("Loaded")+"</span>: 0%</span>"})},e.prototype.dispose=function(){this.partEls_=null,t.prototype.dispose.call(this)},e.prototype.update=function(t){var e=this.player_.buffered(),n=this.player_.duration(),i=this.player_.bufferedEnd(),r=this.partEls_,o=function(t,e){var n=t/e||0;return 100*(n>=1?1:n)+"%"};this.el_.style.width=o(i,n);for(var a=0;a<e.length;a++){var s=e.start(a),l=e.end(a),u=r[a];u||(u=this.el_.appendChild(S()),r[a]=u),u.style.left=o(s,i),u.style.width=o(l-s,i)}for(var c=r.length;c>e.length;c--)this.el_.removeChild(r[c-1]);r.length=e.length},e}(Wn);Wn.registerComponent("LoadProgressBar",Or);var Nr=function(t){function e(){return on(this,e),sn(this,t.apply(this,arguments))}return an(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-time-tooltip"})},e.prototype.update=function(t,e,n){var i=H(this.el_),r=H(this.player_.el()),o=t.width*e;if(r&&i){var a=t.left-r.left+o,s=t.width-o+(r.right-t.right),l=i.width/2;a<l?l+=l-a:s<l&&(l=s),l<0?l=0:l>i.width&&(l=i.width),this.el_.style.right="-"+l+"px",C(this.el_,n)}},e}(Wn);Wn.registerComponent("TimeTooltip",Nr);var Ur=function(t){function e(){return on(this,e),sn(this,t.apply(this,arguments))}return an(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-play-progress vjs-slider-bar",innerHTML:'<span class="vjs-control-text"><span>'+this.localize("Progress")+"</span>: 0%</span>"})},e.prototype.update=function(t,e){var n=this;this.rafId_&&this.cancelAnimationFrame(this.rafId_),this.rafId_=this.requestAnimationFrame(function(){var i=n.player_.scrubbing()?n.player_.getCache().currentTime:n.player_.currentTime(),r=kr(i,n.player_.duration()),o=n.getChild("timeTooltip");o&&o.update(t,e,r)})},e}(Wn);Ur.prototype.options_={children:[]},Qe&&!(Qe>8)||Be||Ge||Ur.prototype.options_.children.push("timeTooltip"),Wn.registerComponent("PlayProgressBar",Ur);var Vr=function(t){function e(n,i){on(this,e);var r=sn(this,t.call(this,n,i));return r.update=Dn(Pn(r,r.update),25),r}return an(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})},e.prototype.update=function(t,e){var n=this;this.rafId_&&this.cancelAnimationFrame(this.rafId_),this.rafId_=this.requestAnimationFrame(function(){var i=n.player_.duration(),r=kr(e*i,i);n.el_.style.left=t.width*e+"px",n.getChild("timeTooltip").update(t,e,r)})},e}(Wn);Vr.prototype.options_={children:["timeTooltip"]},Wn.registerComponent("MouseTimeDisplay",Vr);var Br=30,jr=function(t){function e(n,i){on(this,e);var r=sn(this,t.call(this,n,i));return r.update=Dn(Pn(r,r.update),Br),r.on(n,"timeupdate",r.update),r.on(n,"ended",r.handleEnded),r.updateInterval=null,r.on(n,["playing"],function(){r.clearInterval(r.updateInterval),r.updateInterval=r.setInterval(function(){r.requestAnimationFrame(function(){r.update()})},Br)}),r.on(n,["ended","pause","waiting"],function(){r.clearInterval(r.updateInterval)}),r.on(n,["timeupdate","ended"],r.update),r}return an(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})},e.prototype.update_=function(t,e){var n=this.player_.duration();this.el_.setAttribute("aria-valuenow",(100*e).toFixed(2)),this.el_.setAttribute("aria-valuetext",this.localize("progress bar timing: currentTime={1} duration={2}",[kr(t,n),kr(n,n)],"{1} of {2}")),this.bar.update(H(this.el_),e)},e.prototype.update=function(e){var n=t.prototype.update.call(this);return this.update_(this.getCurrentTime_(),n),n},e.prototype.getCurrentTime_=function(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()},e.prototype.handleEnded=function(t){this.update_(this.player_.duration(),1)},e.prototype.getPercent=function(){var t=this.getCurrentTime_()/this.player_.duration();return t>=1?1:t},e.prototype.handleMouseDown=function(e){Q(e)&&(e.stopPropagation(),this.player_.scrubbing(!0),this.videoWasPlaying=!this.player_.paused(),this.player_.pause(),t.prototype.handleMouseDown.call(this,e))},e.prototype.handleMouseMove=function(t){if(Q(t)){var e=this.calculateDistance(t)*this.player_.duration();e===this.player_.duration()&&(e-=.1),this.player_.currentTime(e)}},e.prototype.enable=function(){t.prototype.enable.call(this);var e=this.getChild("mouseTimeDisplay");e&&e.show()},e.prototype.disable=function(){t.prototype.disable.call(this);var e=this.getChild("mouseTimeDisplay");e&&e.hide()},e.prototype.handleMouseUp=function(e){t.prototype.handleMouseUp.call(this,e),e&&e.stopPropagation(),this.player_.scrubbing(!1),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0}),this.videoWasPlaying&&xt(this.player_.play())},e.prototype.stepForward=function(){this.player_.currentTime(this.player_.currentTime()+5)},e.prototype.stepBack=function(){this.player_.currentTime(this.player_.currentTime()-5)},e.prototype.handleAction=function(t){this.player_.paused()?this.player_.play():this.player_.pause()},e.prototype.handleKeyPress=function(e){32===e.which||13===e.which?(e.preventDefault(),this.handleAction(e)):t.prototype.handleKeyPress&&t.prototype.handleKeyPress.call(this,e)},e}(Fr);jr.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"},Qe&&!(Qe>8)||Be||Ge||jr.prototype.options_.children.splice(1,0,"mouseTimeDisplay"),jr.prototype.playerEvent="timeupdate",Wn.registerComponent("SeekBar",jr);var Gr=function(t){function e(n,i){on(this,e);var r=sn(this,t.call(this,n,i));return r.handleMouseMove=Dn(Pn(r,r.handleMouseMove),25),r.throttledHandleMouseSeek=Dn(Pn(r,r.handleMouseSeek),25),r.enable(),r}return an(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"})},e.prototype.handleMouseMove=function(t){var e=this.getChild("seekBar");if(e){var n=e.getChild("mouseTimeDisplay"),i=e.el(),r=H(i),o=W(i,t).x;o>1?o=1:o<0&&(o=0),n&&n.update(r,o)}},e.prototype.handleMouseSeek=function(t){var e=this.getChild("seekBar");e&&e.handleMouseMove(t)},e.prototype.enabled=function(){return this.enabled_},e.prototype.disable=function(){this.children().forEach(function(t){return t.disable&&t.disable()}),this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDown),this.off(this.el_,"mousemove",this.handleMouseMove),this.handleMouseUp(),this.addClass("disabled"),this.enabled_=!1)},e.prototype.enable=function(){this.children().forEach(function(t){return t.enable&&t.enable()}),this.enabled()||(this.on(["mousedown","touchstart"],this.handleMouseDown),this.on(this.el_,"mousemove",this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)},e.prototype.handleMouseDown=function(t){var e=this.el_.ownerDocument,n=this.getChild("seekBar");n&&n.handleMouseDown(t),this.on(e,"mousemove",this.throttledHandleMouseSeek),this.on(e,"touchmove",this.throttledHandleMouseSeek),this.on(e,"mouseup",this.handleMouseUp),this.on(e,"touchend",this.handleMouseUp)},e.prototype.handleMouseUp=function(t){var e=this.el_.ownerDocument,n=this.getChild("seekBar");n&&n.handleMouseUp(t),this.off(e,"mousemove",this.throttledHandleMouseSeek),this.off(e,"touchmove",this.throttledHandleMouseSeek),this.off(e,"mouseup",this.handleMouseUp),this.off(e,"touchend",this.handleMouseUp)},e}(Wn);Gr.prototype.options_={children:["seekBar"]},Wn.registerComponent("ProgressControl",Gr);var Hr=function(t){function e(n,i){on(this,e);var r=sn(this,t.call(this,n,i));return r.on(n,"fullscreenchange",r.handleFullscreenChange),r}return an(e,t),e.prototype.buildCSSClass=function(){return"vjs-fullscreen-control "+t.prototype.buildCSSClass.call(this)},e.prototype.handleFullscreenChange=function(t){this.player_.isFullscreen()?this.controlText("Non-Fullscreen"):this.controlText("Fullscreen")},e.prototype.handleClick=function(t){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()},e}(Tr);Hr.prototype.controlText_="Fullscreen",Wn.registerComponent("FullscreenToggle",Hr);var zr=function(t,e){e.tech_&&!e.tech_.featuresVolumeControl&&t.addClass("vjs-hidden"),t.on(e,"loadstart",function(){e.tech_.featuresVolumeControl?t.removeClass("vjs-hidden"):t.addClass("vjs-hidden")})},Wr=function(t){function e(){return on(this,e),sn(this,t.apply(this,arguments))}return an(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-volume-level",innerHTML:'<span class="vjs-control-text"></span>'})},e}(Wn);Wn.registerComponent("VolumeLevel",Wr);var Xr=function(t){function e(n,i){on(this,e);var r=sn(this,t.call(this,n,i));return r.on("slideractive",r.updateLastVolume_),r.on(n,"volumechange",r.updateARIAAttributes),n.ready(function(){return r.updateARIAAttributes()}),r}return an(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})},e.prototype.handleMouseDown=function(e){Q(e)&&t.prototype.handleMouseDown.call(this,e)},e.prototype.handleMouseMove=function(t){Q(t)&&(this.checkMuted(),this.player_.volume(this.calculateDistance(t)))},e.prototype.checkMuted=function(){this.player_.muted()&&this.player_.muted(!1)},e.prototype.getPercent=function(){return this.player_.muted()?0:this.player_.volume()},e.prototype.stepForward=function(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)},e.prototype.stepBack=function(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)},e.prototype.updateARIAAttributes=function(t){var e=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",e),this.el_.setAttribute("aria-valuetext",e+"%")},e.prototype.volumeAsPercentage_=function(){return Math.round(100*this.player_.volume())},e.prototype.updateLastVolume_=function(){var t=this,e=this.player_.volume();this.one("sliderinactive",function(){0===t.player_.volume()&&t.player_.lastVolume_(e)})},e}(Fr);Xr.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"},Xr.prototype.playerEvent="volumechange",Wn.registerComponent("VolumeBar",Xr);var qr=function(t){function e(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};on(this,e),i.vertical=i.vertical||!1,(void 0===i.volumeBar||a(i.volumeBar))&&(i.volumeBar=i.volumeBar||{},i.volumeBar.vertical=i.vertical);var r=sn(this,t.call(this,n,i));return zr(r,n),r.throttledHandleMouseMove=Dn(Pn(r,r.handleMouseMove),25),r.on("mousedown",r.handleMouseDown),r.on("touchstart",r.handleMouseDown),r.on(r.volumeBar,["focus","slideractive"],function(){r.volumeBar.addClass("vjs-slider-active"),r.addClass("vjs-slider-active"),r.trigger("slideractive")}),r.on(r.volumeBar,["blur","sliderinactive"],function(){r.volumeBar.removeClass("vjs-slider-active"),r.removeClass("vjs-slider-active"),r.trigger("sliderinactive")}),r}return an(e,t),e.prototype.createEl=function(){var e="vjs-volume-horizontal";return this.options_.vertical&&(e="vjs-volume-vertical"),t.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control "+e})},e.prototype.handleMouseDown=function(t){var e=this.el_.ownerDocument;this.on(e,"mousemove",this.throttledHandleMouseMove),this.on(e,"touchmove",this.throttledHandleMouseMove),this.on(e,"mouseup",this.handleMouseUp),this.on(e,"touchend",this.handleMouseUp)},e.prototype.handleMouseUp=function(t){var e=this.el_.ownerDocument;this.off(e,"mousemove",this.throttledHandleMouseMove),this.off(e,"touchmove",this.throttledHandleMouseMove),this.off(e,"mouseup",this.handleMouseUp),this.off(e,"touchend",this.handleMouseUp)},e.prototype.handleMouseMove=function(t){this.volumeBar.handleMouseMove(t)},e}(Wn);qr.prototype.options_={children:["volumeBar"]},Wn.registerComponent("VolumeControl",qr);var Kr=function(t){function e(n,i){on(this,e);var r=sn(this,t.call(this,n,i));return zr(r,n),r.on(n,["loadstart","volumechange"],r.update),r}return an(e,t),e.prototype.buildCSSClass=function(){return"vjs-mute-control "+t.prototype.buildCSSClass.call(this)},e.prototype.handleClick=function(t){var e=this.player_.volume(),n=this.player_.lastVolume_();if(0===e){var i=n<.1?.1:n;this.player_.volume(i),this.player_.muted(!1)}else this.player_.muted(!this.player_.muted())},e.prototype.update=function(t){this.updateIcon_(),this.updateControlText_()},e.prototype.updateIcon_=function(){var t=this.player_.volume(),e=3;0===t||this.player_.muted()?e=0:t<.33?e=1:t<.67&&(e=2);for(var n=0;n<4;n++)I(this.el_,"vjs-vol-"+n);D(this.el_,"vjs-vol-"+e)},e.prototype.updateControlText_=function(){var t=this.player_.muted()||0===this.player_.volume(),e=t?"Unmute":"Mute";this.controlText()!==e&&this.controlText(e)},e}(Tr);Kr.prototype.controlText_="Mute",Wn.registerComponent("MuteToggle",Kr);var Yr=function(t){function e(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};on(this,e),void 0!==i.inline?i.inline=i.inline:i.inline=!0,(void 0===i.volumeControl||a(i.volumeControl))&&(i.volumeControl=i.volumeControl||{},i.volumeControl.vertical=!i.inline);var r=sn(this,t.call(this,n,i));return zr(r,n),r.on(r.volumeControl,["slideractive"],r.sliderActive_),r.on(r.volumeControl,["sliderinactive"],r.sliderInactive_),r}return an(e,t),e.prototype.sliderActive_=function(){this.addClass("vjs-slider-active")},e.prototype.sliderInactive_=function(){this.removeClass("vjs-slider-active")},e.prototype.createEl=function(){var e="vjs-volume-panel-horizontal";return this.options_.inline||(e="vjs-volume-panel-vertical"),t.prototype.createEl.call(this,"div",{className:"vjs-volume-panel vjs-control "+e})},e}(Wn);Yr.prototype.options_={children:["muteToggle","volumeControl"]},Wn.registerComponent("VolumePanel",Yr);var $r=function(t){function e(n,i){on(this,e);var r=sn(this,t.call(this,n,i));return i&&(r.menuButton_=i.menuButton),r.focusedChild_=-1,r.on("keydown",r.handleKeyPress),r}return an(e,t),e.prototype.addItem=function(t){this.addChild(t),t.on("click",Pn(this,function(e){this.menuButton_&&(this.menuButton_.unpressButton(),"CaptionSettingsMenuItem"!==t.name()&&this.menuButton_.focus())}))},e.prototype.createEl=function(){var e=this.options_.contentElType||"ul";this.contentEl_=S(e,{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu");var n=t.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});return n.appendChild(this.contentEl_),ot(n,"click",function(t){t.preventDefault(),t.stopImmediatePropagation()}),n},e.prototype.dispose=function(){this.contentEl_=null,t.prototype.dispose.call(this)},e.prototype.handleKeyPress=function(t){37===t.which||40===t.which?(t.preventDefault(),this.stepForward()):38!==t.which&&39!==t.which||(t.preventDefault(),this.stepBack())},e.prototype.stepForward=function(){var t=0;void 0!==this.focusedChild_&&(t=this.focusedChild_+1),this.focus(t)},e.prototype.stepBack=function(){var t=0;void 0!==this.focusedChild_&&(t=this.focusedChild_-1),this.focus(t)},e.prototype.focus=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.children().slice();e.length&&e[0].className&&/vjs-menu-title/.test(e[0].className)&&e.shift(),e.length>0&&(t<0?t=0:t>=e.length&&(t=e.length-1),this.focusedChild_=t,e[t].el_.focus())},e}(Wn);Wn.registerComponent("Menu",$r);var Qr=function(t){function e(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};on(this,e);var r=sn(this,t.call(this,n,i));r.menuButton_=new Tr(n,i),r.menuButton_.controlText(r.controlText_),r.menuButton_.el_.setAttribute("aria-haspopup","true");var o=Tr.prototype.buildCSSClass();return r.menuButton_.el_.className=r.buildCSSClass()+" "+o,r.menuButton_.removeClass("vjs-control"),r.addChild(r.menuButton_),r.update(),r.enabled_=!0,r.on(r.menuButton_,"tap",r.handleClick),r.on(r.menuButton_,"click",r.handleClick),r.on(r.menuButton_,"focus",r.handleFocus),r.on(r.menuButton_,"blur",r.handleBlur),r.on("keydown",r.handleSubmenuKeyPress),r}return an(e,t),e.prototype.update=function(){var t=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=t,this.addChild(t),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?this.hide():this.show()},e.prototype.createMenu=function(){var t=new $r(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){var e=S("li",{className:"vjs-menu-title",innerHTML:dt(this.options_.title),tabIndex:-1});this.hideThreshold_+=1,t.children_.unshift(e),M(e,t.contentEl())}if(this.items=this.createItems(),this.items)for(var n=0;n<this.items.length;n++)t.addItem(this.items[n]);return t},e.prototype.createItems=function(){},e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:this.buildWrapperCSSClass()},{})},e.prototype.buildWrapperCSSClass=function(){var e="vjs-menu-button";return!0===this.options_.inline?e+="-inline":e+="-popup","vjs-menu-button "+e+" "+Tr.prototype.buildCSSClass()+" "+t.prototype.buildCSSClass.call(this)},e.prototype.buildCSSClass=function(){var e="vjs-menu-button";return!0===this.options_.inline?e+="-inline":e+="-popup","vjs-menu-button "+e+" "+t.prototype.buildCSSClass.call(this)},e.prototype.controlText=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.menuButton_.el();return this.menuButton_.controlText(t,e)},e.prototype.handleClick=function(t){this.one(this.menu.contentEl(),"mouseleave",Pn(this,function(t){this.unpressButton(),this.el_.blur()})),this.buttonPressed_?this.unpressButton():this.pressButton()},e.prototype.focus=function(){this.menuButton_.focus()},e.prototype.blur=function(){this.menuButton_.blur()},e.prototype.handleFocus=function(){ot(De,"keydown",Pn(this,this.handleKeyPress))},e.prototype.handleBlur=function(){at(De,"keydown",Pn(this,this.handleKeyPress))},e.prototype.handleKeyPress=function(t){27===t.which||9===t.which?(this.buttonPressed_&&this.unpressButton(),9!==t.which&&(t.preventDefault(),this.menuButton_.el_.focus())):38!==t.which&&40!==t.which||this.buttonPressed_||(this.pressButton(),t.preventDefault())},e.prototype.handleSubmenuKeyPress=function(t){27!==t.which&&9!==t.which||(this.buttonPressed_&&this.unpressButton(),9!==t.which&&(t.preventDefault(),this.menuButton_.el_.focus()))},e.prototype.pressButton=function(){if(this.enabled_){if(this.buttonPressed_=!0,this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),Be&&w())return;this.menu.focus()}},e.prototype.unpressButton=function(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","false"))},e.prototype.disable=function(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()},e.prototype.enable=function(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()},e}(Wn);Wn.registerComponent("MenuButton",Qr);var Jr=function(t){function e(n,i){on(this,e);var r=i.tracks,o=sn(this,t.call(this,n,i));if(o.items.length<=1&&o.hide(),!r)return sn(o);var a=Pn(o,o.update);return r.addEventListener("removetrack",a),r.addEventListener("addtrack",a),o.player_.on("ready",a),o.player_.on("dispose",function(){r.removeEventListener("removetrack",a),r.removeEventListener("addtrack",a)}),o}return an(e,t),e}(Qr);Wn.registerComponent("TrackButton",Jr);var Zr=function(t){function e(n,i){on(this,e);var r=sn(this,t.call(this,n,i));return r.selectable=i.selectable,r.isSelected_=i.selected||!1,r.selected(r.isSelected_),r.selectable?r.el_.setAttribute("role","menuitemcheckbox"):r.el_.setAttribute("role","menuitem"),r}return an(e,t),e.prototype.createEl=function(e,n,i){return this.nonIconControl=!0,t.prototype.createEl.call(this,"li",r({className:"vjs-menu-item",innerHTML:'<span class="vjs-menu-item-text">'+this.localize(this.options_.label)+"</span>",tabIndex:-1},n),i)},e.prototype.handleClick=function(t){this.selected(!0)},e.prototype.selected=function(t){this.selectable&&(t?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))},e}(gr);Wn.registerComponent("MenuItem",Zr);var to=function(t){function e(n,i){on(this,e);var r=i.track,o=n.textTracks();i.label=r.label||r.language||"Unknown",i.selected="showing"===r.mode;var a=sn(this,t.call(this,n,i));a.track=r;var s=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];a.handleTracksChange.apply(a,e)},l=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];a.handleSelectedLanguageChange.apply(a,e)};if(n.on(["loadstart","texttrackchange"],s),o.addEventListener("change",s),o.addEventListener("selectedlanguagechange",l),a.on("dispose",function(){n.off(["loadstart","texttrackchange"],s),o.removeEventListener("change",s),o.removeEventListener("selectedlanguagechange",l)}),void 0===o.onchange){var u=void 0;a.on(["tap","click"],function(){if("object"!==rn(ke.Event))try{u=new ke.Event("change")}catch(t){}u||(u=De.createEvent("Event"),u.initEvent("change",!0,!0)),o.dispatchEvent(u)})}return a.handleTracksChange(),a}return an(e,t),e.prototype.handleClick=function(e){var n=this.track.kind,i=this.track.kinds,r=this.player_.textTracks();if(i||(i=[n]),t.prototype.handleClick.call(this,e),r)for(var o=0;o<r.length;o++){var a=r[o];a===this.track&&i.indexOf(a.kind)>-1?"showing"!==a.mode&&(a.mode="showing"):"disabled"!==a.mode&&(a.mode="disabled")}},e.prototype.handleTracksChange=function(t){var e="showing"===this.track.mode;e!==this.isSelected_&&this.selected(e)},e.prototype.handleSelectedLanguageChange=function(t){if("showing"===this.track.mode){var e=this.player_.cache_.selectedLanguage;if(e&&e.enabled&&e.language===this.track.language&&e.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}}},e.prototype.dispose=function(){this.track=null,t.prototype.dispose.call(this)},e}(Zr);Wn.registerComponent("TextTrackMenuItem",to);var eo=function(t){function e(n,i){return on(this,e),i.track={player:n,kind:i.kind,kinds:i.kinds,default:!1,mode:"disabled"},i.kinds||(i.kinds=[i.kind]),i.label?i.track.label=i.label:i.track.label=i.kinds.join(" and ")+" off",i.selectable=!0,sn(this,t.call(this,n,i))}return an(e,t),e.prototype.handleTracksChange=function(t){for(var e=this.player().textTracks(),n=!0,i=0,r=e.length;i<r;i++){var o=e[i];if(this.options_.kinds.indexOf(o.kind)>-1&&"showing"===o.mode){n=!1;break}}n!==this.isSelected_&&this.selected(n)},e.prototype.handleSelectedLanguageChange=function(t){for(var e=this.player().textTracks(),n=!0,i=0,r=e.length;i<r;i++){var o=e[i];if(["captions","descriptions","subtitles"].indexOf(o.kind)>-1&&"showing"===o.mode){n=!1;break}}n&&(this.player_.cache_.selectedLanguage={enabled:!1})},e}(to);Wn.registerComponent("OffTextTrackMenuItem",eo);var no=function(t){function e(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return on(this,e),i.tracks=n.textTracks(),sn(this,t.call(this,n,i))}return an(e,t),e.prototype.createItems=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:to,n=void 0;this.label_&&(n=this.label_+" off"),t.push(new eo(this.player_,{kinds:this.kinds_,kind:this.kind_,label:n})),this.hideThreshold_+=1;var i=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(var r=0;r<i.length;r++){var o=i[r];if(this.kinds_.indexOf(o.kind)>-1){var a=new e(this.player_,{track:o,selectable:!0});a.addClass("vjs-"+o.kind+"-menu-item"),t.push(a)}}return t},e}(Jr);Wn.registerComponent("TextTrackButton",no);var io=function(t){function e(n,i){on(this,e);var r=i.track,o=i.cue,a=n.currentTime();i.selectable=!0,i.label=o.text,i.selected=o.startTime<=a&&a<o.endTime;var s=sn(this,t.call(this,n,i));return s.track=r,s.cue=o,r.addEventListener("cuechange",Pn(s,s.update)),s}return an(e,t),e.prototype.handleClick=function(e){t.prototype.handleClick.call(this),this.player_.currentTime(this.cue.startTime),this.update(this.cue.startTime)},e.prototype.update=function(t){var e=this.cue,n=this.player_.currentTime();this.selected(e.startTime<=n&&n<e.endTime)},e}(Zr);Wn.registerComponent("ChaptersTrackMenuItem",io);var ro=function(t){function e(n,i,r){return on(this,e),sn(this,t.call(this,n,i,r))}return an(e,t),e.prototype.buildCSSClass=function(){return"vjs-chapters-button "+t.prototype.buildCSSClass.call(this)},e.prototype.buildWrapperCSSClass=function(){return"vjs-chapters-button "+t.prototype.buildWrapperCSSClass.call(this)},e.prototype.update=function(e){this.track_&&(!e||"addtrack"!==e.type&&"removetrack"!==e.type)||this.setTrack(this.findChaptersTrack()),t.prototype.update.call(this)},e.prototype.setTrack=function(t){if(this.track_!==t){if(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_){var e=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);e&&e.removeEventListener("load",this.updateHandler_),this.track_=null}if(this.track_=t,this.track_){this.track_.mode="hidden";var n=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);n&&n.addEventListener("load",this.updateHandler_)}}},e.prototype.findChaptersTrack=function(){for(var t=this.player_.textTracks()||[],e=t.length-1;e>=0;e--){var n=t[e];if(n.kind===this.kind_)return n}},e.prototype.getMenuCaption=function(){return this.track_&&this.track_.label?this.track_.label:this.localize(dt(this.kind_))},e.prototype.createMenu=function(){return this.options_.title=this.getMenuCaption(),t.prototype.createMenu.call(this)},e.prototype.createItems=function(){var t=[];if(!this.track_)return t;var e=this.track_.cues;if(!e)return t;for(var n=0,i=e.length;n<i;n++){var r=e[n],o=new io(this.player_,{track:this.track_,cue:r});t.push(o)}return t},e}(no);ro.prototype.kind_="chapters",ro.prototype.controlText_="Chapters",Wn.registerComponent("ChaptersButton",ro);var oo=function(t){function e(n,i,r){on(this,e);var o=sn(this,t.call(this,n,i,r)),a=n.textTracks(),s=Pn(o,o.handleTracksChange);return a.addEventListener("change",s),o.on("dispose",function(){a.removeEventListener("change",s)}),o}return an(e,t),e.prototype.handleTracksChange=function(t){for(var e=this.player().textTracks(),n=!1,i=0,r=e.length;i<r;i++){var o=e[i];if(o.kind!==this.kind_&&"showing"===o.mode){n=!0;break}}n?this.disable():this.enable()},e.prototype.buildCSSClass=function(){return"vjs-descriptions-button "+t.prototype.buildCSSClass.call(this)},e.prototype.buildWrapperCSSClass=function(){return"vjs-descriptions-button "+t.prototype.buildWrapperCSSClass.call(this)},e}(no);oo.prototype.kind_="descriptions",oo.prototype.controlText_="Descriptions",Wn.registerComponent("DescriptionsButton",oo);var ao=function(t){function e(n,i,r){return on(this,e),sn(this,t.call(this,n,i,r))}return an(e,t),e.prototype.buildCSSClass=function(){return"vjs-subtitles-button "+t.prototype.buildCSSClass.call(this)},e.prototype.buildWrapperCSSClass=function(){return"vjs-subtitles-button "+t.prototype.buildWrapperCSSClass.call(this)},e}(no);ao.prototype.kind_="subtitles",ao.prototype.controlText_="Subtitles",Wn.registerComponent("SubtitlesButton",ao);var so=function(t){function e(n,i){on(this,e),i.track={player:n,kind:i.kind,label:i.kind+" settings",selectable:!1,default:!1,mode:"disabled"},i.selectable=!1,i.name="CaptionSettingsMenuItem";var r=sn(this,t.call(this,n,i));return r.addClass("vjs-texttrack-settings"),r.controlText(", opens "+i.kind+" settings dialog"),r}return an(e,t),e.prototype.handleClick=function(t){this.player().getChild("textTrackSettings").open()},e}(to);Wn.registerComponent("CaptionSettingsMenuItem",so);var lo=function(t){function e(n,i,r){return on(this,e),sn(this,t.call(this,n,i,r))}return an(e,t),e.prototype.buildCSSClass=function(){return"vjs-captions-button "+t.prototype.buildCSSClass.call(this)},e.prototype.buildWrapperCSSClass=function(){return"vjs-captions-button "+t.prototype.buildWrapperCSSClass.call(this)},e.prototype.createItems=function(){var e=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(e.push(new so(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),t.prototype.createItems.call(this,e)},e}(no);lo.prototype.kind_="captions",lo.prototype.controlText_="Captions",Wn.registerComponent("CaptionsButton",lo);var uo=function(t){function e(){return on(this,e),sn(this,t.apply(this,arguments))}return an(e,t),e.prototype.createEl=function(e,n,i){var o='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);return"captions"===this.options_.track.kind&&(o+='\n        <span aria-hidden="true" class="vjs-icon-placeholder"></span>\n        <span class="vjs-control-text"> '+this.localize("Captions")+"</span>\n      "),o+="</span>",t.prototype.createEl.call(this,e,r({innerHTML:o},n),i)},e}(to);Wn.registerComponent("SubsCapsMenuItem",uo);var co=function(t){function e(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};on(this,e);var r=sn(this,t.call(this,n,i));return r.label_="subtitles",["en","en-us","en-ca","fr-ca"].indexOf(r.player_.language_)>-1&&(r.label_="captions"),r.menuButton_.controlText(dt(r.label_)),r}return an(e,t),e.prototype.buildCSSClass=function(){return"vjs-subs-caps-button "+t.prototype.buildCSSClass.call(this)},e.prototype.buildWrapperCSSClass=function(){return"vjs-subs-caps-button "+t.prototype.buildWrapperCSSClass.call(this)},e.prototype.createItems=function(){var e=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(e.push(new so(this.player_,{kind:this.label_})),this.hideThreshold_+=1),e=t.prototype.createItems.call(this,e,uo)},e}(no);co.prototype.kinds_=["captions","subtitles"],co.prototype.controlText_="Subtitles",Wn.registerComponent("SubsCapsButton",co);var ho=function(t){function e(n,i){on(this,e);var r=i.track,o=n.audioTracks();i.label=r.label||r.language||"Unknown",i.selected=r.enabled;var a=sn(this,t.call(this,n,i));a.track=r;var s=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];a.handleTracksChange.apply(a,e)};return o.addEventListener("change",s),a.on("dispose",function(){o.removeEventListener("change",s)}),a}return an(e,t),e.prototype.handleClick=function(e){var n=this.player_.audioTracks();t.prototype.handleClick.call(this,e);for(var i=0;i<n.length;i++){var r=n[i];r.enabled=r===this.track}},e.prototype.handleTracksChange=function(t){this.selected(this.track.enabled)},e}(Zr);Wn.registerComponent("AudioTrackMenuItem",ho);var po=function(t){function e(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return on(this,e),i.tracks=n.audioTracks(),sn(this,t.call(this,n,i))}return an(e,t),e.prototype.buildCSSClass=function(){return"vjs-audio-button "+t.prototype.buildCSSClass.call(this)},e.prototype.buildWrapperCSSClass=function(){return"vjs-audio-button "+t.prototype.buildWrapperCSSClass.call(this)},e.prototype.createItems=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.hideThreshold_=1;for(var e=this.player_.audioTracks(),n=0;n<e.length;n++){var i=e[n];t.push(new ho(this.player_,{track:i,selectable:!0}))}return t},e}(Jr);po.prototype.controlText_="Audio Track",Wn.registerComponent("AudioTrackButton",po);var fo=function(t){function e(n,i){on(this,e);var r=i.rate,o=parseFloat(r,10);i.label=r,i.selected=1===o,i.selectable=!0;var a=sn(this,t.call(this,n,i));return a.label=r,a.rate=o,a.on(n,"ratechange",a.update),a}return an(e,t),e.prototype.handleClick=function(e){t.prototype.handleClick.call(this),this.player().playbackRate(this.rate)},e.prototype.update=function(t){this.selected(this.player().playbackRate()===this.rate)},e}(Zr);fo.prototype.contentElType="button",Wn.registerComponent("PlaybackRateMenuItem",fo);var mo=function(t){function e(n,i){on(this,e);var r=sn(this,t.call(this,n,i));return r.updateVisibility(),r.updateLabel(),r.on(n,"loadstart",r.updateVisibility),r.on(n,"ratechange",r.updateLabel),r}return an(e,t),e.prototype.createEl=function(){var e=t.prototype.createEl.call(this);return this.labelEl_=S("div",{className:"vjs-playback-rate-value",innerHTML:"1x"}),e.appendChild(this.labelEl_),e},e.prototype.dispose=function(){this.labelEl_=null,t.prototype.dispose.call(this)},e.prototype.buildCSSClass=function(){return"vjs-playback-rate "+t.prototype.buildCSSClass.call(this)},e.prototype.buildWrapperCSSClass=function(){return"vjs-playback-rate "+t.prototype.buildWrapperCSSClass.call(this)},e.prototype.createMenu=function(){var t=new $r(this.player()),e=this.playbackRates();if(e)for(var n=e.length-1;n>=0;n--)t.addChild(new fo(this.player(),{rate:e[n]+"x"}));return t},e.prototype.updateARIAAttributes=function(){this.el().setAttribute("aria-valuenow",this.player().playbackRate())},e.prototype.handleClick=function(t){for(var e=this.player().playbackRate(),n=this.playbackRates(),i=n[0],r=0;r<n.length;r++)if(n[r]>e){i=n[r];break}this.player().playbackRate(i)},e.prototype.playbackRates=function(){return this.options_.playbackRates||this.options_.playerOptions&&this.options_.playerOptions.playbackRates},e.prototype.playbackRateSupported=function(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0},e.prototype.updateVisibility=function(t){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")},e.prototype.updateLabel=function(t){this.playbackRateSupported()&&(this.labelEl_.innerHTML=this.player().playbackRate()+"x")},e}(Qr);mo.prototype.controlText_="Playback Rate",Wn.registerComponent("PlaybackRateMenuButton",mo);var vo=function(t){function e(){return on(this,e),sn(this,t.apply(this,arguments))}return an(e,t),e.prototype.buildCSSClass=function(){return"vjs-spacer "+t.prototype.buildCSSClass.call(this)},e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:this.buildCSSClass()})},e}(Wn);Wn.registerComponent("Spacer",vo);var go=function(t){function e(){return on(this,e),sn(this,t.apply(this,arguments))}return an(e,t),e.prototype.buildCSSClass=function(){return"vjs-custom-control-spacer "+t.prototype.buildCSSClass.call(this)},e.prototype.createEl=function(){var e=t.prototype.createEl.call(this,{className:this.buildCSSClass()});return e.innerHTML="Â ",e},e}(vo);Wn.registerComponent("CustomControlSpacer",go);var yo=function(t){function e(){return on(this,e),sn(this,t.apply(this,arguments))}return an(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-control-bar",dir:"ltr"},{role:"group"})},e}(Wn);yo.prototype.options_={children:["playToggle","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","fullscreenToggle"]},Wn.registerComponent("ControlBar",yo);var bo=function(t){function e(n,i){on(this,e);var r=sn(this,t.call(this,n,i));return r.on(n,"error",r.open),r}return an(e,t),e.prototype.buildCSSClass=function(){return"vjs-error-display "+t.prototype.buildCSSClass.call(this)},e.prototype.content=function(){var t=this.player().error();return t?this.localize(t.message):""},e}(oi);bo.prototype.options_=ft(oi.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0}),Wn.registerComponent("ErrorDisplay",bo);var _o=["#000","Black"],wo=["#00F","Blue"],To=["#0FF","Cyan"],xo=["#0F0","Green"],Eo=["#F0F","Magenta"],So=["#F00","Red"],Ao=["#FFF","White"],Co=["#FF0","Yellow"],ko=["1","Opaque"],Mo=["0.5","Semi-Transparent"],Lo=["0","Transparent"],Ro={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[_o,Ao,So,xo,wo,Co,Eo,To]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Transparency",options:[ko,Mo,Lo]},color:{selector:".vjs-fg-color > select",id:"captions-foreground-color-%s",label:"Color",options:[Ao,_o,So,xo,wo,Co,Eo,To]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:function(t){return"1.00"===t?null:Number(t)}},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[ko,Mo]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Transparency",options:[Lo,Mo,ko]}};Ro.windowColor.options=Ro.backgroundColor.options;var Po=function(t){function i(n,r){on(this,i),r.temporary=!1;var o=sn(this,t.call(this,n,r));return o.updateDisplay=Pn(o,o.updateDisplay),o.fill(),o.hasBeenOpened_=o.hasBeenFilled_=!0,o.endDialog=S("p",{className:"vjs-control-text",textContent:o.localize("End of dialog window.")}),o.el().appendChild(o.endDialog),o.setDefaults(),void 0===r.persistTextTrackSettings&&(o.options_.persistTextTrackSettings=o.options_.playerOptions.persistTextTrackSettings),o.on(o.$(".vjs-done-button"),"click",function(){o.saveSettings(),o.close()}),o.on(o.$(".vjs-default-button"),"click",function(){o.setDefaults(),o.updateDisplay()}),e(Ro,function(t){o.on(o.$(t.selector),"change",o.updateDisplay)}),o.options_.persistTextTrackSettings&&o.restoreSettings(),o}return an(i,t),i.prototype.dispose=function(){this.endDialog=null,t.prototype.dispose.call(this)},i.prototype.createElSelect_=function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"label",r=Ro[t],o=r.id.replace("%s",this.id_);return["<"+i+' id="'+o+'" class="'+("label"===i?"vjs-label":"")+'">',this.localize(r.label),"</"+i+">",'<select aria-labelledby="'+(""!==n?n+" ":"")+o+'">'].concat(r.options.map(function(t){var i=o+"-"+t[1];return['<option id="'+i+'" value="'+t[0]+'" ','aria-labelledby="'+(""!==n?n+" ":"")+o+" "+i+'">',e.localize(t[1]),"</option>"].join("")})).concat("</select>").join("")},i.prototype.createElFgColor_=function(){var t="captions-text-legend-"+this.id_;return['<fieldset class="vjs-fg-color vjs-track-setting">','<legend id="'+t+'">',this.localize("Text"),"</legend>",this.createElSelect_("color",t),'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",t),"</span>","</fieldset>"].join("")},i.prototype.createElBgColor_=function(){var t="captions-background-"+this.id_;return['<fieldset class="vjs-bg-color vjs-track-setting">','<legend id="'+t+'">',this.localize("Background"),"</legend>",this.createElSelect_("backgroundColor",t),'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",t),"</span>","</fieldset>"].join("")},i.prototype.createElWinColor_=function(){var t="captions-window-"+this.id_;return['<fieldset class="vjs-window-color vjs-track-setting">','<legend id="'+t+'">',this.localize("Window"),"</legend>",this.createElSelect_("windowColor",t),'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",t),"</span>","</fieldset>"].join("")},i.prototype.createElColors_=function(){return S("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})},i.prototype.createElFont_=function(){return S("div",{className:"vjs-track-settings-font",innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"</fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})},i.prototype.createElControls_=function(){var t=this.localize("restore all settings to the default values");return S("div",{className:"vjs-track-settings-controls",innerHTML:['<button class="vjs-default-button" title="'+t+'">',this.localize("Reset"),'<span class="vjs-control-text"> '+t+"</span>","</button>",'<button class="vjs-done-button">'+this.localize("Done")+"</button>"].join("")})},i.prototype.content=function(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]},i.prototype.label=function(){return this.localize("Caption Settings Dialog")},i.prototype.description=function(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")},i.prototype.buildCSSClass=function(){return t.prototype.buildCSSClass.call(this)+" vjs-text-track-settings"},i.prototype.getValues=function(){var t=this;return n(Ro,function(e,n,i){var r=we(t.$(n.selector),n.parser);return void 0!==r&&(e[i]=r),e},{})},i.prototype.setValues=function(t){var n=this;e(Ro,function(e,i){Te(n.$(e.selector),t[i],e.parser)})},i.prototype.setDefaults=function(){var t=this;e(Ro,function(e){var n=e.hasOwnProperty("default")?e.default:0;t.$(e.selector).selectedIndex=n})},i.prototype.restoreSettings=function(){var t=void 0;try{t=JSON.parse(ke.localStorage.getItem("vjs-text-track-settings"))}catch(t){mn.warn(t)}t&&this.setValues(t)},i.prototype.saveSettings=function(){if(this.options_.persistTextTrackSettings){var t=this.getValues();try{(0,_.default)(t).length?ke.localStorage.setItem("vjs-text-track-settings",(0,v.default)(t)):ke.localStorage.removeItem("vjs-text-track-settings")}catch(t){mn.warn(t)}}},i.prototype.updateDisplay=function(){var t=this.player_.getChild("textTrackDisplay");t&&t.updateDisplay()},i.prototype.conditionalBlur_=function(){this.previouslyActiveEl_=null,this.off(De,"keydown",this.handleKeyDown);var t=this.player_.controlBar,e=t&&t.subsCapsButton,n=t&&t.captionsButton;e?e.focus():n&&n.focus()},i}(oi);Wn.registerComponent("TextTrackSettings",Po);var Do=function(t){function e(n,i){on(this,e);var r=i.ResizeObserver||ke.ResizeObserver;null===i.ResizeObserver&&(r=!1);var o=ft({createEl:!r},i),a=sn(this,t.call(this,n,o));return a.ResizeObserver=i.ResizeObserver||ke.ResizeObserver,a.loadListener_=null,a.resizeObserver_=null,a.debouncedHandler_=In(function(){a.resizeHandler()},100,!1,n),r?(a.resizeObserver_=new a.ResizeObserver(a.debouncedHandler_),a.resizeObserver_.observe(n.el())):(a.loadListener_=function(){a.el_.contentWindow&&ot(a.el_.contentWindow,"resize",a.debouncedHandler_),a.off("load",a.loadListener_)},a.on("load",a.loadListener_)),a}return an(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"iframe",{className:"vjs-resize-manager"})},e.prototype.resizeHandler=function(){this.player_.trigger("playerresize")},e.prototype.dispose=function(){this.resizeObserver_&&(this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.el_&&this.el_.contentWindow&&at(this.el_.contentWindow,"resize",this.debouncedHandler_),this.loadListener_&&this.off("load",this.loadListener_),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null},e}(Wn);Wn.registerComponent("ResizeManager",Do);var Io=ln(["Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\n            This may prevent text tracks from loading."],["Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\n            This may prevent text tracks from loading."]),Fo=function(t){function e(n,i){on(this,e);var r=sn(this,t.call(this,n,i));n.enableSourceset&&r.setupSourcesetHandling_();var o=n.source,a=!1;if(o&&(r.el_.currentSrc!==o.src||n.tag&&3===n.tag.initNetworkState_)?r.setSource(o):r.handleLateInit_(r.el_),r.el_.hasChildNodes()){for(var s=r.el_.childNodes,l=s.length,u=[];l--;){var c=s[l];"track"===c.nodeName.toLowerCase()&&(r.featuresNativeTextTracks?(r.remoteTextTrackEls().addTrackElement_(c),r.remoteTextTracks().addTrack(c.track),r.textTracks().addTrack(c.track),a||r.el_.hasAttribute("crossorigin")||!xi(c.src)||(a=!0)):u.push(c))}for(var h=0;h<u.length;h++)r.el_.removeChild(u[h])}return r.proxyNativeTracks_(),r.featuresNativeTextTracks&&a&&mn.warn(vn(Io)),r.restoreMetadataTracksInIOSNativePlayer_(),(tn||Ue||We)&&!0===n.nativeControlsForTouch&&r.setControls(!0),r.proxyWebkitFullscreen_(),r.triggerReady(),r}return an(e,t),e.prototype.dispose=function(){e.disposeMediaElement(this.el_),this.options_=null,t.prototype.dispose.call(this)},e.prototype.setupSourcesetHandling_=function(){var t=this;if(this.featuresSourceset){var e=this.el();(e.src||e.currentSrc&&3!==this.el().initNetworkState_)&&this.triggerSourceset(e.src||e.currentSrc);var n=ke.HTMLMediaElement.prototype,i={};(0,l.default)(e,"src")?i=(0,l.default)(e,"src"):(0,l.default)(n,"src")&&(i=ft(i,(0,l.default)(n,"src"))),i.get||(i.get=function(){return n.getAttribute.call(this,"src")}),i.set||(i.set=function(t){return n.setAttribute.call(this,"src",t)}),void 0===i.enumerable&&(i.enumerable=!0),Object.defineProperty(e,"src",{get:i.get.bind(e),set:function(n){var r=i.set.call(e,n);return t.triggerSourceset(n),r},configurable:!0,enumerable:i.enumerable});var r=e.setAttribute;e.setAttribute=function(n,i){var o=r.call(e,n,i);return"src"===n&&t.triggerSourceset(i),o};var o=e.load;e.load=function(){var n=o.call(e);return t.triggerSourceset(e.src||""),n}}},e.prototype.restoreMetadataTracksInIOSNativePlayer_=function(){var t=this.textTracks(),e=void 0,n=function(){e=[];for(var n=0;n<t.length;n++){var i=t[n];"metadata"===i.kind&&e.push({track:i,storedMode:i.mode})}};n(),t.addEventListener("change",n),this.on("dispose",function(){return t.removeEventListener("change",n)});var i=function n(){for(var i=0;i<e.length;i++){var r=e[i];"disabled"===r.track.mode&&r.track.mode!==r.storedMode&&(r.track.mode=r.storedMode)}t.removeEventListener("change",n)};this.on("webkitbeginfullscreen",function(){t.removeEventListener("change",n),t.removeEventListener("change",i),t.addEventListener("change",i)}),this.on("webkitendfullscreen",function(){t.removeEventListener("change",n),t.addEventListener("change",n),t.removeEventListener("change",i)})},e.prototype.proxyNativeTracks_=function(){var t=this;zi.names.forEach(function(e){var n=zi[e],i=t.el()[n.getterName],r=t[n.getterName]();if(t["featuresNative"+n.capitalName+"Tracks"]&&i&&i.addEventListener){var o={change:function(t){r.trigger({type:"change",target:r,currentTarget:r,srcElement:r})},addtrack:function(t){r.addTrack(t.track)},removetrack:function(t){r.removeTrack(t.track)}},a=function(){for(var t=[],e=0;e<r.length;e++){for(var n=!1,o=0;o<i.length;o++)if(i[o]===r[e]){n=!0;break}n||t.push(r[e])}for(;t.length;)r.removeTrack(t.shift())};(0,_.default)(o).forEach(function(e){var n=o[e];i.addEventListener(e,n),t.on("dispose",function(t){return i.removeEventListener(e,n)})}),t.on("loadstart",a),t.on("dispose",function(e){return t.off("loadstart",a)})}})},e.prototype.createEl=function(){var t=this.options_.tag;if(!t||!this.options_.playerElIngest&&!this.movingMediaElementInDOM){if(t){var n=t.cloneNode(!0);t.parentNode&&t.parentNode.insertBefore(n,t),e.disposeMediaElement(t),t=n}else{t=De.createElement("video");var i=this.options_.tag&&N(this.options_.tag),o=ft({},i);tn&&!0===this.options_.nativeControlsForTouch||delete o.controls,O(t,r(o,{id:this.options_.techId,class:"vjs-tech"}))}t.playerId=this.options_.playerId}void 0!==this.options_.preload&&V(t,"preload",this.options_.preload);for(var a=["loop","muted","playsinline","autoplay"],s=0;s<a.length;s++){var l=a[s],u=this.options_[l];void 0!==u&&(u?V(t,l,l):B(t,l),t[l]=u)}return t},e.prototype.handleLateInit_=function(t){if(0!==t.networkState&&3!==t.networkState){if(0===t.readyState){var e=!1,n=function(){e=!0};this.on("loadstart",n);var i=function(){e||this.trigger("loadstart")};return this.on("loadedmetadata",i),void this.ready(function(){this.off("loadstart",n),this.off("loadedmetadata",i),e||this.trigger("loadstart")})}var r=["loadstart"];r.push("loadedmetadata"),t.readyState>=2&&r.push("loadeddata"),t.readyState>=3&&r.push("canplay"),t.readyState>=4&&r.push("canplaythrough"),this.ready(function(){r.forEach(function(t){this.trigger(t)},this)})}},e.prototype.setCurrentTime=function(t){try{this.el_.currentTime=t}catch(t){mn(t,"Video is not ready. (Video.js)")}},e.prototype.duration=function(){var t=this;if(this.el_.duration===1/0&&Ge&&Ke&&0===this.el_.currentTime){var e=function e(){t.el_.currentTime>0&&(t.el_.duration===1/0&&t.trigger("durationchange"),t.off("timeupdate",e))};return this.on("timeupdate",e),NaN}return this.el_.duration||NaN},e.prototype.width=function(){return this.el_.offsetWidth},e.prototype.height=function(){return this.el_.offsetHeight},e.prototype.proxyWebkitFullscreen_=function(){var t=this;if("webkitDisplayingFullscreen"in this.el_){var e=function(){this.trigger("fullscreenchange",{isFullscreen:!1})},n=function(){"webkitPresentationMode"in this.el_&&"picture-in-picture"!==this.el_.webkitPresentationMode&&(this.one("webkitendfullscreen",e),this.trigger("fullscreenchange",{isFullscreen:!0}))};this.on("webkitbeginfullscreen",n),this.on("dispose",function(){t.off("webkitbeginfullscreen",n),t.off("webkitendfullscreen",e)})}},e.prototype.supportsFullScreen=function(){if("function"==typeof this.el_.webkitEnterFullScreen){var t=ke.navigator&&ke.navigator.userAgent||"";if(/Android/.test(t)||!/Chrome|Mac OS X 10.5/.test(t))return!0}return!1},e.prototype.enterFullScreen=function(){var t=this.el_;t.paused&&t.networkState<=t.HAVE_METADATA?(this.el_.play(),this.setTimeout(function(){t.pause(),t.webkitEnterFullScreen()},0)):t.webkitEnterFullScreen()},e.prototype.exitFullScreen=function(){this.el_.webkitExitFullScreen()},e.prototype.src=function(t){if(void 0===t)return this.el_.src;this.setSrc(t)},e.prototype.reset=function(){e.resetMediaElement(this.el_)},e.prototype.currentSrc=function(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc},e.prototype.setControls=function(t){this.el_.controls=!!t},e.prototype.addTextTrack=function(e,n,i){return this.featuresNativeTextTracks?this.el_.addTextTrack(e,n,i):t.prototype.addTextTrack.call(this,e,n,i)},e.prototype.createRemoteTextTrack=function(e){if(!this.featuresNativeTextTracks)return t.prototype.createRemoteTextTrack.call(this,e);var n=De.createElement("track");return e.kind&&(n.kind=e.kind),e.label&&(n.label=e.label),(e.language||e.srclang)&&(n.srclang=e.language||e.srclang),e.default&&(n.default=e.default),e.id&&(n.id=e.id),e.src&&(n.src=e.src),n},e.prototype.addRemoteTextTrack=function(e,n){var i=t.prototype.addRemoteTextTrack.call(this,e,n);return this.featuresNativeTextTracks&&this.el().appendChild(i),i},e.prototype.removeRemoteTextTrack=function(e){if(t.prototype.removeRemoteTextTrack.call(this,e),this.featuresNativeTextTracks)for(var n=this.$$("track"),i=n.length;i--;)e!==n[i]&&e!==n[i].track||this.el().removeChild(n[i])},e.prototype.getVideoPlaybackQuality=function(){if("function"==typeof this.el().getVideoPlaybackQuality)return this.el().getVideoPlaybackQuality();var t={};return void 0!==this.el().webkitDroppedFrameCount&&void 0!==this.el().webkitDecodedFrameCount&&(t.droppedVideoFrames=this.el().webkitDroppedFrameCount,t.totalVideoFrames=this.el().webkitDecodedFrameCount),ke.performance&&"function"==typeof ke.performance.now?t.creationTime=ke.performance.now():ke.performance&&ke.performance.timing&&"number"==typeof ke.performance.timing.navigationStart&&(t.creationTime=ke.Date.now()-ke.performance.timing.navigationStart),t},e}(sr);if(g()){Fo.TEST_VID=De.createElement("video");var Oo=De.createElement("track");Oo.kind="captions",Oo.srclang="en",Oo.label="English",Fo.TEST_VID.appendChild(Oo)}Fo.isSupported=function(){try{Fo.TEST_VID.volume=.5}catch(t){return!1}return!(!Fo.TEST_VID||!Fo.TEST_VID.canPlayType)},Fo.canPlayType=function(t){return Fo.TEST_VID.canPlayType(t)},Fo.canPlaySource=function(t,e){return Fo.canPlayType(t.type)},Fo.canControlVolume=function(){try{var t=Fo.TEST_VID.volume;return Fo.TEST_VID.volume=t/2+.1,t!==Fo.TEST_VID.volume}catch(t){return!1}},Fo.canControlPlaybackRate=function(){if(Ge&&Ke&&Ye<58)return!1;try{var t=Fo.TEST_VID.playbackRate;return Fo.TEST_VID.playbackRate=t/2+.1,t!==Fo.TEST_VID.playbackRate}catch(t){return!1}},Fo.canOverrideAttributes=function(){if($e)return!1;try{var t=function(){};Object.defineProperty(De.createElement("video"),"src",{get:t,set:t}),Object.defineProperty(De.createElement("audio"),"src",{get:t,set:t})}catch(t){return!1}return!0},Fo.supportsNativeTextTracks=function(){return Ze},Fo.supportsNativeVideoTracks=function(){return!(!Fo.TEST_VID||!Fo.TEST_VID.videoTracks)},Fo.supportsNativeAudioTracks=function(){return!(!Fo.TEST_VID||!Fo.TEST_VID.audioTracks)},Fo.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"],Fo.prototype.featuresVolumeControl=Fo.canControlVolume(),Fo.prototype.featuresPlaybackRate=Fo.canControlPlaybackRate(),Fo.prototype.featuresSourceset=Fo.canOverrideAttributes(),Fo.prototype.movingMediaElementInDOM=!Be,Fo.prototype.featuresFullscreenResize=!0,Fo.prototype.featuresProgressEvents=!0,Fo.prototype.featuresTimeupdateEvents=!0,Fo.prototype.featuresNativeTextTracks=Fo.supportsNativeTextTracks(),Fo.prototype.featuresNativeVideoTracks=Fo.supportsNativeVideoTracks(),Fo.prototype.featuresNativeAudioTracks=Fo.supportsNativeAudioTracks();var No=Fo.TEST_VID&&Fo.TEST_VID.constructor.prototype.canPlayType,Uo=/^application\/(?:x-|vnd\.apple\.)mpegurl/i,Vo=/^video\/mp4/i;Fo.patchCanPlayType=function(){He>=4&&!Xe&&!Ke?Fo.TEST_VID.constructor.prototype.canPlayType=function(t){return t&&Uo.test(t)?"maybe":No.call(this,t)}:ze&&(Fo.TEST_VID.constructor.prototype.canPlayType=function(t){return t&&Vo.test(t)?"maybe":No.call(this,t)})},Fo.unpatchCanPlayType=function(){var t=Fo.TEST_VID.constructor.prototype.canPlayType;return Fo.TEST_VID.constructor.prototype.canPlayType=No,t},Fo.patchCanPlayType(),Fo.disposeMediaElement=function(t){if(t){for(t.parentNode&&t.parentNode.removeChild(t);t.hasChildNodes();)t.removeChild(t.firstChild);t.removeAttribute("src"),"function"==typeof t.load&&function(){try{t.load()}catch(t){}}()}},Fo.resetMediaElement=function(t){if(t){for(var e=t.querySelectorAll("source"),n=e.length;n--;)t.removeChild(e[n]);t.removeAttribute("src"),"function"==typeof t.load&&function(){try{t.load()}catch(t){}}()}},["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach(function(t){Fo.prototype[t]=function(){return this.el_[t]||this.el_.hasAttribute(t)}}),["muted","defaultMuted","autoplay","loop","playsinline"].forEach(function(t){Fo.prototype["set"+dt(t)]=function(e){this.el_[t]=e,e?this.el_.setAttribute(t,t):this.el_.removeAttribute(t)}}),["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","played","networkState","readyState","videoWidth","videoHeight"].forEach(function(t){Fo.prototype[t]=function(){return this.el_[t]}}),["volume","src","poster","preload","playbackRate","defaultPlaybackRate"].forEach(function(t){Fo.prototype["set"+dt(t)]=function(e){this.el_[t]=e}}),["pause","load","play"].forEach(function(t){Fo.prototype[t]=function(){return this.el_[t]()}}),sr.withSourceHandlers(Fo),Fo.nativeSourceHandler={},Fo.nativeSourceHandler.canPlayType=function(t){try{return Fo.TEST_VID.canPlayType(t)}catch(t){return""}},Fo.nativeSourceHandler.canHandleSource=function(t,e){if(t.type)return Fo.nativeSourceHandler.canPlayType(t.type);if(t.src){var n=Ti(t.src);return Fo.nativeSourceHandler.canPlayType("video/"+n)}return""},Fo.nativeSourceHandler.handleSource=function(t,e,n){e.setSrc(t.src)},Fo.nativeSourceHandler.dispose=function(){},Fo.registerSourceHandler(Fo.nativeSourceHandler),sr.registerTech("Html5",Fo);var Bo=ln(["\n        Using the tech directly can be dangerous. I hope you know what you're doing.\n        See https://github.com/videojs/video.js/issues/2617 for more info.\n      "],["\n        Using the tech directly can be dangerous. I hope you know what you're doing.\n        See https://github.com/videojs/video.js/issues/2617 for more info.\n      "]),jo=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","ratechange","resize","volumechange","texttrackchange"],Go=function(t){function e(n,i,o){if(on(this,e),n.id=n.id||"vjs_video_"+J(),i=r(e.getTagSettings(n),i),i.initChildren=!1,i.createEl=!1,i.evented=!1,i.reportTouchActivity=!1,!i.language)if("function"==typeof n.closest){var a=n.closest("[lang]");a&&a.getAttribute&&(i.language=a.getAttribute("lang"))}else for(var s=n;s&&1===s.nodeType;){if(N(s).hasOwnProperty("lang")){i.language=s.getAttribute("lang");break}s=s.parentNode}var l=sn(this,t.call(this,null,i,o));if(l.isPosterFromTech_=!1,l.isReady_=!1,l.hasStarted_=!1,l.userActive_=!1,!l.options_||!l.options_.techOrder||!l.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(l.tag=n,l.tagAttributes=n&&N(n),l.language(l.options_.language),i.languages){var u={};(0,f.default)(i.languages).forEach(function(t){u[t.toLowerCase()]=i.languages[t]}),l.languages_=u}else l.languages_=e.prototype.options_.languages;l.cache_={},l.poster_=i.poster||"",l.controls_=!!i.controls,l.cache_.lastVolume=1,n.controls=!1,n.removeAttribute("controls"),l.scrubbing_=!1,l.el_=l.createEl(),ct(l,{eventBusKey:"el_"});var c=ft(l.options_);if(i.plugins){var h=i.plugins;(0,_.default)(h).forEach(function(t){if("function"!=typeof this[t])throw new Error('plugin "'+t+'" does not exist');this[t](h[t])},l)}l.options_.playerOptions=c,l.middleware_=[],l.initChildren(),l.isAudio("audio"===n.nodeName.toLowerCase()),l.controls()?l.addClass("vjs-controls-enabled"):l.addClass("vjs-controls-disabled"),l.el_.setAttribute("role","region"),l.isAudio()?l.el_.setAttribute("aria-label",l.localize("Audio Player")):l.el_.setAttribute("aria-label",l.localize("Video Player")),l.isAudio()&&l.addClass("vjs-audio"),l.flexNotSupported_()&&l.addClass("vjs-no-flex"),Be||l.addClass("vjs-workinghover"),e.players[l.id_]=l;var d=Se.split(".")[0];return l.addClass("vjs-v"+d),l.userActive(!0),l.reportUserActivity(),l.listenForUserActivity_(),l.on("fullscreenchange",l.handleFullscreenChange_),l.on("stageclick",l.handleStageClick_),l.changingSrc_=!1,l.playWaitingForReady_=!1,l.playOnLoadstart_=null,l}return an(e,t),e.prototype.dispose=function(){this.trigger("dispose"),this.off("dispose"),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),e.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),de(this),t.prototype.dispose.call(this)},e.prototype.createEl=function(){var e=this.tag,n=void 0,i=this.playerElIngest_=e.parentNode&&e.parentNode.hasAttribute&&e.parentNode.hasAttribute("data-vjs-player"),r="video-js"===this.tag.tagName.toLowerCase();i?n=this.el_=e.parentNode:r||(n=this.el_=t.prototype.createEl.call(this,"div"));var o=N(e);if(r){for(n=this.el_=e,e=this.tag=De.createElement("video");n.children.length;)e.appendChild(n.firstChild);R(n,"video-js")||D(n,"video-js"),n.appendChild(e),i=this.playerElIngest_=n}if(e.setAttribute("tabindex","-1"),e.removeAttribute("width"),e.removeAttribute("height"),(0,f.default)(o).forEach(function(t){"class"===t?(n.className+=" "+o[t],r&&(e.className+=" "+o[t])):(n.setAttribute(t,o[t]),r&&e.setAttribute(t,o[t]))}),e.playerId=e.id,e.id+="_html5_api",e.className="vjs-tech",e.player=n.player=this,this.addClass("vjs-paused"),!0!==ke.VIDEOJS_NO_DYNAMIC_STYLE){this.styleEl_=Ln("vjs-styles-dimensions");var a=yn(".vjs-styles-defaults"),s=yn("head");s.insertBefore(this.styleEl_,a?a.nextSibling:s.firstChild)}this.width(this.options_.width),this.height(this.options_.height),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio);for(var l=e.getElementsByTagName("a"),u=0;u<l.length;u++){var c=l.item(u);D(c,"vjs-hidden"),c.setAttribute("hidden","hidden")}return e.initNetworkState_=e.networkState,e.parentNode&&!i&&e.parentNode.insertBefore(n,e),M(e,n),this.children_.unshift(e),this.el_.setAttribute("lang",this.language_),this.el_=n,n},e.prototype.width=function(t){return this.dimension("width",t)},e.prototype.height=function(t){return this.dimension("height",t)},e.prototype.dimension=function(t,e){var n=t+"_";if(void 0===e)return this[n]||0;if(""===e)return this[n]=void 0,void this.updateStyleEl_();var i=parseFloat(e);if(isNaN(i))return void mn.error('Improper value "'+e+'" supplied for for '+t);this[n]=i,this.updateStyleEl_()},e.prototype.fluid=function(t){if(void 0===t)return!!this.fluid_;this.fluid_=!!t,t?this.addClass("vjs-fluid"):this.removeClass("vjs-fluid"),this.updateStyleEl_()},e.prototype.aspectRatio=function(t){if(void 0===t)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(t))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=t,this.fluid(!0),this.updateStyleEl_()},e.prototype.updateStyleEl_=function(){if(!0===ke.VIDEOJS_NO_DYNAMIC_STYLE){var t="number"==typeof this.width_?this.width_:this.options_.width,e="number"==typeof this.height_?this.height_:this.options_.height,n=this.tech_&&this.tech_.el();return void(n&&(t>=0&&(n.width=t),e>=0&&(n.height=e)))}var i=void 0,r=void 0,o=void 0,a=void 0;o=void 0!==this.aspectRatio_&&"auto"!==this.aspectRatio_?this.aspectRatio_:this.videoWidth()>0?this.videoWidth()+":"+this.videoHeight():"16:9";var s=o.split(":"),l=s[1]/s[0];i=void 0!==this.width_?this.width_:void 0!==this.height_?this.height_/l:this.videoWidth()||300,r=void 0!==this.height_?this.height_:i*l,a=/^[^a-zA-Z]/.test(this.id())?"dimensions-"+this.id():this.id()+"-dimensions",this.addClass(a),Rn(this.styleEl_,"\n      ."+a+" {\n        width: "+i+"px;\n        height: "+r+"px;\n      }\n\n      ."+a+".vjs-fluid {\n        padding-top: "+100*l+"%;\n      }\n    ")},e.prototype.loadTech_=function(t,e){var n=this;this.tech_&&this.unloadTech_();var i=dt(t),o=t.charAt(0).toLowerCase()+t.slice(1);"Html5"!==i&&this.tag&&(sr.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=i,this.isReady_=!1;var a={source:e,nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:this.id()+"_"+i+"_api",autoplay:this.options_.autoplay,playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset};Xi.names.forEach(function(t){var e=Xi[t];a[e.getterName]=n[e.privateName]}),r(a,this.options_[i]),r(a,this.options_[o]),r(a,this.options_[t.toLowerCase()]),this.tag&&(a.tag=this.tag),e&&e.src===this.cache_.src&&this.cache_.currentTime>0&&(a.startTime=this.cache_.currentTime);var s=sr.getTech(t);if(!s)throw new Error("No Tech named '"+i+"' exists! '"+i+"' should be registered using videojs.registerTech()'");this.tech_=new s(a),this.tech_.ready(Pn(this,this.handleTechReady_),!0),ii.jsonToTextTracks(this.textTracksJson_||[],this.tech_),jo.forEach(function(t){n.on(n.tech_,t,n["handleTech"+dt(t)+"_"])}),this.on(this.tech_,"loadstart",this.handleTechLoadStart_),this.on(this.tech_,"sourceset",this.handleTechSourceset_),this.on(this.tech_,"waiting",this.handleTechWaiting_),this.on(this.tech_,"canplay",this.handleTechCanPlay_),this.on(this.tech_,"canplaythrough",this.handleTechCanPlayThrough_),this.on(this.tech_,"playing",this.handleTechPlaying_),this.on(this.tech_,"ended",this.handleTechEnded_),this.on(this.tech_,"seeking",this.handleTechSeeking_),this.on(this.tech_,"seeked",this.handleTechSeeked_),this.on(this.tech_,"play",this.handleTechPlay_),this.on(this.tech_,"firstplay",this.handleTechFirstPlay_),this.on(this.tech_,"pause",this.handleTechPause_),this.on(this.tech_,"durationchange",this.handleTechDurationChange_),this.on(this.tech_,"fullscreenchange",this.handleTechFullscreenChange_),this.on(this.tech_,"error",this.handleTechError_),this.on(this.tech_,"loadedmetadata",this.updateStyleEl_),this.on(this.tech_,"posterchange",this.handleTechPosterChange_),this.on(this.tech_,"textdata",this.handleTechTextData_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode===this.el()||"Html5"===i&&this.tag||M(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)},e.prototype.unloadTech_=function(){var t=this;Xi.names.forEach(function(e){var n=Xi[e];t[n.privateName]=t[n.getterName]()}),this.textTracksJson_=ii.textTracksToJson(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1},e.prototype.tech=function(t){return void 0===t&&mn.warn(vn(Bo)),this.tech_},e.prototype.addTechControlsListeners_=function(){this.removeTechControlsListeners_(),this.on(this.tech_,"mousedown",this.handleTechClick_),this.on(this.tech_,"touchstart",this.handleTechTouchStart_),this.on(this.tech_,"touchmove",this.handleTechTouchMove_),this.on(this.tech_,"touchend",this.handleTechTouchEnd_),this.on(this.tech_,"tap",this.handleTechTap_)},e.prototype.removeTechControlsListeners_=function(){this.off(this.tech_,"tap",this.handleTechTap_),this.off(this.tech_,"touchstart",this.handleTechTouchStart_),this.off(this.tech_,"touchmove",this.handleTechTouchMove_),this.off(this.tech_,"touchend",this.handleTechTouchEnd_),this.off(this.tech_,"mousedown",this.handleTechClick_)},e.prototype.handleTechReady_=function(){if(this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_(),(this.src()||this.currentSrc())&&this.tag&&this.options_.autoplay&&this.paused())try{delete this.tag.poster}catch(t){mn("deleting tag.poster throws in some browsers",t)}},e.prototype.handleTechLoadStart_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-seeking"),this.error(null),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):(this.trigger("loadstart"),this.trigger("firstplay"))},e.prototype.handleTechSourceset_=function(t){this.trigger({src:t.src,type:"sourceset"})},e.prototype.hasStarted=function(t){if(void 0===t)return this.hasStarted_;t!==this.hasStarted_&&(this.hasStarted_=t,this.hasStarted_?(this.addClass("vjs-has-started"),this.trigger("firstplay")):this.removeClass("vjs-has-started"))},e.prototype.handleTechPlay_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")},e.prototype.handleTechWaiting_=function(){var t=this;this.addClass("vjs-waiting"),this.trigger("waiting"),this.one("timeupdate",function(){return t.removeClass("vjs-waiting")})},e.prototype.handleTechCanPlay_=function(){this.removeClass("vjs-waiting"),this.trigger("canplay")},e.prototype.handleTechCanPlayThrough_=function(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")},e.prototype.handleTechPlaying_=function(){this.removeClass("vjs-waiting"),this.trigger("playing")},e.prototype.handleTechSeeking_=function(){this.addClass("vjs-seeking"),this.trigger("seeking")},e.prototype.handleTechSeeked_=function(){this.removeClass("vjs-seeking"),this.trigger("seeked")},e.prototype.handleTechFirstPlay_=function(){this.options_.starttime&&(mn.warn("Passing the `starttime` option to the player will be deprecated in 6.0"),this.currentTime(this.options_.starttime)),this.addClass("vjs-has-started"),this.trigger("firstplay")},e.prototype.handleTechPause_=function(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")},e.prototype.handleTechEnded_=function(){this.addClass("vjs-ended"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")},e.prototype.handleTechDurationChange_=function(){this.duration(this.techGet_("duration"))},e.prototype.handleTechClick_=function(t){Q(t)&&this.controls_&&(this.paused()?this.play():this.pause())},e.prototype.handleTechTap_=function(){this.userActive(!this.userActive())},e.prototype.handleTechTouchStart_=function(){this.userWasActive=this.userActive()},e.prototype.handleTechTouchMove_=function(){this.userWasActive&&this.reportUserActivity()},e.prototype.handleTechTouchEnd_=function(t){t.preventDefault()},e.prototype.handleFullscreenChange_=function(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")},e.prototype.handleStageClick_=function(){this.reportUserActivity()},e.prototype.handleTechFullscreenChange_=function(t,e){e&&this.isFullscreen(e.isFullscreen),this.trigger("fullscreenchange")},e.prototype.handleTechError_=function(){var t=this.tech_.error();this.error(t)},e.prototype.handleTechTextData_=function(){var t=null;arguments.length>1&&(t=arguments[1]),this.trigger("textdata",t)},e.prototype.getCache=function(){return this.cache_},e.prototype.techCall_=function(t,e){this.ready(function(){if(t in dr)return le(this.middleware_,this.tech_,t,e);if(t in pr)return ue(this.middleware_,this.tech_,t,e);try{this.tech_&&this.tech_[t](e)}catch(t){throw mn(t),t}},!0)},e.prototype.techGet_=function(t){if(this.tech_&&this.tech_.isReady_){if(t in hr)return se(this.middleware_,this.tech_,t);if(t in pr)return ue(this.middleware_,this.tech_,t);try{return this.tech_[t]()}catch(e){if(void 0===this.tech_[t])throw mn("Video.js: "+t+" method not defined for "+this.techName_+" playback technology.",e),e;if("TypeError"===e.name)throw mn("Video.js: "+t+" unavailable on "+this.techName_+" playback technology element.",e),this.tech_.isReady_=!1,e;throw mn(e),e}}},e.prototype.play=function(){var t=this;if(this.playOnLoadstart_&&this.off("loadstart",this.playOnLoadstart_),this.isReady_){if(!this.changingSrc_)return this.techGet_("play");this.playOnLoadstart_=function(){t.playOnLoadstart_=null,xt(t.play())},this.one("loadstart",this.playOnLoadstart_)}else{if(this.playWaitingForReady_)return;this.playWaitingForReady_=!0,this.ready(function(){t.playWaitingForReady_=!1,xt(t.play())})}},e.prototype.pause=function(){this.techCall_("pause")},e.prototype.paused=function(){return!1!==this.techGet_("paused")},e.prototype.played=function(){return this.techGet_("played")||yt(0,0)},e.prototype.scrubbing=function(t){if(void 0===t)return this.scrubbing_;this.scrubbing_=!!t,t?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")},e.prototype.currentTime=function(t){return void 0!==t?(t<0&&(t=0),void this.techCall_("setCurrentTime",t)):(this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime)},e.prototype.duration=function(t){if(void 0===t)return void 0!==this.cache_.duration?this.cache_.duration:NaN;t=parseFloat(t),t<0&&(t=1/0),t!==this.cache_.duration&&(this.cache_.duration=t,t===1/0?this.addClass("vjs-live"):this.removeClass("vjs-live"),this.trigger("durationchange"))},e.prototype.remainingTime=function(){return this.duration()-this.currentTime()},e.prototype.remainingTimeDisplay=function(){return Math.floor(this.duration())-Math.floor(this.currentTime())},e.prototype.buffered=function(){var t=this.techGet_("buffered");return t&&t.length||(t=yt(0,0)),t},e.prototype.bufferedPercent=function(){return bt(this.buffered(),this.duration())},e.prototype.bufferedEnd=function(){var t=this.buffered(),e=this.duration(),n=t.end(t.length-1);return n>e&&(n=e),n},e.prototype.volume=function(t){var e=void 0;return void 0!==t?(e=Math.max(0,Math.min(1,parseFloat(t))),this.cache_.volume=e,this.techCall_("setVolume",e),void(e>0&&this.lastVolume_(e))):(e=parseFloat(this.techGet_("volume")),isNaN(e)?1:e)},e.prototype.muted=function(t){return void 0!==t?void this.techCall_("setMuted",t):this.techGet_("muted")||!1},e.prototype.defaultMuted=function(t){return void 0!==t?this.techCall_("setDefaultMuted",t):this.techGet_("defaultMuted")||!1},e.prototype.lastVolume_=function(t){return void 0!==t&&0!==t?void(this.cache_.lastVolume=t):this.cache_.lastVolume},e.prototype.supportsFullScreen=function(){return this.techGet_("supportsFullScreen")||!1},e.prototype.isFullscreen=function(t){return void 0!==t?void(this.isFullscreen_=!!t):!!this.isFullscreen_},e.prototype.requestFullscreen=function(){var t=Xn;this.isFullscreen(!0),t.requestFullscreen?(ot(De,t.fullscreenchange,Pn(this,function e(n){this.isFullscreen(De[t.fullscreenElement]),!1===this.isFullscreen()&&at(De,t.fullscreenchange,e),this.trigger("fullscreenchange")})),this.el_[t.requestFullscreen]()):this.tech_.supportsFullScreen()?this.techCall_("enterFullScreen"):(this.enterFullWindow(),this.trigger("fullscreenchange"))},e.prototype.exitFullscreen=function(){var t=Xn;this.isFullscreen(!1),t.requestFullscreen?De[t.exitFullscreen]():this.tech_.supportsFullScreen()?this.techCall_("exitFullScreen"):(this.exitFullWindow(),this.trigger("fullscreenchange"))},e.prototype.enterFullWindow=function(){this.isFullWindow=!0,this.docOrigOverflow=De.documentElement.style.overflow,ot(De,"keydown",Pn(this,this.fullWindowOnEscKey)),De.documentElement.style.overflow="hidden",D(De.body,"vjs-full-window"),this.trigger("enterFullWindow")},e.prototype.fullWindowOnEscKey=function(t){27===t.keyCode&&(!0===this.isFullscreen()?this.exitFullscreen():this.exitFullWindow())},e.prototype.exitFullWindow=function(){this.isFullWindow=!1,at(De,"keydown",this.fullWindowOnEscKey),De.documentElement.style.overflow=this.docOrigOverflow,I(De.body,"vjs-full-window"),this.trigger("exitFullWindow")},e.prototype.canPlayType=function(t){for(var e=void 0,n=0,i=this.options_.techOrder;n<i.length;n++){var r=i[n],o=sr.getTech(r);if(o||(o=Wn.getComponent(r)),o){if(o.isSupported()&&(e=o.canPlayType(t)))return e}else mn.error('The "'+r+'" tech is undefined. Skipped browser support check for that tech.')}return""},e.prototype.selectSource=function(t){var e=this,n=this.options_.techOrder.map(function(t){return[t,sr.getTech(t)]}).filter(function(t){var e=t[0],n=t[1];return n?n.isSupported():(mn.error('The "'+e+'" tech is undefined. Skipped browser support check for that tech.'),!1)}),i=function(t,e,n){var i=void 0;return t.some(function(t){return e.some(function(e){if(i=n(t,e))return!0})}),i},r=function(t,n){var i=t[0];if(t[1].canPlaySource(n,e.options_[i.toLowerCase()]))return{source:n,tech:i}};return(this.options_.sourceOrder?i(t,n,function(t){return function(e,n){return t(n,e)}}(r)):i(n,t,r))||!1},e.prototype.src=function(t){var e=this;if(void 0===t)return this.cache_.src||"";var n=mr(t);if(!n.length)return void this.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0);this.cache_.sources=n,this.changingSrc_=!0,this.cache_.source=n[0],oe(this,n[0],function(t,i){if(e.middleware_=i,e.src_(t))return n.length>1?e.src(n.slice(1)):(e.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0),void e.triggerReady());e.changingSrc_=!1,e.cache_.src=t.src,ae(i,e.tech_)})},e.prototype.src_=function(t){var e=this.selectSource([t]);return!e||(pt(e.tech,this.techName_)?(this.ready(function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",t):this.techCall_("src",t.src),"auto"===this.options_.preload&&this.load()},!0),!1):(this.changingSrc_=!0,this.loadTech_(e.tech,e.source),!1))},e.prototype.load=function(){this.techCall_("load")},e.prototype.reset=function(){this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset")},e.prototype.currentSources=function(){var t=this.currentSource(),e=[];return 0!==(0,_.default)(t).length&&e.push(t),this.cache_.sources||e},e.prototype.currentSource=function(){return this.cache_.source||{}},e.prototype.currentSrc=function(){return this.currentSource()&&this.currentSource().src||""},e.prototype.currentType=function(){return this.currentSource()&&this.currentSource().type||""},e.prototype.preload=function(t){return void 0!==t?(this.techCall_("setPreload",t),void(this.options_.preload=t)):this.techGet_("preload")},e.prototype.autoplay=function(t){return void 0!==t?(this.techCall_("setAutoplay",t),void(this.options_.autoplay=t)):this.techGet_("autoplay",t)},e.prototype.playsinline=function(t){return void 0!==t?(this.techCall_("setPlaysinline",t),this.options_.playsinline=t,this):this.techGet_("playsinline")},e.prototype.loop=function(t){return void 0!==t?(this.techCall_("setLoop",t),void(this.options_.loop=t)):this.techGet_("loop")},e.prototype.poster=function(t){if(void 0===t)return this.poster_;t||(t=""),t!==this.poster_&&(this.poster_=t,this.techCall_("setPoster",t),this.isPosterFromTech_=!1,this.trigger("posterchange"))},e.prototype.handleTechPosterChange_=function(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){var t=this.tech_.poster()||"";t!==this.poster_&&(this.poster_=t,this.isPosterFromTech_=!0,this.trigger("posterchange"))}},e.prototype.controls=function(t){if(void 0===t)return!!this.controls_;t=!!t,this.controls_!==t&&(this.controls_=t,this.usingNativeControls()&&this.techCall_("setControls",t),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))},e.prototype.usingNativeControls=function(t){if(void 0===t)return!!this.usingNativeControls_;t=!!t,this.usingNativeControls_!==t&&(this.usingNativeControls_=t,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))},e.prototype.error=function(t){return void 0===t?this.error_||null:null===t?(this.error_=t,this.removeClass("vjs-error"),void(this.errorDisplay&&this.errorDisplay.close())):(this.error_=new _t(t),this.addClass("vjs-error"),mn.error("(CODE:"+this.error_.code+" "+_t.errorTypes[this.error_.code]+")",this.error_.message,this.error_),void this.trigger("error"))},e.prototype.reportUserActivity=function(t){this.userActivity_=!0},e.prototype.userActive=function(t){if(void 0===t)return this.userActive_;if((t=!!t)!==this.userActive_){if(this.userActive_=t,this.userActive_)return this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),void this.trigger("useractive");this.tech_&&this.tech_.one("mousemove",function(t){t.stopPropagation(),t.preventDefault()}),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")}},e.prototype.listenForUserActivity_=function(){var t=void 0,e=void 0,n=void 0,i=Pn(this,this.reportUserActivity),r=function(t){t.screenX===e&&t.screenY===n||(e=t.screenX,n=t.screenY,i())},o=function(){i(),this.clearInterval(t),t=this.setInterval(i,250)},a=function(e){i(),this.clearInterval(t)};this.on("mousedown",o),this.on("mousemove",r),this.on("mouseup",a),this.on("keydown",i),this.on("keyup",i);var s=void 0;this.setInterval(function(){if(this.userActivity_){this.userActivity_=!1,this.userActive(!0),this.clearTimeout(s);var t=this.options_.inactivityTimeout;t<=0||(s=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},t))}},250)},e.prototype.playbackRate=function(t){return void 0!==t?void this.techCall_("setPlaybackRate",t):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("playbackRate"):1},e.prototype.defaultPlaybackRate=function(t){return void 0!==t?this.techCall_("setDefaultPlaybackRate",t):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1},e.prototype.isAudio=function(t){return void 0!==t?void(this.isAudio_=!!t):!!this.isAudio_},e.prototype.addTextTrack=function(t,e,n){if(this.tech_)return this.tech_.addTextTrack(t,e,n)},e.prototype.addRemoteTextTrack=function(t,e){if(this.tech_)return this.tech_.addRemoteTextTrack(t,e)},e.prototype.removeRemoteTextTrack=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.track,n=void 0===e?arguments[0]:e;if(this.tech_)return this.tech_.removeRemoteTextTrack(n)},e.prototype.getVideoPlaybackQuality=function(){return this.techGet_("getVideoPlaybackQuality")},e.prototype.videoWidth=function(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0},e.prototype.videoHeight=function(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0},e.prototype.language=function(t){if(void 0===t)return this.language_;this.language_=String(t).toLowerCase()},e.prototype.languages=function(){return ft(e.prototype.options_.languages,this.languages_)},e.prototype.toJSON=function(){var t=ft(this.options_),e=t.tracks;t.tracks=[];for(var n=0;n<e.length;n++){var i=e[n];i=ft(i),i.player=void 0,t.tracks[n]=i}return t},e.prototype.createModal=function(t,e){var n=this;e=e||{},e.content=t||"";var i=new oi(this,e);return this.addChild(i),i.on("dispose",function(){n.removeChild(i)}),i.open(),i},e.getTagSettings=function(t){var e={sources:[],tracks:[]},n=N(t),i=n["data-setup"];if(R(t,"vjs-fluid")&&(n.fluid=!0),null!==i){var o=Zn(i||"{}"),a=o[0],s=o[1];a&&mn.error(a),r(n,s)}if(r(e,n),t.hasChildNodes())for(var l=t.childNodes,u=0,c=l.length;u<c;u++){var h=l[u],d=h.nodeName.toLowerCase();"source"===d?e.sources.push(N(h)):"track"===d&&e.tracks.push(N(h))}return e},e.prototype.flexNotSupported_=function(){var t=De.createElement("i");return!("flexBasis"in t.style||"webkitFlexBasis"in t.style||"mozFlexBasis"in t.style||"msFlexBasis"in t.style||"msFlexOrder"in t.style)},e}(Wn);Xi.names.forEach(function(t){var e=Xi[t];Go.prototype[e.getterName]=function(){return this.tech_?this.tech_[e.getterName]():(this[e.privateName]=this[e.privateName]||new e.ListClass,this[e.privateName])}}),Go.players={};var Ho=ke.navigator;Go.prototype.options_={techOrder:sr.defaultTechOrder_,html5:{},flash:{},inactivityTimeout:2e3,playbackRates:[],children:["mediaLoader","posterImage","textTrackDisplay","loadingSpinner","bigPlayButton","controlBar","errorDisplay","textTrackSettings"],language:Ho&&(Ho.languages&&Ho.languages[0]||Ho.userLanguage||Ho.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media."},$e||Go.prototype.options_.children.push("resizeManager"),["ended","seeking","seekable","networkState","readyState"].forEach(function(t){Go.prototype[t]=function(){return this.techGet_(t)}}),jo.forEach(function(t){Go.prototype["handleTech"+dt(t)+"_"]=function(){return this.trigger(t)}}),Wn.registerComponent("Player",Go);var zo={},Wo=function(t){return zo.hasOwnProperty(t)},Xo=function(t){return Wo(t)?zo[t]:void 0},qo=function(t,e){t.activePlugins_=t.activePlugins_||{},t.activePlugins_[e]=!0},Ko=function(t,e,n){var i=(n?"before":"")+"pluginsetup";t.trigger(i,e),t.trigger(i+":"+e.name,e)},Yo=function(t,e){var n=function(){Ko(this,{name:t,plugin:e,instance:null},!0);var n=e.apply(this,arguments);return qo(this,t),Ko(this,{name:t,plugin:e,instance:n}),n};return(0,_.default)(e).forEach(function(t){n[t]=e[t]}),n},$o=function(t,e){return e.prototype.name=t,function(){Ko(this,{name:t,plugin:e,instance:null},!0);for(var n=arguments.length,i=Array(n),r=0;r<n;r++)i[r]=arguments[r];var o=new(Function.prototype.bind.apply(e,[null].concat([this].concat(i))));return this[t]=function(){return o},Ko(this,o.getEventHash()),o}},Qo=function(){function t(e){if(on(this,t),this.constructor===t)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=e,ct(this),delete this.trigger,ht(this,this.constructor.defaultState),qo(e,this.name),this.dispose=Pn(this,this.dispose),e.on("dispose",this.dispose)}return t.prototype.version=function(){return this.constructor.VERSION},t.prototype.getEventHash=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.name=this.name,t.plugin=this.constructor,t.instance=this,t},t.prototype.trigger=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return st(this.eventBusEl_,t,this.getEventHash(e))},t.prototype.handleStateChanged=function(t){},t.prototype.dispose=function(){var t=this.name,e=this.player;this.trigger("dispose"),this.off(),e.off("dispose",this.dispose),e.activePlugins_[t]=!1,this.player=this.state=null,e[t]=$o(t,zo[t])},t.isBasic=function(e){var n="string"==typeof e?Xo(e):e;return"function"==typeof n&&!t.prototype.isPrototypeOf(n.prototype)},t.registerPlugin=function(e,n){if("string"!=typeof e)throw new Error('Illegal plugin name, "'+e+'", must be a string, was '+(void 0===e?"undefined":rn(e))+".");if(Wo(e))mn.warn('A plugin named "'+e+'" already exists. You may want to avoid re-registering plugins!');else if(Go.prototype.hasOwnProperty(e))throw new Error('Illegal plugin name, "'+e+'", cannot share a name with an existing player method!');if("function"!=typeof n)throw new Error('Illegal plugin for "'+e+'", must be a function, was '+(void 0===n?"undefined":rn(n))+".");return zo[e]=n,"plugin"!==e&&(t.isBasic(n)?Go.prototype[e]=Yo(e,n):Go.prototype[e]=$o(e,n)),n},t.deregisterPlugin=function(t){if("plugin"===t)throw new Error("Cannot de-register base plugin.");Wo(t)&&(delete zo[t],delete Go.prototype[t])},t.getPlugins=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,_.default)(zo),e=void 0;return t.forEach(function(t){var n=Xo(t);n&&(e=e||{},e[t]=n)}),e},t.getPluginVersion=function(t){var e=Xo(t);return e&&e.VERSION||""},t}();Qo.getPlugin=Xo,Qo.BASE_PLUGIN_NAME="plugin",Qo.registerPlugin("plugin",Qo),Go.prototype.usingPlugin=function(t){return!!this.activePlugins_&&!0===this.activePlugins_[t]},Go.prototype.hasPlugin=function(t){return!!Wo(t)};var Jo=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":rn(e)));t.prototype=(0,E.default)(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.super_=e)},Zo=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=function(){t.apply(this,arguments)},i={};"object"===(void 0===e?"undefined":rn(e))?(e.constructor!==Object.prototype.constructor&&(n=e.constructor),i=e):"function"==typeof e&&(n=e),Jo(n,t);for(var r in i)i.hasOwnProperty(r)&&(n.prototype[r]=i[r]);return n};"undefined"==typeof HTMLVideoElement&&g()&&(De.createElement("video"),De.createElement("audio"),De.createElement("track"),De.createElement("video-js"));var ta=function(t){return 0===t.indexOf("#")?t.slice(1):t};if(xe.hooks_={},xe.hooks=function(t,e){return xe.hooks_[t]=xe.hooks_[t]||[],e&&(xe.hooks_[t]=xe.hooks_[t].concat(e)),xe.hooks_[t]},xe.hook=function(t,e){xe.hooks(t,e)},xe.hookOnce=function(t,e){xe.hooks(t,[].concat(e).map(function(e){return function n(){return xe.removeHook(t,n),e.apply(void 0,arguments)}}))},xe.removeHook=function(t,e){var n=xe.hooks(t).indexOf(e);return!(n<=-1)&&(xe.hooks_[t]=xe.hooks_[t].slice(),xe.hooks_[t].splice(n,1),!0)},!0!==ke.VIDEOJS_NO_DYNAMIC_STYLE&&g()){var ea=yn(".vjs-styles-defaults");if(!ea){ea=Ln("vjs-styles-defaults");var na=yn("head");na&&na.insertBefore(ea,na.firstChild),Rn(ea,"\n      .video-js {\n        width: 300px;\n        height: 150px;\n      }\n\n      .vjs-fluid {\n        padding-top: 56.25%\n      }\n    ")}}return ut(1,xe),xe.VERSION=Se,xe.options=Go.prototype.options_,xe.getPlayers=function(){return Go.players},xe.getPlayer=function(t){var e=Go.players,n=void 0;if("string"==typeof t){var i=ta(t),r=e[i];if(r)return r;n=yn("#"+i)}else n=t;if(b(n)){var o=n,a=o.player,s=o.playerId;if(a||e[s])return a||e[s]}},xe.getAllPlayers=function(){return(0,_.default)(Go.players).map(function(t){return Go.players[t]}).filter(Boolean)},xe.players=Go.players,xe.getComponent=Wn.getComponent,xe.registerComponent=function(t,e){sr.isTech(e)&&mn.warn("The "+t+" tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)"),Wn.registerComponent.call(Wn,t,e)},xe.getTech=sr.getTech,xe.registerTech=sr.registerTech,xe.use=re,!$e&&d.default?(Object.defineProperty(xe,"middleware",{value:{},writeable:!1,enumerable:!0}),Object.defineProperty(xe.middleware,"TERMINATOR",{value:cr,writeable:!1,enumerable:!0})):xe.middleware={TERMINATOR:cr},xe.browser=nn,xe.TOUCH_ENABLED=tn,xe.extend=Zo,xe.mergeOptions=ft,xe.bind=Pn,xe.registerPlugin=Qo.registerPlugin,xe.plugin=function(t,e){return mn.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),Qo.registerPlugin(t,e)},xe.getPlugins=Qo.getPlugins,xe.getPlugin=Qo.getPlugin,xe.getPluginVersion=Qo.getPluginVersion,xe.addLanguage=function(t,e){var n;return t=(""+t).toLowerCase(),xe.options.languages=ft(xe.options.languages,(n={},n[t]=e,n)),xe.options.languages[t]},xe.log=mn,xe.createTimeRange=xe.createTimeRanges=yt,xe.formatTime=kr,xe.setFormatTime=ye,xe.resetFormatTime=be,xe.parseUrl=_i,xe.isCrossOrigin=xi,xe.EventTarget=Fn,xe.on=ot,xe.one=lt,xe.off=at,xe.trigger=st,xe.xhr=Fi,xe.TextTrack=Ui,xe.AudioTrack=Vi,xe.VideoTrack=Bi,["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach(function(t){xe[t]=function(){return mn.warn("videojs."+t+"() is deprecated; use videojs.dom."+t+"() instead"),_n[t].apply(null,arguments)}}),xe.computedStyle=u,xe.dom=_n,xe.url=Ei,xe})}).call(e,n(77))},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r,o,a=n(14),s=i(a),l=n(21),u=i(l),c=n(30),h=i(c),d=n(55),p=i(d),f=n(13),m=i(f),v=n(112),g=i(v),y=n(113),b=i(y),_={REVISION:"73"};r=_,void 0!==(o="function"==typeof r?r.call(e,n,e,t):r)&&(t.exports=o),void 0!==self.requestAnimationFrame&&void 0!==self.cancelAnimationFrame||function(){for(var t=0,e=["ms","moz","webkit","o"],n=0;n<e.length&&!self.requestAnimationFrame;++n)self.requestAnimationFrame=self[e[n]+"RequestAnimationFrame"],self.cancelAnimationFrame=self[e[n]+"CancelAnimationFrame"]||self[e[n]+"CancelRequestAnimationFrame"];void 0===self.requestAnimationFrame&&void 0!==self.setTimeout&&(self.requestAnimationFrame=function(e){var n=Date.now(),i=Math.max(0,16-(n-t)),r=self.setTimeout(function(){e(n+i)},i);return t=n+i,r}),void 0===self.cancelAnimationFrame&&void 0!==self.clearTimeout&&(self.cancelAnimationFrame=function(t){self.clearTimeout(t)})}(),void 0===self.performance&&(self.performance={}),void 0===self.performance.now&&function(){var t=Date.now();self.performance.now=function(){return Date.now()-t}}(),void 0===b.default&&(Number.EPSILON=Math.pow(2,-52)),void 0===g.default&&(Math.sign=function(t){return 0>t?-1:0<t?1:+t}),void 0===Function.prototype.name&&void 0!==m.default&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*(\S*)\s*\(/)[1]}}),_.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2},_.CullFaceNone=0,_.CullFaceBack=1,_.CullFaceFront=2,_.CullFaceFrontBack=3,_.FrontFaceDirectionCW=0,_.FrontFaceDirectionCCW=1,_.BasicShadowMap=0,_.PCFShadowMap=1,_.PCFSoftShadowMap=2,_.FrontSide=0,_.BackSide=1,_.DoubleSide=2,_.FlatShading=1,_.SmoothShading=2,_.NoColors=0,_.FaceColors=1,_.VertexColors=2,_.NoBlending=0,_.NormalBlending=1,_.AdditiveBlending=2,_.SubtractiveBlending=3,_.MultiplyBlending=4,_.CustomBlending=5,_.AddEquation=100,_.SubtractEquation=101,_.ReverseSubtractEquation=102,_.MinEquation=103,_.MaxEquation=104,_.ZeroFactor=200,_.OneFactor=201,_.SrcColorFactor=202,_.OneMinusSrcColorFactor=203,_.SrcAlphaFactor=204,_.OneMinusSrcAlphaFactor=205,_.DstAlphaFactor=206,_.OneMinusDstAlphaFactor=207,_.DstColorFactor=208,_.OneMinusDstColorFactor=209,_.SrcAlphaSaturateFactor=210,_.NeverDepth=0,_.AlwaysDepth=1,_.LessDepth=2,_.LessEqualDepth=3,_.EqualDepth=4,_.GreaterEqualDepth=5,_.GreaterDepth=6,_.NotEqualDepth=7,_.MultiplyOperation=0,_.MixOperation=1,_.AddOperation=2,_.UVMapping=300,_.CubeReflectionMapping=301,_.CubeRefractionMapping=302,_.EquirectangularReflectionMapping=303,_.EquirectangularRefractionMapping=304,_.SphericalReflectionMapping=305,_.RepeatWrapping=1e3,_.ClampToEdgeWrapping=1001,_.MirroredRepeatWrapping=1002,_.NearestFilter=1003,_.NearestMipMapNearestFilter=1004,_.NearestMipMapLinearFilter=1005,_.LinearFilter=1006,_.LinearMipMapNearestFilter=1007,_.LinearMipMapLinearFilter=1008,_.UnsignedByteType=1009,_.ByteType=1010,_.ShortType=1011,_.UnsignedShortType=1012,_.IntType=1013,_.UnsignedIntType=1014,_.FloatType=1015,_.HalfFloatType=1025,_.UnsignedShort4444Type=1016,_.UnsignedShort5551Type=1017,_.UnsignedShort565Type=1018,_.AlphaFormat=1019,_.RGBFormat=1020,_.RGBAFormat=1021,_.LuminanceFormat=1022,_.LuminanceAlphaFormat=1023,_.RGBEFormat=_.RGBAFormat,_.RGB_S3TC_DXT1_Format=2001,_.RGBA_S3TC_DXT1_Format=2002,_.RGBA_S3TC_DXT3_Format=2003,_.RGBA_S3TC_DXT5_Format=2004,_.RGB_PVRTC_4BPPV1_Format=2100,_.RGB_PVRTC_2BPPV1_Format=2101,_.RGBA_PVRTC_4BPPV1_Format=2102,_.RGBA_PVRTC_2BPPV1_Format=2103,_.LoopOnce=2200,_.LoopRepeat=2201,_.LoopPingPong=2202,_.Projector=function(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(t,e){console.warn("THREE.Projector: .projectVector() is now vector.project()."),t.project(e)},this.unprojectVector=function(t,e){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),t.unproject(e)},this.pickingRay=function(t,e){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}},_.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElement("canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}},_.Color=function(t){return 3===arguments.length?this.fromArray(arguments):this.set(t)},_.Color.prototype={constructor:_.Color,r:1,g:1,b:1,set:function(t){return t instanceof _.Color?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,n){return this.r=t,this.g=e,this.b=n,this},setHSL:function(){function t(t,e,n){return 0>n&&(n+=1),1<n&&(n-=1),n<1/6?t+6*(e-t)*n:.5>n?e:n<2/3?t+6*(e-t)*(2/3-n):t}return function(e,n,i){return e=_.Math.euclideanModulo(e,1),n=_.Math.clamp(n,0,1),i=_.Math.clamp(i,0,1),0===n?this.r=this.g=this.b=i:(n=.5>=i?i*(1+n):i+n-i*n,i=2*i-n,this.r=t(i,n,e+1/3),this.g=t(i,n,e),this.b=t(i,n,e-1/3)),this}}(),setStyle:function(t){function e(e){void 0!==e&&1>parseFloat(e)&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var i=n[2];switch(n[1]){case"rgb":case"rgba":if(n=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(i))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,e(n[5]),this;if(n=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(i))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,e(n[5]),this;break;case"hsl":case"hsla":if(n=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(i)){var i=parseFloat(n[1])/360,r=parseInt(n[2],10)/100,o=parseInt(n[3],10)/100;return e(n[5]),this.setHSL(i,r,o)}}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(t)){if(n=n[1],3===(i=n.length))return this.r=parseInt(n.charAt(0)+n.charAt(0),16)/255,this.g=parseInt(n.charAt(1)+n.charAt(1),16)/255,this.b=parseInt(n.charAt(2)+n.charAt(2),16)/255,this;if(6===i)return this.r=parseInt(n.charAt(0)+n.charAt(1),16)/255,this.g=parseInt(n.charAt(2)+n.charAt(3),16)/255,this.b=parseInt(n.charAt(4)+n.charAt(5),16)/255,this}return t&&0<t.length&&(n=_.ColorKeywords[t],void 0!==n?this.setHex(n):console.warn("THREE.Color: Unknown color "+t)),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){void 0===e&&(e=2);var n=0<e?1/e:1;return this.r=Math.pow(t.r,n),this.g=Math.pow(t.g,n),this.b=Math.pow(t.b,n),this},convertGammaToLinear:function(){var t=this.r,e=this.g,n=this.b;return this.r=t*t,this.g=e*e,this.b=n*n,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){t=t||{h:0,s:0,l:0};var e,n=this.r,i=this.g,r=this.b,o=Math.max(n,i,r),a=Math.min(n,i,r),s=(a+o)/2;if(a===o)a=e=0;else{var l=o-a,a=.5>=s?l/(o+a):l/(2-o-a);switch(o){case n:e=(i-r)/l+(i<r?6:0);break;case i:e=(r-n)/l+2;break;case r:e=(n-i)/l+4}e/=6}return t.h=e,t.s=a,t.l=s,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,e,n){var i=this.getHSL();return i.h+=t,i.s+=e,i.l+=n,this.setHSL(i.h,i.s,i.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}},_.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},_.Quaternion=function(t,e,n,i){this._x=t||0,this._y=e||0,this._z=n||0,this._w=void 0!==i?i:1},_.Quaternion.prototype={constructor:_.Quaternion,get x(){return this._x},set x(t){this._x=t,this.onChangeCallback()},get y(){return this._y},set y(t){this._y=t,this.onChangeCallback()},get z(){return this._z},set z(t){this._z=t,this.onChangeCallback()},get w(){return this._w},set w(t){this._w=t,this.onChangeCallback()},set:function(t,e,n,i){return this._x=t,this._y=e,this._z=n,this._w=i,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this.onChangeCallback(),this},setFromEuler:function(t,e){if(!1==t instanceof _.Euler)throw Error("THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var n=Math.cos(t._x/2),i=Math.cos(t._y/2),r=Math.cos(t._z/2),o=Math.sin(t._x/2),a=Math.sin(t._y/2),s=Math.sin(t._z/2),l=t.order;return"XYZ"===l?(this._x=o*i*r+n*a*s,this._y=n*a*r-o*i*s,this._z=n*i*s+o*a*r,this._w=n*i*r-o*a*s):"YXZ"===l?(this._x=o*i*r+n*a*s,this._y=n*a*r-o*i*s,this._z=n*i*s-o*a*r,this._w=n*i*r+o*a*s):"ZXY"===l?(this._x=o*i*r-n*a*s,this._y=n*a*r+o*i*s,this._z=n*i*s+o*a*r,this._w=n*i*r-o*a*s):"ZYX"===l?(this._x=o*i*r-n*a*s,this._y=n*a*r+o*i*s,this._z=n*i*s-o*a*r,this._w=n*i*r+o*a*s):"YZX"===l?(this._x=o*i*r+n*a*s,this._y=n*a*r+o*i*s,this._z=n*i*s-o*a*r,this._w=n*i*r-o*a*s):"XZY"===l&&(this._x=o*i*r-n*a*s,this._y=n*a*r-o*i*s,this._z=n*i*s+o*a*r,this._w=n*i*r+o*a*s),!1!==e&&this.onChangeCallback(),this},setFromAxisAngle:function(t,e){var n=e/2,i=Math.sin(n);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(n),this.onChangeCallback(),this},setFromRotationMatrix:function(t){var e=t.elements,n=e[0];t=e[4];var i=e[8],r=e[1],o=e[5],a=e[9],s=e[2],l=e[6],e=e[10],u=n+o+e;return 0<u?(n=.5/Math.sqrt(u+1),this._w=.25/n,this._x=(l-a)*n,this._y=(i-s)*n,this._z=(r-t)*n):n>o&&n>e?(n=2*Math.sqrt(1+n-o-e),this._w=(l-a)/n,this._x=.25*n,this._y=(t+r)/n,this._z=(i+s)/n):o>e?(n=2*Math.sqrt(1+o-n-e),this._w=(i-s)/n,this._x=(t+r)/n,this._y=.25*n,this._z=(a+l)/n):(n=2*Math.sqrt(1+e-n-o),this._w=(r-t)/n,this._x=(i+s)/n,this._y=(a+l)/n,this._z=.25*n),this.onChangeCallback(),this},setFromUnitVectors:function(){var t,e;return function(n,i){return void 0===t&&(t=new _.Vector3),e=n.dot(i)+1,1e-6>e?(e=0,Math.abs(n.x)>Math.abs(n.z)?t.set(-n.y,n.x,0):t.set(0,-n.z,n.y)):t.crossVectors(n,i),this._x=t.x,this._y=t.y,this._z=t.z,this._w=e,this.normalize(),this}}(),inverse:function(){return this.conjugate().normalize(),this},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._z=this._y=this._x=0,this._w=1):(t=1/t,this._x*=t,this._y*=t,this._z*=t,this._w*=t),this.onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},multiplyQuaternions:function(t,e){var n=t._x,i=t._y,r=t._z,o=t._w,a=e._x,s=e._y,l=e._z,u=e._w;return this._x=n*u+o*a+i*l-r*s,this._y=i*u+o*s+r*a-n*l,this._z=r*u+o*l+n*s-i*a,this._w=o*u-n*a-i*s-r*l,this.onChangeCallback(),this},multiplyVector3:function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var n=this._x,i=this._y,r=this._z,o=this._w,a=o*t._w+n*t._x+i*t._y+r*t._z;if(0>a?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),1<=a)return this._w=o,this._x=n,this._y=i,this._z=r,this;var s=Math.acos(a),l=Math.sqrt(1-a*a);return.001>Math.abs(l)?(this._w=.5*(o+this._w),this._x=.5*(n+this._x),this._y=.5*(i+this._y),this._z=.5*(r+this._z),this):(a=Math.sin((1-e)*s)/l,s=Math.sin(e*s)/l,this._w=o*a+this._w*s,this._x=n*a+this._x*s,this._y=i*a+this._y*s,this._z=r*a+this._z*s,this.onChangeCallback(),this)},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}},_.Quaternion.slerp=function(t,e,n,i){return n.copy(t).slerp(e,i)},_.Vector2=function(t,e){this.x=t||0,this.y=e||0},_.Vector2.prototype={constructor:_.Vector2,get width(){return this.x},set width(t){this.x=t},get height(){return this.y},set height(t){this.y=t},set:function(t,e){return this.x=t,this.y=e,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return isFinite(t)?(this.x*=t,this.y*=t):this.y=this.x=0,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:function(){var t,e;return function(n,i){return void 0===t&&(t=new _.Vector2,e=new _.Vector2),t.set(n,n),e.set(i,i),this.clamp(t,e)}}(),clampLength:function(t,e){var n=this.length();return this.multiplyScalar(Math.max(t,Math.min(e,n))/n),this},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x;return t=this.y-t.y,e*e+t*t},setLength:function(t){return this.multiplyScalar(t/this.length())},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t),this},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},fromAttribute:function(t,e,n){return void 0===n&&(n=0),e=e*t.itemSize+n,this.x=t.array[e],this.y=t.array[e+1],this},rotateAround:function(t,e){var n=Math.cos(e),i=Math.sin(e),r=this.x-t.x,o=this.y-t.y;return this.x=r*n-o*i+t.x,this.y=r*i+o*n+t.y,this}},_.Vector3=function(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0},_.Vector3.prototype={constructor:_.Vector3,set:function(t,e,n){return this.x=t,this.y=e,this.z=n,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t):this.z=this.y=this.x=0,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(){var t;return function(e){return!1==e instanceof _.Euler&&console.error("THREE.Vector3: .applyEuler() now expects a Euler rotation rather than a Vector3 and order."),void 0===t&&(t=new _.Quaternion),this.applyQuaternion(t.setFromEuler(e)),this}}(),applyAxisAngle:function(){var t;return function(e,n){return void 0===t&&(t=new _.Quaternion),this.applyQuaternion(t.setFromAxisAngle(e,n)),this}}(),applyMatrix3:function(t){var e=this.x,n=this.y,i=this.z;return t=t.elements,this.x=t[0]*e+t[3]*n+t[6]*i,this.y=t[1]*e+t[4]*n+t[7]*i,this.z=t[2]*e+t[5]*n+t[8]*i,this},applyMatrix4:function(t){var e=this.x,n=this.y,i=this.z;return t=t.elements,this.x=t[0]*e+t[4]*n+t[8]*i+t[12],this.y=t[1]*e+t[5]*n+t[9]*i+t[13],this.z=t[2]*e+t[6]*n+t[10]*i+t[14],this},applyProjection:function(t){var e=this.x,n=this.y,i=this.z;t=t.elements;var r=1/(t[3]*e+t[7]*n+t[11]*i+t[15]);return this.x=(t[0]*e+t[4]*n+t[8]*i+t[12])*r,this.y=(t[1]*e+t[5]*n+t[9]*i+t[13])*r,this.z=(t[2]*e+t[6]*n+t[10]*i+t[14])*r,this},applyQuaternion:function(t){var e=this.x,n=this.y,i=this.z,r=t.x,o=t.y,a=t.z;t=t.w;var s=t*e+o*i-a*n,l=t*n+a*e-r*i,u=t*i+r*n-o*e,e=-r*e-o*n-a*i;return this.x=s*t+e*-r+l*-a-u*-o,this.y=l*t+e*-o+u*-r-s*-a,this.z=u*t+e*-a+s*-o-l*-r,this},project:function(){var t;return function(e){return void 0===t&&(t=new _.Matrix4),t.multiplyMatrices(e.projectionMatrix,t.getInverse(e.matrixWorld)),this.applyProjection(t)}}(),unproject:function(){var t;return function(e){return void 0===t&&(t=new _.Matrix4),t.multiplyMatrices(e.matrixWorld,t.getInverse(e.projectionMatrix)),this.applyProjection(t)}}(),transformDirection:function(t){var e=this.x,n=this.y,i=this.z;return t=t.elements,this.x=t[0]*e+t[4]*n+t[8]*i,this.y=t[1]*e+t[5]*n+t[9]*i,this.z=t[2]*e+t[6]*n+t[10]*i,this.normalize(),this},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(){var t,e;return function(n,i){return void 0===t&&(t=new _.Vector3,e=new _.Vector3),t.set(n,n,n),e.set(i,i,i),this.clamp(t,e)}}(),clampLength:function(t,e){var n=this.length();return this.multiplyScalar(Math.max(t,Math.min(e,n))/n),this},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){return this.multiplyScalar(t/this.length())},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t),this},cross:function(t,e){if(void 0!==e)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e);var n=this.x,i=this.y,r=this.z;return this.x=i*t.z-r*t.y,this.y=r*t.x-n*t.z,this.z=n*t.y-i*t.x,this},crossVectors:function(t,e){var n=t.x,i=t.y,r=t.z,o=e.x,a=e.y,s=e.z;return this.x=i*s-r*a,this.y=r*o-n*s,this.z=n*a-i*o,this},projectOnVector:function(){var t,e;return function(n){return void 0===t&&(t=new _.Vector3),t.copy(n).normalize(),e=this.dot(t),this.copy(t).multiplyScalar(e)}}(),projectOnPlane:function(){var t;return function(e){return void 0===t&&(t=new _.Vector3),t.copy(this).projectOnVector(e),this.sub(t)}}(),reflect:function(){var t;return function(e){return void 0===t&&(t=new _.Vector3),this.sub(t.copy(e).multiplyScalar(2*this.dot(e)))}}(),angleTo:function(t){return t=this.dot(t)/(this.length()*t.length()),Math.acos(_.Math.clamp(t,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y;return t=this.z-t.z,e*e+n*n+t*t},setEulerFromRotationMatrix:function(t,e){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(t,e){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},setFromMatrixPosition:function(t){return this.x=t.elements[12],this.y=t.elements[13],this.z=t.elements[14],this},setFromMatrixScale:function(t){var e=this.set(t.elements[0],t.elements[1],t.elements[2]).length(),n=this.set(t.elements[4],t.elements[5],t.elements[6]).length();return t=this.set(t.elements[8],t.elements[9],t.elements[10]).length(),this.x=e,this.y=n,this.z=t,this},setFromMatrixColumn:function(t,e){var n=4*t,i=e.elements;return this.x=i[n],this.y=i[n+1],this.z=i[n+2],this},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromAttribute:function(t,e,n){return void 0===n&&(n=0),e=e*t.itemSize+n,this.x=t.array[e],this.y=t.array[e+1],this.z=t.array[e+2],this}},_.Vector4=function(t,e,n,i){this.x=t||0,this.y=e||0,this.z=n||0,this.w=void 0!==i?i:1},_.Vector4.prototype={constructor:_.Vector4,set:function(t,e,n,i){return this.x=t,this.y=e,this.z=n,this.w=i,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t,this.w*=t):this.w=this.z=this.y=this.x=0,this},applyMatrix4:function(t){var e=this.x,n=this.y,i=this.z,r=this.w;return t=t.elements,this.x=t[0]*e+t[4]*n+t[8]*i+t[12]*r,this.y=t[1]*e+t[5]*n+t[9]*i+t[13]*r,this.z=t[2]*e+t[6]*n+t[10]*i+t[14]*r,this.w=t[3]*e+t[7]*n+t[11]*i+t[15]*r,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return 1e-4>e?(this.x=1,this.z=this.y=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,n,i;t=t.elements;var r=t[0];i=t[4];var o=t[8],a=t[1],s=t[5],l=t[9];n=t[2],e=t[6];var u=t[10];return.01>Math.abs(i-a)&&.01>Math.abs(o-n)&&.01>Math.abs(l-e)?.1>Math.abs(i+a)&&.1>Math.abs(o+n)&&.1>Math.abs(l+e)&&.1>Math.abs(r+s+u-3)?(this.set(1,0,0,0),this):(t=Math.PI,r=(r+1)/2,s=(s+1)/2,u=(u+1)/2,i=(i+a)/4,o=(o+n)/4,l=(l+e)/4,r>s&&r>u?.01>r?(e=0,i=n=.707106781):(e=Math.sqrt(r),n=i/e,i=o/e):s>u?.01>s?(e=.707106781,n=0,i=.707106781):(n=Math.sqrt(s),e=i/n,i=l/n):.01>u?(n=e=.707106781,i=0):(i=Math.sqrt(u),e=o/i,n=l/i),this.set(e,n,i,t),this):(t=Math.sqrt((e-l)*(e-l)+(o-n)*(o-n)+(a-i)*(a-i)),.001>Math.abs(t)&&(t=1),this.x=(e-l)/t,this.y=(o-n)/t,this.z=(a-i)/t,this.w=Math.acos((r+s+u-1)/2),this)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(){var t,e;return function(n,i){return void 0===t&&(t=new _.Vector4,e=new _.Vector4),t.set(n,n,n,n),e.set(i,i,i,i),this.clamp(t,e)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){return this.multiplyScalar(t/this.length())},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t),this},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromAttribute:function(t,e,n){return void 0===n&&(n=0),e=e*t.itemSize+n,this.x=t.array[e],this.y=t.array[e+1],this.z=t.array[e+2],this.w=t.array[e+3],this}},_.Euler=function(t,e,n,i){this._x=t||0,this._y=e||0,this._z=n||0,this._order=i||_.Euler.DefaultOrder},_.Euler.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" "),_.Euler.DefaultOrder="XYZ",_.Euler.prototype={constructor:_.Euler,get x(){return this._x},set x(t){this._x=t,this.onChangeCallback()},get y(){return this._y},set y(t){this._y=t,this.onChangeCallback()},get z(){return this._z},set z(t){this._z=t,this.onChangeCallback()},get order(){return this._order},set order(t){this._order=t,this.onChangeCallback()},set:function(t,e,n,i){return this._x=t,this._y=e,this._z=n,this._order=i||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this.onChangeCallback(),this},setFromRotationMatrix:function(t,e,n){var i=_.Math.clamp,r=t.elements;t=r[0];var o=r[4],a=r[8],s=r[1],l=r[5],u=r[9],c=r[2],h=r[6],r=r[10];return e=e||this._order,"XYZ"===e?(this._y=Math.asin(i(a,-1,1)),.99999>Math.abs(a)?(this._x=Math.atan2(-u,r),this._z=Math.atan2(-o,t)):(this._x=Math.atan2(h,l),this._z=0)):"YXZ"===e?(this._x=Math.asin(-i(u,-1,1)),.99999>Math.abs(u)?(this._y=Math.atan2(a,r),this._z=Math.atan2(s,l)):(this._y=Math.atan2(-c,t),this._z=0)):"ZXY"===e?(this._x=Math.asin(i(h,-1,1)),.99999>Math.abs(h)?(this._y=Math.atan2(-c,r),this._z=Math.atan2(-o,l)):(this._y=0,this._z=Math.atan2(s,t))):"ZYX"===e?(this._y=Math.asin(-i(c,-1,1)),.99999>Math.abs(c)?(this._x=Math.atan2(h,r),this._z=Math.atan2(s,t)):(this._x=0,this._z=Math.atan2(-o,l))):"YZX"===e?(this._z=Math.asin(i(s,-1,1)),.99999>Math.abs(s)?(this._x=Math.atan2(-u,l),this._y=Math.atan2(-c,t)):(this._x=0,this._y=Math.atan2(a,r))):"XZY"===e?(this._z=Math.asin(-i(o,-1,1)),.99999>Math.abs(o)?(this._x=Math.atan2(h,l),this._y=Math.atan2(a,t)):(this._x=Math.atan2(-u,r),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+e),this._order=e,!1!==n&&this.onChangeCallback(),this},setFromQuaternion:function(){var t;return function(e,n,i){return void 0===t&&(t=new _.Matrix4),t.makeRotationFromQuaternion(e),this.setFromRotationMatrix(t,n,i),this}}(),setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:function(){var t=new _.Quaternion;return function(e){t.setFromEuler(this),this.setFromQuaternion(t,e)}}(),equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new _.Vector3(this._x,this._y,this._z)},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}},_.Line3=function(t,e){this.start=void 0!==t?t:new _.Vector3,this.end=void 0!==e?e:new _.Vector3},_.Line3.prototype={constructor:_.Line3,set:function(t,e){return this.start.copy(t),this.end.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},center:function(t){return(t||new _.Vector3).addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return(t||new _.Vector3).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){var n=e||new _.Vector3;return this.delta(n).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(){var t=new _.Vector3,e=new _.Vector3;return function(n,i){t.subVectors(n,this.start),e.subVectors(this.end,this.start);var r=e.dot(e),r=e.dot(t)/r;return i&&(r=_.Math.clamp(r,0,1)),r}}(),closestPointToPoint:function(t,e,n){return t=this.closestPointToPointParameter(t,e),n=n||new _.Vector3,this.delta(n).multiplyScalar(t).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}},_.Box2=function(t,e){this.min=void 0!==t?t:new _.Vector2(1/0,1/0),this.max=void 0!==e?e:new _.Vector2(-1/0,-1/0)},_.Box2.prototype={constructor:_.Box2,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new _.Vector2;return function(e,n){var i=t.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(t){return(t||new _.Vector2).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(t){return(t||new _.Vector2).subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,e){return(e||new _.Vector2).set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},isIntersectionBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,e){return(e||new _.Vector2).copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new _.Vector2;return function(e){return t.copy(e).clamp(this.min,this.max).sub(e).length()}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}},_.Box3=function(t,e){this.min=void 0!==t?t:new _.Vector3(1/0,1/0,1/0),this.max=void 0!==e?e:new _.Vector3(-1/0,-1/0,-1/0)},_.Box3.prototype={constructor:_.Box3,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new _.Vector3;return function(e,n){var i=t.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}}(),setFromObject:function(){var t=new _.Vector3;return function(e){var n=this;return e.updateMatrixWorld(!0),this.makeEmpty(),e.traverse(function(e){var i=e.geometry;if(void 0!==i)if(i instanceof _.Geometry)for(var r=i.vertices,i=0,o=r.length;i<o;i++)t.copy(r[i]),t.applyMatrix4(e.matrixWorld),n.expandByPoint(t);else if(i instanceof _.BufferGeometry&&void 0!==i.attributes.position)for(r=i.attributes.position.array,i=0,o=r.length;i<o;i+=3)t.set(r[i],r[i+1],r[i+2]),t.applyMatrix4(e.matrixWorld),n.expandByPoint(t)}),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(t){return(t||new _.Vector3).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(t){return(t||new _.Vector3).subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){return(e||new _.Vector3).set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},clampPoint:function(t,e){return(e||new _.Vector3).copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new _.Vector3;return function(e){return t.copy(e).clamp(this.min,this.max).sub(e).length()}}(),getBoundingSphere:function(){var t=new _.Vector3;return function(e){return e=e||new _.Sphere,e.center=this.center(),e.radius=.5*this.size(t).length(),e}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(){var t=[new _.Vector3,new _.Vector3,new _.Vector3,new _.Vector3,new _.Vector3,new _.Vector3,new _.Vector3,new _.Vector3];return function(e){return t[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),t[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),t[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),t[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),t[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),t[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),t[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),t[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.makeEmpty(),this.setFromPoints(t),this}}(),translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}},_.Matrix3=function(){this.elements=new Float32Array([1,0,0,0,1,0,0,0,1]),0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")},_.Matrix3.prototype={constructor:_.Matrix3,set:function(t,e,n,i,r,o,a,s,l){var u=this.elements;return u[0]=t,u[3]=e,u[6]=n,u[1]=i,u[4]=r,u[7]=o,u[2]=a,u[5]=s,u[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){return t=t.elements,this.set(t[0],t[3],t[6],t[1],t[4],t[7],t[2],t[5],t[8]),this},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(t){return console.warn("THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(t)},applyToVector3Array:function(){var t;return function(e,n,i){void 0===t&&(t=new _.Vector3),void 0===n&&(n=0),void 0===i&&(i=e.length);for(var r=0;r<i;r+=3,n+=3)t.fromArray(e,n),t.applyMatrix3(this),t.toArray(e,n);return e}}(),applyToBuffer:function(){var t;return function(e,n,i){void 0===t&&(t=new _.Vector3),void 0===n&&(n=0),void 0===i&&(i=e.length/e.itemSize);for(var r=0;r<i;r++,n++)t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.applyMatrix3(this),e.setXYZ(t.x,t.y,t.z);return e}}(),multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],o=t[4],a=t[5],s=t[6],l=t[7],t=t[8];return e*o*t-e*a*l-n*r*t+n*a*s+i*r*l-i*o*s},getInverse:function(t,e){var n=t.elements,i=this.elements;if(i[0]=n[10]*n[5]-n[6]*n[9],i[1]=-n[10]*n[1]+n[2]*n[9],i[2]=n[6]*n[1]-n[2]*n[5],i[3]=-n[10]*n[4]+n[6]*n[8],i[4]=n[10]*n[0]-n[2]*n[8],i[5]=-n[6]*n[0]+n[2]*n[4],i[6]=n[9]*n[4]-n[5]*n[8],i[7]=-n[9]*n[0]+n[1]*n[8],i[8]=n[5]*n[0]-n[1]*n[4],0===(n=n[0]*i[0]+n[1]*i[3]+n[2]*i[6])){if(e)throw Error("Matrix3.getInverse(): can't invert matrix, determinant is 0");return console.warn("Matrix3.getInverse(): can't invert matrix, determinant is 0"),this.identity(),this}return this.multiplyScalar(1/n),this},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},flattenToArrayOffset:function(t,e){var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t},getNormalMatrix:function(t){return this.getInverse(t).transpose(),this},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},fromArray:function(t){return this.elements.set(t),this},toArray:function(){var t=this.elements;return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]]}},_.Matrix4=function(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")},_.Matrix4.prototype={constructor:_.Matrix4,set:function(t,e,n,i,r,o,a,s,l,u,c,h,d,p,f,m){var v=this.elements;return v[0]=t,v[4]=e,v[8]=n,v[12]=i,v[1]=r,v[5]=o,v[9]=a,v[13]=s,v[2]=l,v[6]=u,v[10]=c,v[14]=h,v[3]=d,v[7]=p,v[11]=f,v[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new _.Matrix4).fromArray(this.elements)},copy:function(t){return this.elements.set(t.elements),this},extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},copyPosition:function(t){var e=this.elements;return t=t.elements,e[12]=t[12],e[13]=t[13],e[14]=t[14],this},extractBasis:function(t,e,n){var i=this.elements;return t.set(i[0],i[1],i[2]),e.set(i[4],i[5],i[6]),n.set(i[8],i[9],i[10]),this},makeBasis:function(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this},extractRotation:function(){var t;return function(e){void 0===t&&(t=new _.Vector3);var n=this.elements;e=e.elements;var i=1/t.set(e[0],e[1],e[2]).length(),r=1/t.set(e[4],e[5],e[6]).length(),o=1/t.set(e[8],e[9],e[10]).length();return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n[4]=e[4]*r,n[5]=e[5]*r,n[6]=e[6]*r,n[8]=e[8]*o,n[9]=e[9]*o,n[10]=e[10]*o,this}}(),makeRotationFromEuler:function(t){!1==t instanceof _.Euler&&console.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,n=t.x,i=t.y,r=t.z,o=Math.cos(n),n=Math.sin(n),a=Math.cos(i),i=Math.sin(i),s=Math.cos(r),r=Math.sin(r);if("XYZ"===t.order){t=o*s;var l=o*r,u=n*s,c=n*r;e[0]=a*s,e[4]=-a*r,e[8]=i,e[1]=l+u*i,e[5]=t-c*i,e[9]=-n*a,e[2]=c-t*i,e[6]=u+l*i,e[10]=o*a}else"YXZ"===t.order?(t=a*s,l=a*r,u=i*s,c=i*r,e[0]=t+c*n,e[4]=u*n-l,e[8]=o*i,e[1]=o*r,e[5]=o*s,e[9]=-n,e[2]=l*n-u,e[6]=c+t*n,e[10]=o*a):"ZXY"===t.order?(t=a*s,l=a*r,u=i*s,c=i*r,e[0]=t-c*n,e[4]=-o*r,e[8]=u+l*n,e[1]=l+u*n,e[5]=o*s,e[9]=c-t*n,e[2]=-o*i,e[6]=n,e[10]=o*a):"ZYX"===t.order?(t=o*s,l=o*r,u=n*s,c=n*r,e[0]=a*s,e[4]=u*i-l,e[8]=t*i+c,e[1]=a*r,e[5]=c*i+t,e[9]=l*i-u,e[2]=-i,e[6]=n*a,e[10]=o*a):"YZX"===t.order?(t=o*a,l=o*i,u=n*a,c=n*i,e[0]=a*s,e[4]=c-t*r,e[8]=u*r+l,e[1]=r,e[5]=o*s,e[9]=-n*s,e[2]=-i*s,e[6]=l*r+u,e[10]=t-c*r):"XZY"===t.order&&(t=o*a,l=o*i,u=n*a,c=n*i,e[0]=a*s,e[4]=-r,e[8]=i*s,e[1]=t*r+c,e[5]=o*s,e[9]=l*r-u,e[2]=u*r-l,e[6]=n*s,e[10]=c*r+t);return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},makeRotationFromQuaternion:function(t){var e=this.elements,n=t.x,i=t.y,r=t.z,o=t.w,a=n+n,s=i+i,l=r+r;t=n*a;var u=n*s,n=n*l,c=i*s,i=i*l,r=r*l,a=o*a,s=o*s,o=o*l;return e[0]=1-(c+r),e[4]=u-o,e[8]=n+s,e[1]=u+o,e[5]=1-(t+r),e[9]=i-a,e[2]=n-s,e[6]=i+a,e[10]=1-(t+c),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},lookAt:function(){var t,e,n;return function(i,r,o){void 0===t&&(t=new _.Vector3),void 0===e&&(e=new _.Vector3),void 0===n&&(n=new _.Vector3);var a=this.elements;return n.subVectors(i,r).normalize(),0===n.lengthSq()&&(n.z=1),t.crossVectors(o,n).normalize(),0===t.lengthSq()&&(n.x+=1e-4,t.crossVectors(o,n).normalize()),e.crossVectors(n,t),a[0]=t.x,a[4]=e.x,a[8]=n.x,a[1]=t.y,a[5]=e.y,a[9]=n.y,a[2]=t.z,a[6]=e.z,a[10]=n.z,this}}(),multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},multiplyMatrices:function(t,e){var n=t.elements,i=e.elements,r=this.elements,o=n[0],a=n[4],s=n[8],l=n[12],u=n[1],c=n[5],h=n[9],d=n[13],p=n[2],f=n[6],m=n[10],v=n[14],g=n[3],y=n[7],b=n[11],n=n[15],_=i[0],w=i[4],T=i[8],x=i[12],E=i[1],S=i[5],A=i[9],C=i[13],k=i[2],M=i[6],L=i[10],R=i[14],P=i[3],D=i[7],I=i[11],i=i[15];return r[0]=o*_+a*E+s*k+l*P,r[4]=o*w+a*S+s*M+l*D,r[8]=o*T+a*A+s*L+l*I,r[12]=o*x+a*C+s*R+l*i,r[1]=u*_+c*E+h*k+d*P,r[5]=u*w+c*S+h*M+d*D,r[9]=u*T+c*A+h*L+d*I,r[13]=u*x+c*C+h*R+d*i,r[2]=p*_+f*E+m*k+v*P,r[6]=p*w+f*S+m*M+v*D,r[10]=p*T+f*A+m*L+v*I,r[14]=p*x+f*C+m*R+v*i,r[3]=g*_+y*E+b*k+n*P,r[7]=g*w+y*S+b*M+n*D,r[11]=g*T+y*A+b*L+n*I,r[15]=g*x+y*C+b*R+n*i,this},multiplyToArray:function(t,e,n){var i=this.elements;return this.multiplyMatrices(t,e),n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead."),t.applyProjection(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(t){return console.warn("THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(t)},applyToVector3Array:function(){var t;return function(e,n,i){void 0===t&&(t=new _.Vector3),void 0===n&&(n=0),void 0===i&&(i=e.length);for(var r=0;r<i;r+=3,n+=3)t.fromArray(e,n),t.applyMatrix4(this),t.toArray(e,n);return e}}(),applyToBuffer:function(){var t;return function(e,n,i){void 0===t&&(t=new _.Vector3),void 0===n&&(n=0),void 0===i&&(i=e.length/e.itemSize);for(var r=0;r<i;r++,n++)t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.applyMatrix4(this),e.setXYZ(t.x,t.y,t.z);return e}}(),rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},determinant:function(){var t=this.elements,e=t[0],n=t[4],i=t[8],r=t[12],o=t[1],a=t[5],s=t[9],l=t[13],u=t[2],c=t[6],h=t[10],d=t[14];return t[3]*(+r*s*c-i*l*c-r*a*h+n*l*h+i*a*d-n*s*d)+t[7]*(+e*s*d-e*l*h+r*o*h-i*o*d+i*l*u-r*s*u)+t[11]*(+e*l*c-e*a*d-r*o*c+n*o*d+r*a*u-n*l*u)+t[15]*(-i*a*u-e*s*c+e*a*h+i*o*c-n*o*h+n*s*u)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},flattenToArrayOffset:function(t,e){var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t},getPosition:function(){var t;return function(){void 0===t&&(t=new _.Vector3),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");var e=this.elements;return t.set(e[12],e[13],e[14])}}(),setPosition:function(t){var e=this.elements;return e[12]=t.x,e[13]=t.y,e[14]=t.z,this},getInverse:function(t,e){var n=this.elements,i=t.elements,r=i[0],o=i[4],a=i[8],s=i[12],l=i[1],u=i[5],c=i[9],h=i[13],d=i[2],p=i[6],f=i[10],m=i[14],v=i[3],g=i[7],y=i[11],i=i[15];if(n[0]=c*m*g-h*f*g+h*p*y-u*m*y-c*p*i+u*f*i,n[4]=s*f*g-a*m*g-s*p*y+o*m*y+a*p*i-o*f*i,n[8]=a*h*g-s*c*g+s*u*y-o*h*y-a*u*i+o*c*i,n[12]=s*c*p-a*h*p-s*u*f+o*h*f+a*u*m-o*c*m,n[1]=h*f*v-c*m*v-h*d*y+l*m*y+c*d*i-l*f*i,n[5]=a*m*v-s*f*v+s*d*y-r*m*y-a*d*i+r*f*i,n[9]=s*c*v-a*h*v-s*l*y+r*h*y+a*l*i-r*c*i,n[13]=a*h*d-s*c*d+s*l*f-r*h*f-a*l*m+r*c*m,n[2]=u*m*v-h*p*v+h*d*g-l*m*g-u*d*i+l*p*i,n[6]=s*p*v-o*m*v-s*d*g+r*m*g+o*d*i-r*p*i,n[10]=o*h*v-s*u*v+s*l*g-r*h*g-o*l*i+r*u*i,n[14]=s*u*d-o*h*d-s*l*p+r*h*p+o*l*m-r*u*m,n[3]=c*p*v-u*f*v-c*d*g+l*f*g+u*d*y-l*p*y,n[7]=o*f*v-a*p*v+a*d*g-r*f*g-o*d*y+r*p*y,n[11]=a*u*v-o*c*v-a*l*g+r*c*g+o*l*y-r*u*y,n[15]=o*c*d-a*u*d+a*l*p-r*c*p-o*l*f+r*u*f,0===(n=r*n[0]+l*n[4]+d*n[8]+v*n[12])){if(e)throw Error("THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0");return console.warn("THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0"),this.identity(),this}return this.multiplyScalar(1/n),this},translate:function(t){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(t){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(t){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(t){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(t,e){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},scale:function(t){var e=this.elements,n=t.x,i=t.y;return t=t.z,e[0]*=n,e[4]*=i,e[8]*=t,e[1]*=n,e[5]*=i,e[9]*=t,e[2]*=n,e[6]*=i,e[10]*=t,e[3]*=n,e[7]*=i,e[11]*=t,this},getMaxScaleOnAxis:function(){var t=this.elements;return Math.sqrt(Math.max(t[0]*t[0]+t[1]*t[1]+t[2]*t[2],t[4]*t[4]+t[5]*t[5]+t[6]*t[6],t[8]*t[8]+t[9]*t[9]+t[10]*t[10]))},makeTranslation:function(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t);return t=Math.sin(t),this.set(1,0,0,0,0,e,-t,0,0,t,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t);return t=Math.sin(t),this.set(e,0,t,0,0,1,0,0,-t,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t);return t=Math.sin(t),this.set(e,-t,0,0,t,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var n=Math.cos(e),i=Math.sin(e),r=1-n,o=t.x,a=t.y,s=t.z,l=r*o,u=r*a;return this.set(l*o+n,l*a-i*s,l*s+i*a,0,l*a+i*s,u*a+n,u*s-i*o,0,l*s-i*a,u*s+i*o,r*s*s+n,0,0,0,0,1),this},makeScale:function(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this},compose:function(t,e,n){return this.makeRotationFromQuaternion(e),this.scale(n),this.setPosition(t),this},decompose:function(){var t,e;return function(n,i,r){void 0===t&&(t=new _.Vector3),void 0===e&&(e=new _.Matrix4);var o=this.elements,a=t.set(o[0],o[1],o[2]).length(),s=t.set(o[4],o[5],o[6]).length(),l=t.set(o[8],o[9],o[10]).length();0>this.determinant()&&(a=-a),n.x=o[12],n.y=o[13],n.z=o[14],e.elements.set(this.elements),n=1/a;var o=1/s,u=1/l;return e.elements[0]*=n,e.elements[1]*=n,e.elements[2]*=n,e.elements[4]*=o,e.elements[5]*=o,e.elements[6]*=o,e.elements[8]*=u,e.elements[9]*=u,e.elements[10]*=u,i.setFromRotationMatrix(e),r.x=a,r.y=s,r.z=l,this}}(),makeFrustum:function(t,e,n,i,r,o){var a=this.elements;return a[0]=2*r/(e-t),a[4]=0,a[8]=(e+t)/(e-t),a[12]=0,a[1]=0,a[5]=2*r/(i-n),a[9]=(i+n)/(i-n),a[13]=0,a[2]=0,a[6]=0,a[10]=-(o+r)/(o-r),a[14]=-2*o*r/(o-r),a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makePerspective:function(t,e,n,i){t=n*Math.tan(_.Math.degToRad(.5*t));var r=-t;return this.makeFrustum(r*e,t*e,r,t,n,i)},makeOrthographic:function(t,e,n,i,r,o){var a=this.elements,s=e-t,l=n-i,u=o-r;return a[0]=2/s,a[4]=0,a[8]=0,a[12]=-(e+t)/s,a[1]=0,a[5]=2/l,a[9]=0,a[13]=-(n+i)/l,a[2]=0,a[6]=0,a[10]=-2/u,a[14]=-(o+r)/u,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(t){var e=this.elements;t=t.elements;for(var n=0;16>n;n++)if(e[n]!==t[n])return!1;return!0},fromArray:function(t){return this.elements.set(t),this},toArray:function(){var t=this.elements;return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]]}},_.Ray=function(t,e){this.origin=void 0!==t?t:new _.Vector3,this.direction=void 0!==e?e:new _.Vector3},_.Ray.prototype={constructor:_.Ray,set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){return(e||new _.Vector3).copy(this.direction).multiplyScalar(t).add(this.origin)},recast:function(){var t=new _.Vector3;return function(e){return this.origin.copy(this.at(e,t)),this}}(),closestPointToPoint:function(t,e){var n=e||new _.Vector3;n.subVectors(t,this.origin);var i=n.dot(this.direction);return 0>i?n.copy(this.origin):n.copy(this.direction).multiplyScalar(i).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(){var t=new _.Vector3;return function(e){var n=t.subVectors(e,this.origin).dot(this.direction);return 0>n?this.origin.distanceToSquared(e):(t.copy(this.direction).multiplyScalar(n).add(this.origin),t.distanceToSquared(e))}}(),distanceSqToSegment:function(){var t=new _.Vector3,e=new _.Vector3,n=new _.Vector3;return function(i,r,o,a){t.copy(i).add(r).multiplyScalar(.5),e.copy(r).sub(i).normalize(),n.copy(this.origin).sub(t);var s,l=.5*i.distanceTo(r),u=-this.direction.dot(e),c=n.dot(this.direction),h=-n.dot(e),d=n.lengthSq(),p=Math.abs(1-u*u);return 0<p?(i=u*h-c,r=u*c-h,s=l*p,0<=i?r>=-s?r<=s?(l=1/p,i*=l,r*=l,u=i*(i+u*r+2*c)+r*(u*i+r+2*h)+d):(r=l,i=Math.max(0,-(u*r+c)),u=-i*i+r*(r+2*h)+d):(r=-l,i=Math.max(0,-(u*r+c)),u=-i*i+r*(r+2*h)+d):r<=-s?(i=Math.max(0,-(-u*l+c)),r=0<i?-l:Math.min(Math.max(-l,-h),l),u=-i*i+r*(r+2*h)+d):r<=s?(i=0,r=Math.min(Math.max(-l,-h),l),u=r*(r+2*h)+d):(i=Math.max(0,-(u*l+c)),r=0<i?l:Math.min(Math.max(-l,-h),l),u=-i*i+r*(r+2*h)+d)):(r=0<u?-l:l,i=Math.max(0,-(u*r+c)),u=-i*i+r*(r+2*h)+d),o&&o.copy(this.direction).multiplyScalar(i).add(this.origin),a&&a.copy(e).multiplyScalar(r).add(t),u}}(),isIntersectionSphere:function(t){return this.distanceToPoint(t.center)<=t.radius},intersectSphere:function(){var t=new _.Vector3;return function(e,n){t.subVectors(e.center,this.origin);var i=t.dot(this.direction),r=t.dot(t)-i*i,o=e.radius*e.radius;return r>o?null:(o=Math.sqrt(o-r),r=i-o,i+=o,0>r&&0>i?null:0>r?this.at(i,n):this.at(r,n))}}(),isIntersectionPlane:function(t){var e=t.distanceToPoint(this.origin);return 0===e||0>t.normal.dot(this.direction)*e},distanceToPlane:function(t){var e=t.normal.dot(this.direction);return 0===e?0===t.distanceToPoint(this.origin)?0:null:(t=-(this.origin.dot(t.normal)+t.constant)/e,0<=t?t:null)},intersectPlane:function(t,e){var n=this.distanceToPlane(t);return null===n?null:this.at(n,e)},isIntersectionBox:function(){var t=new _.Vector3;return function(e){return null!==this.intersectBox(e,t)}}(),intersectBox:function(t,e){var n,i,r,o,a;i=1/this.direction.x,o=1/this.direction.y,a=1/this.direction.z;var s=this.origin;return 0<=i?(n=(t.min.x-s.x)*i,i*=t.max.x-s.x):(n=(t.max.x-s.x)*i,i*=t.min.x-s.x),0<=o?(r=(t.min.y-s.y)*o,o*=t.max.y-s.y):(r=(t.max.y-s.y)*o,o*=t.min.y-s.y),n>o||r>i?null:((r>n||n!==n)&&(n=r),(o<i||i!==i)&&(i=o),0<=a?(r=(t.min.z-s.z)*a,a*=t.max.z-s.z):(r=(t.max.z-s.z)*a,a*=t.min.z-s.z),n>a||r>i?null:((r>n||n!==n)&&(n=r),(a<i||i!==i)&&(i=a),0>i?null:this.at(0<=n?n:i,e)))},intersectTriangle:function(){var t=new _.Vector3,e=new _.Vector3,n=new _.Vector3,i=new _.Vector3;return function(r,o,a,s,l){if(e.subVectors(o,r),n.subVectors(a,r),i.crossVectors(e,n),0<(o=this.direction.dot(i))){if(s)return null;s=1}else{if(!(0>o))return null;s=-1,o=-o}return t.subVectors(this.origin,r),0>(r=s*this.direction.dot(n.crossVectors(t,n)))?null:0>(a=s*this.direction.dot(e.cross(t)))||r+a>o?null:(r=-s*t.dot(i),0>r?null:this.at(r/o,l))}}(),applyMatrix4:function(t){return this.direction.add(this.origin).applyMatrix4(t),this.origin.applyMatrix4(t),this.direction.sub(this.origin),this.direction.normalize(),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}},_.Sphere=function(t,e){this.center=void 0!==t?t:new _.Vector3,this.radius=void 0!==e?e:0},_.Sphere.prototype={constructor:_.Sphere,set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:function(){var t=new _.Box3;return function(e,n){var i=this.center;void 0!==n?i.copy(n):t.setFromPoints(e).center(i);for(var r=0,o=0,a=e.length;o<a;o++)r=Math.max(r,i.distanceToSquared(e[o]));return this.radius=Math.sqrt(r),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return 0>=this.radius},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},clampPoint:function(t,e){var n=this.center.distanceToSquared(t),i=e||new _.Vector3;return i.copy(t),n>this.radius*this.radius&&(i.sub(this.center).normalize(),i.multiplyScalar(this.radius).add(this.center)),i},getBoundingBox:function(t){return t=t||new _.Box3,t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius*=t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}},_.Frustum=function(t,e,n,i,r,o){this.planes=[void 0!==t?t:new _.Plane,void 0!==e?e:new _.Plane,void 0!==n?n:new _.Plane,void 0!==i?i:new _.Plane,void 0!==r?r:new _.Plane,void 0!==o?o:new _.Plane]},_.Frustum.prototype={constructor:_.Frustum,set:function(t,e,n,i,r,o){var a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(n),a[3].copy(i),a[4].copy(r),a[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){for(var e=this.planes,n=0;6>n;n++)e[n].copy(t.planes[n]);return this},setFromMatrix:function(t){var e=this.planes,n=t.elements;t=n[0];var i=n[1],r=n[2],o=n[3],a=n[4],s=n[5],l=n[6],u=n[7],c=n[8],h=n[9],d=n[10],p=n[11],f=n[12],m=n[13],v=n[14],n=n[15];return e[0].setComponents(o-t,u-a,p-c,n-f).normalize(),e[1].setComponents(o+t,u+a,p+c,n+f).normalize(),e[2].setComponents(o+i,u+s,p+h,n+m).normalize(),e[3].setComponents(o-i,u-s,p-h,n-m).normalize(),e[4].setComponents(o-r,u-l,p-d,n-v).normalize(),e[5].setComponents(o+r,u+l,p+d,n+v).normalize(),this},intersectsObject:function(){var t=new _.Sphere;return function(e){var n=e.geometry;return null===n.boundingSphere&&n.computeBoundingSphere(),t.copy(n.boundingSphere),t.applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSphere:function(t){var e=this.planes,n=t.center;t=-t.radius;for(var i=0;6>i;i++)if(e[i].distanceToPoint(n)<t)return!1;return!0},intersectsBox:function(){var t=new _.Vector3,e=new _.Vector3;return function(n){for(var i=this.planes,r=0;6>r;r++){var o=i[r];t.x=0<o.normal.x?n.min.x:n.max.x,e.x=0<o.normal.x?n.max.x:n.min.x,t.y=0<o.normal.y?n.min.y:n.max.y,e.y=0<o.normal.y?n.max.y:n.min.y,t.z=0<o.normal.z?n.min.z:n.max.z,e.z=0<o.normal.z?n.max.z:n.min.z;var a=o.distanceToPoint(t),o=o.distanceToPoint(e);if(0>a&&0>o)return!1}return!0}}(),containsPoint:function(t){for(var e=this.planes,n=0;6>n;n++)if(0>e[n].distanceToPoint(t))return!1;return!0}},_.Plane=function(t,e){this.normal=void 0!==t?t:new _.Vector3(1,0,0),this.constant=void 0!==e?e:0},_.Plane.prototype={constructor:_.Plane,set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,n,i){return this.normal.set(t,e,n),this.constant=i,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(){var t=new _.Vector3,e=new _.Vector3;return function(n,i,r){return i=t.subVectors(r,i).cross(e.subVectors(n,i)).normalize(),this.setFromNormalAndCoplanarPoint(i,n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return this.orthoPoint(t,e).sub(t).negate()},orthoPoint:function(t,e){var n=this.distanceToPoint(t);return(e||new _.Vector3).copy(this.normal).multiplyScalar(n)},isIntersectionLine:function(t){var e=this.distanceToPoint(t.start);return t=this.distanceToPoint(t.end),0>e&&0<t||0>t&&0<e},intersectLine:function(){var t=new _.Vector3;return function(e,n){var i=n||new _.Vector3,r=e.delta(t),o=this.normal.dot(r);return 0!==o?(o=-(e.start.dot(this.normal)+this.constant)/o,0>o||1<o?void 0:i.copy(r).multiplyScalar(o).add(e.start)):0===this.distanceToPoint(e.start)?i.copy(e.start):void 0}}(),coplanarPoint:function(t){return(t||new _.Vector3).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var t=new _.Vector3,e=new _.Vector3,n=new _.Matrix3;return function(i,r){var o=r||n.getNormalMatrix(i),o=t.copy(this.normal).applyMatrix3(o),a=this.coplanarPoint(e);return a.applyMatrix4(i),this.setFromNormalAndCoplanarPoint(o,a),this}}(),translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}},_.Math={generateUUID:function(){var t,e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),n=Array(36),i=0;return function(){for(var r=0;36>r;r++)8===r||13===r||18===r||23===r?n[r]="-":14===r?n[r]="4":(2>=i&&(i=33554432+16777216*Math.random()|0),t=15&i,i>>=4,n[r]=e[19===r?3&t|8:t]);return n.join("")}}(),clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(){var t=Math.PI/180;return function(e){return e*t}}(),radToDeg:function(){var t=180/Math.PI;return function(e){return e*t}}(),isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},nearestPowerOfTwo:function(t){return Math.pow(2,Math.round(Math.log(t)/Math.LN2))},nextPowerOfTwo:function(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t}},_.Spline=function(t){function e(t,e,n,i,r,o,a){return t=.5*(n-t),i=.5*(i-e),(2*(e-n)+t+i)*a+(-3*(e-n)-2*t-i)*o+t*r+e}this.points=t;var n,i,r,o,a,s,l,u,c,h=[],d={x:0,y:0,z:0};this.initFromArray=function(t){this.points=[];for(var e=0;e<t.length;e++)this.points[e]={x:t[e][0],y:t[e][1],z:t[e][2]}},this.getPoint=function(t){return n=(this.points.length-1)*t,i=Math.floor(n),r=n-i,h[0]=0===i?i:i-1,h[1]=i,h[2]=i>this.points.length-2?this.points.length-1:i+1,h[3]=i>this.points.length-3?this.points.length-1:i+2,s=this.points[h[0]],l=this.points[h[1]],u=this.points[h[2]],c=this.points[h[3]],o=r*r,a=r*o,d.x=e(s.x,l.x,u.x,c.x,r,o,a),d.y=e(s.y,l.y,u.y,c.y,r,o,a),d.z=e(s.z,l.z,u.z,c.z,r,o,a),d},this.getControlPointsArray=function(){var t,e,n=this.points.length,i=[];for(t=0;t<n;t++)e=this.points[t],i[t]=[e.x,e.y,e.z];return i},this.getLength=function(t){var e,n,i,r=e=e=0,o=new _.Vector3,a=new _.Vector3,s=[],l=0;for(s[0]=0,t||(t=100),n=this.points.length*t,o.copy(this.points[0]),t=1;t<n;t++)e=t/n,i=this.getPoint(e),a.copy(i),l+=a.distanceTo(o),o.copy(i),e*=this.points.length-1,(e=Math.floor(e))!==r&&(s[e]=l,r=e);return s[s.length]=l,{chunks:s,total:l}},this.reparametrizeByArcLength=function(t){var e,n,i,r,o,a,s=[],l=new _.Vector3,u=this.getLength();for(s.push(l.copy(this.points[0]).clone()),e=1;e<this.points.length;e++){for(n=u.chunks[e]-u.chunks[e-1],a=Math.ceil(t*n/u.total),r=(e-1)/(this.points.length-1),o=e/(this.points.length-1),n=1;n<a-1;n++)i=r+1/a*n*(o-r),i=this.getPoint(i),s.push(l.copy(i).clone());s.push(l.copy(this.points[e]).clone())}this.points=s}},_.Triangle=function(t,e,n){this.a=void 0!==t?t:new _.Vector3,this.b=void 0!==e?e:new _.Vector3,this.c=void 0!==n?n:new _.Vector3},_.Triangle.normal=function(){var t=new _.Vector3;return function(e,n,i,r){return r=r||new _.Vector3,r.subVectors(i,n),t.subVectors(e,n),r.cross(t),e=r.lengthSq(),0<e?r.multiplyScalar(1/Math.sqrt(e)):r.set(0,0,0)}}(),_.Triangle.barycoordFromPoint=function(){var t=new _.Vector3,e=new _.Vector3,n=new _.Vector3;return function(i,r,o,a,s){t.subVectors(a,r),e.subVectors(o,r),n.subVectors(i,r),i=t.dot(t),r=t.dot(e),o=t.dot(n);var l=e.dot(e);a=e.dot(n);var u=i*l-r*r;return s=s||new _.Vector3,0===u?s.set(-2,-1,-1):(u=1/u,l=(l*o-r*a)*u,i=(i*a-r*o)*u,s.set(1-l-i,i,l))}}(),_.Triangle.containsPoint=function(){var t=new _.Vector3;return function(e,n,i,r){return e=_.Triangle.barycoordFromPoint(e,n,i,r,t),0<=e.x&&0<=e.y&&1>=e.x+e.y}}(),_.Triangle.prototype={constructor:_.Triangle,set:function(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this},setFromPointsAndIndices:function(t,e,n,i){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[i]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},area:function(){var t=new _.Vector3,e=new _.Vector3;return function(){return t.subVectors(this.c,this.b),e.subVectors(this.a,this.b),.5*t.cross(e).length()}}(),midpoint:function(t){return(t||new _.Vector3).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(t){return _.Triangle.normal(this.a,this.b,this.c,t)},plane:function(t){return(t||new _.Plane).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(t,e){return _.Triangle.barycoordFromPoint(t,this.a,this.b,this.c,e)},containsPoint:function(t){return _.Triangle.containsPoint(t,this.a,this.b,this.c)},equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}},_.Channels=function(){this.mask=1},_.Channels.prototype={constructor:_.Channels,set:function(t){this.mask=1<<t},enable:function(t){this.mask|=1<<t},toggle:function(t){this.mask^=1<<t},disable:function(t){this.mask&=~(1<<t)}},_.Clock=function(t){this.autoStart=void 0===t||t,this.elapsedTime=this.oldTime=this.startTime=0,this.running=!1},_.Clock.prototype={constructor:_.Clock,start:function(){this.oldTime=this.startTime=self.performance.now(),this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running&&this.start(),this.running){var e=self.performance.now(),t=.001*(e-this.oldTime);this.oldTime=e,this.elapsedTime+=t}return t}},_.EventDispatcher=function(){},_.EventDispatcher.prototype={constructor:_.EventDispatcher,apply:function(t){t.addEventListener=_.EventDispatcher.prototype.addEventListener,t.hasEventListener=_.EventDispatcher.prototype.hasEventListener,t.removeEventListener=_.EventDispatcher.prototype.removeEventListener,t.dispatchEvent=_.EventDispatcher.prototype.dispatchEvent},addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)},removeEventListener:function(t,e){if(void 0!==this._listeners){var n=this._listeners[t];if(void 0!==n){var i=n.indexOf(e);-1!==i&&n.splice(i,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var n=[],i=e.length,r=0;r<i;r++)n[r]=e[r];for(r=0;r<i;r++)n[r].call(this,t)}}}},function(t){function e(t,e){return t.distance-e.distance}function n(t,e,i,r){if(!1!==t.visible&&(t.raycast(e,i),!0===r)){t=t.children,r=0;for(var o=t.length;r<o;r++)n(t[r],e,i,!0)}}t.Raycaster=function(e,n,i,r){this.ray=new t.Ray(e,n),this.near=i||0,this.far=r||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},(0,p.default)(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})},t.Raycaster.prototype={constructor:t.Raycaster,linePrecision:1,set:function(t,e){this.ray.set(t,e)},setFromCamera:function(e,n){n instanceof t.PerspectiveCamera?(this.ray.origin.setFromMatrixPosition(n.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(n).sub(this.ray.origin).normalize()):n instanceof t.OrthographicCamera?(this.ray.origin.set(e.x,e.y,-1).unproject(n),this.ray.direction.set(0,0,-1).transformDirection(n.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,i){var r=[];return n(t,this,r,i),r.sort(e),r},intersectObjects:function(t,i){var r=[];if(!1===Array.isArray(t))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),r;for(var o=0,a=t.length;o<a;o++)n(t[o],this,r,i);return r.sort(e),r}}}(_),_.Object3D=function(){Object.defineProperty(this,"id",{value:_.Object3DIdCount++}),this.uuid=_.Math.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.channels=new _.Channels,this.children=[],this.up=_.Object3D.DefaultUp.clone();var t=new _.Vector3,e=new _.Euler,n=new _.Quaternion,i=new _.Vector3(1,1,1);e.onChange(function(){n.setFromEuler(e,!1)}),n.onChange(function(){e.setFromQuaternion(n,void 0,!1)}),(0,p.default)(this,{position:{enumerable:!0,value:t},rotation:{enumerable:!0,value:e},quaternion:{enumerable:!0,value:n},scale:{enumerable:!0,value:i},modelViewMatrix:{value:new _.Matrix4},normalMatrix:{value:new _.Matrix3}}),this.rotationAutoUpdate=!0,this.matrix=new _.Matrix4,this.matrixWorld=new _.Matrix4,this.matrixAutoUpdate=_.Object3D.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.visible=!0,this.receiveShadow=this.castShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}},_.Object3D.DefaultUp=new _.Vector3(0,1,0),_.Object3D.DefaultMatrixAutoUpdate=!0,_.Object3D.prototype={constructor:_.Object3D,get eulerOrder(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set eulerOrder(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t},get useQuaternion(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set useQuaternion(t){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set renderDepth(t){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},applyMatrix:function(t){this.matrix.multiplyMatrices(t,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(){var t=new _.Quaternion;return function(e,n){return t.setFromAxisAngle(e,n),this.quaternion.multiply(t),this}}(),rotateX:function(){var t=new _.Vector3(1,0,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateY:function(){var t=new _.Vector3(0,1,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateZ:function(){var t=new _.Vector3(0,0,1);return function(e){return this.rotateOnAxis(t,e)}}(),translateOnAxis:function(){var t=new _.Vector3;return function(e,n){return t.copy(e).applyQuaternion(this.quaternion),this.position.add(t.multiplyScalar(n)),this}}(),translate:function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)},translateX:function(){var t=new _.Vector3(1,0,0);return function(e){return this.translateOnAxis(t,e)}}(),translateY:function(){var t=new _.Vector3(0,1,0);return function(e){return this.translateOnAxis(t,e)}}(),translateZ:function(){var t=new _.Vector3(0,0,1);return function(e){return this.translateOnAxis(t,e)}}(),localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var t=new _.Matrix4;return function(e){return e.applyMatrix4(t.getInverse(this.matrixWorld))}}(),lookAt:function(){var t=new _.Matrix4;return function(e){t.lookAt(e,this.position,this.up),this.quaternion.setFromRotationMatrix(t)}}(),add:function(t){if(1<arguments.length){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t instanceof _.Object3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,t.dispatchEvent({type:"added"}),this.children.push(t)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(1<arguments.length)for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);-1!==(e=this.children.indexOf(t))&&(t.parent=null,t.dispatchEvent({type:"removed"}),this.children.splice(e,1))},getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var n=0,i=this.children.length;n<i;n++){var r=this.children[n].getObjectByProperty(t,e);if(void 0!==r)return r}},getWorldPosition:function(t){return t=t||new _.Vector3,this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var t=new _.Vector3,e=new _.Vector3;return function(n){return n=n||new _.Quaternion,this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,n,e),n}}(),getWorldRotation:function(){var t=new _.Quaternion;return function(e){return e=e||new _.Euler,this.getWorldQuaternion(t),e.setFromQuaternion(t,this.rotation.order,!1)}}(),getWorldScale:function(){var t=new _.Vector3,e=new _.Quaternion;return function(n){return n=n||new _.Vector3,this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,e,n),n}}(),getWorldDirection:function(){var t=new _.Quaternion;return function(e){return e=e||new _.Vector3,this.getWorldQuaternion(t),e.set(0,0,1).applyQuaternion(t)}}(),raycast:function(){},traverse:function(t){t(this);for(var e=this.children,n=0,i=e.length;n<i;n++)e[n].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,n=0,i=e.length;n<i;n++)e[n].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){!0===this.matrixAutoUpdate&&this.updateMatrix(),!0!==this.matrixWorldNeedsUpdate&&!0!==t||(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=0,n=this.children.length;e<n;e++)this.children[e].updateMatrixWorld(t)},toJSON:function(t){function e(t){var e,n=[];for(e in t){var i=t[e];delete i.metadata,n.push(i)}return n}var n=void 0===t,i={};n&&(t={geometries:{},materials:{},textures:{},images:{}},i.metadata={version:4.4,type:"Object",generator:"Object3D.toJSON"});var r={};if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),"{}"!==(0,h.default)(this.userData)&&(r.userData=this.userData),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),r.matrix=this.matrix.toArray(),void 0!==this.geometry&&(void 0===t.geometries[this.geometry.uuid]&&(t.geometries[this.geometry.uuid]=this.geometry.toJSON(t)),r.geometry=this.geometry.uuid),void 0!==this.material&&(void 0===t.materials[this.material.uuid]&&(t.materials[this.material.uuid]=this.material.toJSON(t)),r.material=this.material.uuid),0<this.children.length){r.children=[];for(var o=0;o<this.children.length;o++)r.children.push(this.children[o].toJSON(t).object)}if(n){var n=e(t.geometries),o=e(t.materials),a=e(t.textures);t=e(t.images),0<n.length&&(i.geometries=n),0<o.length&&(i.materials=o),0<a.length&&(i.textures=a),0<t.length&&(i.images=t)}return i.object=r,i},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.rotationAutoUpdate=t.rotationAutoUpdate,this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse((0,h.default)(t.userData)),!0===e)for(var n=0;n<t.children.length;n++)this.add(t.children[n].clone());return this}},_.EventDispatcher.prototype.apply(_.Object3D.prototype),_.Object3DIdCount=0,_.Face3=function(t,e,n,i,r,o){this.a=t,this.b=e,this.c=n,this.normal=i instanceof _.Vector3?i:new _.Vector3,this.vertexNormals=Array.isArray(i)?i:[],this.color=r instanceof _.Color?r:new _.Color,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=void 0!==o?o:0},_.Face3.prototype={constructor:_.Face3,clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,n=t.vertexNormals.length;e<n;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(e=0,n=t.vertexColors.length;e<n;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}},_.Face4=function(t,e,n,i,r,o,a){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new _.Face3(t,e,n,r,o,a)},_.BufferAttribute=function(t,e){this.uuid=_.Math.generateUUID(),this.array=t,this.itemSize=e,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0},_.BufferAttribute.prototype={constructor:_.BufferAttribute,get length(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Please use .count."),this.array.length},get count(){return this.array.length/this.itemSize},set needsUpdate(t){!0===t&&this.version++},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.dynamic=t.dynamic,this},copyAt:function(t,e,n){t*=this.itemSize,n*=e.itemSize;for(var i=0,r=this.itemSize;i<r;i++)this.array[t+i]=e.array[n+i];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var o=t[i];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),o=new _.Color),e[n++]=o.r,e[n++]=o.g,e[n++]=o.b}return this},copyIndicesArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var o=t[i];e[n++]=o.a,e[n++]=o.b,e[n++]=o.c}return this},copyVector2sArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var o=t[i];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),o=new _.Vector2),e[n++]=o.x,e[n++]=o.y}return this},copyVector3sArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var o=t[i];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),o=new _.Vector3),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z}return this},copyVector4sArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var o=t[i];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),o=new _.Vector4),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z,e[n++]=o.w}return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this},setXYZ:function(t,e,n,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this},setXYZW:function(t,e,n,i,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this.array[t+3]=r,this},clone:function(){return(new this.constructor).copy(this)}},_.Int8Attribute=function(t,e){return new _.BufferAttribute(new Int8Array(t),e)},_.Uint8Attribute=function(t,e){return new _.BufferAttribute(new Uint8Array(t),e)},_.Uint8ClampedAttribute=function(t,e){return new _.BufferAttribute(new Uint8ClampedArray(t),e)},_.Int16Attribute=function(t,e){return new _.BufferAttribute(new Int16Array(t),e)},_.Uint16Attribute=function(t,e){return new _.BufferAttribute(new Uint16Array(t),e)},_.Int32Attribute=function(t,e){return new _.BufferAttribute(new Int32Array(t),e)},_.Uint32Attribute=function(t,e){return new _.BufferAttribute(new Uint32Array(t),e)},_.Float32Attribute=function(t,e){return new _.BufferAttribute(new Float32Array(t),e)},_.Float64Attribute=function(t,e){return new _.BufferAttribute(new Float64Array(t),e)},_.DynamicBufferAttribute=function(t,e){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new _.BufferAttribute(t,e).setDynamic(!0)},_.InstancedBufferAttribute=function(t,e,n){_.BufferAttribute.call(this,t,e),this.meshPerAttribute=n||1},_.InstancedBufferAttribute.prototype=(0,u.default)(_.BufferAttribute.prototype),_.InstancedBufferAttribute.prototype.constructor=_.InstancedBufferAttribute,_.InstancedBufferAttribute.prototype.copy=function(t){return _.BufferAttribute.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},_.InterleavedBuffer=function(t,e){this.uuid=_.Math.generateUUID(),this.array=t,this.stride=e,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0},_.InterleavedBuffer.prototype={constructor:_.InterleavedBuffer,get length(){return this.array.length},get count(){return this.array.length/this.stride},set needsUpdate(t){!0===t&&this.version++},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){this.array=new t.array.constructor(t.array),this.stride=t.stride,this.dynamic=t.dynamic},copyAt:function(t,e,n){t*=this.stride,n*=e.stride;for(var i=0,r=this.stride;i<r;i++)this.array[t+i]=e.array[n+i];return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},clone:function(){return(new this.constructor).copy(this)}},_.InstancedInterleavedBuffer=function(t,e,n){_.InterleavedBuffer.call(this,t,e),this.meshPerAttribute=n||1},_.InstancedInterleavedBuffer.prototype=(0,u.default)(_.InterleavedBuffer.prototype),_.InstancedInterleavedBuffer.prototype.constructor=_.InstancedInterleavedBuffer,_.InstancedInterleavedBuffer.prototype.copy=function(t){return _.InterleavedBuffer.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},_.InterleavedBufferAttribute=function(t,e,n){this.uuid=_.Math.generateUUID(),this.data=t,this.itemSize=e,this.offset=n},_.InterleavedBufferAttribute.prototype={constructor:_.InterleavedBufferAttribute,get length(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Please use .count."),this.array.length},get count(){return this.data.array.length/this.data.stride},setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this},setXYZ:function(t,e,n,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this},setXYZW:function(t,e,n,i,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this.data.array[t+3]=r,this}},_.Geometry=function(){Object.defineProperty(this,"id",{value:_.GeometryIdCount++}),this.uuid=_.Math.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.elementsNeedUpdate=this.verticesNeedUpdate=!1},_.Geometry.prototype={constructor:_.Geometry,applyMatrix:function(t){for(var e=(new _.Matrix3).getNormalMatrix(t),n=0,i=this.vertices.length;n<i;n++)this.vertices[n].applyMatrix4(t);for(n=0,i=this.faces.length;n<i;n++){t=this.faces[n],t.normal.applyMatrix3(e).normalize();for(var r=0,o=t.vertexNormals.length;r<o;r++)t.vertexNormals[r].applyMatrix3(e).normalize()}null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.normalsNeedUpdate=this.verticesNeedUpdate=!0},rotateX:function(){var t;return function(e){return void 0===t&&(t=new _.Matrix4),t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t;return function(e){return void 0===t&&(t=new _.Matrix4),t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t;return function(e){return void 0===t&&(t=new _.Matrix4),t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t;return function(e,n,i){return void 0===t&&(t=new _.Matrix4),t.makeTranslation(e,n,i),this.applyMatrix(t),this}}(),scale:function(){var t;return function(e,n,i){return void 0===t&&(t=new _.Matrix4),t.makeScale(e,n,i),this.applyMatrix(t),this}}(),lookAt:function(){var t;return function(e){void 0===t&&(t=new _.Object3D),t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),fromBufferGeometry:function(t){function e(t,e,i){var r=void 0!==a?[c[t].clone(),c[e].clone(),c[i].clone()]:[],o=void 0!==s?[n.colors[t].clone(),n.colors[e].clone(),n.colors[i].clone()]:[],r=new _.Face3(t,e,i,r,o);n.faces.push(r),void 0!==l&&n.faceVertexUvs[0].push([h[t].clone(),h[e].clone(),h[i].clone()]),void 0!==u&&n.faceVertexUvs[1].push([d[t].clone(),d[e].clone(),d[i].clone()])}var n=this,i=null!==t.index?t.index.array:void 0,r=t.attributes,o=r.position.array,a=void 0!==r.normal?r.normal.array:void 0,s=void 0!==r.color?r.color.array:void 0,l=void 0!==r.uv?r.uv.array:void 0,u=void 0!==r.uv2?r.uv2.array:void 0;void 0!==u&&(this.faceVertexUvs[1]=[]);for(var c=[],h=[],d=[],p=r=0;r<o.length;r+=3,p+=2)n.vertices.push(new _.Vector3(o[r],o[r+1],o[r+2])),void 0!==a&&c.push(new _.Vector3(a[r],a[r+1],a[r+2])),void 0!==s&&n.colors.push(new _.Color(s[r],s[r+1],s[r+2])),void 0!==l&&h.push(new _.Vector2(l[p],l[p+1])),void 0!==u&&d.push(new _.Vector2(u[p],u[p+1]));if(void 0!==i)if(o=t.groups,0<o.length)for(r=0;r<o.length;r++)for(var p=o[r],f=p.start,m=p.count,p=f,f=f+m;p<f;p+=3)e(i[p],i[p+1],i[p+2]);else for(r=0;r<i.length;r+=3)e(i[r],i[r+1],i[r+2]);else for(r=0;r<o.length/3;r+=3)e(r,r+1,r+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var t=this.boundingBox.center().negate();return this.translate(t.x,t.y,t.z),t},normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=this.boundingSphere.radius,e=0===e?1:1/e,n=new _.Matrix4;return n.set(e,0,0,-e*t.x,0,e,0,-e*t.y,0,0,e,-e*t.z,0,0,0,1),this.applyMatrix(n),this},computeFaceNormals:function(){for(var t=new _.Vector3,e=new _.Vector3,n=0,i=this.faces.length;n<i;n++){var r=this.faces[n],o=this.vertices[r.a],a=this.vertices[r.b];t.subVectors(this.vertices[r.c],a),e.subVectors(o,a),t.cross(e),t.normalize(),r.normal.copy(t)}},computeVertexNormals:function(t){var e,n,i;for(i=Array(this.vertices.length),e=0,n=this.vertices.length;e<n;e++)i[e]=new _.Vector3;if(t){var r,o,a,s=new _.Vector3,l=new _.Vector3;for(t=0,e=this.faces.length;t<e;t++)n=this.faces[t],r=this.vertices[n.a],o=this.vertices[n.b],a=this.vertices[n.c],s.subVectors(a,o),l.subVectors(r,o),s.cross(l),i[n.a].add(s),i[n.b].add(s),i[n.c].add(s)}else for(t=0,e=this.faces.length;t<e;t++)n=this.faces[t],i[n.a].add(n.normal),i[n.b].add(n.normal),i[n.c].add(n.normal);for(e=0,n=this.vertices.length;e<n;e++)i[e].normalize();for(t=0,e=this.faces.length;t<e;t++)n=this.faces[t],r=n.vertexNormals,3===r.length?(r[0].copy(i[n.a]),r[1].copy(i[n.b]),r[2].copy(i[n.c])):(r[0]=i[n.a].clone(),r[1]=i[n.b].clone(),r[2]=i[n.c].clone())},computeMorphNormals:function(){var t,e,n,i,r;for(n=0,i=this.faces.length;n<i;n++)for(r=this.faces[n],r.__originalFaceNormal?r.__originalFaceNormal.copy(r.normal):r.__originalFaceNormal=r.normal.clone(),r.__originalVertexNormals||(r.__originalVertexNormals=[]),t=0,e=r.vertexNormals.length;t<e;t++)r.__originalVertexNormals[t]?r.__originalVertexNormals[t].copy(r.vertexNormals[t]):r.__originalVertexNormals[t]=r.vertexNormals[t].clone();var o=new _.Geometry;for(o.faces=this.faces,t=0,e=this.morphTargets.length;t<e;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[],r=this.morphNormals[t].faceNormals;var a,s,l=this.morphNormals[t].vertexNormals;for(n=0,i=this.faces.length;n<i;n++)a=new _.Vector3,s={a:new _.Vector3,b:new _.Vector3,c:new _.Vector3},r.push(a),l.push(s)}for(l=this.morphNormals[t],o.vertices=this.morphTargets[t].vertices,o.computeFaceNormals(),o.computeVertexNormals(),n=0,i=this.faces.length;n<i;n++)r=this.faces[n],a=l.faceNormals[n],s=l.vertexNormals[n],a.copy(r.normal),s.a.copy(r.vertexNormals[0]),s.b.copy(r.vertexNormals[1]),s.c.copy(r.vertexNormals[2])}for(n=0,i=this.faces.length;n<i;n++)r=this.faces[n],r.normal=r.__originalFaceNormal,r.vertexNormals=r.__originalVertexNormals},computeTangents:function(){console.warn("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){for(var t=0,e=this.vertices,n=0,i=e.length;n<i;n++)0<n&&(t+=e[n].distanceTo(e[n-1])),this.lineDistances[n]=t},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new _.Box3),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new _.Sphere),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,n){if(!1==t instanceof _.Geometry)console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t);else{var i,r=this.vertices.length,o=this.vertices,a=t.vertices,s=this.faces,l=t.faces,u=this.faceVertexUvs[0];t=t.faceVertexUvs[0],void 0===n&&(n=0),void 0!==e&&(i=(new _.Matrix3).getNormalMatrix(e));for(var c=0,h=a.length;c<h;c++){var d=a[c].clone();void 0!==e&&d.applyMatrix4(e),o.push(d)}for(c=0,h=l.length;c<h;c++){var p,a=l[c],f=a.vertexNormals,m=a.vertexColors,d=new _.Face3(a.a+r,a.b+r,a.c+r);for(d.normal.copy(a.normal),void 0!==i&&d.normal.applyMatrix3(i).normalize(),e=0,o=f.length;e<o;e++)p=f[e].clone(),void 0!==i&&p.applyMatrix3(i).normalize(),d.vertexNormals.push(p);for(d.color.copy(a.color),e=0,o=m.length;e<o;e++)p=m[e],d.vertexColors.push(p.clone());d.materialIndex=a.materialIndex+n,s.push(d)}for(c=0,h=t.length;c<h;c++)if(n=t[c],i=[],void 0!==n){for(e=0,o=n.length;e<o;e++)i.push(n[e].clone());u.push(i)}}},mergeMesh:function(t){!1==t instanceof _.Mesh?console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t):(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix))},mergeVertices:function(){var t,e,n,i={},r=[],o=[],a=Math.pow(10,4);for(e=0,n=this.vertices.length;e<n;e++)t=this.vertices[e],t=Math.round(t.x*a)+"_"+Math.round(t.y*a)+"_"+Math.round(t.z*a),void 0===i[t]?(i[t]=e,r.push(this.vertices[e]),o[e]=r.length-1):o[e]=o[i[t]];for(i=[],e=0,n=this.faces.length;e<n;e++)for(a=this.faces[e],a.a=o[a.a],a.b=o[a.b],a.c=o[a.c],a=[a.a,a.b,a.c],t=0;3>t;t++)if(a[t]===a[(t+1)%3]){i.push(e);break}for(e=i.length-1;0<=e;e--)for(a=i[e],this.faces.splice(a,1),o=0,n=this.faceVertexUvs.length;o<n;o++)this.faceVertexUvs[o].splice(a,1);return e=this.vertices.length-r.length,this.vertices=r,e},sortFacesByMaterialIndex:function(){for(var t=this.faces,e=t.length,n=0;n<e;n++)t[n]._id=n;t.sort(function(t,e){return t.materialIndex-e.materialIndex});var i,r,o=this.faceVertexUvs[0],a=this.faceVertexUvs[1];for(o&&o.length===e&&(i=[]),a&&a.length===e&&(r=[]),n=0;n<e;n++){var s=t[n]._id;i&&i.push(o[s]),r&&r.push(a[s])}i&&(this.faceVertexUvs[0]=i),r&&(this.faceVertexUvs[1]=r)},toJSON:function(){function t(t,e,n){return n?t|1<<e:t&~(1<<e)}function e(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==u[e]?u[e]:(u[e]=l.length/3,l.push(t.x,t.y,t.z),u[e])}function n(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==h[e]?h[e]:(h[e]=c.length,c.push(t.getHex()),h[e])}function i(t){var e=t.x.toString()+t.y.toString();return void 0!==p[e]?p[e]:(p[e]=d.length/2,d.push(t.x,t.y),p[e])}var r={metadata:{version:4.4,type:"Geometry",generator:"Geometry.toJSON"}};if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),void 0!==this.parameters){var o,a=this.parameters;for(o in a)void 0!==a[o]&&(r[o]=a[o]);return r}for(a=[],o=0;o<this.vertices.length;o++){var s=this.vertices[o];a.push(s.x,s.y,s.z)}var s=[],l=[],u={},c=[],h={},d=[],p={};for(o=0;o<this.faces.length;o++){var f=this.faces[o],m=void 0!==this.faceVertexUvs[0][o],v=0<f.normal.length(),g=0<f.vertexNormals.length,y=1!==f.color.r||1!==f.color.g||1!==f.color.b,b=0<f.vertexColors.length,_=0,_=t(_,0,0),_=t(_,1,!1),_=t(_,2,!1),_=t(_,3,m),_=t(_,4,v),_=t(_,5,g),_=t(_,6,y),_=t(_,7,b);s.push(_),s.push(f.a,f.b,f.c),m&&(m=this.faceVertexUvs[0][o],s.push(i(m[0]),i(m[1]),i(m[2]))),v&&s.push(e(f.normal)),g&&(v=f.vertexNormals,s.push(e(v[0]),e(v[1]),e(v[2]))),y&&s.push(n(f.color)),b&&(f=f.vertexColors,s.push(n(f[0]),n(f[1]),n(f[2])))}return r.data={},r.data.vertices=a,r.data.normals=l,0<c.length&&(r.data.colors=c),0<d.length&&(r.data.uvs=[d]),r.data.faces=s,r},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]];for(var e=t.vertices,n=0,i=e.length;n<i;n++)this.vertices.push(e[n].clone());for(e=t.faces,n=0,i=e.length;n<i;n++)this.faces.push(e[n].clone());for(n=0,i=t.faceVertexUvs.length;n<i;n++){e=t.faceVertexUvs[n],void 0===this.faceVertexUvs[n]&&(this.faceVertexUvs[n]=[]);for(var r=0,o=e.length;r<o;r++){for(var a=e[r],s=[],l=0,u=a.length;l<u;l++)s.push(a[l].clone());this.faceVertexUvs[n].push(s)}}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}},_.EventDispatcher.prototype.apply(_.Geometry.prototype),_.GeometryIdCount=0,_.DirectGeometry=function(){Object.defineProperty(this,"id",{value:_.GeometryIdCount++}),this.uuid=_.Math.generateUUID(),this.name="",this.type="DirectGeometry",this.indices=[],this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.uvsNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.verticesNeedUpdate=!1},_.DirectGeometry.prototype={constructor:_.DirectGeometry,computeBoundingBox:_.Geometry.prototype.computeBoundingBox,computeBoundingSphere:_.Geometry.prototype.computeBoundingSphere,computeFaceNormals:function(){console.warn("THREE.DirectGeometry: computeFaceNormals() is not a method of this type of geometry.")},computeVertexNormals:function(){console.warn("THREE.DirectGeometry: computeVertexNormals() is not a method of this type of geometry.")},computeGroups:function(t){var e,n,i=[];t=t.faces;for(var r=0;r<t.length;r++){var o=t[r];o.materialIndex!==n&&(n=o.materialIndex,void 0!==e&&(e.count=3*r-e.start,i.push(e)),e={start:3*r,materialIndex:n})}void 0!==e&&(e.count=3*r-e.start,i.push(e)),this.groups=i},fromGeometry:function(t){var e=t.faces,n=t.vertices,i=t.faceVertexUvs,r=i[0]&&0<i[0].length,o=i[1]&&0<i[1].length,a=t.morphTargets,s=a.length;if(0<s){for(var l=[],u=0;u<s;u++)l[u]=[];this.morphTargets.position=l}var c=t.morphNormals,h=c.length;if(0<h){for(var d=[],u=0;u<h;u++)d[u]=[];this.morphTargets.normal=d}for(var p=t.skinIndices,f=t.skinWeights,m=p.length===n.length,v=f.length===n.length,u=0;u<e.length;u++){var g=e[u];this.vertices.push(n[g.a],n[g.b],n[g.c]);var y=g.vertexNormals;for(3===y.length?this.normals.push(y[0],y[1],y[2]):(y=g.normal,this.normals.push(y,y,y)),y=g.vertexColors,3===y.length?this.colors.push(y[0],y[1],y[2]):(y=g.color,this.colors.push(y,y,y)),!0===r&&(y=i[0][u],void 0!==y?this.uvs.push(y[0],y[1],y[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",u),this.uvs.push(new _.Vector2,new _.Vector2,new _.Vector2))),!0===o&&(y=i[1][u],void 0!==y?this.uvs2.push(y[0],y[1],y[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",u),this.uvs2.push(new _.Vector2,new _.Vector2,new _.Vector2))),y=0;y<s;y++){var b=a[y].vertices;l[y].push(b[g.a],b[g.b],b[g.c])}for(y=0;y<h;y++)b=c[y].vertexNormals[u],d[y].push(b.a,b.b,b.c);m&&this.skinIndices.push(p[g.a],p[g.b],p[g.c]),v&&this.skinWeights.push(f[g.a],f[g.b],f[g.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}},_.EventDispatcher.prototype.apply(_.DirectGeometry.prototype),_.BufferGeometry=function(){Object.defineProperty(this,"id",{value:_.GeometryIdCount++}),this.uuid=_.Math.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingSphere=this.boundingBox=null,this.drawRange={start:0,count:1/0}},_.BufferGeometry.prototype={constructor:_.BufferGeometry,addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},getIndex:function(){return this.index},setIndex:function(t){this.index=t},addAttribute:function(t,e,n){!1==e instanceof _.BufferAttribute&&!1==e instanceof _.InterleavedBufferAttribute?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.addAttribute(t,new _.BufferAttribute(e,n))):"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e)):this.attributes[t]=e},getAttribute:function(t){return this.attributes[t]},removeAttribute:function(t){delete this.attributes[t]},get drawcalls(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups},get offsets(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups},addDrawCall:function(t,e,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},addGroup:function(t,e,n){this.groups.push({start:t,count:e,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix:function(t){var e=this.attributes.position;void 0!==e&&(t.applyToVector3Array(e.array),e.needsUpdate=!0),e=this.attributes.normal,void 0!==e&&((new _.Matrix3).getNormalMatrix(t).applyToVector3Array(e.array),e.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere()},rotateX:function(){var t;return function(e){return void 0===t&&(t=new _.Matrix4),t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t;return function(e){return void 0===t&&(t=new _.Matrix4),t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t;return function(e){return void 0===t&&(t=new _.Matrix4),t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t;return function(e,n,i){return void 0===t&&(t=new _.Matrix4),t.makeTranslation(e,n,i),this.applyMatrix(t),this}}(),scale:function(){var t;return function(e,n,i){return void 0===t&&(t=new _.Matrix4),t.makeScale(e,n,i),this.applyMatrix(t),this}}(),lookAt:function(){var t;return function(e){void 0===t&&(t=new _.Object3D),t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),center:function(){this.computeBoundingBox();var t=this.boundingBox.center().negate();return this.translate(t.x,t.y,t.z),t},setFromObject:function(t){var e=t.geometry;if(t instanceof _.Points||t instanceof _.Line){t=new _.Float32Attribute(3*e.vertices.length,3);var n=new _.Float32Attribute(3*e.colors.length,3);this.addAttribute("position",t.copyVector3sArray(e.vertices)),this.addAttribute("color",n.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length&&(t=new _.Float32Attribute(e.lineDistances.length,1),this.addAttribute("lineDistance",t.copyArray(e.lineDistances))),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone())}else t instanceof _.Mesh&&e instanceof _.Geometry&&this.fromGeometry(e);return this},updateFromObject:function(t){var e=t.geometry;if(t instanceof _.Mesh){var n=e.__directGeometry;if(void 0===n)return this.fromGeometry(e);n.verticesNeedUpdate=e.verticesNeedUpdate,n.normalsNeedUpdate=e.normalsNeedUpdate,n.colorsNeedUpdate=e.colorsNeedUpdate,n.uvsNeedUpdate=e.uvsNeedUpdate,n.groupsNeedUpdate=e.groupsNeedUpdate,e.verticesNeedUpdate=!1,e.normalsNeedUpdate=!1,e.colorsNeedUpdate=!1,e.uvsNeedUpdate=!1,e.groupsNeedUpdate=!1,e=n}return!0===e.verticesNeedUpdate&&(n=this.attributes.position,void 0!==n&&(n.copyVector3sArray(e.vertices),n.needsUpdate=!0),e.verticesNeedUpdate=!1),!0===e.normalsNeedUpdate&&(n=this.attributes.normal,void 0!==n&&(n.copyVector3sArray(e.normals),n.needsUpdate=!0),e.normalsNeedUpdate=!1),!0===e.colorsNeedUpdate&&(n=this.attributes.color,void 0!==n&&(n.copyColorsArray(e.colors),n.needsUpdate=!0),e.colorsNeedUpdate=!1),e.uvsNeedUpdate&&(n=this.attributes.uv,void 0!==n&&(n.copyVector2sArray(e.uvs),n.needsUpdate=!0),e.uvsNeedUpdate=!1),e.lineDistancesNeedUpdate&&(n=this.attributes.lineDistance,void 0!==n&&(n.copyArray(e.lineDistances),n.needsUpdate=!0),e.lineDistancesNeedUpdate=!1),e.groupsNeedUpdate&&(e.computeGroups(t.geometry),this.groups=e.groups,e.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new _.DirectGeometry).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var e=new Float32Array(3*t.vertices.length);this.addAttribute("position",new _.BufferAttribute(e,3).copyVector3sArray(t.vertices)),0<t.normals.length&&(e=new Float32Array(3*t.normals.length),this.addAttribute("normal",new _.BufferAttribute(e,3).copyVector3sArray(t.normals))),0<t.colors.length&&(e=new Float32Array(3*t.colors.length),this.addAttribute("color",new _.BufferAttribute(e,3).copyColorsArray(t.colors))),0<t.uvs.length&&(e=new Float32Array(2*t.uvs.length),this.addAttribute("uv",new _.BufferAttribute(e,2).copyVector2sArray(t.uvs))),0<t.uvs2.length&&(e=new Float32Array(2*t.uvs2.length),this.addAttribute("uv2",new _.BufferAttribute(e,2).copyVector2sArray(t.uvs2))),0<t.indices.length&&(e=new(65535<t.vertices.length?Uint32Array:Uint16Array)(3*t.indices.length),this.setIndex(new _.BufferAttribute(e,1).copyIndicesArray(t.indices))),this.groups=t.groups;for(var n in t.morphTargets){for(var e=[],i=t.morphTargets[n],r=0,o=i.length;r<o;r++){var a=i[r],s=new _.Float32Attribute(3*a.length,3);e.push(s.copyVector3sArray(a))}this.morphAttributes[n]=e}return 0<t.skinIndices.length&&(n=new _.Float32Attribute(4*t.skinIndices.length,4),this.addAttribute("skinIndex",n.copyVector4sArray(t.skinIndices))),0<t.skinWeights.length&&(n=new _.Float32Attribute(4*t.skinWeights.length,4),this.addAttribute("skinWeight",n.copyVector4sArray(t.skinWeights))),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){var t=new _.Vector3;return function(){null===this.boundingBox&&(this.boundingBox=new _.Box3);var e=this.attributes.position.array;if(e){var n=this.boundingBox;n.makeEmpty();for(var i=0,r=e.length;i<r;i+=3)t.fromArray(e,i),n.expandByPoint(t)}void 0!==e&&0!==e.length||(this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0)),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}}(),computeBoundingSphere:function(){var t=new _.Box3,e=new _.Vector3;return function(){null===this.boundingSphere&&(this.boundingSphere=new _.Sphere);var n=this.attributes.position.array;if(n){t.makeEmpty();for(var i=this.boundingSphere.center,r=0,o=n.length;r<o;r+=3)e.fromArray(n,r),t.expandByPoint(e);t.center(i);for(var a=0,r=0,o=n.length;r<o;r+=3)e.fromArray(n,r),a=Math.max(a,i.distanceToSquared(e));this.boundingSphere.radius=Math.sqrt(a),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes,n=this.groups;if(e.position){var i=e.position.array;if(void 0===e.normal)this.addAttribute("normal",new _.BufferAttribute(new Float32Array(i.length),3));else for(var r=e.normal.array,o=0,a=r.length;o<a;o++)r[o]=0;var s,l,u,r=e.normal.array,c=new _.Vector3,h=new _.Vector3,d=new _.Vector3,p=new _.Vector3,f=new _.Vector3;if(t){t=t.array,0===n.length&&this.addGroup(0,t.length);for(var m=0,v=n.length;m<v;++m)for(o=n[m],a=o.start,s=o.count,o=a,a+=s;o<a;o+=3)s=3*t[o+0],l=3*t[o+1],u=3*t[o+2],c.fromArray(i,s),h.fromArray(i,l),d.fromArray(i,u),p.subVectors(d,h),f.subVectors(c,h),p.cross(f),r[s]+=p.x,r[s+1]+=p.y,r[s+2]+=p.z,r[l]+=p.x,r[l+1]+=p.y,r[l+2]+=p.z,r[u]+=p.x,r[u+1]+=p.y,r[u+2]+=p.z}else for(o=0,a=i.length;o<a;o+=9)c.fromArray(i,o),h.fromArray(i,o+3),d.fromArray(i,o+6),p.subVectors(d,h),f.subVectors(c,h),p.cross(f),r[o]=p.x,r[o+1]=p.y,r[o+2]=p.z,r[o+3]=p.x,r[o+4]=p.y,r[o+5]=p.z,r[o+6]=p.x,r[o+7]=p.y,r[o+8]=p.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(t){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},merge:function(t,e){if(!1!=t instanceof _.BufferGeometry){void 0===e&&(e=0);var n,i=this.attributes;for(n in i)if(void 0!==t.attributes[n])for(var r=i[n].array,o=t.attributes[n],a=o.array,s=0,o=o.itemSize*e;s<a.length;s++,o++)r[o]=a[s];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t)},normalizeNormals:function(){for(var t,e,n,i=this.attributes.normal.array,r=0,o=i.length;r<o;r+=3)t=i[r],e=i[r+1],n=i[r+2],t=1/Math.sqrt(t*t+e*e+n*n),i[r]*=t,i[r+1]*=t,i[r+2]*=t},toJSON:function(){var t={metadata:{version:4.4,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e,n=this.parameters;for(e in n)void 0!==n[e]&&(t[e]=n[e]);return t}t.data={attributes:{}};var i=this.index;null!==i&&(n=Array.prototype.slice.call(i.array),t.data.index={type:i.array.constructor.name,array:n}),i=this.attributes;for(e in i){var r=i[e],n=Array.prototype.slice.call(r.array);t.data.attributes[e]={itemSize:r.itemSize,type:r.array.constructor.name,array:n}}return e=this.groups,0<e.length&&(t.data.groups=JSON.parse((0,h.default)(e))),e=this.boundingSphere,null!==e&&(t.data.boundingSphere={center:e.center.toArray(),radius:e.radius}),t},clone:function(){return(new this.constructor).copy(this)},copy:function(t){var e=t.index;null!==e&&this.setIndex(e.clone());var n,e=t.attributes;for(n in e)this.addAttribute(n,e[n].clone());for(t=t.groups,n=0,e=t.length;n<e;n++){var i=t[n];this.addGroup(i.start,i.count)}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}},_.EventDispatcher.prototype.apply(_.BufferGeometry.prototype),_.BufferGeometry.MaxIndex=65535,_.InstancedBufferGeometry=function(){_.BufferGeometry.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0},_.InstancedBufferGeometry.prototype=(0,u.default)(_.BufferGeometry.prototype),_.InstancedBufferGeometry.prototype.constructor=_.InstancedBufferGeometry,_.InstancedBufferGeometry.prototype.addGroup=function(t,e,n){this.groups.push({start:t,count:e,instances:n})},_.InstancedBufferGeometry.prototype.copy=function(t){var e=t.index;null!==e&&this.setIndex(e.clone());var n,e=t.attributes;for(n in e)this.addAttribute(n,e[n].clone());for(t=t.groups,n=0,e=t.length;n<e;n++){var i=t[n];this.addGroup(i.start,i.count,i.instances)}return this},_.EventDispatcher.prototype.apply(_.InstancedBufferGeometry.prototype),_.AnimationAction=function(t,e,n,i,r){if(void 0===t)throw Error("clip is null");this.clip=t,this.localRoot=null,this.startTime=e||0,this.timeScale=n||1,this.weight=i||1,this.loop=r||_.LoopRepeat,this.loopCount=0,this.enabled=!0,this.actionTime=-this.startTime,this.clipTime=0,this.propertyBindings=[]},_.AnimationAction.prototype={constructor:_.AnimationAction,setLocalRoot:function(t){return this.localRoot=t,this},updateTime:function(t){var e=this.clipTime,n=this.loopCount,i=this.clip.duration;return this.actionTime+=t,this.loop===_.LoopOnce?(this.loopCount=0,this.clipTime=Math.min(Math.max(this.actionTime,0),i),this.clipTime!==e&&(this.clipTime===i?this.mixer.dispatchEvent({type:"finished",action:this,direction:1}):0===this.clipTime&&this.mixer.dispatchEvent({type:"finished",action:this,direction:-1})),this.clipTime):(this.loopCount=Math.floor(this.actionTime/i),t=this.actionTime-this.loopCount*i,t%=i,this.loop==_.LoopPingPong&&1===Math.abs(this.loopCount%2)&&(t=i-t),this.clipTime=t,this.loopCount!==n&&this.mixer.dispatchEvent({type:"loop",action:this,loopDelta:this.loopCount-this.loopCount}),this.clipTime)},syncWith:function(t){return this.actionTime=t.actionTime,this.timeScale=t.timeScale,this},warpToDuration:function(t){return this.timeScale=this.clip.duration/t,this},init:function(t){return this.clipTime=t-this.startTime,this},update:function(t){return this.updateTime(t),this.clip.getAt(this.clipTime)},getTimeScaleAt:function(t){return this.timeScale.getAt?this.timeScale.getAt(t):this.timeScale},getWeightAt:function(t){return this.weight.getAt?this.weight.getAt(t):this.weight}},_.AnimationClip=function(t,e,n){if(this.name=t,this.tracks=n,this.duration=void 0!==e?e:-1,0>this.duration)for(t=0;t<this.tracks.length;t++)e=this.tracks[t],this.duration=Math.max(e.keys[e.keys.length-1].time);this.trim(),this.optimize(),this.results=[]},_.AnimationClip.prototype={constructor:_.AnimationClip,getAt:function(t){t=Math.max(0,Math.min(t,this.duration));for(var e=0;e<this.tracks.length;e++)this.results[e]=this.tracks[e].getAt(t);return this.results},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}},_.AnimationClip.CreateFromMorphTargetSequence=function(t,e,n){for(var i=e.length,r=[],o=0;o<i;o++){var a=[];a.push({time:(o+i-1)%i,value:0}),a.push({time:o,value:1}),a.push({time:(o+1)%i,value:0}),a.sort(_.KeyframeTrack.keyComparer),0===a[0].time&&a.push({time:i,value:a[0].value}),r.push(new _.NumberKeyframeTrack(".morphTargetInfluences["+e[o].name+"]",a).scale(1/n))}return new _.AnimationClip(t,-1,r)},_.AnimationClip.findByName=function(t,e){for(var n=0;n<t.length;n++)if(t[n].name===e)return t[n];return null},_.AnimationClip.CreateClipsFromMorphTargetSequences=function(t,e){for(var n={},i=/^([\w-]*?)([\d]+)$/,r=0,o=t.length;r<o;r++){var a=t[r],s=a.name.match(i);if(s&&1<s.length){var l=s[1];(s=n[l])||(n[l]=s=[]),s.push(a)}}i=[];for(l in n)i.push(_.AnimationClip.CreateFromMorphTargetSequence(l,n[l],e));return i},_.AnimationClip.parse=function(t){for(var e=[],n=0;n<t.tracks.length;n++)e.push(_.KeyframeTrack.parse(t.tracks[n]).scale(1/t.fps));return new _.AnimationClip(t.name,t.duration,e)},_.AnimationClip.parseAnimation=function(t,e,n){if(!t)return console.error("  no animation in JSONLoader data"),null;var i=function(t,e,n,i,r){for(var o=[],a=0;a<e.length;a++){var s=e[a];void 0!==s[n]&&o.push({time:s.time,value:r(s)})}return 0<o.length?new i(t,o):null},r=[],o=t.name||"default",a=t.length||-1,s=t.fps||30;t=t.hierarchy||[];for(var l=0;l<t.length;l++){var u=t[l].keys;if(u&&0!=u.length)if(u[0].morphTargets){for(var a={},c=0;c<u.length;c++)if(u[c].morphTargets)for(var h=0;h<u[c].morphTargets.length;h++)a[u[c].morphTargets[h]]=-1;for(var d in a){for(var p=[],h=0;h<u[c].morphTargets.length;h++){var f=u[c];p.push({time:f.time,value:f.morphTarget===d?1:0})}r.push(new _.NumberKeyframeTrack(n+".morphTargetInfluence["+d+"]",p))}a=a.length*(s||1)}else c=n+".bones["+e[l].name+"]",(h=i(c+".position",u,"pos",_.VectorKeyframeTrack,function(t){return(new _.Vector3).fromArray(t.pos)}))&&r.push(h),(h=i(c+".quaternion",u,"rot",_.QuaternionKeyframeTrack,function(t){return t.rot.slerp?t.rot.clone():(new _.Quaternion).fromArray(t.rot)}))&&r.push(h),(u=i(c+".scale",u,"scl",_.VectorKeyframeTrack,function(t){return(new _.Vector3).fromArray(t.scl)}))&&r.push(u)}return 0===r.length?null:new _.AnimationClip(o,a,r)},_.AnimationMixer=function(t){this.root=t,this.time=0,this.timeScale=1,this.actions=[],this.propertyBindingMap={}},_.AnimationMixer.prototype={constructor:_.AnimationMixer,addAction:function(t){this.actions.push(t),t.init(this.time),t.mixer=this;for(var e=t.clip.tracks,n=t.localRoot||this.root,i=0;i<e.length;i++){var r=e[i],o=n.uuid+"-"+r.name,a=this.propertyBindingMap[o];void 0===a&&(a=new _.PropertyBinding(n,r.name),this.propertyBindingMap[o]=a),t.propertyBindings.push(a),a.referenceCount+=1}},removeAllActions:function(){for(var t=0;t<this.actions.length;t++)this.actions[t].mixer=null;for(var e in this.propertyBindingMap)this.propertyBindingMap[e].unbind();return this.actions=[],this.propertyBindingMap={},this},removeAction:function(t){var e=this.actions.indexOf(t);-1!==e&&(this.actions.splice(e,1),t.mixer=null),e=t.localRoot||this.root,t=t.clip.tracks;for(var n=0;n<t.length;n++){var i=e.uuid+"-"+t[n].name,r=this.propertyBindingMap[i];r.referenceCount-=1,0>=r.referenceCount&&(r.unbind(),delete this.propertyBindingMap[i])}return this},findActionByName:function(t){for(var e=0;e<this.actions.length;e++)if(this.actions[e].name===t)return this.actions[e];return null},play:function(t,e){return t.startTime=this.time,this.addAction(t),this},fadeOut:function(t,e){var n=[];return n.push({time:this.time,value:1}),n.push({time:this.time+e,value:0}),t.weight=new _.NumberKeyframeTrack("weight",n),this},fadeIn:function(t,e){var n=[];return n.push({time:this.time,value:0}),n.push({time:this.time+e,value:1}),t.weight=new _.NumberKeyframeTrack("weight",n),this},warp:function(t,e,n,i){var r=[];return r.push({time:this.time,value:e}),r.push({time:this.time+i,value:n}),t.timeScale=new _.NumberKeyframeTrack("timeScale",r),this},crossFade:function(t,e,n,i){if(this.fadeOut(t,n),this.fadeIn(e,n),i){i=t.clip.duration/e.clip.duration;var r=1/i;this.warp(t,1,i,n),this.warp(e,r,1,n)}return this},update:function(t){t*=this.timeScale,this.time+=t;for(var e=0;e<this.actions.length;e++){var n=this.actions[e],i=n.getWeightAt(this.time),r=n.getTimeScaleAt(this.time),r=n.update(t*r);if(!(0>=n.weight)&&n.enabled)for(var o=0;o<r.length;o++)n.propertyBindings[o].accumulate(r[o],i)}for(var a in this.propertyBindingMap)this.propertyBindingMap[a].apply();return this}},_.EventDispatcher.prototype.apply(_.AnimationMixer.prototype),_.AnimationUtils={getEqualsFunc:function(t){return t.equals?function(t,e){return t.equals(e)}:function(t,e){return t===e}},clone:function(t){if("object"===(void 0===t?"undefined":(0,s.default)(t))){if(t.clone)return t.clone();console.error("can not figure out how to copy exemplarValue",t)}return t},lerp:function(t,e,n,i){return _.AnimationUtils.getLerpFunc(t,i)(t,e,n)},lerp_object:function(t,e,n){return t.lerp(e,n)},slerp_object:function(t,e,n){return t.slerp(e,n)},lerp_number:function(t,e,n){return t*(1-n)+e*n},lerp_boolean:function(t,e,n){return.5>n?t:e},lerp_boolean_immediate:function(t,e,n){return t},lerp_string:function(t,e,n){return.5>n?t:e},lerp_string_immediate:function(t,e,n){return t},getLerpFunc:function(t,e){if(void 0===t||null===t)throw Error("examplarValue is null");switch(void 0===t?"undefined":(0,s.default)(t)){case"object":if(t.lerp)return _.AnimationUtils.lerp_object;if(t.slerp)return _.AnimationUtils.slerp_object;break;case"number":return _.AnimationUtils.lerp_number;case"boolean":return e?_.AnimationUtils.lerp_boolean:_.AnimationUtils.lerp_boolean_immediate;case"string":return e?_.AnimationUtils.lerp_string:_.AnimationUtils.lerp_string_immediate}}},_.KeyframeTrack=function(t,e){if(void 0===t)throw Error("track name is undefined");if(void 0===e||0===e.length)throw Error("no keys in track named "+t);this.name=t,this.keys=e,this.lastIndex=0,this.validate(),this.optimize()},_.KeyframeTrack.prototype={constructor:_.KeyframeTrack,getAt:function(t){for(;this.lastIndex<this.keys.length&&t>=this.keys[this.lastIndex].time;)this.lastIndex++;for(;0<this.lastIndex&&t<this.keys[this.lastIndex-1].time;)this.lastIndex--;if(this.lastIndex>=this.keys.length)return this.setResult(this.keys[this.keys.length-1].value),this.result;if(0===this.lastIndex)return this.setResult(this.keys[0].value),this.result;var e=this.keys[this.lastIndex-1];if(this.setResult(e.value),e.constantToNext)return this.result;var n=this.keys[this.lastIndex];return this.result=this.lerpValues(this.result,n.value,(t-e.time)/(n.time-e.time))},shift:function(t){if(0!==t)for(var e=0;e<this.keys.length;e++)this.keys[e].time+=t;return this},scale:function(t){if(1!==t)for(var e=0;e<this.keys.length;e++)this.keys[e].time*=t;return this},trim:function(t,e){for(var n=0,i=1;i<this.keys.length;i++)this.keys[i]<=t&&n++;for(var r=0,i=this.keys.length-2;0<i&&this.keys[i]>=e;i++)r++;return 0<n+r&&(this.keys=this.keys.splice(n,this.keys.length-r-n)),this},validate:function(){var t=null;if(0!==this.keys.length){for(var e=0;e<this.keys.length;e++){var n=this.keys[e];if(!n)return void console.error("  key is null in track",this,e);if("number"!=typeof n.time||isNaN(n.time))return void console.error("  key.time is not a valid number",this,e,n);if(void 0===n.value||null===n.value)return void console.error("  key.value is null in track",this,e,n);if(t&&t.time>n.time)return void console.error("  key.time is less than previous key time, out of order keys",this,e,n,t);t=n}return this}console.error("  track is empty, no keys",this)},optimize:function(){var t=[],e=this.keys[0];t.push(e),_.AnimationUtils.getEqualsFunc(e.value);for(var n=1;n<this.keys.length-1;n++){var i=this.keys[n],r=this.keys[n+1];e.time===i.time||this.compareValues(e.value,i.value)&&this.compareValues(i.value,r.value)||(e.constantToNext=this.compareValues(e.value,i.value),t.push(i),e=i)}return t.push(this.keys[this.keys.length-1]),this.keys=t,this}},_.KeyframeTrack.keyComparer=function(t,e){return t.time-e.time},_.KeyframeTrack.parse=function(t){if(void 0===t.type)throw Error("track type undefined, can not parse");return _.KeyframeTrack.GetTrackTypeForTypeName(t.type).parse(t)},_.KeyframeTrack.GetTrackTypeForTypeName=function(t){switch(t.toLowerCase()){case"vector":case"vector2":case"vector3":case"vector4":return _.VectorKeyframeTrack;case"quaternion":return _.QuaternionKeyframeTrack;case"integer":case"scalar":case"double":case"float":case"number":return _.NumberKeyframeTrack;case"bool":case"boolean":return _.BooleanKeyframeTrack;case"string":return _.StringKeyframeTrack}throw Error("Unsupported typeName: "+t)},_.PropertyBinding=function(t,e){this.rootNode=t,this.trackName=e,this.referenceCount=0,this.originalValue=null;var n=_.PropertyBinding.parseTrackName(e);this.directoryName=n.directoryName,this.nodeName=n.nodeName,this.objectName=n.objectName,this.objectIndex=n.objectIndex,this.propertyName=n.propertyName,this.propertyIndex=n.propertyIndex,this.node=_.PropertyBinding.findNode(t,this.nodeName)||t,this.cumulativeValue=null,this.cumulativeWeight=0},_.PropertyBinding.prototype={constructor:_.PropertyBinding,reset:function(){this.cumulativeValue=null,this.cumulativeWeight=0},accumulate:function(t,e){this.isBound||this.bind(),0===this.cumulativeWeight?0<e&&(null===this.cumulativeValue&&(this.cumulativeValue=_.AnimationUtils.clone(t)),this.cumulativeWeight=e):(this.cumulativeValue=this.lerpValue(this.cumulativeValue,t,e/(this.cumulativeWeight+e)),this.cumulativeWeight+=e)},unbind:function(){this.isBound&&(this.setValue(this.originalValue),this.triggerDirty=this.equalsValue=this.lerpValue=this.getValue=this.setValue=null,this.isBound=!1)},bind:function(){if(!this.isBound){var t=this.node;if(t){if(this.objectName){if("materials"===this.objectName){if(!t.material)return void console.error("  can not bind to material as node does not have a material",this);if(!t.material.materials)return void console.error("  can not bind to material.materials as node.material does not have a materials array",this);t=t.material.materials}else if("bones"===this.objectName){if(!t.skeleton)return void console.error("  can not bind to bones as node does not have a skeleton",this);for(var t=t.skeleton.bones,e=0;e<t.length;e++)if(t[e].name===this.objectIndex){this.objectIndex=e;break}}else{if(void 0===t[this.objectName])return void console.error("  can not bind to objectName of node, undefined",this);t=t[this.objectName]}if(void 0!==this.objectIndex){if(void 0===t[this.objectIndex])return void console.error("  trying to bind to objectIndex of objectName, but is undefined:",this,t);t=t[this.objectIndex]}}var n=t[this.propertyName];if(n){if(void 0!==this.propertyIndex){if("morphTargetInfluences"===this.propertyName)for(t.geometry||console.error("  can not bind to morphTargetInfluences becasuse node does not have a geometry",this),t.geometry.morphTargets||console.error("  can not bind to morphTargetInfluences becasuse node does not have a geometry.morphTargets",this),e=0;e<this.node.geometry.morphTargets.length;e++)if(t.geometry.morphTargets[e].name===this.propertyIndex){this.propertyIndex=e;break}this.setValue=function(t){return!this.equalsValue(n[this.propertyIndex],t)&&(n[this.propertyIndex]=t,!0)},this.getValue=function(){return n[this.propertyIndex]}}else n.copy?(this.setValue=function(t){return!this.equalsValue(n,t)&&(n.copy(t),!0)},this.getValue=function(){return n}):(this.setValue=function(e){return!this.equalsValue(t[this.propertyName],e)&&(t[this.propertyName]=e,!0)},this.getValue=function(){return t[this.propertyName]});void 0!==t.needsUpdate?this.triggerDirty=function(){this.node.needsUpdate=!0}:void 0!==t.matrixWorldNeedsUpdate&&(this.triggerDirty=function(){t.matrixWorldNeedsUpdate=!0}),this.originalValue=this.getValue(),this.equalsValue=_.AnimationUtils.getEqualsFunc(this.originalValue),this.lerpValue=_.AnimationUtils.getLerpFunc(this.originalValue,!0),this.isBound=!0}else console.error("  trying to update property for track: "+this.nodeName+"."+this.propertyName+" but it wasn't found.",t)}else console.error("  trying to update node for track: "+this.trackName+" but it wasn't found.")}},apply:function(){if(this.isBound||this.bind(),0<this.cumulativeWeight){if(1>this.cumulativeWeight){var t=1-this.cumulativeWeight;this.cumulativeValue=this.lerpValue(this.cumulativeValue,this.originalValue,t/(this.cumulativeWeight+t))}this.setValue(this.cumulativeValue)&&this.triggerDirty&&this.triggerDirty(),this.cumulativeValue=null,this.cumulativeWeight=0}}},_.PropertyBinding.parseTrackName=function(t){var e=/^(([\w]+\/)*)([\w-\d]+)?(\.([\w]+)(\[([\w\d\[\]\_. ]+)\])?)?(\.([\w.]+)(\[([\w\d\[\]\_. ]+)\])?)$/,n=e.exec(t);if(!n)throw Error("cannot parse trackName at all: "+t);if(n.index===e.lastIndex&&e.lastIndex++,e={directoryName:n[1],nodeName:n[3],objectName:n[5],objectIndex:n[7],propertyName:n[9],propertyIndex:n[11]},null===e.propertyName||0===e.propertyName.length)throw Error("can not parse propertyName from trackName: "+t);return e},_.PropertyBinding.findNode=function(t,e){function n(t){for(var i=0;i<t.length;i++){var r=t[i];if(r.name===e||r.uuid===e||(r=n(r.children)))return r}return null}if(!e||""===e||"root"===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){var i=function(t){for(var n=0;n<t.bones.length;n++){var i=t.bones[n];if(i.name===e)return i}return null}(t.skeleton);if(i)return i}return t.children&&(i=n(t.children))?i:null},_.VectorKeyframeTrack=function(t,e){_.KeyframeTrack.call(this,t,e),this.result=this.keys[0].value.clone()},_.VectorKeyframeTrack.prototype=(0,u.default)(_.KeyframeTrack.prototype),_.VectorKeyframeTrack.prototype.constructor=_.VectorKeyframeTrack,_.VectorKeyframeTrack.prototype.setResult=function(t){this.result.copy(t)},_.VectorKeyframeTrack.prototype.lerpValues=function(t,e,n){return t.lerp(e,n)},_.VectorKeyframeTrack.prototype.compareValues=function(t,e){return t.equals(e)},_.VectorKeyframeTrack.prototype.clone=function(){for(var t=[],e=0;e<this.keys.length;e++){var n=this.keys[e];t.push({time:n.time,value:n.value.clone()})}return new _.VectorKeyframeTrack(this.name,t)},_.VectorKeyframeTrack.parse=function(t){for(var e=_["Vector"+t.keys[0].value.length],n=[],i=0;i<t.keys.length;i++){var r=t.keys[i];n.push({value:(new e).fromArray(r.value),time:r.time})}return new _.VectorKeyframeTrack(t.name,n)},_.QuaternionKeyframeTrack=function(t,e){_.KeyframeTrack.call(this,t,e),this.result=this.keys[0].value.clone()},_.QuaternionKeyframeTrack.prototype=(0,u.default)(_.KeyframeTrack.prototype),_.QuaternionKeyframeTrack.prototype.constructor=_.QuaternionKeyframeTrack,_.QuaternionKeyframeTrack.prototype.setResult=function(t){this.result.copy(t)},_.QuaternionKeyframeTrack.prototype.lerpValues=function(t,e,n){return t.slerp(e,n)},_.QuaternionKeyframeTrack.prototype.compareValues=function(t,e){return t.equals(e)},_.QuaternionKeyframeTrack.prototype.multiply=function(t){for(var e=0;e<this.keys.length;e++)this.keys[e].value.multiply(t);return this},_.QuaternionKeyframeTrack.prototype.clone=function(){for(var t=[],e=0;e<this.keys.length;e++){var n=this.keys[e];t.push({time:n.time,value:n.value.clone()})}return new _.QuaternionKeyframeTrack(this.name,t)},_.QuaternionKeyframeTrack.parse=function(t){for(var e=[],n=0;n<t.keys.length;n++){var i=t.keys[n];e.push({value:(new _.Quaternion).fromArray(i.value),time:i.time})}return new _.QuaternionKeyframeTrack(t.name,e)},_.StringKeyframeTrack=function(t,e){_.KeyframeTrack.call(this,t,e),this.result=this.keys[0].value},_.StringKeyframeTrack.prototype=(0,u.default)(_.KeyframeTrack.prototype),_.StringKeyframeTrack.prototype.constructor=_.StringKeyframeTrack,_.StringKeyframeTrack.prototype.setResult=function(t){this.result=t},_.StringKeyframeTrack.prototype.lerpValues=function(t,e,n){return 1>n?t:e},_.StringKeyframeTrack.prototype.compareValues=function(t,e){return t===e},_.StringKeyframeTrack.prototype.clone=function(){for(var t=[],e=0;e<this.keys.length;e++){var n=this.keys[e];t.push({time:n.time,value:n.value})}return new _.StringKeyframeTrack(this.name,t)},_.StringKeyframeTrack.parse=function(t){return new _.StringKeyframeTrack(t.name,t.keys)},_.BooleanKeyframeTrack=function(t,e){_.KeyframeTrack.call(this,t,e),this.result=this.keys[0].value},_.BooleanKeyframeTrack.prototype=(0,u.default)(_.KeyframeTrack.prototype),_.BooleanKeyframeTrack.prototype.constructor=_.BooleanKeyframeTrack,_.BooleanKeyframeTrack.prototype.setResult=function(t){this.result=t},_.BooleanKeyframeTrack.prototype.lerpValues=function(t,e,n){return 1>n?t:e},_.BooleanKeyframeTrack.prototype.compareValues=function(t,e){return t===e},_.BooleanKeyframeTrack.prototype.clone=function(){for(var t=[],e=0;e<this.keys.length;e++){var n=this.keys[e];t.push({time:n.time,value:n.value})}return new _.BooleanKeyframeTrack(this.name,t)},_.BooleanKeyframeTrack.parse=function(t){return new _.BooleanKeyframeTrack(t.name,t.keys)},_.NumberKeyframeTrack=function(t,e){_.KeyframeTrack.call(this,t,e),this.result=this.keys[0].value},_.NumberKeyframeTrack.prototype=(0,u.default)(_.KeyframeTrack.prototype),_.NumberKeyframeTrack.prototype.constructor=_.NumberKeyframeTrack,_.NumberKeyframeTrack.prototype.setResult=function(t){this.result=t},_.NumberKeyframeTrack.prototype.lerpValues=function(t,e,n){return t*(1-n)+e*n},_.NumberKeyframeTrack.prototype.compareValues=function(t,e){return t===e},_.NumberKeyframeTrack.prototype.clone=function(){for(var t=[],e=0;e<this.keys.length;e++){var n=this.keys[e];t.push({time:n.time,value:n.value})}return new _.NumberKeyframeTrack(this.name,t)},_.NumberKeyframeTrack.parse=function(t){return new _.NumberKeyframeTrack(t.name,t.keys)},_.Camera=function(){_.Object3D.call(this),this.type="Camera",this.matrixWorldInverse=new _.Matrix4,this.projectionMatrix=new _.Matrix4},_.Camera.prototype=(0,u.default)(_.Object3D.prototype),_.Camera.prototype.constructor=_.Camera,_.Camera.prototype.getWorldDirection=function(){var t=new _.Quaternion;return function(e){return e=e||new _.Vector3,this.getWorldQuaternion(t),e.set(0,0,-1).applyQuaternion(t)}}(),_.Camera.prototype.lookAt=function(){var t=new _.Matrix4;return function(e){t.lookAt(this.position,e,this.up),this.quaternion.setFromRotationMatrix(t)}}(),_.Camera.prototype.clone=function(){return(new this.constructor).copy(this)},_.Camera.prototype.copy=function(t){return _.Object3D.prototype.copy.call(this,t),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this},_.CubeCamera=function(t,e,n){_.Object3D.call(this),this.type="CubeCamera";var i=new _.PerspectiveCamera(90,1,t,e);i.up.set(0,-1,0),i.lookAt(new _.Vector3(1,0,0)),this.add(i);var r=new _.PerspectiveCamera(90,1,t,e);r.up.set(0,-1,0),r.lookAt(new _.Vector3(-1,0,0)),this.add(r);var o=new _.PerspectiveCamera(90,1,t,e);o.up.set(0,0,1),o.lookAt(new _.Vector3(0,1,0)),this.add(o);var a=new _.PerspectiveCamera(90,1,t,e);a.up.set(0,0,-1),a.lookAt(new _.Vector3(0,-1,0)),this.add(a);var s=new _.PerspectiveCamera(90,1,t,e);s.up.set(0,-1,0),s.lookAt(new _.Vector3(0,0,1)),this.add(s);var l=new _.PerspectiveCamera(90,1,t,e);l.up.set(0,-1,0),l.lookAt(new _.Vector3(0,0,-1)),this.add(l),this.renderTarget=new _.WebGLRenderTargetCube(n,n,{format:_.RGBFormat,magFilter:_.LinearFilter,minFilter:_.LinearFilter}),this.updateCubeMap=function(t,e){null===this.parent&&this.updateMatrixWorld();var n=this.renderTarget,u=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,n.activeCubeFace=0,t.render(e,i,n),n.activeCubeFace=1,t.render(e,r,n),n.activeCubeFace=2,t.render(e,o,n),n.activeCubeFace=3,t.render(e,a,n),n.activeCubeFace=4,t.render(e,s,n),n.texture.generateMipmaps=u,n.activeCubeFace=5,t.render(e,l,n),t.setRenderTarget(null)}},_.CubeCamera.prototype=(0,u.default)(_.Object3D.prototype),_.CubeCamera.prototype.constructor=_.CubeCamera,_.OrthographicCamera=function(t,e,n,i,r,o){_.Camera.call(this),this.type="OrthographicCamera",this.zoom=1,this.left=t,this.right=e,this.top=n,this.bottom=i,this.near=void 0!==r?r:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()},_.OrthographicCamera.prototype=(0,u.default)(_.Camera.prototype),_.OrthographicCamera.prototype.constructor=_.OrthographicCamera,_.OrthographicCamera.prototype.updateProjectionMatrix=function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2;this.projectionMatrix.makeOrthographic(n-t,n+t,i+e,i-e,this.near,this.far)},_.OrthographicCamera.prototype.copy=function(t){return _.Camera.prototype.copy.call(this,t),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this},_.OrthographicCamera.prototype.toJSON=function(t){return t=_.Object3D.prototype.toJSON.call(this,t),t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,t},_.PerspectiveCamera=function(t,e,n,i){_.Camera.call(this),this.type="PerspectiveCamera",this.zoom=1,this.fov=void 0!==t?t:50,this.aspect=void 0!==e?e:1,this.near=void 0!==n?n:.1,this.far=void 0!==i?i:2e3,this.updateProjectionMatrix()},_.PerspectiveCamera.prototype=(0,u.default)(_.Camera.prototype),_.PerspectiveCamera.prototype.constructor=_.PerspectiveCamera,_.PerspectiveCamera.prototype.setLens=function(t,e){void 0===e&&(e=24),this.fov=2*_.Math.radToDeg(Math.atan(e/(2*t))),this.updateProjectionMatrix()},_.PerspectiveCamera.prototype.setViewOffset=function(t,e,n,i,r,o){this.fullWidth=t,this.fullHeight=e,this.x=n,this.y=i,this.width=r,this.height=o,this.updateProjectionMatrix()},_.PerspectiveCamera.prototype.updateProjectionMatrix=function(){var t=_.Math.radToDeg(2*Math.atan(Math.tan(.5*_.Math.degToRad(this.fov))/this.zoom));if(this.fullWidth){var e=this.fullWidth/this.fullHeight,t=Math.tan(_.Math.degToRad(.5*t))*this.near,n=-t,i=e*n,e=Math.abs(e*t-i),n=Math.abs(t-n);this.projectionMatrix.makeFrustum(i+this.x*e/this.fullWidth,i+(this.x+this.width)*e/this.fullWidth,t-(this.y+this.height)*n/this.fullHeight,t-this.y*n/this.fullHeight,this.near,this.far)}else this.projectionMatrix.makePerspective(t,this.aspect,this.near,this.far)},_.PerspectiveCamera.prototype.copy=function(t){return _.Camera.prototype.copy.call(this,t),this.fov=t.fov,this.aspect=t.aspect,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this},_.PerspectiveCamera.prototype.toJSON=function(t){return t=_.Object3D.prototype.toJSON.call(this,t),t.object.zoom=this.zoom,t.object.fov=this.fov,t.object.aspect=this.aspect,t.object.near=this.near,t.object.far=this.far,t},_.Light=function(t){_.Object3D.call(this),this.type="Light",this.color=new _.Color(t),this.receiveShadow=void 0},_.Light.prototype=(0,u.default)(_.Object3D.prototype),_.Light.prototype.constructor=_.Light,(0,p.default)(_.Light.prototype,{onlyShadow:{set:function(t){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){this.shadow.camera.far=t}},shadowCameraVisible:{set:function(t){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow ) instead.")}},shadowBias:{set:function(t){this.shadow.bias=t}},shadowDarkness:{set:function(t){this.shadow.darkness=t}},shadowMapWidth:{set:function(t){this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){this.shadow.mapSize.height=t}}}),_.Light.prototype.copy=function(t){return _.Object3D.prototype.copy.call(this,t),this.color.copy(t.color),this},_.Light.prototype.toJSON=function(t){return t=_.Object3D.prototype.toJSON.call(this,t),t.object.color=this.color.getHex(),void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.intensity&&(t.object.intensity=this.intensity),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.exponent&&(t.object.exponent=this.exponent),t},_.LightShadow=function(t){this.camera=t,this.bias=0,this.darkness=1,this.mapSize=new _.Vector2(512,512),this.matrix=this.map=null},_.LightShadow.prototype={constructor:_.LightShadow,copy:function(t){this.camera=t.camera.clone(),this.bias=t.bias,this.darkness=t.darkness,this.mapSize.copy(t.mapSize)},clone:function(){return(new this.constructor).copy(this)}},_.AmbientLight=function(t){_.Light.call(this,t),this.type="AmbientLight",this.castShadow=void 0},_.AmbientLight.prototype=(0,u.default)(_.Light.prototype),_.AmbientLight.prototype.constructor=_.AmbientLight,_.DirectionalLight=function(t,e){_.Light.call(this,t),this.type="DirectionalLight",this.position.set(0,1,0),this.updateMatrix(),this.target=new _.Object3D,this.intensity=void 0!==e?e:1,this.shadow=new _.LightShadow(new _.OrthographicCamera(-500,500,500,-500,50,5e3))},_.DirectionalLight.prototype=(0,u.default)(_.Light.prototype),_.DirectionalLight.prototype.constructor=_.DirectionalLight,_.DirectionalLight.prototype.copy=function(t){return _.Light.prototype.copy.call(this,t),this.intensity=t.intensity,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this},_.HemisphereLight=function(t,e,n){_.Light.call(this,t),this.type="HemisphereLight",this.castShadow=void 0,this.position.set(0,1,0),this.updateMatrix(),this.groundColor=new _.Color(e),this.intensity=void 0!==n?n:1},_.HemisphereLight.prototype=(0,u.default)(_.Light.prototype),_.HemisphereLight.prototype.constructor=_.HemisphereLight,_.HemisphereLight.prototype.copy=function(t){return _.Light.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this.intensity=t.intensity,this},_.PointLight=function(t,e,n,i){_.Light.call(this,t),this.type="PointLight",this.intensity=void 0!==e?e:1,this.distance=void 0!==n?n:0,this.decay=void 0!==i?i:1,this.shadow=new _.LightShadow(new _.PerspectiveCamera(90,1,1,500))},_.PointLight.prototype=(0,u.default)(_.Light.prototype),_.PointLight.prototype.constructor=_.PointLight,_.PointLight.prototype.copy=function(t){return _.Light.prototype.copy.call(this,t),this.intensity=t.intensity,this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this},_.SpotLight=function(t,e,n,i,r,o){_.Light.call(this,t),this.type="SpotLight",this.position.set(0,1,0),this.updateMatrix(),this.target=new _.Object3D,this.intensity=void 0!==e?e:1,this.distance=void 0!==n?n:0,this.angle=void 0!==i?i:Math.PI/3,this.exponent=void 0!==r?r:10,this.decay=void 0!==o?o:1,this.shadow=new _.LightShadow(new _.PerspectiveCamera(50,1,50,5e3))},_.SpotLight.prototype=(0,u.default)(_.Light.prototype),_.SpotLight.prototype.constructor=_.SpotLight,_.SpotLight.prototype.copy=function(t){return _.Light.prototype.copy.call(this,t),this.intensity=t.intensity,this.distance=t.distance,this.angle=t.angle,this.exponent=t.exponent,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this},_.Cache={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}},_.Loader=function(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}},_.Loader.prototype={constructor:_.Loader,crossOrigin:void 0,extractUrlBase:function(t){return t=t.split("/"),1===t.length?"./":(t.pop(),t.join("/")+"/")},initMaterials:function(t,e,n){for(var i=[],r=0;r<t.length;++r)i[r]=this.createMaterial(t[r],e,n);return i},createMaterial:function(){var t,e,n;return function(i,r,o){function a(t,n,i,a,s){t=r+t;var u=_.Loader.Handlers.get(t);return null!==u?t=u.load(t):(e.setCrossOrigin(o),t=e.load(t)),void 0!==n&&(t.repeat.fromArray(n),1!==n[0]&&(t.wrapS=_.RepeatWrapping),1!==n[1]&&(t.wrapT=_.RepeatWrapping)),void 0!==i&&t.offset.fromArray(i),void 0!==a&&("repeat"===a[0]&&(t.wrapS=_.RepeatWrapping),"mirror"===a[0]&&(t.wrapS=_.MirroredRepeatWrapping),"repeat"===a[1]&&(t.wrapT=_.RepeatWrapping),"mirror"===a[1]&&(t.wrapT=_.MirroredRepeatWrapping)),void 0!==s&&(t.anisotropy=s),n=_.Math.generateUUID(),l[n]=t,n}void 0===t&&(t=new _.Color),void 0===e&&(e=new _.TextureLoader),void 0===n&&(n=new _.MaterialLoader);var s,l={},u={uuid:_.Math.generateUUID(),type:"MeshLambertMaterial"};for(s in i){var c=i[s];switch(s){case"DbgColor":u.color=c;break;case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":u.name=c;break;case"blending":u.blending=_[c];break;case"colorDiffuse":u.color=t.fromArray(c).getHex();break;case"colorSpecular":u.specular=t.fromArray(c).getHex();break;case"colorEmissive":u.emissive=t.fromArray(c).getHex();break;case"specularCoef":u.shininess=c;break;case"shading":"basic"===c.toLowerCase()&&(u.type="MeshBasicMaterial"),"phong"===c.toLowerCase()&&(u.type="MeshPhongMaterial");break;case"mapDiffuse":u.map=a(c,i.mapDiffuseRepeat,i.mapDiffuseOffset,i.mapDiffuseWrap,i.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapLight":u.lightMap=a(c,i.mapLightRepeat,i.mapLightOffset,i.mapLightWrap,i.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":u.aoMap=a(c,i.mapAORepeat,i.mapAOOffset,i.mapAOWrap,i.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":u.bumpMap=a(c,i.mapBumpRepeat,i.mapBumpOffset,i.mapBumpWrap,i.mapBumpAnisotropy);break;case"mapBumpScale":u.bumpScale=c;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":u.normalMap=a(c,i.mapNormalRepeat,i.mapNormalOffset,i.mapNormalWrap,i.mapNormalAnisotropy);break;case"mapNormalFactor":u.normalScale=[c,c];break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":u.specularMap=a(c,i.mapSpecularRepeat,i.mapSpecularOffset,i.mapSpecularWrap,i.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapAlpha":u.alphaMap=a(c,i.mapAlphaRepeat,i.mapAlphaOffset,i.mapAlphaWrap,i.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":u.side=_.BackSide;break;case"doubleSided":u.side=_.DoubleSide;break;case"transparency":console.warn("THREE.Loader: transparency has been renamed to opacity"),u.opacity=c;break;case"opacity":case"transparent":case"depthTest":case"depthWrite":case"transparent":case"visible":case"wireframe":u[s]=c;break;case"vertexColors":!0===c&&(u.vertexColors=_.VertexColors),"face"===c&&(u.vertexColors=_.FaceColors);break;default:console.error("Loader.createMaterial: Unsupported",s,c)}}return"MeshPhongMaterial"!==u.type&&delete u.specular,1>u.opacity&&(u.transparent=!0),n.setTextures(l),n.parse(u)}}()},_.Loader.Handlers={handlers:[],add:function(t,e){this.handlers.push(t,e)},get:function(t){for(var e=this.handlers,n=0,i=e.length;n<i;n+=2){var r=e[n+1];if(e[n].test(t))return r}return null}},_.XHRLoader=function(t){this.manager=void 0!==t?t:_.DefaultLoadingManager},_.XHRLoader.prototype={constructor:_.XHRLoader,load:function(t,e,n,i){var r=this,o=_.Cache.get(t);if(void 0!==o)return e&&setTimeout(function(){e(o)},0),o;var a=new XMLHttpRequest;return a.open("GET",t,!0),a.addEventListener("load",function(n){n=n.target.response,_.Cache.add(t,n),e&&e(n),r.manager.itemEnd(t)},!1),void 0!==n&&a.addEventListener("progress",function(t){n(t)},!1),a.addEventListener("error",function(e){i&&i(e),r.manager.itemError(t)},!1),void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),void 0!==this.responseType&&(a.responseType=this.responseType),void 0!==this.withCredentials&&(a.withCredentials=this.withCredentials),a.send(null),r.manager.itemStart(t),a},setResponseType:function(t){this.responseType=t},setCrossOrigin:function(t){this.crossOrigin=t},setWithCredentials:function(t){this.withCredentials=t}},_.ImageLoader=function(t){this.manager=void 0!==t?t:_.DefaultLoadingManager},_.ImageLoader.prototype={constructor:_.ImageLoader,load:function(t,e,n,i){var r=this,o=_.Cache.get(t);if(void 0!==o)return r.manager.itemStart(t),e?setTimeout(function(){e(o),r.manager.itemEnd(t)},0):r.manager.itemEnd(t),o;var a=document.createElement("img");return a.addEventListener("load",function(n){_.Cache.add(t,this),e&&e(this),r.manager.itemEnd(t)},!1),void 0!==n&&a.addEventListener("progress",function(t){n(t)},!1),a.addEventListener("error",function(e){i&&i(e),r.manager.itemError(t)},!1),void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),r.manager.itemStart(t),a.src=t,a},setCrossOrigin:function(t){this.crossOrigin=t}},_.JSONLoader=function(t){"boolean"==typeof t&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),t=void 0),this.manager=void 0!==t?t:_.DefaultLoadingManager,this.withCredentials=!1},_.JSONLoader.prototype={constructor:_.JSONLoader,get statusDomElement(){return void 0===this._statusDomElement&&(this._statusDomElement=document.createElement("div")),console.warn("THREE.JSONLoader: .statusDomElement has been removed."),this._statusDomElement},load:function(t,e,n,i){var r=this,o=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:_.Loader.prototype.extractUrlBase(t);n=new _.XHRLoader(this.manager),n.setCrossOrigin(this.crossOrigin),n.setWithCredentials(this.withCredentials),n.load(t,function(n){n=JSON.parse(n);var i=n.metadata;if(void 0!==i){if("object"===i.type)return void console.error("THREE.JSONLoader: "+t+" should be loaded with THREE.ObjectLoader instead.");if("scene"===i.type)return void console.error("THREE.JSONLoader: "+t+" should be loaded with THREE.SceneLoader instead.")}n=r.parse(n,o),e(n.geometry,n.materials)})},setCrossOrigin:function(t){this.crossOrigin=t},setTexturePath:function(t){this.texturePath=t},parse:function(t,e){var n=new _.Geometry,i=void 0!==t.scale?1/t.scale:1;return function(e){var i,r,o,a,s,l,u,c,h,d,p,f,m,v=t.faces;l=t.vertices;var g=t.normals,y=t.colors,b=0;if(void 0!==t.uvs){for(i=0;i<t.uvs.length;i++)t.uvs[i].length&&b++;for(i=0;i<b;i++)n.faceVertexUvs[i]=[]}for(a=0,s=l.length;a<s;)i=new _.Vector3,i.x=l[a++]*e,i.y=l[a++]*e,i.z=l[a++]*e,n.vertices.push(i);for(a=0,s=v.length;a<s;)if(e=v[a++],h=1&e,o=2&e,i=8&e,u=16&e,d=32&e,l=64&e,e&=128,h){if(h=new _.Face3,h.a=v[a],h.b=v[a+1],h.c=v[a+3],p=new _.Face3,p.a=v[a+1],p.b=v[a+2],p.c=v[a+3],a+=4,o&&(o=v[a++],h.materialIndex=o,p.materialIndex=o),o=n.faces.length,i)for(i=0;i<b;i++)for(f=t.uvs[i],n.faceVertexUvs[i][o]=[],n.faceVertexUvs[i][o+1]=[],r=0;4>r;r++)c=v[a++],m=f[2*c],c=f[2*c+1],m=new _.Vector2(m,c),2!==r&&n.faceVertexUvs[i][o].push(m),0!==r&&n.faceVertexUvs[i][o+1].push(m);if(u&&(u=3*v[a++],h.normal.set(g[u++],g[u++],g[u]),p.normal.copy(h.normal)),d)for(i=0;4>i;i++)u=3*v[a++],d=new _.Vector3(g[u++],g[u++],g[u]),2!==i&&h.vertexNormals.push(d),0!==i&&p.vertexNormals.push(d);if(l&&(l=v[a++],l=y[l],h.color.setHex(l),p.color.setHex(l)),e)for(i=0;4>i;i++)l=v[a++],l=y[l],2!==i&&h.vertexColors.push(new _.Color(l)),0!==i&&p.vertexColors.push(new _.Color(l));n.faces.push(h),n.faces.push(p)}else{if(h=new _.Face3,h.a=v[a++],h.b=v[a++],h.c=v[a++],o&&(o=v[a++],h.materialIndex=o),o=n.faces.length,i)for(i=0;i<b;i++)for(f=t.uvs[i],n.faceVertexUvs[i][o]=[],r=0;3>r;r++)c=v[a++],m=f[2*c],c=f[2*c+1],m=new _.Vector2(m,c),n.faceVertexUvs[i][o].push(m);if(u&&(u=3*v[a++],h.normal.set(g[u++],g[u++],g[u])),d)for(i=0;3>i;i++)u=3*v[a++],d=new _.Vector3(g[u++],g[u++],g[u]),h.vertexNormals.push(d);if(l&&(l=v[a++],h.color.setHex(y[l])),e)for(i=0;3>i;i++)l=v[a++],h.vertexColors.push(new _.Color(y[l]));n.faces.push(h)}}(i),function(){var e=void 0!==t.influencesPerVertex?t.influencesPerVertex:2;if(t.skinWeights)for(var i=0,r=t.skinWeights.length;i<r;i+=e)n.skinWeights.push(new _.Vector4(t.skinWeights[i],1<e?t.skinWeights[i+1]:0,2<e?t.skinWeights[i+2]:0,3<e?t.skinWeights[i+3]:0));if(t.skinIndices)for(i=0,r=t.skinIndices.length;i<r;i+=e)n.skinIndices.push(new _.Vector4(t.skinIndices[i],1<e?t.skinIndices[i+1]:0,2<e?t.skinIndices[i+2]:0,3<e?t.skinIndices[i+3]:0));n.bones=t.bones,n.bones&&0<n.bones.length&&(n.skinWeights.length!==n.skinIndices.length||n.skinIndices.length!==n.vertices.length)&&console.warn("When skinning, number of vertices ("+n.vertices.length+"), skinIndices ("+n.skinIndices.length+"), and skinWeights ("+n.skinWeights.length+") should match.")}(),function(e){if(void 0!==t.morphTargets)for(var i=0,r=t.morphTargets.length;i<r;i++){n.morphTargets[i]={},n.morphTargets[i].name=t.morphTargets[i].name,n.morphTargets[i].vertices=[];for(var o=n.morphTargets[i].vertices,a=t.morphTargets[i].vertices,s=0,l=a.length;s<l;s+=3){var u=new _.Vector3;u.x=a[s]*e,u.y=a[s+1]*e,u.z=a[s+2]*e,o.push(u)}}if(void 0!==t.morphColors&&0<t.morphColors.length)for(console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.'),e=n.faces,o=t.morphColors[0].colors,i=0,r=e.length;i<r;i++)e[i].color.fromArray(o,3*i)}(i),function(){var e=[],i=[];void 0!==t.animation&&i.push(t.animation),void 0!==t.animations&&(t.animations.length?i=i.concat(t.animations):i.push(t.animations));for(var r=0;r<i.length;r++){var o=_.AnimationClip.parseAnimation(i[r],n.bones);o&&e.push(o)}n.morphTargets&&(i=_.AnimationClip.CreateClipsFromMorphTargetSequences(n.morphTargets,10),e=e.concat(i)),0<e.length&&(n.animations=e)}(),n.computeFaceNormals(),n.computeBoundingSphere(),void 0===t.materials||0===t.materials.length?{geometry:n}:(i=_.Loader.prototype.initMaterials(t.materials,e,this.crossOrigin),{geometry:n,materials:i})}},_.LoadingManager=function(t,e,n){var i=this,r=!1,o=0,a=0;this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){a++,!1===r&&void 0!==i.onStart&&i.onStart(t,o,a),r=!0},this.itemEnd=function(t){o++,void 0!==i.onProgress&&i.onProgress(t,o,a),o===a&&(r=!1,void 0!==i.onLoad)&&i.onLoad()},this.itemError=function(t){void 0!==i.onError&&i.onError(t)}},_.DefaultLoadingManager=new _.LoadingManager,_.BufferGeometryLoader=function(t){this.manager=void 0!==t?t:_.DefaultLoadingManager},_.BufferGeometryLoader.prototype={constructor:_.BufferGeometryLoader,load:function(t,e,n,i){var r=this,o=new _.XHRLoader(r.manager);o.setCrossOrigin(this.crossOrigin),o.load(t,function(t){e(r.parse(JSON.parse(t)))},n,i)},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(t){var e=new _.BufferGeometry,n=t.data.index;void 0!==n&&(n=new self[n.type](n.array),e.setIndex(new _.BufferAttribute(n,1)));var i,r=t.data.attributes;for(i in r){var o=r[i],n=new self[o.type](o.array);e.addAttribute(i,new _.BufferAttribute(n,o.itemSize))}if(void 0!==(i=t.data.groups||t.data.drawcalls||t.data.offsets))for(n=0,r=i.length;n!==r;++n)o=i[n],e.addGroup(o.start,o.count);return t=t.data.boundingSphere,void 0!==t&&(i=new _.Vector3,void 0!==t.center&&i.fromArray(t.center),e.boundingSphere=new _.Sphere(i,t.radius)),e}},_.MaterialLoader=function(t){this.manager=void 0!==t?t:_.DefaultLoadingManager,this.textures={}},_.MaterialLoader.prototype={constructor:_.MaterialLoader,load:function(t,e,n,i){var r=this,o=new _.XHRLoader(r.manager);o.setCrossOrigin(this.crossOrigin),o.load(t,function(t){e(r.parse(JSON.parse(t)))},n,i)},setCrossOrigin:function(t){this.crossOrigin=t},setTextures:function(t){this.textures=t},getTexture:function(t){var e=this.textures;return void 0===e[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),e[t]},parse:function(t){var e=new _[t.type];if(e.uuid=t.uuid,void 0!==t.name&&(e.name=t.name),void 0!==t.color&&e.color.setHex(t.color),void 0!==t.emissive&&e.emissive.setHex(t.emissive),void 0!==t.specular&&e.specular.setHex(t.specular),void 0!==t.shininess&&(e.shininess=t.shininess),void 0!==t.uniforms&&(e.uniforms=t.uniforms),void 0!==t.vertexShader&&(e.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(e.fragmentShader=t.fragmentShader),void 0!==t.vertexColors&&(e.vertexColors=t.vertexColors),void 0!==t.shading&&(e.shading=t.shading),void 0!==t.blending&&(e.blending=t.blending),void 0!==t.side&&(e.side=t.side),void 0!==t.opacity&&(e.opacity=t.opacity),void 0!==t.transparent&&(e.transparent=t.transparent),void 0!==t.alphaTest&&(e.alphaTest=t.alphaTest),void 0!==t.depthTest&&(e.depthTest=t.depthTest),void 0!==t.depthWrite&&(e.depthWrite=t.depthWrite),void 0!==t.wireframe&&(e.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(e.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.size&&(e.size=t.size),void 0!==t.sizeAttenuation&&(e.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(e.map=this.getTexture(t.map)),void 0!==t.alphaMap&&(e.alphaMap=this.getTexture(t.alphaMap),e.transparent=!0),void 0!==t.bumpMap&&(e.bumpMap=this.getTexture(t.bumpMap)),void 0!==t.bumpScale&&(e.bumpScale=t.bumpScale),void 0!==t.normalMap&&(e.normalMap=this.getTexture(t.normalMap)),t.normalScale&&(e.normalScale=new _.Vector2(t.normalScale,t.normalScale)),void 0!==t.displacementMap&&(e.displacementMap=this.getTexture(t.displacementMap)),void 0!==t.displacementScale&&(e.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(e.displacementBias=t.displacementBias),void 0!==t.specularMap&&(e.specularMap=this.getTexture(t.specularMap)),void 0!==t.envMap&&(e.envMap=this.getTexture(t.envMap),e.combine=_.MultiplyOperation),t.reflectivity&&(e.reflectivity=t.reflectivity),void 0!==t.lightMap&&(e.lightMap=this.getTexture(t.lightMap)),void 0!==t.lightMapIntensity&&(e.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(e.aoMap=this.getTexture(t.aoMap)),void 0!==t.aoMapIntensity&&(e.aoMapIntensity=t.aoMapIntensity),void 0!==t.materials)for(var n=0,i=t.materials.length;n<i;n++)e.materials.push(this.parse(t.materials[n]));return e}},_.ObjectLoader=function(t){this.manager=void 0!==t?t:_.DefaultLoadingManager,this.texturePath=""},_.ObjectLoader.prototype={constructor:_.ObjectLoader,load:function(t,e,n,i){""===this.texturePath&&(this.texturePath=t.substring(0,t.lastIndexOf("/")+1));var r=this,o=new _.XHRLoader(r.manager);o.setCrossOrigin(this.crossOrigin),o.load(t,function(t){r.parse(JSON.parse(t),e)},n,i)},setTexturePath:function(t){this.texturePath=t},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(t,e){var n=this.parseGeometries(t.geometries),i=this.parseImages(t.images,function(){void 0!==e&&e(r)}),i=this.parseTextures(t.textures,i),i=this.parseMaterials(t.materials,i),r=this.parseObject(t.object,n,i);return t.animations&&(r.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0===e||e(r),r},parseGeometries:function(t){var e={};if(void 0!==t)for(var n=new _.JSONLoader,i=new _.BufferGeometryLoader,r=0,o=t.length;r<o;r++){var a,s=t[r];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":a=new _[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"CubeGeometry":a=new _.BoxGeometry(s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleBufferGeometry":a=new _.CircleBufferGeometry(s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CircleGeometry":a=new _.CircleGeometry(s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":a=new _.CylinderGeometry(s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":a=new _.SphereGeometry(s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"SphereBufferGeometry":a=new _.SphereBufferGeometry(s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":a=new _.DodecahedronGeometry(s.radius,s.detail);break;case"IcosahedronGeometry":a=new _.IcosahedronGeometry(s.radius,s.detail);break;case"OctahedronGeometry":a=new _.OctahedronGeometry(s.radius,s.detail);break;case"TetrahedronGeometry":a=new _.TetrahedronGeometry(s.radius,s.detail);break;case"RingGeometry":a=new _.RingGeometry(s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":a=new _.TorusGeometry(s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":a=new _.TorusKnotGeometry(s.radius,s.tube,s.radialSegments,s.tubularSegments,s.p,s.q,s.heightScale);break;case"BufferGeometry":a=i.parse(s);break;case"Geometry":a=n.parse(s.data,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),e[s.uuid]=a}return e},parseMaterials:function(t,e){var n={};if(void 0!==t){var i=new _.MaterialLoader;i.setTextures(e);for(var r=0,o=t.length;r<o;r++){var a=i.parse(t[r]);n[a.uuid]=a}}return n},parseAnimations:function(t){for(var e=[],n=0;n<t.length;n++){var i=_.AnimationClip.parse(t[n]);e.push(i)}return e},parseImages:function(t,e){var n=this,i={};if(void 0!==t&&0<t.length){var r=new _.LoadingManager(e),o=new _.ImageLoader(r);o.setCrossOrigin(this.crossOrigin);for(var r=0,a=t.length;r<a;r++){var s=t[r],l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(s.url)?s.url:n.texturePath+s.url;i[s.uuid]=function(t){return n.manager.itemStart(t),o.load(t,function(){n.manager.itemEnd(t)})}(l)}}return i},parseTextures:function(t,e){function n(t){return"number"==typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),_[t])}var i={};if(void 0!==t)for(var r=0,o=t.length;r<o;r++){var a=t[r];void 0===a.image&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),void 0===e[a.image]&&console.warn("THREE.ObjectLoader: Undefined image",a.image);var s=new _.Texture(e[a.image]);s.needsUpdate=!0,s.uuid=a.uuid,void 0!==a.name&&(s.name=a.name),void 0!==a.mapping&&(s.mapping=n(a.mapping)),void 0!==a.offset&&(s.offset=new _.Vector2(a.offset[0],a.offset[1])),void 0!==a.repeat&&(s.repeat=new _.Vector2(a.repeat[0],a.repeat[1])),void 0!==a.minFilter&&(s.minFilter=n(a.minFilter)),void 0!==a.magFilter&&(s.magFilter=n(a.magFilter)),void 0!==a.anisotropy&&(s.anisotropy=a.anisotropy),Array.isArray(a.wrap)&&(s.wrapS=n(a.wrap[0]),s.wrapT=n(a.wrap[1])),i[a.uuid]=s}return i},parseObject:function(){var t=new _.Matrix4;return function(e,n,i){function r(t){return void 0===n[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),n[t]}function o(t){if(void 0!==t)return void 0===i[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),i[t]}var a;switch(e.type){case"Scene":a=new _.Scene;break;case"PerspectiveCamera":a=new _.PerspectiveCamera(e.fov,e.aspect,e.near,e.far);break;case"OrthographicCamera":a=new _.OrthographicCamera(e.left,e.right,e.top,e.bottom,e.near,e.far);break;case"AmbientLight":a=new _.AmbientLight(e.color);break;case"DirectionalLight":a=new _.DirectionalLight(e.color,e.intensity);break;case"PointLight":a=new _.PointLight(e.color,e.intensity,e.distance,e.decay);break;case"SpotLight":a=new _.SpotLight(e.color,e.intensity,e.distance,e.angle,e.exponent,e.decay);break;case"HemisphereLight":a=new _.HemisphereLight(e.color,e.groundColor,e.intensity);break;case"Mesh":a=new _.Mesh(r(e.geometry),o(e.material));break;case"LOD":a=new _.LOD;break;case"Line":a=new _.Line(r(e.geometry),o(e.material),e.mode);break;case"PointCloud":case"Points":a=new _.Points(r(e.geometry),o(e.material));break;case"Sprite":a=new _.Sprite(o(e.material));break;case"Group":a=new _.Group;break;default:a=new _.Object3D}if(a.uuid=e.uuid,void 0!==e.name&&(a.name=e.name),void 0!==e.matrix?(t.fromArray(e.matrix),t.decompose(a.position,a.quaternion,a.scale)):(void 0!==e.position&&a.position.fromArray(e.position),void 0!==e.rotation&&a.rotation.fromArray(e.rotation),void 0!==e.scale&&a.scale.fromArray(e.scale)),void 0!==e.castShadow&&(a.castShadow=e.castShadow),void 0!==e.receiveShadow&&(a.receiveShadow=e.receiveShadow),void 0!==e.visible&&(a.visible=e.visible),void 0!==e.userData&&(a.userData=e.userData),void 0!==e.children)for(var s in e.children)a.add(this.parseObject(e.children[s],n,i));if("LOD"===e.type){e=e.levels;for(var l=0;l<e.length;l++){var u=e[l];s=a.getObjectByProperty("uuid",u.object),void 0!==s&&a.addLevel(s,u.distance)}}return a}}()},_.TextureLoader=function(t){this.manager=void 0!==t?t:_.DefaultLoadingManager},_.TextureLoader.prototype={constructor:_.TextureLoader,load:function(t,e,n,i){var r=new _.Texture,o=new _.ImageLoader(this.manager);return o.setCrossOrigin(this.crossOrigin),o.load(t,function(t){r.image=t,r.needsUpdate=!0,void 0!==e&&e(r)},n,i),r},setCrossOrigin:function(t){this.crossOrigin=t}},_.CubeTextureLoader=function(t){this.manager=void 0!==t?t:_.DefaultLoadingManager},_.CubeTextureLoader.prototype={constructor:_.CubeTextureLoader,load:function(t,e,n,i){var r=new _.CubeTexture([]),o=new _.ImageLoader;o.setCrossOrigin(this.crossOrigin);var a=0;for(n=0;n<t.length;++n)!function(n){o.load(t[n],function(t){r.images[n]=t,6==++a&&(r.needsUpdate=!0,e&&e(r))},void 0,i)}(n);return r},setCrossOrigin:function(t){this.crossOrigin=t}},_.DataTextureLoader=_.BinaryTextureLoader=function(t){this.manager=void 0!==t?t:_.DefaultLoadingManager,this._parser=null},_.BinaryTextureLoader.prototype={constructor:_.BinaryTextureLoader,load:function(t,e,n,i){var r=this,o=new _.DataTexture,a=new _.XHRLoader(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setResponseType("arraybuffer"),a.load(t,function(t){(t=r._parser(t))&&(void 0!==t.image?o.image=t.image:void 0!==t.data&&(o.image.width=t.width,o.image.height=t.height,o.image.data=t.data),o.wrapS=void 0!==t.wrapS?t.wrapS:_.ClampToEdgeWrapping,o.wrapT=void 0!==t.wrapT?t.wrapT:_.ClampToEdgeWrapping,o.magFilter=void 0!==t.magFilter?t.magFilter:_.LinearFilter,o.minFilter=void 0!==t.minFilter?t.minFilter:_.LinearMipMapLinearFilter,o.anisotropy=void 0!==t.anisotropy?t.anisotropy:1,void 0!==t.format&&(o.format=t.format),void 0!==t.type&&(o.type=t.type),void 0!==t.mipmaps&&(o.mipmaps=t.mipmaps),1===t.mipmapCount&&(o.minFilter=_.LinearFilter),o.needsUpdate=!0,e&&e(o,t))},n,i),o},setCrossOrigin:function(t){this.crossOrigin=t}},_.CompressedTextureLoader=function(t){this.manager=void 0!==t?t:_.DefaultLoadingManager,this._parser=null},_.CompressedTextureLoader.prototype={constructor:_.CompressedTextureLoader,load:function(t,e,n,i){var r=this,o=[],a=new _.CompressedTexture;a.image=o;var s=new _.XHRLoader(this.manager);if(s.setCrossOrigin(this.crossOrigin),s.setResponseType("arraybuffer"),Array.isArray(t))for(var l=0,u=0,c=t.length;u<c;++u)!function(u){s.load(t[u],function(t){t=r._parser(t,!0),o[u]={width:t.width,height:t.height,format:t.format,mipmaps:t.mipmaps},6===(l+=1)&&(1===t.mipmapCount&&(a.minFilter=_.LinearFilter),a.format=t.format,a.needsUpdate=!0,e&&e(a))},n,i)}(u);else s.load(t,function(t){if(t=r._parser(t,!0),t.isCubemap)for(var n=t.mipmaps.length/t.mipmapCount,i=0;i<n;i++){o[i]={mipmaps:[]};for(var s=0;s<t.mipmapCount;s++)o[i].mipmaps.push(t.mipmaps[i*t.mipmapCount+s]),o[i].format=t.format,o[i].width=t.width,o[i].height=t.height}else a.image.width=t.width,a.image.height=t.height,a.mipmaps=t.mipmaps;1===t.mipmapCount&&(a.minFilter=_.LinearFilter),a.format=t.format,a.needsUpdate=!0,e&&e(a)},n,i);return a},setCrossOrigin:function(t){this.crossOrigin=t}},_.Material=function(){Object.defineProperty(this,"id",{value:_.MaterialIdCount++}),this.uuid=_.Math.generateUUID(),this.name="",this.type="Material",this.side=_.FrontSide,this.opacity=1,this.transparent=!1,this.blending=_.NormalBlending,this.blendSrc=_.SrcAlphaFactor,this.blendDst=_.OneMinusSrcAlphaFactor,this.blendEquation=_.AddEquation,this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=null,this.depthFunc=_.LessEqualDepth,this.colorWrite=this.depthWrite=this.depthTest=!0,this.precision=null,this.polygonOffset=!1,this.overdraw=this.alphaTest=this.polygonOffsetUnits=this.polygonOffsetFactor=0,this._needsUpdate=this.visible=!0},_.Material.prototype={constructor:_.Material,get needsUpdate(){return this._needsUpdate},set needsUpdate(t){!0===t&&this.update(),this._needsUpdate=t},setValues:function(t){if(void 0!==t)for(var e in t){var n=t[e];if(void 0===n)console.warn("THREE.Material: '"+e+"' parameter is undefined.");else{var i=this[e];void 0===i?console.warn("THREE."+this.type+": '"+e+"' is not a property of this material."):i instanceof _.Color?i.set(n):i instanceof _.Vector3&&n instanceof _.Vector3?i.copy(n):this[e]="overdraw"===e?Number(n):n}}},toJSON:function(t){var e={metadata:{version:4.4,type:"Material",generator:"Material.toJSON"}};return e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),this.color instanceof _.Color&&(e.color=this.color.getHex()),this.emissive instanceof _.Color&&(e.emissive=this.emissive.getHex()),this.specular instanceof _.Color&&(e.specular=this.specular.getHex()),void 0!==this.shininess&&(e.shininess=this.shininess),this.map instanceof _.Texture&&(e.map=this.map.toJSON(t).uuid),this.alphaMap instanceof _.Texture&&(e.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap instanceof _.Texture&&(e.lightMap=this.lightMap.toJSON(t).uuid),this.bumpMap instanceof _.Texture&&(e.bumpMap=this.bumpMap.toJSON(t).uuid,e.bumpScale=this.bumpScale),this.normalMap instanceof _.Texture&&(e.normalMap=this.normalMap.toJSON(t).uuid,e.normalScale=this.normalScale),this.displacementMap instanceof _.Texture&&(e.displacementMap=this.displacementMap.toJSON(t).uuid,e.displacementScale=this.displacementScale,e.displacementBias=this.displacementBias),this.specularMap instanceof _.Texture&&(e.specularMap=this.specularMap.toJSON(t).uuid),this.envMap instanceof _.Texture&&(e.envMap=this.envMap.toJSON(t).uuid,e.reflectivity=this.reflectivity),void 0!==this.size&&(e.size=this.size),void 0!==this.sizeAttenuation&&(e.sizeAttenuation=this.sizeAttenuation),void 0!==this.vertexColors&&this.vertexColors!==_.NoColors&&(e.vertexColors=this.vertexColors),void 0!==this.shading&&this.shading!==_.SmoothShading&&(e.shading=this.shading),void 0!==this.blending&&this.blending!==_.NormalBlending&&(e.blending=this.blending),void 0!==this.side&&this.side!==_.FrontSide&&(e.side=this.side),1>this.opacity&&(e.opacity=this.opacity),!0===this.transparent&&(e.transparent=this.transparent),0<this.alphaTest&&(e.alphaTest=this.alphaTest),!0===this.wireframe&&(e.wireframe=this.wireframe),1<this.wireframeLinewidth&&(e.wireframeLinewidth=this.wireframeLinewidth),e},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.side=t.side,this.opacity=t.opacity,this.transparent=t.transparent,this.blending=t.blending,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.alphaTest=t.alphaTest,this.overdraw=t.overdraw,this.visible=t.visible,this},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})},get wrapAround(){console.warn("THREE."+this.type+": .wrapAround has been removed.")},set wrapAround(t){console.warn("THREE."+this.type+": .wrapAround has been removed.")},get wrapRGB(){return console.warn("THREE."+this.type+": .wrapRGB has been removed."),new _.Color}},_.EventDispatcher.prototype.apply(_.Material.prototype),_.MaterialIdCount=0,_.LineBasicMaterial=function(t){_.Material.call(this),this.type="LineBasicMaterial",this.color=new _.Color(16777215),this.linewidth=1,this.linejoin=this.linecap="round",this.vertexColors=_.NoColors,this.fog=!0,this.setValues(t)},_.LineBasicMaterial.prototype=(0,u.default)(_.Material.prototype),_.LineBasicMaterial.prototype.constructor=_.LineBasicMaterial,_.LineBasicMaterial.prototype.copy=function(t){return _.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.vertexColors=t.vertexColors,this.fog=t.fog,this},_.LineDashedMaterial=function(t){_.Material.call(this),this.type="LineDashedMaterial",this.color=new _.Color(16777215),this.scale=this.linewidth=1,this.dashSize=3,this.gapSize=1,this.vertexColors=!1,this.fog=!0,this.setValues(t)},_.LineDashedMaterial.prototype=(0,u.default)(_.Material.prototype),_.LineDashedMaterial.prototype.constructor=_.LineDashedMaterial,_.LineDashedMaterial.prototype.copy=function(t){return _.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this.vertexColors=t.vertexColors,this.fog=t.fog,this},_.MeshBasicMaterial=function(t){_.Material.call(this),this.type="MeshBasicMaterial",this.color=new _.Color(16777215),this.aoMap=this.map=null,this.aoMapIntensity=1,this.envMap=this.alphaMap=this.specularMap=null,this.combine=_.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=_.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.vertexColors=_.NoColors,this.morphTargets=this.skinning=!1,this.setValues(t)},_.MeshBasicMaterial.prototype=(0,u.default)(_.Material.prototype),_.MeshBasicMaterial.prototype.constructor=_.MeshBasicMaterial,_.MeshBasicMaterial.prototype.copy=function(t){return _.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.fog=t.fog,this.shading=t.shading,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.vertexColors=t.vertexColors,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this},_.MeshLambertMaterial=function(t){_.Material.call(this),this.type="MeshLambertMaterial",this.color=new _.Color(16777215),this.emissive=new _.Color(0),this.envMap=this.alphaMap=this.specularMap=this.map=null,this.combine=_.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.vertexColors=_.NoColors,this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)},_.MeshLambertMaterial.prototype=(0,u.default)(_.Material.prototype),_.MeshLambertMaterial.prototype.constructor=_.MeshLambertMaterial,_.MeshLambertMaterial.prototype.copy=function(t){return _.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.emissive.copy(t.emissive),this.map=t.map,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.fog=t.fog,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.vertexColors=t.vertexColors,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},_.MeshPhongMaterial=function(t){_.Material.call(this),this.type="MeshPhongMaterial",this.color=new _.Color(16777215),this.emissive=new _.Color(0),this.specular=new _.Color(1118481),this.shininess=30,this.metal=!1,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new _.Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.specularMap=null,this.combine=_.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=_.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.vertexColors=_.NoColors,this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)},_.MeshPhongMaterial.prototype=(0,u.default)(_.Material.prototype),_.MeshPhongMaterial.prototype.constructor=_.MeshPhongMaterial,_.MeshPhongMaterial.prototype.copy=function(t){return _.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.emissive.copy(t.emissive),this.specular.copy(t.specular),this.shininess=t.shininess,this.metal=t.metal,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissiveMap=t.emissiveMap,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.fog=t.fog,this.shading=t.shading,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.vertexColors=t.vertexColors,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},_.MeshDepthMaterial=function(t){_.Material.call(this),this.type="MeshDepthMaterial",this.wireframe=this.morphTargets=!1,this.wireframeLinewidth=1,this.setValues(t)},_.MeshDepthMaterial.prototype=(0,u.default)(_.Material.prototype),_.MeshDepthMaterial.prototype.constructor=_.MeshDepthMaterial,_.MeshDepthMaterial.prototype.copy=function(t){return _.Material.prototype.copy.call(this,t),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},_.MeshNormalMaterial=function(t){_.Material.call(this,t),this.type="MeshNormalMaterial",this.wireframe=!1,this.wireframeLinewidth=1,this.morphTargets=!1,this.setValues(t)},_.MeshNormalMaterial.prototype=(0,u.default)(_.Material.prototype),_.MeshNormalMaterial.prototype.constructor=_.MeshNormalMaterial,_.MeshNormalMaterial.prototype.copy=function(t){return _.Material.prototype.copy.call(this,t),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},_.MultiMaterial=function(t){this.uuid=_.Math.generateUUID(),this.type="MultiMaterial",this.materials=t instanceof Array?t:[],this.visible=!0},_.MultiMaterial.prototype={constructor:_.MultiMaterial,toJSON:function(){for(var t={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type,materials:[]},e=0,n=this.materials.length;e<n;e++)t.materials.push(this.materials[e].toJSON());return t.visible=this.visible,t},clone:function(){for(var t=new this.constructor,e=0;e<this.materials.length;e++)t.materials.push(this.materials[e].clone());return t.visible=this.visible,t}},_.MeshFaceMaterial=_.MultiMaterial,_.PointsMaterial=function(t){_.Material.call(this),this.type="PointsMaterial",this.color=new _.Color(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.vertexColors=_.NoColors,this.fog=!0,this.setValues(t)},_.PointsMaterial.prototype=(0,u.default)(_.Material.prototype),_.PointsMaterial.prototype.constructor=_.PointsMaterial,_.PointsMaterial.prototype.copy=function(t){return _.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.vertexColors=t.vertexColors,this.fog=t.fog,this},_.PointCloudMaterial=function(t){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new _.PointsMaterial(t)},_.ParticleBasicMaterial=function(t){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new _.PointsMaterial(t)},_.ParticleSystemMaterial=function(t){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new _.PointsMaterial(t)},_.ShaderMaterial=function(t){_.Material.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.shading=_.SmoothShading,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.lights=this.fog=!1,this.vertexColors=_.NoColors,this.derivatives=this.morphNormals=this.morphTargets=this.skinning=!1,this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))},_.ShaderMaterial.prototype=(0,u.default)(_.Material.prototype),_.ShaderMaterial.prototype.constructor=_.ShaderMaterial,_.ShaderMaterial.prototype.copy=function(t){return _.Material.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=_.UniformsUtils.clone(t.uniforms),this.attributes=t.attributes,this.defines=t.defines,this.shading=t.shading,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.fog=t.fog,this.lights=t.lights,this.vertexColors=t.vertexColors,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.derivatives=t.derivatives,this},_.ShaderMaterial.prototype.toJSON=function(t){return t=_.Material.prototype.toJSON.call(this,t),t.uniforms=this.uniforms,t.attributes=this.attributes,t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t},_.RawShaderMaterial=function(t){_.ShaderMaterial.call(this,t),this.type="RawShaderMaterial"},_.RawShaderMaterial.prototype=(0,u.default)(_.ShaderMaterial.prototype),_.RawShaderMaterial.prototype.constructor=_.RawShaderMaterial,_.SpriteMaterial=function(t){_.Material.call(this),this.type="SpriteMaterial",this.color=new _.Color(16777215),this.map=null,this.rotation=0,this.fog=!1,this.setValues(t)},_.SpriteMaterial.prototype=(0,u.default)(_.Material.prototype),_.SpriteMaterial.prototype.constructor=_.SpriteMaterial,_.SpriteMaterial.prototype.copy=function(t){return _.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.rotation=t.rotation,this.fog=t.fog,this},_.Texture=function(t,e,n,i,r,o,a,s,l){Object.defineProperty(this,"id",{value:_.TextureIdCount++}),this.uuid=_.Math.generateUUID(),this.sourceFile=this.name="",this.image=void 0!==t?t:_.Texture.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:_.Texture.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:_.ClampToEdgeWrapping,this.wrapT=void 0!==i?i:_.ClampToEdgeWrapping,this.magFilter=void 0!==r?r:_.LinearFilter,this.minFilter=void 0!==o?o:_.LinearMipMapLinearFilter,this.anisotropy=void 0!==l?l:1,this.format=void 0!==a?a:_.RGBAFormat,this.type=void 0!==s?s:_.UnsignedByteType,this.offset=new _.Vector2(0,0),this.repeat=new _.Vector2(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.version=0,this.onUpdate=null},_.Texture.DEFAULT_IMAGE=void 0,_.Texture.DEFAULT_MAPPING=_.UVMapping,_.Texture.prototype={constructor:_.Texture,set needsUpdate(t){!0===t&&this.version++},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this},toJSON:function(t){if(void 0!==t.textures[this.uuid])return t.textures[this.uuid];var e={metadata:{version:4.4,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy};if(void 0!==this.image){var n=this.image;if(void 0===n.uuid&&(n.uuid=_.Math.generateUUID()),void 0===t.images[n.uuid]){var i,r=t.images,o=n.uuid,a=n.uuid;void 0!==n.toDataURL?i=n:(i=document.createElement("canvas"),i.width=n.width,i.height=n.height,i.getContext("2d").drawImage(n,0,0,n.width,n.height)),i=2048<i.width||2048<i.height?i.toDataURL("image/jpeg",.6):i.toDataURL("image/png"),r[o]={uuid:a,url:i}}e.image=n.uuid}return t.textures[this.uuid]=e},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(this.mapping===_.UVMapping){if(t.multiply(this.repeat),t.add(this.offset),0>t.x||1<t.x)switch(this.wrapS){case _.RepeatWrapping:t.x-=Math.floor(t.x);break;case _.ClampToEdgeWrapping:t.x=0>t.x?0:1;break;case _.MirroredRepeatWrapping:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x-=Math.floor(t.x)}if(0>t.y||1<t.y)switch(this.wrapT){case _.RepeatWrapping:t.y-=Math.floor(t.y);break;case _.ClampToEdgeWrapping:t.y=0>t.y?0:1;break;case _.MirroredRepeatWrapping:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y-=Math.floor(t.y)}this.flipY&&(t.y=1-t.y)}}};_.EventDispatcher.prototype.apply(_.Texture.prototype),_.TextureIdCount=0,_.CanvasTexture=function(t,e,n,i,r,o,a,s,l){_.Texture.call(this,t,e,n,i,r,o,a,s,l),this.needsUpdate=!0},_.CanvasTexture.prototype=(0,u.default)(_.Texture.prototype),_.CanvasTexture.prototype.constructor=_.CanvasTexture,_.CubeTexture=function(t,e,n,i,r,o,a,s,l){e=void 0!==e?e:_.CubeReflectionMapping,_.Texture.call(this,t,e,n,i,r,o,a,s,l),this.images=t,this.flipY=!1},_.CubeTexture.prototype=(0,u.default)(_.Texture.prototype),_.CubeTexture.prototype.constructor=_.CubeTexture,_.CubeTexture.prototype.copy=function(t){return _.Texture.prototype.copy.call(this,t),this.images=t.images,this},_.CompressedTexture=function(t,e,n,i,r,o,a,s,l,u,c){_.Texture.call(this,null,o,a,s,l,u,i,r,c),this.image={width:e,height:n},this.mipmaps=t,this.generateMipmaps=this.flipY=!1},_.CompressedTexture.prototype=(0,u.default)(_.Texture.prototype),_.CompressedTexture.prototype.constructor=_.CompressedTexture,_.DataTexture=function(t,e,n,i,r,o,a,s,l,u,c){_.Texture.call(this,null,o,a,s,l,u,i,r,c),this.image={data:t,width:e,height:n},this.magFilter=void 0!==l?l:_.NearestFilter,this.minFilter=void 0!==u?u:_.NearestFilter,this.generateMipmaps=this.flipY=!1},_.DataTexture.prototype=(0,u.default)(_.Texture.prototype),_.DataTexture.prototype.constructor=_.DataTexture,_.VideoTexture=function(t,e,n,i,r,o,a,s,l){function u(){requestAnimationFrame(u),t.readyState===t.HAVE_ENOUGH_DATA&&(c.needsUpdate=!0)}_.Texture.call(this,t,e,n,i,r,o,a,s,l),this.generateMipmaps=!1;var c=this;u()},_.VideoTexture.prototype=(0,u.default)(_.Texture.prototype),_.VideoTexture.prototype.constructor=_.VideoTexture,_.Group=function(){_.Object3D.call(this),this.type="Group"},_.Group.prototype=(0,u.default)(_.Object3D.prototype),_.Group.prototype.constructor=_.Group,_.Points=function(t,e){_.Object3D.call(this),this.type="Points",this.geometry=void 0!==t?t:new _.Geometry,this.material=void 0!==e?e:new _.PointsMaterial({color:16777215*Math.random()})},_.Points.prototype=(0,u.default)(_.Object3D.prototype),_.Points.prototype.constructor=_.Points,_.Points.prototype.raycast=function(){var t=new _.Matrix4,e=new _.Ray;return function(n,i){function r(t,r){var a=e.distanceSqToPoint(t);if(a<l){var s=e.closestPointToPoint(t);s.applyMatrix4(o.matrixWorld);var u=n.ray.origin.distanceTo(s);u<n.near||u>n.far||i.push({distance:u,distanceToRay:Math.sqrt(a),point:s.clone(),index:r,face:null,object:o})}}var o=this,a=o.geometry,s=n.params.Points.threshold;if(t.getInverse(this.matrixWorld),e.copy(n.ray).applyMatrix4(t),null===a.boundingBox||!1!==e.isIntersectionBox(a.boundingBox)){var s=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=s*s,s=new _.Vector3;if(a instanceof _.BufferGeometry){var u=a.index,a=a.attributes.position.array;if(null!==u)for(var c=u.array,u=0,h=c.length;u<h;u++){var d=c[u];s.fromArray(a,3*d),r(s,d)}else for(u=0,c=a.length/3;u<c;u++)s.fromArray(a,3*u),r(s,u)}else for(s=a.vertices,u=0,c=s.length;u<c;u++)r(s[u],u)}}}(),_.Points.prototype.clone=function(){return new this.constructor(this.geometry,this.material).copy(this)},_.PointCloud=function(t,e){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new _.Points(t,e)},_.ParticleSystem=function(t,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new _.Points(t,e)},_.Line=function(t,e,n){if(1===n)return console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new _.LineSegments(t,e);_.Object3D.call(this),this.type="Line",this.geometry=void 0!==t?t:new _.Geometry,this.material=void 0!==e?e:new _.LineBasicMaterial({color:16777215*Math.random()})},_.Line.prototype=(0,u.default)(_.Object3D.prototype),_.Line.prototype.constructor=_.Line,_.Line.prototype.raycast=function(){var t=new _.Matrix4,e=new _.Ray,n=new _.Sphere;return function(i,r){var o=i.linePrecision,o=o*o,a=this.geometry;if(null===a.boundingSphere&&a.computeBoundingSphere(),n.copy(a.boundingSphere),n.applyMatrix4(this.matrixWorld),!1!==i.ray.isIntersectionSphere(n)){t.getInverse(this.matrixWorld),e.copy(i.ray).applyMatrix4(t);var s=new _.Vector3,l=new _.Vector3,u=new _.Vector3,c=new _.Vector3,h=this instanceof _.LineSegments?2:1;if(a instanceof _.BufferGeometry){var d=a.index,p=a.attributes;if(null!==d)for(var a=d.array,p=p.position.array,d=0,f=a.length-1;d<f;d+=h){var m=a[d+1];s.fromArray(p,3*a[d]),l.fromArray(p,3*m),m=e.distanceSqToSegment(s,l,c,u),m>o||(c.applyMatrix4(this.matrixWorld),(m=i.ray.origin.distanceTo(c))<i.near||m>i.far||r.push({distance:m,point:u.clone().applyMatrix4(this.matrixWorld),index:d,face:null,faceIndex:null,object:this}))}else for(p=p.position.array,d=0,f=p.length/3-1;d<f;d+=h)s.fromArray(p,3*d),l.fromArray(p,3*d+3),(m=e.distanceSqToSegment(s,l,c,u))>o||(c.applyMatrix4(this.matrixWorld),(m=i.ray.origin.distanceTo(c))<i.near||m>i.far||r.push({distance:m,point:u.clone().applyMatrix4(this.matrixWorld),index:d,face:null,faceIndex:null,object:this}))}else if(a instanceof _.Geometry)for(s=a.vertices,l=s.length,d=0;d<l-1;d+=h)(m=e.distanceSqToSegment(s[d],s[d+1],c,u))>o||(c.applyMatrix4(this.matrixWorld),(m=i.ray.origin.distanceTo(c))<i.near||m>i.far||r.push({distance:m,point:u.clone().applyMatrix4(this.matrixWorld),index:d,face:null,faceIndex:null,object:this}))}}}(),_.Line.prototype.clone=function(){return new this.constructor(this.geometry,this.material).copy(this)},_.LineStrip=0,_.LinePieces=1,_.LineSegments=function(t,e){_.Line.call(this,t,e),this.type="LineSegments"},_.LineSegments.prototype=(0,u.default)(_.Line.prototype),_.LineSegments.prototype.constructor=_.LineSegments,_.Mesh=function(t,e){_.Object3D.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new _.Geometry,this.material=void 0!==e?e:new _.MeshBasicMaterial({color:16777215*Math.random()}),this.updateMorphTargets()},_.Mesh.prototype=(0,u.default)(_.Object3D.prototype),_.Mesh.prototype.constructor=_.Mesh,_.Mesh.prototype.updateMorphTargets=function(){if(void 0!==this.geometry.morphTargets&&0<this.geometry.morphTargets.length){this.morphTargetBase=-1,this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var t=0,e=this.geometry.morphTargets.length;t<e;t++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[t].name]=t}},_.Mesh.prototype.getMorphTargetIndexByName=function(t){return void 0!==this.morphTargetDictionary[t]?this.morphTargetDictionary[t]:(console.warn("THREE.Mesh.getMorphTargetIndexByName: morph target "+t+" does not exist. Returning 0."),0)},_.Mesh.prototype.raycast=function(){function t(t,e,n,i,r,o,a){return _.Triangle.barycoordFromPoint(t,e,n,i,m),r.multiplyScalar(m.x),o.multiplyScalar(m.y),a.multiplyScalar(m.z),r.add(o).add(a),r.clone()}function e(t,e,n,i,r,o,a){var s=t.material;return null===(s.side===_.BackSide?n.intersectTriangle(o,r,i,!0,a):n.intersectTriangle(i,r,o,s.side!==_.DoubleSide,a))?null:(g.copy(a),g.applyMatrix4(t.matrixWorld),n=e.ray.origin.distanceTo(g),n<e.near||n>e.far?null:{distance:n,point:g.clone(),object:t})}function n(n,i,r,o,u,c,h,m){return a.fromArray(o,3*c),s.fromArray(o,3*h),l.fromArray(o,3*m),(n=e(n,i,r,a,s,l,v))&&(u&&(d.fromArray(u,2*c),p.fromArray(u,2*h),f.fromArray(u,2*m),n.uv=t(v,a,s,l,d,p,f)),n.face=new _.Face3(c,h,m,_.Triangle.normal(a,s,l)),n.faceIndex=c),n}var i=new _.Matrix4,r=new _.Ray,o=new _.Sphere,a=new _.Vector3,s=new _.Vector3,l=new _.Vector3,u=new _.Vector3,c=new _.Vector3,h=new _.Vector3,d=new _.Vector2,p=new _.Vector2,f=new _.Vector2,m=new _.Vector3,v=new _.Vector3,g=new _.Vector3;return function(m,g){var y=this.geometry,b=this.material;if(void 0!==b){null===y.boundingSphere&&y.computeBoundingSphere();var w=this.matrixWorld;if(o.copy(y.boundingSphere),o.applyMatrix4(w),!1!==m.ray.isIntersectionSphere(o)&&(i.getInverse(w),r.copy(m.ray).applyMatrix4(i),null===y.boundingBox||!1!==r.isIntersectionBox(y.boundingBox))){var T,x;if(y instanceof _.BufferGeometry){var E,S,b=y.index,w=y.attributes,y=w.position.array;if(void 0!==w.uv&&(T=w.uv.array),null!==b)for(var w=b.array,A=0,C=w.length;A<C;A+=3)b=w[A],E=w[A+1],S=w[A+2],(x=n(this,m,r,y,T,b,E,S))&&(x.faceIndex=Math.floor(A/3),g.push(x));else for(A=0,C=y.length;A<C;A+=9)b=A/3,E=b+1,S=b+2,(x=n(this,m,r,y,T,b,E,S))&&(x.index=b,g.push(x))}else if(y instanceof _.Geometry){var k,M,w=b instanceof _.MeshFaceMaterial,A=!0===w?b.materials:null,C=y.vertices;E=y.faces,S=y.faceVertexUvs[0],0<S.length&&(T=S);for(var L=0,R=E.length;L<R;L++){var P=E[L];if(void 0!==(x=!0===w?A[P.materialIndex]:b)){if(S=C[P.a],k=C[P.b],M=C[P.c],!0===x.morphTargets){x=y.morphTargets;var D=this.morphTargetInfluences;a.set(0,0,0),s.set(0,0,0),l.set(0,0,0);for(var I=0,F=x.length;I<F;I++){var O=D[I];if(0!==O){var N=x[I].vertices;a.addScaledVector(u.subVectors(N[P.a],S),O),s.addScaledVector(c.subVectors(N[P.b],k),O),l.addScaledVector(h.subVectors(N[P.c],M),O)}}a.add(S),s.add(k),l.add(M),S=a,k=s,M=l}(x=e(this,m,r,S,k,M,v))&&(T&&(D=T[L],d.copy(D[0]),p.copy(D[1]),f.copy(D[2]),x.uv=t(v,S,k,M,d,p,f)),x.face=P,x.faceIndex=L,g.push(x))}}}}}}}(),_.Mesh.prototype.clone=function(){return new this.constructor(this.geometry,this.material).copy(this)},_.Bone=function(t){_.Object3D.call(this),this.type="Bone",this.skin=t},_.Bone.prototype=(0,u.default)(_.Object3D.prototype),_.Bone.prototype.constructor=_.Bone,_.Bone.prototype.copy=function(t){return _.Object3D.prototype.copy.call(this,t),this.skin=t.skin,this},_.Skeleton=function(t,e,n){if(this.useVertexTexture=void 0===n||n,this.identityMatrix=new _.Matrix4,t=t||[],this.bones=t.slice(0),this.useVertexTexture?(t=Math.sqrt(4*this.bones.length),t=_.Math.nextPowerOfTwo(Math.ceil(t)),this.boneTextureHeight=this.boneTextureWidth=t=Math.max(t,4),this.boneMatrices=new Float32Array(this.boneTextureWidth*this.boneTextureHeight*4),this.boneTexture=new _.DataTexture(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,_.RGBAFormat,_.FloatType)):this.boneMatrices=new Float32Array(16*this.bones.length),void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else for(console.warn("THREE.Skeleton bonInverses is the wrong length."),this.boneInverses=[],e=0,t=this.bones.length;e<t;e++)this.boneInverses.push(new _.Matrix4)},_.Skeleton.prototype.calculateInverses=function(){this.boneInverses=[];for(var t=0,e=this.bones.length;t<e;t++){var n=new _.Matrix4;this.bones[t]&&n.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(n)}},_.Skeleton.prototype.pose=function(){for(var t,e=0,n=this.bones.length;e<n;e++)(t=this.bones[e])&&t.matrixWorld.getInverse(this.boneInverses[e]);for(e=0,n=this.bones.length;e<n;e++)(t=this.bones[e])&&(t.parent?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},_.Skeleton.prototype.update=function(){var t=new _.Matrix4;return function(){for(var e=0,n=this.bones.length;e<n;e++)t.multiplyMatrices(this.bones[e]?this.bones[e].matrixWorld:this.identityMatrix,this.boneInverses[e]),t.flattenToArrayOffset(this.boneMatrices,16*e);this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)}}(),_.Skeleton.prototype.clone=function(){return new _.Skeleton(this.bones,this.boneInverses,this.useVertexTexture)},_.SkinnedMesh=function(t,e,n){if(_.Mesh.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new _.Matrix4,this.bindMatrixInverse=new _.Matrix4,t=[],this.geometry&&void 0!==this.geometry.bones){for(var i,r=0,o=this.geometry.bones.length;r<o;++r)i=this.geometry.bones[r],e=new _.Bone(this),t.push(e),e.name=i.name,e.position.fromArray(i.pos),e.quaternion.fromArray(i.rotq),void 0!==i.scl&&e.scale.fromArray(i.scl);for(r=0,o=this.geometry.bones.length;r<o;++r)i=this.geometry.bones[r],-1!==i.parent&&null!==i.parent?t[i.parent].add(t[r]):this.add(t[r])}this.normalizeSkinWeights(),this.updateMatrixWorld(!0),this.bind(new _.Skeleton(t,void 0,n),this.matrixWorld)},_.SkinnedMesh.prototype=(0,u.default)(_.Mesh.prototype),_.SkinnedMesh.prototype.constructor=_.SkinnedMesh,_.SkinnedMesh.prototype.bind=function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},_.SkinnedMesh.prototype.pose=function(){this.skeleton.pose()},_.SkinnedMesh.prototype.normalizeSkinWeights=function(){if(this.geometry instanceof _.Geometry)for(var t=0;t<this.geometry.skinIndices.length;t++){var e=this.geometry.skinWeights[t],n=1/e.lengthManhattan();1/0!==n?e.multiplyScalar(n):e.set(1)}},_.SkinnedMesh.prototype.updateMatrixWorld=function(t){_.Mesh.prototype.updateMatrixWorld.call(this,!0),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh unrecognized bindMode: "+this.bindMode)},_.SkinnedMesh.prototype.clone=function(){return new this.constructor(this.geometry,this.material,this.useVertexTexture).copy(this)},_.LOD=function(){_.Object3D.call(this),this.type="LOD",(0,p.default)(this,{levels:{enumerable:!0,value:[]},objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}})},_.LOD.prototype=(0,u.default)(_.Object3D.prototype),_.LOD.prototype.constructor=_.LOD,_.LOD.prototype.addLevel=function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var n=this.levels,i=0;i<n.length&&!(e<n[i].distance);i++);n.splice(i,0,{distance:e,object:t}),this.add(t)},_.LOD.prototype.getObjectForDistance=function(t){for(var e=this.levels,n=1,i=e.length;n<i&&!(t<e[n].distance);n++);return e[n-1].object},_.LOD.prototype.raycast=function(){var t=new _.Vector3;return function(e,n){t.setFromMatrixPosition(this.matrixWorld);var i=e.ray.origin.distanceTo(t);this.getObjectForDistance(i).raycast(e,n)}}(),_.LOD.prototype.update=function(){var t=new _.Vector3,e=new _.Vector3;return function(n){var i=this.levels;if(1<i.length){t.setFromMatrixPosition(n.matrixWorld),e.setFromMatrixPosition(this.matrixWorld),n=t.distanceTo(e),i[0].object.visible=!0;for(var r=1,o=i.length;r<o&&n>=i[r].distance;r++)i[r-1].object.visible=!1,i[r].object.visible=!0;for(;r<o;r++)i[r].object.visible=!1}}}(),_.LOD.prototype.copy=function(t){_.Object3D.prototype.copy.call(this,t,!1),t=t.levels;for(var e=0,n=t.length;e<n;e++){var i=t[e];this.addLevel(i.object.clone(),i.distance)}return this},_.LOD.prototype.toJSON=function(t){t=_.Object3D.prototype.toJSON.call(this,t),t.object.levels=[];for(var e=this.levels,n=0,i=e.length;n<i;n++){var r=e[n];t.object.levels.push({object:r.object.uuid,distance:r.distance})}return t},_.Sprite=function(){var t=new Uint16Array([0,1,2,0,2,3]),e=new Float32Array([-.5,-.5,0,.5,-.5,0,.5,.5,0,-.5,.5,0]),n=new Float32Array([0,0,1,0,1,1,0,1]),i=new _.BufferGeometry;return i.setIndex(new _.BufferAttribute(t,1)),i.addAttribute("position",new _.BufferAttribute(e,3)),i.addAttribute("uv",new _.BufferAttribute(n,2)),function(t){_.Object3D.call(this),this.type="Sprite",this.geometry=i,this.material=void 0!==t?t:new _.SpriteMaterial}}(),_.Sprite.prototype=(0,u.default)(_.Object3D.prototype),_.Sprite.prototype.constructor=_.Sprite,_.Sprite.prototype.raycast=function(){var t=new _.Vector3;return function(e,n){t.setFromMatrixPosition(this.matrixWorld);var i=e.ray.distanceSqToPoint(t);i>this.scale.x*this.scale.y||n.push({distance:Math.sqrt(i),point:this.position,face:null,object:this})}}(),_.Sprite.prototype.clone=function(){return new this.constructor(this.material).copy(this)},_.Particle=_.Sprite,_.LensFlare=function(t,e,n,i,r){_.Object3D.call(this),this.lensFlares=[],this.positionScreen=new _.Vector3,this.customUpdateCallback=void 0,void 0!==t&&this.add(t,e,n,i,r)},_.LensFlare.prototype=(0,u.default)(_.Object3D.prototype),_.LensFlare.prototype.constructor=_.LensFlare,_.LensFlare.prototype.add=function(t,e,n,i,r,o){void 0===e&&(e=-1),void 0===n&&(n=0),void 0===o&&(o=1),void 0===r&&(r=new _.Color(16777215)),void 0===i&&(i=_.NormalBlending),n=Math.min(n,Math.max(0,n)),this.lensFlares.push({texture:t,size:e,distance:n,x:0,y:0,z:0,scale:1,rotation:0,opacity:o,color:r,blending:i})},_.LensFlare.prototype.updateLensFlares=function(){var t,e,n=this.lensFlares.length,i=2*-this.positionScreen.x,r=2*-this.positionScreen.y;for(t=0;t<n;t++)e=this.lensFlares[t],e.x=this.positionScreen.x+i*e.distance,e.y=this.positionScreen.y+r*e.distance,e.wantedRotation=e.x*Math.PI*.25,e.rotation+=.25*(e.wantedRotation-e.rotation)},_.LensFlare.prototype.copy=function(t){_.Object3D.prototype.copy.call(this,t),this.positionScreen.copy(t.positionScreen),this.customUpdateCallback=t.customUpdateCallback;for(var e=0,n=t.lensFlares.length;e<n;e++)this.lensFlares.push(t.lensFlares[e]);return this},_.Scene=function(){_.Object3D.call(this),this.type="Scene",this.overrideMaterial=this.fog=null,this.autoUpdate=!0},_.Scene.prototype=(0,u.default)(_.Object3D.prototype),_.Scene.prototype.constructor=_.Scene,_.Scene.prototype.copy=function(t){return _.Object3D.prototype.copy.call(this,t),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},_.Fog=function(t,e,n){this.name="",this.color=new _.Color(t),this.near=void 0!==e?e:1,this.far=void 0!==n?n:1e3},_.Fog.prototype.clone=function(){return new _.Fog(this.color.getHex(),this.near,this.far)},_.FogExp2=function(t,e){this.name="",this.color=new _.Color(t),this.density=void 0!==e?e:25e-5},_.FogExp2.prototype.clone=function(){return new _.FogExp2(this.color.getHex(),this.density)},_.ShaderChunk={},_.ShaderChunk.alphamap_fragment="#ifdef USE_ALPHAMAP\n\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n\n#endif\n",_.ShaderChunk.alphamap_pars_fragment="#ifdef USE_ALPHAMAP\n\n\tuniform sampler2D alphaMap;\n\n#endif\n",_.ShaderChunk.alphatest_fragment="#ifdef ALPHATEST\n\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n\n#endif\n",_.ShaderChunk.aomap_fragment="#ifdef USE_AOMAP\n\n\ttotalAmbientLight *= ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\n#endif\n",_.ShaderChunk.aomap_pars_fragment="#ifdef USE_AOMAP\n\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n\n#endif",_.ShaderChunk.begin_vertex="\nvec3 transformed = vec3( position );\n",_.ShaderChunk.beginnormal_vertex="\nvec3 objectNormal = vec3( normal );\n",_.ShaderChunk.bumpmap_pars_fragment="#ifdef USE_BUMPMAP\n\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\n\n\n\tvec2 dHdxy_fwd() {\n\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\n\t\treturn vec2( dBx, dBy );\n\n\t}\n\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\n\t\tvec3 vSigmaX = dFdx( surf_pos );\n\t\tvec3 vSigmaY = dFdy( surf_pos );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\n\t}\n\n#endif\n",_.ShaderChunk.color_fragment="#ifdef USE_COLOR\n\n\tdiffuseColor.rgb *= vColor;\n\n#endif",_.ShaderChunk.color_pars_fragment="#ifdef USE_COLOR\n\n\tvarying vec3 vColor;\n\n#endif\n",_.ShaderChunk.color_pars_vertex="#ifdef USE_COLOR\n\n\tvarying vec3 vColor;\n\n#endif",_.ShaderChunk.color_vertex="#ifdef USE_COLOR\n\n\tvColor.xyz = color.xyz;\n\n#endif",_.ShaderChunk.common="#define PI 3.14159\n#define PI2 6.28318\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\n\nvec3 transformDirection( in vec3 normal, in mat4 matrix ) {\n\n\treturn normalize( ( matrix * vec4( normal, 0.0 ) ).xyz );\n\n}\n\nvec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {\n\n\treturn normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );\n\n}\n\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\n\treturn - distance * planeNormal + point;\n\n}\n\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n\n}\n\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n\n}\n\nfloat calcLightAttenuation( float lightDistance, float cutoffDistance, float decayExponent ) {\n\n\tif ( decayExponent > 0.0 ) {\n\n\t  return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\n\t}\n\n\treturn 1.0;\n\n}\n\nvec3 F_Schlick( in vec3 specularColor, in float dotLH ) {\n\n\n\tfloat fresnel = exp2( ( -5.55437 * dotLH - 6.98316 ) * dotLH );\n\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n\n}\n\nfloat G_BlinnPhong_Implicit( /* in float dotNL, in float dotNV */ ) {\n\n\n\treturn 0.25;\n\n}\n\nfloat D_BlinnPhong( in float shininess, in float dotNH ) {\n\n\n\treturn ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n\n}\n\nvec3 BRDF_BlinnPhong( in vec3 specularColor, in float shininess, in vec3 normal, in vec3 lightDir, in vec3 viewDir ) {\n\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( lightDir, halfDir ) );\n\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\n\tfloat G = G_BlinnPhong_Implicit( /* dotNL, dotNV */ );\n\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\n\treturn F * G * D;\n\n}\n\nvec3 inputToLinear( in vec3 a ) {\n\n\t#ifdef GAMMA_INPUT\n\n\t\treturn pow( a, vec3( float( GAMMA_FACTOR ) ) );\n\n\t#else\n\n\t\treturn a;\n\n\t#endif\n\n}\n\nvec3 linearToOutput( in vec3 a ) {\n\n\t#ifdef GAMMA_OUTPUT\n\n\t\treturn pow( a, vec3( 1.0 / float( GAMMA_FACTOR ) ) );\n\n\t#else\n\n\t\treturn a;\n\n\t#endif\n\n}\n",_.ShaderChunk.defaultnormal_vertex="#ifdef FLIP_SIDED\n\n\tobjectNormal = -objectNormal;\n\n#endif\n\nvec3 transformedNormal = normalMatrix * objectNormal;\n",_.ShaderChunk.displacementmap_vertex="#ifdef USE_DISPLACEMENTMAP\n\n\ttransformed += normal * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n\n#endif\n",_.ShaderChunk.displacementmap_pars_vertex="#ifdef USE_DISPLACEMENTMAP\n\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n\n#endif\n",_.ShaderChunk.emissivemap_fragment="#ifdef USE_EMISSIVEMAP\n\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\n\temissiveColor.rgb = inputToLinear( emissiveColor.rgb );\n\n\ttotalEmissiveLight *= emissiveColor.rgb;\n\n#endif\n",_.ShaderChunk.emissivemap_pars_fragment="#ifdef USE_EMISSIVEMAP\n\n\tuniform sampler2D emissiveMap;\n\n#endif\n",_.ShaderChunk.envmap_fragment="#ifdef USE_ENVMAP\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\n\t\t#else\n\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\n\t\t#endif\n\n\t#else\n\n\t\tvec3 reflectVec = vReflect;\n\n\t#endif\n\n\t#ifdef DOUBLE_SIDED\n\t\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#else\n\t\tfloat flipNormal = 1.0;\n\t#endif\n\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\tvec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#endif\n\n\tenvColor.xyz = inputToLinear( envColor.xyz );\n\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\n\t#endif\n\n#endif\n",_.ShaderChunk.envmap_pars_fragment="#ifdef USE_ENVMAP\n\n\tuniform float reflectivity;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n\t\tuniform float refractionRatio;\n\n\t#else\n\n\t\tvarying vec3 vReflect;\n\n\t#endif\n\n#endif\n",_.ShaderChunk.envmap_pars_vertex="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\n\n\tvarying vec3 vReflect;\n\n\tuniform float refractionRatio;\n\n#endif\n",_.ShaderChunk.envmap_vertex="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\n\n\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\n\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\n\t#ifdef ENVMAP_MODE_REFLECTION\n\n\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\n\t#else\n\n\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\n\t#endif\n\n#endif\n",_.ShaderChunk.fog_fragment="#ifdef USE_FOG\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\n\n\t#else\n\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n\n\t#endif\n\n\t#ifdef FOG_EXP2\n\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * depth * depth * LOG2 ) );\n\n\t#else\n\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n\n\t#endif\n\t\n\toutgoingLight = mix( outgoingLight, fogColor, fogFactor );\n\n#endif",_.ShaderChunk.fog_pars_fragment="#ifdef USE_FOG\n\n\tuniform vec3 fogColor;\n\n\t#ifdef FOG_EXP2\n\n\t\tuniform float fogDensity;\n\n\t#else\n\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n\n#endif",_.ShaderChunk.hemilight_fragment="#if MAX_HEMI_LIGHTS > 0\n\n\tfor ( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\n\n\t\tvec3 lightDir = hemisphereLightDirection[ i ];\n\n\t\tfloat dotProduct = dot( normal, lightDir );\n\n\t\tfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\n\n\t\tvec3 lightColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n\n\t\ttotalAmbientLight += lightColor;\n\n\t}\n\n#endif\n\n",_.ShaderChunk.lightmap_fragment="#ifdef USE_LIGHTMAP\n\n\ttotalAmbientLight += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\n#endif\n",_.ShaderChunk.lightmap_pars_fragment="#ifdef USE_LIGHTMAP\n\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n\n#endif",_.ShaderChunk.lights_lambert_pars_vertex="#if MAX_DIR_LIGHTS > 0\n\n\tuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\n\tuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n\tuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\n\tuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\n\tuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n\tuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\n\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n\tuniform float pointLightDecay[ MAX_POINT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n\tuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\n\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\n\tuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\n\n#endif\n",_.ShaderChunk.lights_lambert_vertex="vLightFront = vec3( 0.0 );\n\n#ifdef DOUBLE_SIDED\n\n\tvLightBack = vec3( 0.0 );\n\n#endif\n\nvec3 normal = normalize( transformedNormal );\n\n#if MAX_POINT_LIGHTS > 0\n\n\tfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n\n\t\tvec3 lightColor = pointLightColor[ i ];\n\n\t\tvec3 lVector = pointLightPosition[ i ] - mvPosition.xyz;\n\t\tvec3 lightDir = normalize( lVector );\n\n\n\t\tfloat attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\n\n\n\t\tfloat dotProduct = dot( normal, lightDir );\n\n\t\tvLightFront += lightColor * attenuation * saturate( dotProduct );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += lightColor * attenuation * saturate( - dotProduct );\n\n\t\t#endif\n\n\t}\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n\tfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n\n\t\tvec3 lightColor = spotLightColor[ i ];\n\n\t\tvec3 lightPosition = spotLightPosition[ i ];\n\t\tvec3 lVector = lightPosition - mvPosition.xyz;\n\t\tvec3 lightDir = normalize( lVector );\n\n\t\tfloat spotEffect = dot( spotLightDirection[ i ], lightDir );\n\n\t\tif ( spotEffect > spotLightAngleCos[ i ] ) {\n\n\t\t\tspotEffect = saturate( pow( saturate( spotEffect ), spotLightExponent[ i ] ) );\n\n\n\t\t\tfloat attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\n\n\t\t\tattenuation *= spotEffect;\n\n\n\t\t\tfloat dotProduct = dot( normal, lightDir );\n\n\t\t\tvLightFront += lightColor * attenuation * saturate( dotProduct );\n\n\t\t\t#ifdef DOUBLE_SIDED\n\n\t\t\t\tvLightBack += lightColor * attenuation * saturate( - dotProduct );\n\n\t\t\t#endif\n\n\t\t}\n\n\t}\n\n#endif\n\n#if MAX_DIR_LIGHTS > 0\n\n\tfor ( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\n\n\t\tvec3 lightColor = directionalLightColor[ i ];\n\n\t\tvec3 lightDir = directionalLightDirection[ i ];\n\n\n\t\tfloat dotProduct = dot( normal, lightDir );\n\n\t\tvLightFront += lightColor * saturate( dotProduct );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += lightColor * saturate( - dotProduct );\n\n\t\t#endif\n\n\t}\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n\tfor ( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\n\n\t\tvec3 lightDir = hemisphereLightDirection[ i ];\n\n\n\t\tfloat dotProduct = dot( normal, lightDir );\n\n\t\tfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\n\n\t\tvLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tfloat hemiDiffuseWeightBack = - 0.5 * dotProduct + 0.5;\n\n\t\t\tvLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );\n\n\t\t#endif\n\n\t}\n\n#endif\n",_.ShaderChunk.lights_phong_fragment="vec3 viewDir = normalize( vViewPosition );\n\nvec3 totalDiffuseLight = vec3( 0.0 );\nvec3 totalSpecularLight = vec3( 0.0 );\n\n#if MAX_POINT_LIGHTS > 0\n\n\tfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n\n\t\tvec3 lightColor = pointLightColor[ i ];\n\n\t\tvec3 lightPosition = pointLightPosition[ i ];\n\t\tvec3 lVector = lightPosition + vViewPosition.xyz;\n\t\tvec3 lightDir = normalize( lVector );\n\n\n\t\tfloat attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\n\n\n\t\tfloat cosineTerm = saturate( dot( normal, lightDir ) );\n\n\t\ttotalDiffuseLight += lightColor * attenuation * cosineTerm;\n\n\n\t\tvec3 brdf = BRDF_BlinnPhong( specular, shininess, normal, lightDir, viewDir );\n\n\t\ttotalSpecularLight += brdf * specularStrength * lightColor * attenuation * cosineTerm;\n\n\n\t}\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n\tfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n\n\t\tvec3 lightColor = spotLightColor[ i ];\n\n\t\tvec3 lightPosition = spotLightPosition[ i ];\n\t\tvec3 lVector = lightPosition + vViewPosition.xyz;\n\t\tvec3 lightDir = normalize( lVector );\n\n\t\tfloat spotEffect = dot( spotLightDirection[ i ], lightDir );\n\n\t\tif ( spotEffect > spotLightAngleCos[ i ] ) {\n\n\t\t\tspotEffect = saturate( pow( saturate( spotEffect ), spotLightExponent[ i ] ) );\n\n\n\t\t\tfloat attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\n\n\t\t\tattenuation *= spotEffect;\n\n\n\t\t\tfloat cosineTerm = saturate( dot( normal, lightDir ) );\n\n\t\t\ttotalDiffuseLight += lightColor * attenuation * cosineTerm;\n\n\n\t\t\tvec3 brdf = BRDF_BlinnPhong( specular, shininess, normal, lightDir, viewDir );\n\n\t\t\ttotalSpecularLight += brdf * specularStrength * lightColor * attenuation * cosineTerm;\n\n\t\t}\n\n\t}\n\n#endif\n\n#if MAX_DIR_LIGHTS > 0\n\n\tfor ( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\n\n\t\tvec3 lightColor = directionalLightColor[ i ];\n\n\t\tvec3 lightDir = directionalLightDirection[ i ];\n\n\n\t\tfloat cosineTerm = saturate( dot( normal, lightDir ) );\n\n\t\ttotalDiffuseLight += lightColor * cosineTerm;\n\n\n\t\tvec3 brdf = BRDF_BlinnPhong( specular, shininess, normal, lightDir, viewDir );\n\n\t\ttotalSpecularLight += brdf * specularStrength * lightColor * cosineTerm;\n\n\t}\n\n#endif\n",_.ShaderChunk.lights_phong_pars_fragment="uniform vec3 ambientLightColor;\n\n#if MAX_DIR_LIGHTS > 0\n\n\tuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\n\tuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n\tuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\n\tuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\n\tuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n\tuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n\n\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\n\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n\tuniform float pointLightDecay[ MAX_POINT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n\tuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\n\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\n\tuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_ENVMAP )\n\n\tvarying vec3 vWorldPosition;\n\n#endif\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n",_.ShaderChunk.lights_phong_pars_vertex="#if MAX_SPOT_LIGHTS > 0 || defined( USE_ENVMAP )\n\n\tvarying vec3 vWorldPosition;\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\n\n#endif\n",_.ShaderChunk.lights_phong_vertex="#if MAX_SPOT_LIGHTS > 0 || defined( USE_ENVMAP )\n\n\tvWorldPosition = worldPosition.xyz;\n\n#endif\n",_.ShaderChunk.linear_to_gamma_fragment="\n\toutgoingLight = linearToOutput( outgoingLight );\n",_.ShaderChunk.logdepthbuf_fragment="#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n\n#endif",_.ShaderChunk.logdepthbuf_pars_fragment="#ifdef USE_LOGDEPTHBUF\n\n\tuniform float logDepthBufFC;\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tvarying float vFragDepth;\n\n\t#endif\n\n#endif\n",_.ShaderChunk.logdepthbuf_pars_vertex="#ifdef USE_LOGDEPTHBUF\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tvarying float vFragDepth;\n\n\t#endif\n\n\tuniform float logDepthBufFC;\n\n#endif",_.ShaderChunk.logdepthbuf_vertex="#ifdef USE_LOGDEPTHBUF\n\n\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\n#else\n\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\n\t#endif\n\n#endif",_.ShaderChunk.map_fragment="#ifdef USE_MAP\n\n\tvec4 texelColor = texture2D( map, vUv );\n\n\ttexelColor.xyz = inputToLinear( texelColor.xyz );\n\n\tdiffuseColor *= texelColor;\n\n#endif\n",_.ShaderChunk.map_pars_fragment="#ifdef USE_MAP\n\n\tuniform sampler2D map;\n\n#endif",_.ShaderChunk.map_particle_fragment="#ifdef USE_MAP\n\n\tdiffuseColor *= texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\n\n#endif\n",_.ShaderChunk.map_particle_pars_fragment="#ifdef USE_MAP\n\n\tuniform vec4 offsetRepeat;\n\tuniform sampler2D map;\n\n#endif\n",_.ShaderChunk.morphnormal_vertex="#ifdef USE_MORPHNORMALS\n\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n\n#endif\n",_.ShaderChunk.morphtarget_pars_vertex="#ifdef USE_MORPHTARGETS\n\n\t#ifndef USE_MORPHNORMALS\n\n\tuniform float morphTargetInfluences[ 8 ];\n\n\t#else\n\n\tuniform float morphTargetInfluences[ 4 ];\n\n\t#endif\n\n#endif",_.ShaderChunk.morphtarget_vertex="#ifdef USE_MORPHTARGETS\n\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\n\t#ifndef USE_MORPHNORMALS\n\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\n\t#endif\n\n#endif\n",_.ShaderChunk.normal_phong_fragment="#ifndef FLAT_SHADED\n\n\tvec3 normal = normalize( vNormal );\n\n\t#ifdef DOUBLE_SIDED\n\n\t\tnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n\n\t#endif\n\n#else\n\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n\n#endif\n\n#ifdef USE_NORMALMAP\n\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n\n#elif defined( USE_BUMPMAP )\n\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n\n#endif\n\n",_.ShaderChunk.normalmap_pars_fragment="#ifdef USE_NORMALMAP\n\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\n\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\n\t}\n\n#endif\n",_.ShaderChunk.project_vertex="#ifdef USE_SKINNING\n\n\tvec4 mvPosition = modelViewMatrix * skinned;\n\n#else\n\n\tvec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n\n#endif\n\ngl_Position = projectionMatrix * mvPosition;\n",_.ShaderChunk.shadowmap_fragment="#ifdef USE_SHADOWMAP\n\n\tfor ( int i = 0; i < MAX_SHADOWS; i ++ ) {\n\n\t\tfloat texelSizeY =  1.0 / shadowMapSize[ i ].y;\n\n\t\tfloat shadow = 0.0;\n\n#if defined( POINT_LIGHT_SHADOWS )\n\n\t\tbool isPointLight = shadowDarkness[ i ] < 0.0;\n\n\t\tif ( isPointLight ) {\n\n\t\t\tfloat realShadowDarkness = abs( shadowDarkness[ i ] );\n\n\t\t\tvec3 lightToPosition = vShadowCoord[ i ].xyz;\n\n\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\n\t\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t\tfloat dp = length( lightToPosition );\n\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D, texelSizeY ) ), shadowBias[ i ], shadow );\n\n\n\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tconst float Dr = 1.25;\n\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tconst float Dr = 2.25;\n\t#endif\n\n\t\t\tfloat os = Dr *  2.0 * texelSizeY;\n\n\t\t\tconst vec3 Gsd = vec3( - 1, 0, 1 );\n\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.zzz * os, texelSizeY ) ), shadowBias[ i ], shadow );\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.zxz * os, texelSizeY ) ), shadowBias[ i ], shadow );\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.xxz * os, texelSizeY ) ), shadowBias[ i ], shadow );\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.xzz * os, texelSizeY ) ), shadowBias[ i ], shadow );\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.zzx * os, texelSizeY ) ), shadowBias[ i ], shadow );\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.zxx * os, texelSizeY ) ), shadowBias[ i ], shadow );\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.xxx * os, texelSizeY ) ), shadowBias[ i ], shadow );\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.xzx * os, texelSizeY ) ), shadowBias[ i ], shadow );\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.zzy * os, texelSizeY ) ), shadowBias[ i ], shadow );\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.zxy * os, texelSizeY ) ), shadowBias[ i ], shadow );\n\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.xxy * os, texelSizeY ) ), shadowBias[ i ], shadow );\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.xzy * os, texelSizeY ) ), shadowBias[ i ], shadow );\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.zyz * os, texelSizeY ) ), shadowBias[ i ], shadow );\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.xyz * os, texelSizeY ) ), shadowBias[ i ], shadow );\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.zyx * os, texelSizeY ) ), shadowBias[ i ], shadow );\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.xyx * os, texelSizeY ) ), shadowBias[ i ], shadow );\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.yzz * os, texelSizeY ) ), shadowBias[ i ], shadow );\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.yxz * os, texelSizeY ) ), shadowBias[ i ], shadow );\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.yxx * os, texelSizeY ) ), shadowBias[ i ], shadow );\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.yzx * os, texelSizeY ) ), shadowBias[ i ], shadow );\n\n\t\t\tshadow *= realShadowDarkness * ( 1.0 / 21.0 );\n\n\t#else \n\t\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t\tfloat dp = length( lightToPosition );\n\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D, texelSizeY ) ), shadowBias[ i ], shadow );\n\n\t\t\tshadow *= realShadowDarkness;\n\n\t#endif\n\n\t\t} else {\n\n#endif \n\t\t\tfloat texelSizeX =  1.0 / shadowMapSize[ i ].x;\n\n\t\t\tvec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\n\n\n\t\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\t\tbool inFrustum = all( inFrustumVec );\n\n\t\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\n\t\t\tbool frustumTest = all( frustumTestVec );\n\n\t\t\tif ( frustumTest ) {\n\n\t#if defined( SHADOWMAP_TYPE_PCF )\n\n\n\t\t\t\t/*\n\t\t\t\t\tfor ( float y = -1.25; y <= 1.25; y += 1.25 )\n\t\t\t\t\t\tfor ( float x = -1.25; x <= 1.25; x += 1.25 ) {\n\t\t\t\t\t\t\tvec4 rgbaDepth = texture2D( shadowMap[ i ], vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy );\n\t\t\t\t\t\t\tfloat fDepth = unpackDepth( rgbaDepth );\n\t\t\t\t\t\t\tif ( fDepth < shadowCoord.z )\n\t\t\t\t\t\t\t\tshadow += 1.0;\n\t\t\t\t\t}\n\t\t\t\t\tshadow /= 9.0;\n\t\t\t\t*/\n\n\t\t\t\tshadowCoord.z += shadowBias[ i ];\n\n\t\t\t\tconst float ShadowDelta = 1.0 / 9.0;\n\n\t\t\t\tfloat xPixelOffset = texelSizeX;\n\t\t\t\tfloat yPixelOffset = texelSizeY;\n\n\t\t\t\tfloat dx0 = - 1.25 * xPixelOffset;\n\t\t\t\tfloat dy0 = - 1.25 * yPixelOffset;\n\t\t\t\tfloat dx1 = 1.25 * xPixelOffset;\n\t\t\t\tfloat dy1 = 1.25 * yPixelOffset;\n\n\t\t\t\tfloat fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += ShadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += ShadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += ShadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += ShadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += ShadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += ShadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += ShadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += ShadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += ShadowDelta;\n\n\t\t\t\tshadow *= shadowDarkness[ i ];\n\n\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\n\n\t\t\t\tshadowCoord.z += shadowBias[ i ];\n\n\t\t\t\tfloat xPixelOffset = texelSizeX;\n\t\t\t\tfloat yPixelOffset = texelSizeY;\n\n\t\t\t\tfloat dx0 = - 1.0 * xPixelOffset;\n\t\t\t\tfloat dy0 = - 1.0 * yPixelOffset;\n\t\t\t\tfloat dx1 = 1.0 * xPixelOffset;\n\t\t\t\tfloat dy1 = 1.0 * yPixelOffset;\n\n\t\t\t\tmat3 shadowKernel;\n\t\t\t\tmat3 depthKernel;\n\n\t\t\t\tdepthKernel[ 0 ][ 0 ] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\n\t\t\t\tdepthKernel[ 0 ][ 1 ] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\n\t\t\t\tdepthKernel[ 0 ][ 2 ] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\n\t\t\t\tdepthKernel[ 1 ][ 0 ] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\n\t\t\t\tdepthKernel[ 1 ][ 1 ] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\n\t\t\t\tdepthKernel[ 1 ][ 2 ] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\n\t\t\t\tdepthKernel[ 2 ][ 0 ] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\n\t\t\t\tdepthKernel[ 2 ][ 1 ] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\n\t\t\t\tdepthKernel[ 2 ][ 2 ] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\n\n\t\t\t\tvec3 shadowZ = vec3( shadowCoord.z );\n\t\t\t\tshadowKernel[ 0 ] = vec3( lessThan( depthKernel[ 0 ], shadowZ ) );\n\t\t\t\tshadowKernel[ 0 ] *= vec3( 0.25 );\n\n\t\t\t\tshadowKernel[ 1 ] = vec3( lessThan( depthKernel[ 1 ], shadowZ ) );\n\t\t\t\tshadowKernel[ 1 ] *= vec3( 0.25 );\n\n\t\t\t\tshadowKernel[ 2 ] = vec3( lessThan( depthKernel[ 2 ], shadowZ ) );\n\t\t\t\tshadowKernel[ 2 ] *= vec3( 0.25 );\n\n\t\t\t\tvec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[ i ].xy );\n\n\t\t\t\tshadowKernel[ 0 ] = mix( shadowKernel[ 1 ], shadowKernel[ 0 ], fractionalCoord.x );\n\t\t\t\tshadowKernel[ 1 ] = mix( shadowKernel[ 2 ], shadowKernel[ 1 ], fractionalCoord.x );\n\n\t\t\t\tvec4 shadowValues;\n\t\t\t\tshadowValues.x = mix( shadowKernel[ 0 ][ 1 ], shadowKernel[ 0 ][ 0 ], fractionalCoord.y );\n\t\t\t\tshadowValues.y = mix( shadowKernel[ 0 ][ 2 ], shadowKernel[ 0 ][ 1 ], fractionalCoord.y );\n\t\t\t\tshadowValues.z = mix( shadowKernel[ 1 ][ 1 ], shadowKernel[ 1 ][ 0 ], fractionalCoord.y );\n\t\t\t\tshadowValues.w = mix( shadowKernel[ 1 ][ 2 ], shadowKernel[ 1 ][ 1 ], fractionalCoord.y );\n\n\t\t\t\tshadow = dot( shadowValues, vec4( 1.0 ) ) * shadowDarkness[ i ];\n\n\t#else \n\t\t\t\tshadowCoord.z += shadowBias[ i ];\n\n\t\t\t\tvec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\n\t\t\t\tfloat fDepth = unpackDepth( rgbaDepth );\n\n\t\t\t\tif ( fDepth < shadowCoord.z )\n\t\t\t\t\tshadow = shadowDarkness[ i ];\n\n\t#endif\n\n\t\t\t}\n\n#ifdef SHADOWMAP_DEBUG\n\n\t\t\tif ( inFrustum ) {\n\n\t\t\t\tif ( i == 0 ) {\n\n\t\t\t\t\toutgoingLight *= vec3( 1.0, 0.5, 0.0 );\n\n\t\t\t\t} else if ( i == 1 ) {\n\n\t\t\t\t\toutgoingLight *= vec3( 0.0, 1.0, 0.8 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\toutgoingLight *= vec3( 0.0, 0.5, 1.0 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n#endif\n\n#if defined( POINT_LIGHT_SHADOWS )\n\n\t\t}\n\n#endif\n\n\t\tshadowMask = shadowMask * vec3( 1.0 - shadow );\n\n\t}\n\n#endif\n",_.ShaderChunk.shadowmap_pars_fragment="#ifdef USE_SHADOWMAP\n\n\tuniform sampler2D shadowMap[ MAX_SHADOWS ];\n\tuniform vec2 shadowMapSize[ MAX_SHADOWS ];\n\n\tuniform float shadowDarkness[ MAX_SHADOWS ];\n\tuniform float shadowBias[ MAX_SHADOWS ];\n\n\tvarying vec4 vShadowCoord[ MAX_SHADOWS ];\n\n\tfloat unpackDepth( const in vec4 rgba_depth ) {\n\n\t\tconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\n\t\tfloat depth = dot( rgba_depth, bit_shift );\n\t\treturn depth;\n\n\t}\n\n\t#if defined(POINT_LIGHT_SHADOWS)\n\n\n\t\tvoid adjustShadowValue1K( const float testDepth, const vec4 textureData, const float bias, inout float shadowValue ) {\n\n\t\t\tconst vec4 bitSh = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\n\t\t\tif ( testDepth >= dot( textureData, bitSh ) * 1000.0 + bias )\n\t\t\t\tshadowValue += 1.0;\n\n\t\t}\n\n\n\t\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\n\n\t\t\tvec3 absV = abs( v );\n\n\n\t\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\t\tabsV *= scaleToCube;\n\n\n\t\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\n\n\n\t\t\tvec2 planar = v.xy;\n\n\t\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\t\tfloat almostOne = 1.0 - almostATexel;\n\n\t\t\tif ( absV.z >= almostOne ) {\n\n\t\t\t\tif ( v.z > 0.0 )\n\t\t\t\t\tplanar.x = 4.0 - v.x;\n\n\t\t\t} else if ( absV.x >= almostOne ) {\n\n\t\t\t\tfloat signX = sign( v.x );\n\t\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\n\t\t\t} else if ( absV.y >= almostOne ) {\n\n\t\t\t\tfloat signY = sign( v.y );\n\t\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\t\tplanar.y = v.z * signY - 2.0;\n\n\t\t\t}\n\n\n\t\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\n\t\t}\n\n\t#endif\n\n#endif\n",_.ShaderChunk.shadowmap_pars_vertex="#ifdef USE_SHADOWMAP\n\n\tuniform float shadowDarkness[ MAX_SHADOWS ];\n\tuniform mat4 shadowMatrix[ MAX_SHADOWS ];\n\tvarying vec4 vShadowCoord[ MAX_SHADOWS ];\n\n#endif",_.ShaderChunk.shadowmap_vertex="#ifdef USE_SHADOWMAP\n\n\tfor ( int i = 0; i < MAX_SHADOWS; i ++ ) {\n\n\t\t\tvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n\n\t}\n\n#endif",_.ShaderChunk.skinbase_vertex="#ifdef USE_SKINNING\n\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n\n#endif",_.ShaderChunk.skinning_pars_vertex="#ifdef USE_SKINNING\n\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\n\t#ifdef BONE_TEXTURE\n\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureWidth;\n\t\tuniform int boneTextureHeight;\n\n\t\tmat4 getBoneMatrix( const in float i ) {\n\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureWidth ) );\n\t\t\tfloat y = floor( j / float( boneTextureWidth ) );\n\n\t\t\tfloat dx = 1.0 / float( boneTextureWidth );\n\t\t\tfloat dy = 1.0 / float( boneTextureHeight );\n\n\t\t\ty = dy * ( y + 0.5 );\n\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\n\t\t\treturn bone;\n\n\t\t}\n\n\t#else\n\n\t\tuniform mat4 boneGlobalMatrices[ MAX_BONES ];\n\n\t\tmat4 getBoneMatrix( const in float i ) {\n\n\t\t\tmat4 bone = boneGlobalMatrices[ int(i) ];\n\t\t\treturn bone;\n\n\t\t}\n\n\t#endif\n\n#endif\n",_.ShaderChunk.skinning_vertex="#ifdef USE_SKINNING\n\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\tskinned  = bindMatrixInverse * skinned;\n\n#endif\n",_.ShaderChunk.skinnormal_vertex="#ifdef USE_SKINNING\n\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\n#endif\n",_.ShaderChunk.specularmap_fragment="float specularStrength;\n\n#ifdef USE_SPECULARMAP\n\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n\n#else\n\n\tspecularStrength = 1.0;\n\n#endif",_.ShaderChunk.specularmap_pars_fragment="#ifdef USE_SPECULARMAP\n\n\tuniform sampler2D specularMap;\n\n#endif",_.ShaderChunk.uv2_pars_fragment="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\n\tvarying vec2 vUv2;\n\n#endif",_.ShaderChunk.uv2_pars_vertex="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\n#endif",_.ShaderChunk.uv2_vertex="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\n\tvUv2 = uv2;\n\n#endif",_.ShaderChunk.uv_pars_fragment="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP )\n\n\tvarying vec2 vUv;\n\n#endif",_.ShaderChunk.uv_pars_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP )\n\n\tvarying vec2 vUv;\n\tuniform vec4 offsetRepeat;\n\n#endif\n",_.ShaderChunk.uv_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP )\n\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n\n#endif",_.ShaderChunk.worldpos_vertex="#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\n\t#ifdef USE_SKINNING\n\n\t\tvec4 worldPosition = modelMatrix * skinned;\n\n\t#else\n\n\t\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n\n\t#endif\n\n#endif\n",_.UniformsUtils={merge:function(t){for(var e={},n=0;n<t.length;n++){var i,r=this.clone(t[n]);for(i in r)e[i]=r[i]}return e},clone:function(t){var e,n={};for(e in t){n[e]={};for(var i in t[e]){var r=t[e][i];r instanceof _.Color||r instanceof _.Vector2||r instanceof _.Vector3||r instanceof _.Vector4||r instanceof _.Matrix3||r instanceof _.Matrix4||r instanceof _.Texture?n[e][i]=r.clone():Array.isArray(r)?n[e][i]=r.slice():n[e][i]=r}}return n}},_.UniformsLib={common:{diffuse:{type:"c",value:new _.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new _.Vector4(0,0,1,1)},specularMap:{type:"t",value:null},alphaMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"f",value:-1},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:.98}},aomap:{aoMap:{type:"t",value:null},aoMapIntensity:{type:"f",value:1}},lightmap:{lightMap:{type:"t",value:null},lightMapIntensity:{type:"f",value:1}},emissivemap:{emissiveMap:{type:"t",value:null}},bumpmap:{bumpMap:{type:"t",value:null},bumpScale:{type:"f",value:1}},normalmap:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new _.Vector2(1,1)}},displacementmap:{displacementMap:{type:"t",value:null},displacementScale:{type:"f",value:1},displacementBias:{type:"f",value:0}},fog:{fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new _.Color(16777215)}},lights:{ambientLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},hemisphereLightDirection:{type:"fv",value:[]},hemisphereLightSkyColor:{type:"fv",value:[]},hemisphereLightGroundColor:{type:"fv",value:[]},pointLightColor:{type:"fv",value:[]},pointLightPosition:{type:"fv",value:[]},pointLightDistance:{type:"fv1",value:[]},pointLightDecay:{type:"fv1",value:[]},spotLightColor:{type:"fv",value:[]},spotLightPosition:{type:"fv",value:[]},spotLightDirection:{type:"fv",value:[]},spotLightDistance:{type:"fv1",value:[]},spotLightAngleCos:{type:"fv1",value:[]},spotLightExponent:{type:"fv1",value:[]},spotLightDecay:{type:"fv1",value:[]}},points:{psColor:{type:"c",value:new _.Color(15658734)},opacity:{type:"f",value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new _.Vector4(0,0,1,1)},fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new _.Color(16777215)}},shadowmap:{shadowMap:{type:"tv",value:[]},shadowMapSize:{type:"v2v",value:[]},shadowBias:{type:"fv1",value:[]},shadowDarkness:{type:"fv1",value:[]},shadowMatrix:{type:"m4v",value:[]}}},_.ShaderLib={basic:{uniforms:_.UniformsUtils.merge([_.UniformsLib.common,_.UniformsLib.aomap,_.UniformsLib.fog,_.UniformsLib.shadowmap]),vertexShader:[_.ShaderChunk.common,_.ShaderChunk.uv_pars_vertex,_.ShaderChunk.uv2_pars_vertex,_.ShaderChunk.envmap_pars_vertex,_.ShaderChunk.color_pars_vertex,_.ShaderChunk.morphtarget_pars_vertex,_.ShaderChunk.skinning_pars_vertex,_.ShaderChunk.shadowmap_pars_vertex,_.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",_.ShaderChunk.uv_vertex,_.ShaderChunk.uv2_vertex,_.ShaderChunk.color_vertex,_.ShaderChunk.skinbase_vertex,"\t#ifdef USE_ENVMAP",_.ShaderChunk.beginnormal_vertex,_.ShaderChunk.morphnormal_vertex,_.ShaderChunk.skinnormal_vertex,_.ShaderChunk.defaultnormal_vertex,"\t#endif",_.ShaderChunk.begin_vertex,_.ShaderChunk.morphtarget_vertex,_.ShaderChunk.skinning_vertex,_.ShaderChunk.project_vertex,_.ShaderChunk.logdepthbuf_vertex,_.ShaderChunk.worldpos_vertex,_.ShaderChunk.envmap_vertex,_.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;",_.ShaderChunk.common,_.ShaderChunk.color_pars_fragment,_.ShaderChunk.uv_pars_fragment,_.ShaderChunk.uv2_pars_fragment,_.ShaderChunk.map_pars_fragment,_.ShaderChunk.alphamap_pars_fragment,_.ShaderChunk.aomap_pars_fragment,_.ShaderChunk.envmap_pars_fragment,_.ShaderChunk.fog_pars_fragment,_.ShaderChunk.shadowmap_pars_fragment,_.ShaderChunk.specularmap_pars_fragment,_.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tvec3 totalAmbientLight = vec3( 1.0 );\n\tvec3 shadowMask = vec3( 1.0 );",_.ShaderChunk.logdepthbuf_fragment,_.ShaderChunk.map_fragment,_.ShaderChunk.color_fragment,_.ShaderChunk.alphamap_fragment,_.ShaderChunk.alphatest_fragment,_.ShaderChunk.specularmap_fragment,_.ShaderChunk.aomap_fragment,_.ShaderChunk.shadowmap_fragment,"\toutgoingLight = diffuseColor.rgb * totalAmbientLight * shadowMask;",_.ShaderChunk.envmap_fragment,_.ShaderChunk.linear_to_gamma_fragment,_.ShaderChunk.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n}"].join("\n")},lambert:{uniforms:_.UniformsUtils.merge([_.UniformsLib.common,_.UniformsLib.fog,_.UniformsLib.lights,_.UniformsLib.shadowmap,{emissive:{type:"c",value:new _.Color(0)}}]),vertexShader:["#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif",_.ShaderChunk.common,_.ShaderChunk.uv_pars_vertex,_.ShaderChunk.uv2_pars_vertex,_.ShaderChunk.envmap_pars_vertex,_.ShaderChunk.lights_lambert_pars_vertex,_.ShaderChunk.color_pars_vertex,_.ShaderChunk.morphtarget_pars_vertex,_.ShaderChunk.skinning_pars_vertex,_.ShaderChunk.shadowmap_pars_vertex,_.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",_.ShaderChunk.uv_vertex,_.ShaderChunk.uv2_vertex,_.ShaderChunk.color_vertex,_.ShaderChunk.beginnormal_vertex,_.ShaderChunk.morphnormal_vertex,_.ShaderChunk.skinbase_vertex,_.ShaderChunk.skinnormal_vertex,_.ShaderChunk.defaultnormal_vertex,_.ShaderChunk.begin_vertex,_.ShaderChunk.morphtarget_vertex,_.ShaderChunk.skinning_vertex,_.ShaderChunk.project_vertex,_.ShaderChunk.logdepthbuf_vertex,_.ShaderChunk.worldpos_vertex,_.ShaderChunk.envmap_vertex,_.ShaderChunk.lights_lambert_vertex,_.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nuniform vec3 ambientLightColor;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif",_.ShaderChunk.common,_.ShaderChunk.color_pars_fragment,_.ShaderChunk.uv_pars_fragment,_.ShaderChunk.uv2_pars_fragment,_.ShaderChunk.map_pars_fragment,_.ShaderChunk.alphamap_pars_fragment,_.ShaderChunk.envmap_pars_fragment,_.ShaderChunk.fog_pars_fragment,_.ShaderChunk.shadowmap_pars_fragment,_.ShaderChunk.specularmap_pars_fragment,_.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tvec3 totalAmbientLight = ambientLightColor;\n\tvec3 shadowMask = vec3( 1.0 );",_.ShaderChunk.logdepthbuf_fragment,_.ShaderChunk.map_fragment,_.ShaderChunk.color_fragment,_.ShaderChunk.alphamap_fragment,_.ShaderChunk.alphatest_fragment,_.ShaderChunk.specularmap_fragment,_.ShaderChunk.shadowmap_fragment,"\t#ifdef DOUBLE_SIDED\n\t\tif ( gl_FrontFacing )\n\t\t\toutgoingLight += diffuseColor.rgb * ( vLightFront * shadowMask + totalAmbientLight ) + emissive;\n\t\telse\n\t\t\toutgoingLight += diffuseColor.rgb * ( vLightBack * shadowMask + totalAmbientLight ) + emissive;\n\t#else\n\t\toutgoingLight += diffuseColor.rgb * ( vLightFront * shadowMask + totalAmbientLight ) + emissive;\n\t#endif",_.ShaderChunk.envmap_fragment,_.ShaderChunk.linear_to_gamma_fragment,_.ShaderChunk.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n}"].join("\n")},phong:{uniforms:_.UniformsUtils.merge([_.UniformsLib.common,_.UniformsLib.aomap,_.UniformsLib.lightmap,_.UniformsLib.emissivemap,_.UniformsLib.bumpmap,_.UniformsLib.normalmap,_.UniformsLib.displacementmap,_.UniformsLib.fog,_.UniformsLib.lights,_.UniformsLib.shadowmap,{emissive:{type:"c",value:new _.Color(0)},specular:{type:"c",value:new _.Color(1118481)},shininess:{type:"f",value:30}}]),vertexShader:["#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif",_.ShaderChunk.common,_.ShaderChunk.uv_pars_vertex,_.ShaderChunk.uv2_pars_vertex,_.ShaderChunk.displacementmap_pars_vertex,_.ShaderChunk.envmap_pars_vertex,_.ShaderChunk.lights_phong_pars_vertex,_.ShaderChunk.color_pars_vertex,_.ShaderChunk.morphtarget_pars_vertex,_.ShaderChunk.skinning_pars_vertex,_.ShaderChunk.shadowmap_pars_vertex,_.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",_.ShaderChunk.uv_vertex,_.ShaderChunk.uv2_vertex,_.ShaderChunk.color_vertex,_.ShaderChunk.beginnormal_vertex,_.ShaderChunk.morphnormal_vertex,_.ShaderChunk.skinbase_vertex,_.ShaderChunk.skinnormal_vertex,_.ShaderChunk.defaultnormal_vertex,"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif",_.ShaderChunk.begin_vertex,_.ShaderChunk.displacementmap_vertex,_.ShaderChunk.morphtarget_vertex,_.ShaderChunk.skinning_vertex,_.ShaderChunk.project_vertex,_.ShaderChunk.logdepthbuf_vertex,"\tvViewPosition = - mvPosition.xyz;",_.ShaderChunk.worldpos_vertex,_.ShaderChunk.envmap_vertex,_.ShaderChunk.lights_phong_vertex,_.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;",_.ShaderChunk.common,_.ShaderChunk.color_pars_fragment,_.ShaderChunk.uv_pars_fragment,_.ShaderChunk.uv2_pars_fragment,_.ShaderChunk.map_pars_fragment,_.ShaderChunk.alphamap_pars_fragment,_.ShaderChunk.aomap_pars_fragment,_.ShaderChunk.lightmap_pars_fragment,_.ShaderChunk.emissivemap_pars_fragment,_.ShaderChunk.envmap_pars_fragment,_.ShaderChunk.fog_pars_fragment,_.ShaderChunk.lights_phong_pars_fragment,_.ShaderChunk.shadowmap_pars_fragment,_.ShaderChunk.bumpmap_pars_fragment,_.ShaderChunk.normalmap_pars_fragment,_.ShaderChunk.specularmap_pars_fragment,_.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tvec3 totalAmbientLight = ambientLightColor;\n\tvec3 totalEmissiveLight = emissive;\n\tvec3 shadowMask = vec3( 1.0 );",_.ShaderChunk.logdepthbuf_fragment,_.ShaderChunk.map_fragment,_.ShaderChunk.color_fragment,_.ShaderChunk.alphamap_fragment,_.ShaderChunk.alphatest_fragment,_.ShaderChunk.specularmap_fragment,_.ShaderChunk.normal_phong_fragment,_.ShaderChunk.lightmap_fragment,_.ShaderChunk.hemilight_fragment,_.ShaderChunk.aomap_fragment,_.ShaderChunk.emissivemap_fragment,_.ShaderChunk.lights_phong_fragment,_.ShaderChunk.shadowmap_fragment,"totalDiffuseLight *= shadowMask;\ntotalSpecularLight *= shadowMask;\n#ifdef METAL\n\toutgoingLight += diffuseColor.rgb * ( totalDiffuseLight + totalAmbientLight ) * specular + totalSpecularLight + totalEmissiveLight;\n#else\n\toutgoingLight += diffuseColor.rgb * ( totalDiffuseLight + totalAmbientLight ) + totalSpecularLight + totalEmissiveLight;\n#endif",_.ShaderChunk.envmap_fragment,_.ShaderChunk.linear_to_gamma_fragment,_.ShaderChunk.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n}"].join("\n")},points:{uniforms:_.UniformsUtils.merge([_.UniformsLib.points,_.UniformsLib.shadowmap]),vertexShader:["uniform float size;\nuniform float scale;",_.ShaderChunk.common,_.ShaderChunk.color_pars_vertex,_.ShaderChunk.shadowmap_pars_vertex,_.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",_.ShaderChunk.color_vertex,"\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / length( mvPosition.xyz ) );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\tgl_Position = projectionMatrix * mvPosition;",_.ShaderChunk.logdepthbuf_vertex,_.ShaderChunk.worldpos_vertex,_.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 psColor;\nuniform float opacity;",_.ShaderChunk.common,_.ShaderChunk.color_pars_fragment,_.ShaderChunk.map_particle_pars_fragment,_.ShaderChunk.fog_pars_fragment,_.ShaderChunk.shadowmap_pars_fragment,_.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( psColor, opacity );\n\tvec3 shadowMask = vec3( 1.0 );",_.ShaderChunk.logdepthbuf_fragment,_.ShaderChunk.map_particle_fragment,_.ShaderChunk.color_fragment,_.ShaderChunk.alphatest_fragment,_.ShaderChunk.shadowmap_fragment,"\toutgoingLight = diffuseColor.rgb * shadowMask;",_.ShaderChunk.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n}"].join("\n")},dashed:{uniforms:_.UniformsUtils.merge([_.UniformsLib.common,_.UniformsLib.fog,{scale:{type:"f",value:1},dashSize:{type:"f",value:1},totalSize:{type:"f",value:2}}]),vertexShader:["uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;",_.ShaderChunk.common,_.ShaderChunk.color_pars_vertex,_.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",_.ShaderChunk.color_vertex,"\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;",_.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;",_.ShaderChunk.common,_.ShaderChunk.color_pars_fragment,_.ShaderChunk.fog_pars_fragment,_.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );",_.ShaderChunk.logdepthbuf_fragment,_.ShaderChunk.color_fragment,"\toutgoingLight = diffuseColor.rgb;",_.ShaderChunk.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n}"].join("\n")},depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2e3},opacity:{type:"f",value:1}},vertexShader:[_.ShaderChunk.common,_.ShaderChunk.morphtarget_pars_vertex,_.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",_.ShaderChunk.begin_vertex,_.ShaderChunk.morphtarget_vertex,_.ShaderChunk.project_vertex,_.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform float mNear;\nuniform float mFar;\nuniform float opacity;",_.ShaderChunk.common,_.ShaderChunk.logdepthbuf_pars_fragment,"void main() {",_.ShaderChunk.logdepthbuf_fragment,"\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\n\t#else\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n\t#endif\n\tfloat color = 1.0 - smoothstep( mNear, mFar, depth );\n\tgl_FragColor = vec4( vec3( color ), opacity );\n}"].join("\n")},normal:{uniforms:{opacity:{type:"f",value:1}},vertexShader:["varying vec3 vNormal;",_.ShaderChunk.common,_.ShaderChunk.morphtarget_pars_vertex,_.ShaderChunk.logdepthbuf_pars_vertex,"void main() {\n\tvNormal = normalize( normalMatrix * normal );",_.ShaderChunk.begin_vertex,_.ShaderChunk.morphtarget_vertex,_.ShaderChunk.project_vertex,_.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;\nvarying vec3 vNormal;",_.ShaderChunk.common,_.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tgl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );",_.ShaderChunk.logdepthbuf_fragment,"}"].join("\n")},cube:{uniforms:{tCube:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:["varying vec3 vWorldPosition;",_.ShaderChunk.common,_.ShaderChunk.logdepthbuf_pars_vertex,"void main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",_.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform samplerCube tCube;\nuniform float tFlip;\nvarying vec3 vWorldPosition;",_.ShaderChunk.common,_.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );",_.ShaderChunk.logdepthbuf_fragment,"}"].join("\n")},equirect:{uniforms:{tEquirect:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:["varying vec3 vWorldPosition;",_.ShaderChunk.common,_.ShaderChunk.logdepthbuf_pars_vertex,"void main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",_.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform sampler2D tEquirect;\nuniform float tFlip;\nvarying vec3 vWorldPosition;",_.ShaderChunk.common,_.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\nvec3 direction = normalize( vWorldPosition );\nvec2 sampleUV;\nsampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );\nsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\ngl_FragColor = texture2D( tEquirect, sampleUV );",_.ShaderChunk.logdepthbuf_fragment,"}"].join("\n")},depthRGBA:{uniforms:{},vertexShader:[_.ShaderChunk.common,_.ShaderChunk.morphtarget_pars_vertex,_.ShaderChunk.skinning_pars_vertex,_.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",_.ShaderChunk.skinbase_vertex,_.ShaderChunk.begin_vertex,_.ShaderChunk.morphtarget_vertex,_.ShaderChunk.skinning_vertex,_.ShaderChunk.project_vertex,_.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:[_.ShaderChunk.common,_.ShaderChunk.logdepthbuf_pars_fragment,"vec4 pack_depth( const in float depth ) {\n\tconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\n\tconst vec4 bit_mask = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\n\tvec4 res = mod( depth * bit_shift * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );\n\tres -= res.xxyz * bit_mask;\n\treturn res;\n}\nvoid main() {",_.ShaderChunk.logdepthbuf_fragment,"\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tgl_FragData[ 0 ] = pack_depth( gl_FragDepthEXT );\n\t#else\n\t\tgl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );\n\t#endif\n}"].join("\n")},distanceRGBA:{uniforms:{lightPos:{type:"v3",value:new _.Vector3(0,0,0)}},vertexShader:["varying vec4 vWorldPosition;",_.ShaderChunk.common,_.ShaderChunk.morphtarget_pars_vertex,_.ShaderChunk.skinning_pars_vertex,"void main() {",_.ShaderChunk.skinbase_vertex,_.ShaderChunk.begin_vertex,_.ShaderChunk.morphtarget_vertex,_.ShaderChunk.skinning_vertex,_.ShaderChunk.project_vertex,_.ShaderChunk.worldpos_vertex,"vWorldPosition = worldPosition;\n}"].join("\n"),fragmentShader:["uniform vec3 lightPos;\nvarying vec4 vWorldPosition;",_.ShaderChunk.common,"vec4 pack1K ( float depth ) {\n   depth /= 1000.0;\n   const vec4 bitSh = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\n\tconst vec4 bitMsk = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\n\tvec4 res = fract( depth * bitSh );\n\tres -= res.xxyz * bitMsk;\n\treturn res; \n}\nfloat unpack1K ( vec4 color ) {\n\tconst vec4 bitSh = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\n\treturn dot( color, bitSh ) * 1000.0;\n}\nvoid main () {\n\tgl_FragColor = pack1K( length( vWorldPosition.xyz - lightPos.xyz ) );\n}"].join("\n")}},_.WebGLRenderer=function(t){function e(t,e,n,i){!0===B&&(t*=i,e*=i,n*=i),bt.clearColor(t,e,n,i)}function n(){Tt.init(),bt.viewport(ot,at,st,lt),e(G.r,G.g,G.b,H)}function i(){it=Z=null,nt="",et=-1,mt=!0,Tt.reset()}function r(t){t.preventDefault(),i(),n(),xt.clear()}function o(t){t=t.target,t.removeEventListener("dispose",o);t:{var e=xt.get(t);if(t.image&&e.__image__webglTextureCube)bt.deleteTexture(e.__image__webglTextureCube);else{if(void 0===e.__webglInit)break t;bt.deleteTexture(e.__webglTexture)}xt.delete(t)}gt.textures--}function a(t){t=t.target,t.removeEventListener("dispose",a);var e=xt.get(t),n=xt.get(t.texture);if(t&&void 0!==n.__webglTexture){if(bt.deleteTexture(n.__webglTexture),t instanceof _.WebGLRenderTargetCube)for(n=0;6>n;n++)bt.deleteFramebuffer(e.__webglFramebuffer[n]),bt.deleteRenderbuffer(e.__webglRenderbuffer[n]);else bt.deleteFramebuffer(e.__webglFramebuffer),bt.deleteRenderbuffer(e.__webglRenderbuffer);xt.delete(t.texture),xt.delete(t)}gt.textures--}function s(t){t=t.target,t.removeEventListener("dispose",s),l(t),xt.delete(t)}function l(t){var e=xt.get(t).program;t.program=void 0,void 0!==e&&St.releaseProgram(e)}function u(t,e){return e[0]-t[0]}function c(t,e){return t.object.renderOrder!==e.object.renderOrder?t.object.renderOrder-e.object.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function h(t,e){return t.object.renderOrder!==e.object.renderOrder?t.object.renderOrder-e.object.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function d(t,e,n,i,r){var o;n.transparent?(i=q,o=++K):(i=W,o=++X),o=i[o],void 0!==o?(o.id=t.id,o.object=t,o.geometry=e,o.material=n,o.z=pt.z,o.group=r):(o={id:t.id,object:t,geometry:e,material:n,z:pt.z,group:r},i.push(o))}function f(t,e){if(!1!==t.visible){if(0!=(t.channels.mask&e.channels.mask))if(t instanceof _.Light)z.push(t);else if(t instanceof _.Sprite)$.push(t);else if(t instanceof _.LensFlare)Q.push(t);else if(t instanceof _.ImmediateRenderObject)!0===J.sortObjects&&(pt.setFromMatrixPosition(t.matrixWorld),pt.applyProjection(dt)),d(t,null,t.material,pt.z,null);else if((t instanceof _.Mesh||t instanceof _.Line||t instanceof _.Points)&&(t instanceof _.SkinnedMesh&&t.skeleton.update(),!1===t.frustumCulled||!0===ht.intersectsObject(t))){var n=t.material;if(!0===n.visible){!0===J.sortObjects&&(pt.setFromMatrixPosition(t.matrixWorld),pt.applyProjection(dt));var i=Et.update(t);if(n instanceof _.MeshFaceMaterial)for(var r=i.groups,o=n.materials,n=0,a=r.length;n<a;n++){var s=r[n],l=o[s.materialIndex];!0===l.visible&&d(t,i,l,pt.z,s)}else d(t,i,n,pt.z,null)}}for(i=t.children,n=0,a=i.length;n<a;n++)f(i[n],e)}}function m(t,e,n,i,r){for(var o=0,a=t.length;o<a;o++){var s=t[o],l=s.object,u=s.geometry,c=void 0===r?s.material:r,s=s.group;if(l.modelViewMatrix.multiplyMatrices(e.matrixWorldInverse,l.matrixWorld),l.normalMatrix.getNormalMatrix(l.modelViewMatrix),l instanceof _.ImmediateRenderObject){v(c);var h=g(e,n,i,c,l);nt="",l.render(function(t){J.renderBufferImmediate(t,h,c)})}else J.renderBufferDirect(e,n,i,u,c,l,s)}}function v(t){t.side!==_.DoubleSide?Tt.enable(bt.CULL_FACE):Tt.disable(bt.CULL_FACE),Tt.setFlipSided(t.side===_.BackSide),!0===t.transparent?Tt.setBlending(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha):Tt.setBlending(_.NoBlending),Tt.setDepthFunc(t.depthFunc),Tt.setDepthTest(t.depthTest),Tt.setDepthWrite(t.depthWrite),Tt.setColorWrite(t.colorWrite),Tt.setPolygonOffset(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)}function g(t,e,n,i,r){rt=0;var o=xt.get(i);if(i.needsUpdate||!o.program){t:{var a=xt.get(i),u=St.getParameters(i,e,n,r),c=St.getProgramCode(i,u),h=a.program,d=!0;if(void 0===h)i.addEventListener("dispose",s);else if(h.code!==c)l(i);else{if(void 0!==u.shaderID)break t;d=!1}if(d&&(u.shaderID?(h=_.ShaderLib[u.shaderID],a.__webglShader={name:i.type,uniforms:_.UniformsUtils.clone(h.uniforms),vertexShader:h.vertexShader,fragmentShader:h.fragmentShader}):a.__webglShader={name:i.type,uniforms:i.uniforms,vertexShader:i.vertexShader,fragmentShader:i.fragmentShader},i.__webglShader=a.__webglShader,h=St.acquireProgram(i,u,c),a.program=h,i.program=h),u=h.getAttributes(),i.morphTargets)for(c=i.numSupportedMorphTargets=0;c<J.maxMorphTargets;c++)0<=u["morphTarget"+c]&&i.numSupportedMorphTargets++;if(i.morphNormals)for(c=i.numSupportedMorphNormals=0;c<J.maxMorphNormals;c++)0<=u["morphNormal"+c]&&i.numSupportedMorphNormals++;a.uniformsList=[];var p,u=a.program.getUniforms();for(p in a.__webglShader.uniforms)(c=u[p])&&a.uniformsList.push([a.__webglShader.uniforms[p],c])}i.needsUpdate=!1}if(c=h=d=!1,a=o.program,p=a.getUniforms(),u=o.__webglShader.uniforms,a.id!==Z&&(bt.useProgram(a.program),Z=a.id,c=h=d=!0),i.id!==et&&(-1===et&&(c=!0),et=i.id,h=!0),(d||t!==it)&&(bt.uniformMatrix4fv(p.projectionMatrix,!1,t.projectionMatrix.elements),wt.logarithmicDepthBuffer&&bt.uniform1f(p.logDepthBufFC,2/(Math.log(t.far+1)/Math.LN2)),t!==it&&(it=t),(i instanceof _.ShaderMaterial||i instanceof _.MeshPhongMaterial||i.envMap)&&void 0!==p.cameraPosition&&(pt.setFromMatrixPosition(t.matrixWorld),bt.uniform3f(p.cameraPosition,pt.x,pt.y,pt.z)),(i instanceof _.MeshPhongMaterial||i instanceof _.MeshLambertMaterial||i instanceof _.MeshBasicMaterial||i instanceof _.ShaderMaterial||i.skinning)&&void 0!==p.viewMatrix&&bt.uniformMatrix4fv(p.viewMatrix,!1,t.matrixWorldInverse.elements)),i.skinning&&(r.bindMatrix&&void 0!==p.bindMatrix&&bt.uniformMatrix4fv(p.bindMatrix,!1,r.bindMatrix.elements),r.bindMatrixInverse&&void 0!==p.bindMatrixInverse&&bt.uniformMatrix4fv(p.bindMatrixInverse,!1,r.bindMatrixInverse.elements),wt.floatVertexTextures&&r.skeleton&&r.skeleton.useVertexTexture?(void 0!==p.boneTexture&&(d=b(),bt.uniform1i(p.boneTexture,d),J.setTexture(r.skeleton.boneTexture,d)),void 0!==p.boneTextureWidth&&bt.uniform1i(p.boneTextureWidth,r.skeleton.boneTextureWidth),void 0!==p.boneTextureHeight&&bt.uniform1i(p.boneTextureHeight,r.skeleton.boneTextureHeight)):r.skeleton&&r.skeleton.boneMatrices&&void 0!==p.boneGlobalMatrices&&bt.uniformMatrix4fv(p.boneGlobalMatrices,!1,r.skeleton.boneMatrices)),h){if(n&&i.fog&&(u.fogColor.value=n.color,n instanceof _.Fog?(u.fogNear.value=n.near,u.fogFar.value=n.far):n instanceof _.FogExp2&&(u.fogDensity.value=n.density)),i instanceof _.MeshPhongMaterial||i instanceof _.MeshLambertMaterial||i.lights){if(mt){var f,m,v,g,c=!0,T=d=0,x=0,E=vt,C=t.matrixWorldInverse,k=E.directional.colors,M=E.directional.positions,L=E.point.colors,P=E.point.positions,D=E.point.distances,I=E.point.decays,F=E.spot.colors,O=E.spot.positions,N=E.spot.distances,U=E.spot.directions,V=E.spot.anglesCos,B=E.spot.exponents,j=E.spot.decays,G=E.hemi.skyColors,H=E.hemi.groundColors,z=E.hemi.positions,W=0,X=0,q=0,K=0,Y=0,$=0,Q=0,tt=0,nt=f=0;for(n=g=nt=0,h=e.length;n<h;n++)f=e[n],m=f.color,v=f.intensity,g=f.distance,f instanceof _.AmbientLight?f.visible&&(d+=m.r,T+=m.g,x+=m.b):f instanceof _.DirectionalLight?(Y+=1,f.visible&&(ft.setFromMatrixPosition(f.matrixWorld),pt.setFromMatrixPosition(f.target.matrixWorld),ft.sub(pt),ft.transformDirection(C),f=3*W,M[f+0]=ft.x,M[f+1]=ft.y,M[f+2]=ft.z,w(k,f,m,v),W+=1)):f instanceof _.PointLight?($+=1,f.visible&&(nt=3*X,w(L,nt,m,v),pt.setFromMatrixPosition(f.matrixWorld),pt.applyMatrix4(C),P[nt+0]=pt.x,P[nt+1]=pt.y,P[nt+2]=pt.z,D[X]=g,I[X]=0===f.distance?0:f.decay,X+=1)):f instanceof _.SpotLight?(Q+=1,f.visible&&(nt=3*q,w(F,nt,m,v),ft.setFromMatrixPosition(f.matrixWorld),pt.copy(ft).applyMatrix4(C),O[nt+0]=pt.x,O[nt+1]=pt.y,O[nt+2]=pt.z,N[q]=g,pt.setFromMatrixPosition(f.target.matrixWorld),ft.sub(pt),ft.transformDirection(C),U[nt+0]=ft.x,U[nt+1]=ft.y,U[nt+2]=ft.z,V[q]=Math.cos(f.angle),B[q]=f.exponent,j[q]=0===f.distance?0:f.decay,q+=1)):f instanceof _.HemisphereLight&&(tt+=1,f.visible&&(ft.setFromMatrixPosition(f.matrixWorld),ft.transformDirection(C),g=3*K,z[g+0]=ft.x,z[g+1]=ft.y,z[g+2]=ft.z,m=f.color,f=f.groundColor,w(G,g,m,v),w(H,g,f,v),K+=1));for(n=3*W,h=Math.max(k.length,3*Y);n<h;n++)k[n]=0;for(n=3*X,h=Math.max(L.length,3*$);n<h;n++)L[n]=0;for(n=3*q,h=Math.max(F.length,3*Q);n<h;n++)F[n]=0;for(n=3*K,h=Math.max(G.length,3*tt);n<h;n++)G[n]=0;for(n=3*K,h=Math.max(H.length,3*tt);n<h;n++)H[n]=0;E.directional.length=W,E.point.length=X,E.spot.length=q,E.hemi.length=K,E.ambient[0]=d,E.ambient[1]=T,E.ambient[2]=x,mt=!1}c?(c=vt,u.ambientLightColor.value=c.ambient,u.directionalLightColor.value=c.directional.colors,u.directionalLightDirection.value=c.directional.positions,u.pointLightColor.value=c.point.colors,u.pointLightPosition.value=c.point.positions,u.pointLightDistance.value=c.point.distances,u.pointLightDecay.value=c.point.decays,u.spotLightColor.value=c.spot.colors,u.spotLightPosition.value=c.spot.positions,u.spotLightDistance.value=c.spot.distances,u.spotLightDirection.value=c.spot.directions,u.spotLightAngleCos.value=c.spot.anglesCos,u.spotLightExponent.value=c.spot.exponents,u.spotLightDecay.value=c.spot.decays,u.hemisphereLightSkyColor.value=c.hemi.skyColors,u.hemisphereLightGroundColor.value=c.hemi.groundColors,u.hemisphereLightDirection.value=c.hemi.positions,y(u,!0)):y(u,!1)}if(i instanceof _.MeshBasicMaterial||i instanceof _.MeshLambertMaterial||i instanceof _.MeshPhongMaterial){u.opacity.value=i.opacity,u.diffuse.value=i.color,i.emissive&&(u.emissive.value=i.emissive),u.map.value=i.map,u.specularMap.value=i.specularMap,u.alphaMap.value=i.alphaMap,i.aoMap&&(u.aoMap.value=i.aoMap,u.aoMapIntensity.value=i.aoMapIntensity);var ot;i.map?ot=i.map:i.specularMap?ot=i.specularMap:i.displacementMap?ot=i.displacementMap:i.normalMap?ot=i.normalMap:i.bumpMap?ot=i.bumpMap:i.alphaMap?ot=i.alphaMap:i.emissiveMap&&(ot=i.emissiveMap),void 0!==ot&&(ot instanceof _.WebGLRenderTarget&&(ot=ot.texture),c=ot.offset,ot=ot.repeat,u.offsetRepeat.value.set(c.x,c.y,ot.x,ot.y)),u.envMap.value=i.envMap,u.flipEnvMap.value=i.envMap instanceof _.WebGLRenderTargetCube?1:-1,u.reflectivity.value=i.reflectivity,u.refractionRatio.value=i.refractionRatio}if(i instanceof _.LineBasicMaterial?(u.diffuse.value=i.color,u.opacity.value=i.opacity):i instanceof _.LineDashedMaterial?(u.diffuse.value=i.color,u.opacity.value=i.opacity,u.dashSize.value=i.dashSize,u.totalSize.value=i.dashSize+i.gapSize,u.scale.value=i.scale):i instanceof _.PointsMaterial?(u.psColor.value=i.color,u.opacity.value=i.opacity,u.size.value=i.size,u.scale.value=R.height/2,u.map.value=i.map,null!==i.map&&(t=i.map.offset,ot=i.map.repeat,u.offsetRepeat.value.set(t.x,t.y,ot.x,ot.y))):i instanceof _.MeshPhongMaterial?(u.specular.value=i.specular,u.shininess.value=Math.max(i.shininess,1e-4),i.lightMap&&(u.lightMap.value=i.lightMap,u.lightMapIntensity.value=i.lightMapIntensity),i.emissiveMap&&(u.emissiveMap.value=i.emissiveMap),i.bumpMap&&(u.bumpMap.value=i.bumpMap,u.bumpScale.value=i.bumpScale),i.normalMap&&(u.normalMap.value=i.normalMap,u.normalScale.value.copy(i.normalScale)),i.displacementMap&&(u.displacementMap.value=i.displacementMap,u.displacementScale.value=i.displacementScale,u.displacementBias.value=i.displacementBias)):i instanceof _.MeshDepthMaterial?(u.mNear.value=t.near,u.mFar.value=t.far,u.opacity.value=i.opacity):i instanceof _.MeshNormalMaterial&&(u.opacity.value=i.opacity),r.receiveShadow&&!i._shadowPass&&u.shadowMatrix)for(t=i=0,ot=e.length;t<ot;t++)c=e[t],!0===c.castShadow&&(c instanceof _.PointLight||c instanceof _.SpotLight||c instanceof _.DirectionalLight)&&(n=c.shadow,c instanceof _.PointLight?(pt.setFromMatrixPosition(c.matrixWorld).negate(),n.matrix.identity().setPosition(pt),u.shadowDarkness.value[i]=-n.darkness):u.shadowDarkness.value[i]=n.darkness,u.shadowMatrix.value[i]=n.matrix,u.shadowMap.value[i]=n.map,u.shadowMapSize.value[i]=n.mapSize,u.shadowBias.value[i]=n.bias,i++);for(e=o.uniformsList,o=0,i=e.length;o<i;o++)if(t=e[o][0],!1!==t.needsUpdate)switch(u=t.type,n=t.value,ot=e[o][1],u){case"1i":bt.uniform1i(ot,n);break;case"1f":bt.uniform1f(ot,n);break;case"2f":bt.uniform2f(ot,n[0],n[1]);break;case"3f":bt.uniform3f(ot,n[0],n[1],n[2]);break;case"4f":bt.uniform4f(ot,n[0],n[1],n[2],n[3]);break;case"1iv":bt.uniform1iv(ot,n);break;case"3iv":bt.uniform3iv(ot,n);break;case"1fv":bt.uniform1fv(ot,n);break;case"2fv":bt.uniform2fv(ot,n);break;case"3fv":bt.uniform3fv(ot,n);break;case"4fv":bt.uniform4fv(ot,n);break;case"Matrix3fv":bt.uniformMatrix3fv(ot,!1,n);break;case"Matrix4fv":bt.uniformMatrix4fv(ot,!1,n);break;case"i":bt.uniform1i(ot,n);break;case"f":bt.uniform1f(ot,n);break;case"v2":bt.uniform2f(ot,n.x,n.y);break;case"v3":bt.uniform3f(ot,n.x,n.y,n.z);break;case"v4":bt.uniform4f(ot,n.x,n.y,n.z,n.w);break;case"c":bt.uniform3f(ot,n.r,n.g,n.b);break;case"iv1":bt.uniform1iv(ot,n);break;case"iv":bt.uniform3iv(ot,n);break;case"fv1":bt.uniform1fv(ot,n);break;case"fv":bt.uniform3fv(ot,n);break;case"v2v":for(void 0===t._array&&(t._array=new Float32Array(2*n.length)),h=u=0,c=n.length;u<c;u++,h+=2)t._array[h+0]=n[u].x,t._array[h+1]=n[u].y;bt.uniform2fv(ot,t._array);break;case"v3v":for(void 0===t._array&&(t._array=new Float32Array(3*n.length)),h=u=0,c=n.length;u<c;u++,h+=3)t._array[h+0]=n[u].x,t._array[h+1]=n[u].y,t._array[h+2]=n[u].z;bt.uniform3fv(ot,t._array);break;case"v4v":for(void 0===t._array&&(t._array=new Float32Array(4*n.length)),h=u=0,c=n.length;u<c;u++,h+=4)t._array[h+0]=n[u].x,t._array[h+1]=n[u].y,t._array[h+2]=n[u].z,t._array[h+3]=n[u].w;bt.uniform4fv(ot,t._array);break;case"m3":bt.uniformMatrix3fv(ot,!1,n.elements);break;case"m3v":for(void 0===t._array&&(t._array=new Float32Array(9*n.length)),u=0,c=n.length;u<c;u++)n[u].flattenToArrayOffset(t._array,9*u);bt.uniformMatrix3fv(ot,!1,t._array);break;case"m4":bt.uniformMatrix4fv(ot,!1,n.elements);break;case"m4v":for(void 0===t._array&&(t._array=new Float32Array(16*n.length)),u=0,c=n.length;u<c;u++)n[u].flattenToArrayOffset(t._array,16*u);bt.uniformMatrix4fv(ot,!1,t._array);break;case"t":if(h=b(),bt.uniform1i(ot,h),!n)continue;n instanceof _.CubeTexture||Array.isArray(n.image)&&6===n.image.length?S(n,h):n instanceof _.WebGLRenderTargetCube?A(n.texture,h):n instanceof _.WebGLRenderTarget?J.setTexture(n.texture,h):J.setTexture(n,h);break;case"tv":for(void 0===t._array&&(t._array=[]),u=0,c=t.value.length;u<c;u++)t._array[u]=b();for(bt.uniform1iv(ot,t._array),u=0,c=t.value.length;u<c;u++)n=t.value[u],h=t._array[u],n&&(n instanceof _.CubeTexture||n.image instanceof Array&&6===n.image.length?S(n,h):n instanceof _.WebGLRenderTarget?J.setTexture(n.texture,h):n instanceof _.WebGLRenderTargetCube?A(n.texture,h):J.setTexture(n,h));break;default:console.warn("THREE.WebGLRenderer: Unknown uniform type: "+u)}}return bt.uniformMatrix4fv(p.modelViewMatrix,!1,r.modelViewMatrix.elements),p.normalMatrix&&bt.uniformMatrix3fv(p.normalMatrix,!1,r.normalMatrix.elements),void 0!==p.modelMatrix&&bt.uniformMatrix4fv(p.modelMatrix,!1,r.matrixWorld.elements),a}function y(t,e){t.ambientLightColor.needsUpdate=e,t.directionalLightColor.needsUpdate=e,t.directionalLightDirection.needsUpdate=e,t.pointLightColor.needsUpdate=e,t.pointLightPosition.needsUpdate=e,t.pointLightDistance.needsUpdate=e,t.pointLightDecay.needsUpdate=e,t.spotLightColor.needsUpdate=e,t.spotLightPosition.needsUpdate=e,t.spotLightDistance.needsUpdate=e,t.spotLightDirection.needsUpdate=e,t.spotLightAngleCos.needsUpdate=e,t.spotLightExponent.needsUpdate=e,t.spotLightDecay.needsUpdate=e,t.hemisphereLightSkyColor.needsUpdate=e,t.hemisphereLightGroundColor.needsUpdate=e,t.hemisphereLightDirection.needsUpdate=e}function b(){var t=rt;return t>=wt.maxTextures&&console.warn("WebGLRenderer: trying to use "+t+" texture units while this GPU supports only "+wt.maxTextures),rt+=1,t}function w(t,e,n,i){t[e+0]=n.r*i,t[e+1]=n.g*i,t[e+2]=n.b*i}function T(t,e,n){n?(bt.texParameteri(t,bt.TEXTURE_WRAP_S,L(e.wrapS)),bt.texParameteri(t,bt.TEXTURE_WRAP_T,L(e.wrapT)),bt.texParameteri(t,bt.TEXTURE_MAG_FILTER,L(e.magFilter)),bt.texParameteri(t,bt.TEXTURE_MIN_FILTER,L(e.minFilter))):(bt.texParameteri(t,bt.TEXTURE_WRAP_S,bt.CLAMP_TO_EDGE),bt.texParameteri(t,bt.TEXTURE_WRAP_T,bt.CLAMP_TO_EDGE),e.wrapS===_.ClampToEdgeWrapping&&e.wrapT===_.ClampToEdgeWrapping||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",e),bt.texParameteri(t,bt.TEXTURE_MAG_FILTER,M(e.magFilter)),bt.texParameteri(t,bt.TEXTURE_MIN_FILTER,M(e.minFilter)),e.minFilter!==_.NearestFilter&&e.minFilter!==_.LinearFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",e)),!(n=_t.get("EXT_texture_filter_anisotropic"))||e.type===_.FloatType&&null===_t.get("OES_texture_float_linear")||e.type===_.HalfFloatType&&null===_t.get("OES_texture_half_float_linear")||!(1<e.anisotropy||xt.get(e).__currentAnisotropy)||(bt.texParameterf(t,n.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(e.anisotropy,J.getMaxAnisotropy())),xt.get(e).__currentAnisotropy=e.anisotropy)}function x(t,e){if(t.width>e||t.height>e){var n=e/Math.max(t.width,t.height),i=document.createElement("canvas");return i.width=Math.floor(t.width*n),i.height=Math.floor(t.height*n),i.getContext("2d").drawImage(t,0,0,t.width,t.height,0,0,i.width,i.height),console.warn("THREE.WebGLRenderer: image is too big ("+t.width+"x"+t.height+"). Resized to "+i.width+"x"+i.height,t),i}return t}function E(t){return _.Math.isPowerOfTwo(t.width)&&_.Math.isPowerOfTwo(t.height)}function S(t,e){var n=xt.get(t);if(6===t.image.length)if(0<t.version&&n.__version!==t.version){n.__image__webglTextureCube||(t.addEventListener("dispose",o),n.__image__webglTextureCube=bt.createTexture(),gt.textures++),Tt.activeTexture(bt.TEXTURE0+e),Tt.bindTexture(bt.TEXTURE_CUBE_MAP,n.__image__webglTextureCube),bt.pixelStorei(bt.UNPACK_FLIP_Y_WEBGL,t.flipY);for(var i=t instanceof _.CompressedTexture,r=t.image[0]instanceof _.DataTexture,a=[],s=0;6>s;s++)a[s]=!J.autoScaleCubemaps||i||r?r?t.image[s].image:t.image[s]:x(t.image[s],wt.maxCubemapSize);var l=E(a[0]),u=L(t.format),c=L(t.type);for(T(bt.TEXTURE_CUBE_MAP,t,l),s=0;6>s;s++)if(i)for(var h,d=a[s].mipmaps,p=0,f=d.length;p<f;p++)h=d[p],t.format!==_.RGBAFormat&&t.format!==_.RGBFormat?-1<Tt.getCompressedTextureFormats().indexOf(u)?Tt.compressedTexImage2D(bt.TEXTURE_CUBE_MAP_POSITIVE_X+s,p,u,h.width,h.height,0,h.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setCubeTexture()"):Tt.texImage2D(bt.TEXTURE_CUBE_MAP_POSITIVE_X+s,p,u,h.width,h.height,0,u,c,h.data);else r?Tt.texImage2D(bt.TEXTURE_CUBE_MAP_POSITIVE_X+s,0,u,a[s].width,a[s].height,0,u,c,a[s].data):Tt.texImage2D(bt.TEXTURE_CUBE_MAP_POSITIVE_X+s,0,u,u,c,a[s]);t.generateMipmaps&&l&&bt.generateMipmap(bt.TEXTURE_CUBE_MAP),n.__version=t.version,t.onUpdate&&t.onUpdate(t)}else Tt.activeTexture(bt.TEXTURE0+e),Tt.bindTexture(bt.TEXTURE_CUBE_MAP,n.__image__webglTextureCube)}function A(t,e){Tt.activeTexture(bt.TEXTURE0+e),Tt.bindTexture(bt.TEXTURE_CUBE_MAP,xt.get(t).__webglTexture)}function C(t,e,n){bt.bindFramebuffer(bt.FRAMEBUFFER,t),bt.framebufferTexture2D(bt.FRAMEBUFFER,bt.COLOR_ATTACHMENT0,n,xt.get(e.texture).__webglTexture,0)}function k(t,e){bt.bindRenderbuffer(bt.RENDERBUFFER,t),e.depthBuffer&&!e.stencilBuffer?(bt.renderbufferStorage(bt.RENDERBUFFER,bt.DEPTH_COMPONENT16,e.width,e.height),bt.framebufferRenderbuffer(bt.FRAMEBUFFER,bt.DEPTH_ATTACHMENT,bt.RENDERBUFFER,t)):e.depthBuffer&&e.stencilBuffer?(bt.renderbufferStorage(bt.RENDERBUFFER,bt.DEPTH_STENCIL,e.width,e.height),bt.framebufferRenderbuffer(bt.FRAMEBUFFER,bt.DEPTH_STENCIL_ATTACHMENT,bt.RENDERBUFFER,t)):bt.renderbufferStorage(bt.RENDERBUFFER,bt.RGBA4,e.width,e.height)}function M(t){return t===_.NearestFilter||t===_.NearestMipMapNearestFilter||t===_.NearestMipMapLinearFilter?bt.NEAREST:bt.LINEAR}function L(t){var e;if(t===_.RepeatWrapping)return bt.REPEAT;if(t===_.ClampToEdgeWrapping)return bt.CLAMP_TO_EDGE;if(t===_.MirroredRepeatWrapping)return bt.MIRRORED_REPEAT;if(t===_.NearestFilter)return bt.NEAREST;if(t===_.NearestMipMapNearestFilter)return bt.NEAREST_MIPMAP_NEAREST;if(t===_.NearestMipMapLinearFilter)return bt.NEAREST_MIPMAP_LINEAR;if(t===_.LinearFilter)return bt.LINEAR;if(t===_.LinearMipMapNearestFilter)return bt.LINEAR_MIPMAP_NEAREST;if(t===_.LinearMipMapLinearFilter)return bt.LINEAR_MIPMAP_LINEAR;if(t===_.UnsignedByteType)return bt.UNSIGNED_BYTE;if(t===_.UnsignedShort4444Type)return bt.UNSIGNED_SHORT_4_4_4_4;if(t===_.UnsignedShort5551Type)return bt.UNSIGNED_SHORT_5_5_5_1;if(t===_.UnsignedShort565Type)return bt.UNSIGNED_SHORT_5_6_5;if(t===_.ByteType)return bt.BYTE;if(t===_.ShortType)return bt.SHORT;if(t===_.UnsignedShortType)return bt.UNSIGNED_SHORT;if(t===_.IntType)return bt.INT;if(t===_.UnsignedIntType)return bt.UNSIGNED_INT;if(t===_.FloatType)return bt.FLOAT;if(null!==(e=_t.get("OES_texture_half_float"))&&t===_.HalfFloatType)return e.HALF_FLOAT_OES;if(t===_.AlphaFormat)return bt.ALPHA;if(t===_.RGBFormat)return bt.RGB;if(t===_.RGBAFormat)return bt.RGBA;if(t===_.LuminanceFormat)return bt.LUMINANCE;if(t===_.LuminanceAlphaFormat)return bt.LUMINANCE_ALPHA;if(t===_.AddEquation)return bt.FUNC_ADD;if(t===_.SubtractEquation)return bt.FUNC_SUBTRACT;if(t===_.ReverseSubtractEquation)return bt.FUNC_REVERSE_SUBTRACT;if(t===_.ZeroFactor)return bt.ZERO;if(t===_.OneFactor)return bt.ONE;if(t===_.SrcColorFactor)return bt.SRC_COLOR;if(t===_.OneMinusSrcColorFactor)return bt.ONE_MINUS_SRC_COLOR;if(t===_.SrcAlphaFactor)return bt.SRC_ALPHA;if(t===_.OneMinusSrcAlphaFactor)return bt.ONE_MINUS_SRC_ALPHA;if(t===_.DstAlphaFactor)return bt.DST_ALPHA;if(t===_.OneMinusDstAlphaFactor)return bt.ONE_MINUS_DST_ALPHA;if(t===_.DstColorFactor)return bt.DST_COLOR;if(t===_.OneMinusDstColorFactor)return bt.ONE_MINUS_DST_COLOR;if(t===_.SrcAlphaSaturateFactor)return bt.SRC_ALPHA_SATURATE;if(null!==(e=_t.get("WEBGL_compressed_texture_s3tc"))){if(t===_.RGB_S3TC_DXT1_Format)return e.COMPRESSED_RGB_S3TC_DXT1_EXT;if(t===_.RGBA_S3TC_DXT1_Format)return e.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(t===_.RGBA_S3TC_DXT3_Format)return e.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(t===_.RGBA_S3TC_DXT5_Format)return e.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(null!==(e=_t.get("WEBGL_compressed_texture_pvrtc"))){if(t===_.RGB_PVRTC_4BPPV1_Format)return e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(t===_.RGB_PVRTC_2BPPV1_Format)return e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(t===_.RGBA_PVRTC_4BPPV1_Format)return e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(t===_.RGBA_PVRTC_2BPPV1_Format)return e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(null!==(e=_t.get("EXT_blend_minmax"))){if(t===_.MinEquation)return e.MIN_EXT;if(t===_.MaxEquation)return e.MAX_EXT}return 0}console.log("THREE.WebGLRenderer",_.REVISION),t=t||{};var R=void 0!==t.canvas?t.canvas:document.createElement("canvas"),P=void 0!==t.context?t.context:null,D=R.width,I=R.height,F=1,O=void 0!==t.alpha&&t.alpha,N=void 0===t.depth||t.depth,U=void 0===t.stencil||t.stencil,V=void 0!==t.antialias&&t.antialias,B=void 0===t.premultipliedAlpha||t.premultipliedAlpha,j=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,G=new _.Color(0),H=0,z=[],W=[],X=-1,q=[],K=-1,Y=new Float32Array(8),$=[],Q=[];this.domElement=R,this.context=null,this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0,this.gammaFactor=2,this.gammaOutput=this.gammaInput=!1,this.maxMorphTargets=8,this.maxMorphNormals=4,this.autoScaleCubemaps=!0;var J=this,Z=null,tt=null,et=-1,nt="",it=null,rt=0,ot=0,at=0,st=R.width,lt=R.height,ut=0,ct=0,ht=new _.Frustum,dt=new _.Matrix4,pt=new _.Vector3,ft=new _.Vector3,mt=!0,vt={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[],decays:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[],decays:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}},gt={geometries:0,textures:0},yt={calls:0,vertices:0,faces:0,points:0};this.info={render:yt,memory:gt,programs:null};var bt;try{if(O={alpha:O,depth:N,stencil:U,antialias:V,premultipliedAlpha:B,preserveDrawingBuffer:j},null===(bt=P||R.getContext("webgl",O)||R.getContext("experimental-webgl",O))){if(null!==R.getContext("webgl"))throw"Error creating WebGL context with your selected attributes.";throw"Error creating WebGL context."}R.addEventListener("webglcontextlost",r,!1)}catch(t){console.error("THREE.WebGLRenderer: "+t)}var _t=new _.WebGLExtensions(bt);_t.get("OES_texture_float"),_t.get("OES_texture_float_linear"),_t.get("OES_texture_half_float"),_t.get("OES_texture_half_float_linear"),_t.get("OES_standard_derivatives"),_t.get("ANGLE_instanced_arrays"),_t.get("OES_element_index_uint")&&(_.BufferGeometry.MaxIndex=4294967296);var wt=new _.WebGLCapabilities(bt,_t,t),Tt=new _.WebGLState(bt,_t,L),xt=new _.WebGLProperties,Et=new _.WebGLObjects(bt,xt,this.info),St=new _.WebGLPrograms(this,wt);this.info.programs=St.programs;var At=new _.WebGLBufferRenderer(bt,_t,yt),Ct=new _.WebGLIndexedBufferRenderer(bt,_t,yt);n(),this.context=bt,this.capabilities=wt,this.extensions=_t,this.state=Tt;var kt=new _.WebGLShadowMap(this,z,Et);this.shadowMap=kt;var Mt=new _.SpritePlugin(this,$),Lt=new _.LensFlarePlugin(this,Q);this.getContext=function(){return bt},this.getContextAttributes=function(){return bt.getContextAttributes()},this.forceContextLoss=function(){_t.get("WEBGL_lose_context").loseContext()},this.getMaxAnisotropy=function(){var t;return function(){if(void 0!==t)return t;var e=_t.get("EXT_texture_filter_anisotropic");return t=null!==e?bt.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}}(),this.getPrecision=function(){return wt.precision},this.getPixelRatio=function(){return F},this.setPixelRatio=function(t){void 0!==t&&(F=t)},this.getSize=function(){return{width:D,height:I}},this.setSize=function(t,e,n){D=t,I=e,R.width=t*F,R.height=e*F,!1!==n&&(R.style.width=t+"px",R.style.height=e+"px"),this.setViewport(0,0,t,e)},this.setViewport=function(t,e,n,i){ot=t*F,at=e*F,st=n*F,lt=i*F,bt.viewport(ot,at,st,lt)},this.getViewport=function(t){t.x=ot/F,t.y=at/F,t.z=st/F,t.w=lt/F},this.setScissor=function(t,e,n,i){bt.scissor(t*F,e*F,n*F,i*F)},this.enableScissorTest=function(t){Tt.setScissorTest(t)},this.getClearColor=function(){return G},this.setClearColor=function(t,n){G.set(t),H=void 0!==n?n:1,e(G.r,G.g,G.b,H)},this.getClearAlpha=function(){return H},this.setClearAlpha=function(t){H=t,e(G.r,G.g,G.b,H)},this.clear=function(t,e,n){var i=0;(void 0===t||t)&&(i|=bt.COLOR_BUFFER_BIT),(void 0===e||e)&&(i|=bt.DEPTH_BUFFER_BIT),(void 0===n||n)&&(i|=bt.STENCIL_BUFFER_BIT),bt.clear(i)},this.clearColor=function(){bt.clear(bt.COLOR_BUFFER_BIT)},this.clearDepth=function(){bt.clear(bt.DEPTH_BUFFER_BIT)},this.clearStencil=function(){bt.clear(bt.STENCIL_BUFFER_BIT)},this.clearTarget=function(t,e,n,i){this.setRenderTarget(t),this.clear(e,n,i)},this.resetGLState=i,this.dispose=function(){R.removeEventListener("webglcontextlost",r,!1)},this.renderBufferImmediate=function(t,e,n){Tt.initAttributes();var i=xt.get(t);if(t.hasPositions&&!i.position&&(i.position=bt.createBuffer()),t.hasNormals&&!i.normal&&(i.normal=bt.createBuffer()),t.hasUvs&&!i.uv&&(i.uv=bt.createBuffer()),t.hasColors&&!i.color&&(i.color=bt.createBuffer()),e=e.getAttributes(),t.hasPositions&&(bt.bindBuffer(bt.ARRAY_BUFFER,i.position),bt.bufferData(bt.ARRAY_BUFFER,t.positionArray,bt.DYNAMIC_DRAW),Tt.enableAttribute(e.position),bt.vertexAttribPointer(e.position,3,bt.FLOAT,!1,0,0)),t.hasNormals){if(bt.bindBuffer(bt.ARRAY_BUFFER,i.normal),"MeshPhongMaterial"!==n.type&&n.shading===_.FlatShading)for(var r=0,o=3*t.count;r<o;r+=9){var a=t.normalArray,s=(a[r+0]+a[r+3]+a[r+6])/3,l=(a[r+1]+a[r+4]+a[r+7])/3,u=(a[r+2]+a[r+5]+a[r+8])/3;a[r+0]=s,a[r+1]=l,a[r+2]=u,a[r+3]=s,a[r+4]=l,a[r+5]=u,a[r+6]=s,a[r+7]=l,a[r+8]=u}bt.bufferData(bt.ARRAY_BUFFER,t.normalArray,bt.DYNAMIC_DRAW),Tt.enableAttribute(e.normal),bt.vertexAttribPointer(e.normal,3,bt.FLOAT,!1,0,0)}t.hasUvs&&n.map&&(bt.bindBuffer(bt.ARRAY_BUFFER,i.uv),bt.bufferData(bt.ARRAY_BUFFER,t.uvArray,bt.DYNAMIC_DRAW),Tt.enableAttribute(e.uv),bt.vertexAttribPointer(e.uv,2,bt.FLOAT,!1,0,0)),t.hasColors&&n.vertexColors!==_.NoColors&&(bt.bindBuffer(bt.ARRAY_BUFFER,i.color),bt.bufferData(bt.ARRAY_BUFFER,t.colorArray,bt.DYNAMIC_DRAW),Tt.enableAttribute(e.color),bt.vertexAttribPointer(e.color,3,bt.FLOAT,!1,0,0)),Tt.disableUnusedAttributes(),bt.drawArrays(bt.TRIANGLES,0,t.count),t.count=0},this.renderBufferDirect=function(t,e,n,i,r,o,a){v(r);var s=g(t,e,n,r,o),l=!1;if(t=i.id+"_"+s.id+"_"+r.wireframe,t!==nt&&(nt=t,l=!0),void 0!==(e=o.morphTargetInfluences)){for(t=[],n=0,l=e.length;n<l;n++){var c=e[n];t.push([c,n])}t.sort(u),8<t.length&&(t.length=8);var h=i.morphAttributes;for(n=0,l=t.length;n<l;n++)c=t[n],Y[n]=c[0],0!==c[0]?(e=c[1],!0===r.morphTargets&&h.position&&i.addAttribute("morphTarget"+n,h.position[e]),!0===r.morphNormals&&h.normal&&i.addAttribute("morphNormal"+n,h.normal[e])):(!0===r.morphTargets&&i.removeAttribute("morphTarget"+n),!0===r.morphNormals&&i.removeAttribute("morphNormal"+n));t=s.getUniforms(),null!==t.morphTargetInfluences&&bt.uniform1fv(t.morphTargetInfluences,Y),l=!0}if(e=i.index,n=i.attributes.position,!0===r.wireframe&&(e=Et.getWireframeAttribute(i)),null!==e?(t=Ct,t.setIndex(e)):t=At,l){var d,l=void 0;if(i instanceof _.InstancedBufferGeometry&&null===(d=_t.get("ANGLE_instanced_arrays")))console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{void 0===l&&(l=0),Tt.initAttributes();var p,c=i.attributes,s=s.getAttributes(),h=r.defaultAttributeValues;for(p in s){var f=s[p];if(0<=f){var m=c[p];if(void 0!==m){var y=m.itemSize,b=Et.getAttributeBuffer(m);if(m instanceof _.InterleavedBufferAttribute){var w=m.data,T=w.stride,m=m.offset;w instanceof _.InstancedInterleavedBuffer?(Tt.enableAttributeAndDivisor(f,w.meshPerAttribute,d),void 0===i.maxInstancedCount&&(i.maxInstancedCount=w.meshPerAttribute*w.count)):Tt.enableAttribute(f),bt.bindBuffer(bt.ARRAY_BUFFER,b),bt.vertexAttribPointer(f,y,bt.FLOAT,!1,T*w.array.BYTES_PER_ELEMENT,(l*T+m)*w.array.BYTES_PER_ELEMENT)}else m instanceof _.InstancedBufferAttribute?(Tt.enableAttributeAndDivisor(f,m.meshPerAttribute,d),void 0===i.maxInstancedCount&&(i.maxInstancedCount=m.meshPerAttribute*m.count)):Tt.enableAttribute(f),bt.bindBuffer(bt.ARRAY_BUFFER,b),bt.vertexAttribPointer(f,y,bt.FLOAT,!1,0,l*y*4)}else if(void 0!==h&&void 0!==(y=h[p]))switch(y.length){case 2:bt.vertexAttrib2fv(f,y);break;case 3:bt.vertexAttrib3fv(f,y);break;case 4:bt.vertexAttrib4fv(f,y);break;default:bt.vertexAttrib1fv(f,y)}}}Tt.disableUnusedAttributes()}null!==e&&bt.bindBuffer(bt.ELEMENT_ARRAY_BUFFER,Et.getAttributeBuffer(e))}d=1/0,null!==e?d=e.count:void 0!==n&&(d=n.count),p=i.drawRange.start,e=i.drawRange.count,n=null!==a?a.start:0,l=null!==a?a.count:1/0,a=Math.max(0,p,n),d=Math.min(0+d,p+e,n+l)-1,d=Math.max(0,d-a+1),o instanceof _.Mesh?(!0===r.wireframe?(Tt.setLineWidth(r.wireframeLinewidth*F),t.setMode(bt.LINES)):t.setMode(bt.TRIANGLES),i instanceof _.InstancedBufferGeometry&&0<i.maxInstancedCount?t.renderInstances(i):t.render(a,d)):o instanceof _.Line?(i=r.linewidth,void 0===i&&(i=1),Tt.setLineWidth(i*F),o instanceof _.LineSegments?t.setMode(bt.LINES):t.setMode(bt.LINE_STRIP),t.render(a,d)):o instanceof _.Points&&(t.setMode(bt.POINTS),t.render(a,d))},this.render=function(t,e,n,i){if(!1==e instanceof _.Camera)console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");else{var r=t.fog;nt="",et=-1,it=null,mt=!0,!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),e.matrixWorldInverse.getInverse(e.matrixWorld),dt.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),ht.setFromMatrix(dt),z.length=0,K=X=-1,$.length=0,Q.length=0,f(t,e),W.length=X+1,q.length=K+1,!0===J.sortObjects&&(W.sort(c),q.sort(h)),kt.render(t),yt.calls=0,yt.vertices=0,yt.faces=0,yt.points=0,this.setRenderTarget(n),(this.autoClear||i)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil),t.overrideMaterial?(i=t.overrideMaterial,m(W,e,z,r,i),m(q,e,z,r,i)):(Tt.setBlending(_.NoBlending),m(W,e,z,r),m(q,e,z,r)),Mt.render(t,e),Lt.render(t,e,ut,ct),n&&(t=n.texture,e=E(n),t.generateMipmaps&&e&&t.minFilter!==_.NearestFilter&&t.minFilter!==_.LinearFilter&&(t=n instanceof _.WebGLRenderTargetCube?bt.TEXTURE_CUBE_MAP:bt.TEXTURE_2D,n=xt.get(n.texture).__webglTexture,Tt.bindTexture(t,n),bt.generateMipmap(t),Tt.bindTexture(t,null))),Tt.setDepthTest(!0),Tt.setDepthWrite(!0),Tt.setColorWrite(!0)}},this.setFaceCulling=function(t,e){t===_.CullFaceNone?Tt.disable(bt.CULL_FACE):(e===_.FrontFaceDirectionCW?bt.frontFace(bt.CW):bt.frontFace(bt.CCW),t===_.CullFaceBack?bt.cullFace(bt.BACK):t===_.CullFaceFront?bt.cullFace(bt.FRONT):bt.cullFace(bt.FRONT_AND_BACK),Tt.enable(bt.CULL_FACE))},this.setTexture=function(t,e){var n=xt.get(t);if(0<t.version&&n.__version!==t.version){var i=t.image;if(void 0===i)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",t);else if(!1===i.complete)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",t);else{if(void 0===n.__webglInit&&(n.__webglInit=!0,t.addEventListener("dispose",o),n.__webglTexture=bt.createTexture(),gt.textures++),Tt.activeTexture(bt.TEXTURE0+e),Tt.bindTexture(bt.TEXTURE_2D,n.__webglTexture),bt.pixelStorei(bt.UNPACK_FLIP_Y_WEBGL,t.flipY),bt.pixelStorei(bt.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),bt.pixelStorei(bt.UNPACK_ALIGNMENT,t.unpackAlignment),t.image=x(t.image,wt.maxTextureSize),(t.wrapS!==_.ClampToEdgeWrapping||t.wrapT!==_.ClampToEdgeWrapping||t.minFilter!==_.NearestFilter&&t.minFilter!==_.LinearFilter)&&!1===E(t.image)){if((i=t.image)instanceof HTMLImageElement||i instanceof HTMLCanvasElement){var r=document.createElement("canvas");r.width=_.Math.nearestPowerOfTwo(i.width),r.height=_.Math.nearestPowerOfTwo(i.height),r.getContext("2d").drawImage(i,0,0,r.width,r.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+i.width+"x"+i.height+"). Resized to "+r.width+"x"+r.height,i),i=r}t.image=i}var a=t.image,i=E(a),r=L(t.format),s=L(t.type);T(bt.TEXTURE_2D,t,i);var l=t.mipmaps;if(t instanceof _.DataTexture)if(0<l.length&&i){for(var u=0,c=l.length;u<c;u++)a=l[u],Tt.texImage2D(bt.TEXTURE_2D,u,r,a.width,a.height,0,r,s,a.data);t.generateMipmaps=!1}else Tt.texImage2D(bt.TEXTURE_2D,0,r,a.width,a.height,0,r,s,a.data);else if(t instanceof _.CompressedTexture)for(u=0,c=l.length;u<c;u++)a=l[u],t.format!==_.RGBAFormat&&t.format!==_.RGBFormat?-1<Tt.getCompressedTextureFormats().indexOf(r)?Tt.compressedTexImage2D(bt.TEXTURE_2D,u,r,a.width,a.height,0,a.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Tt.texImage2D(bt.TEXTURE_2D,u,r,a.width,a.height,0,r,s,a.data);else if(0<l.length&&i){for(u=0,c=l.length;u<c;u++)a=l[u],Tt.texImage2D(bt.TEXTURE_2D,u,r,r,s,a);t.generateMipmaps=!1}else Tt.texImage2D(bt.TEXTURE_2D,0,r,r,s,t.image);t.generateMipmaps&&i&&bt.generateMipmap(bt.TEXTURE_2D),n.__version=t.version,t.onUpdate&&t.onUpdate(t)}}else Tt.activeTexture(bt.TEXTURE0+e),Tt.bindTexture(bt.TEXTURE_2D,n.__webglTexture)},this.setRenderTarget=function(t){var e=t instanceof _.WebGLRenderTargetCube;if(t&&void 0===xt.get(t).__webglFramebuffer){var n=xt.get(t),i=xt.get(t.texture);void 0===t.depthBuffer&&(t.depthBuffer=!0),void 0===t.stencilBuffer&&(t.stencilBuffer=!0),t.addEventListener("dispose",a),i.__webglTexture=bt.createTexture(),gt.textures++;var r=E(t),o=L(t.texture.format),s=L(t.texture.type);if(e){for(n.__webglFramebuffer=[],n.__webglRenderbuffer=[],Tt.bindTexture(bt.TEXTURE_CUBE_MAP,i.__webglTexture),T(bt.TEXTURE_CUBE_MAP,t.texture,r),i=0;6>i;i++)n.__webglFramebuffer[i]=bt.createFramebuffer(),n.__webglRenderbuffer[i]=bt.createRenderbuffer(),Tt.texImage2D(bt.TEXTURE_CUBE_MAP_POSITIVE_X+i,0,o,t.width,t.height,0,o,s,null),C(n.__webglFramebuffer[i],t,bt.TEXTURE_CUBE_MAP_POSITIVE_X+i),k(n.__webglRenderbuffer[i],t);t.texture.generateMipmaps&&r&&bt.generateMipmap(bt.TEXTURE_CUBE_MAP)}else n.__webglFramebuffer=bt.createFramebuffer(),n.__webglRenderbuffer=t.shareDepthFrom?t.shareDepthFrom.__webglRenderbuffer:bt.createRenderbuffer(),Tt.bindTexture(bt.TEXTURE_2D,i.__webglTexture),T(bt.TEXTURE_2D,t.texture,r),Tt.texImage2D(bt.TEXTURE_2D,0,o,t.width,t.height,0,o,s,null),C(n.__webglFramebuffer,t,bt.TEXTURE_2D),t.shareDepthFrom?t.depthBuffer&&!t.stencilBuffer?bt.framebufferRenderbuffer(bt.FRAMEBUFFER,bt.DEPTH_ATTACHMENT,bt.RENDERBUFFER,n.__webglRenderbuffer):t.depthBuffer&&t.stencilBuffer&&bt.framebufferRenderbuffer(bt.FRAMEBUFFER,bt.DEPTH_STENCIL_ATTACHMENT,bt.RENDERBUFFER,n.__webglRenderbuffer):k(n.__webglRenderbuffer,t),t.texture.generateMipmaps&&r&&bt.generateMipmap(bt.TEXTURE_2D);e?Tt.bindTexture(bt.TEXTURE_CUBE_MAP,null):Tt.bindTexture(bt.TEXTURE_2D,null),bt.bindRenderbuffer(bt.RENDERBUFFER,null),bt.bindFramebuffer(bt.FRAMEBUFFER,null)}t?(n=xt.get(t),i=e?n.__webglFramebuffer[t.activeCubeFace]:n.__webglFramebuffer,n=t.width,r=t.height,s=o=0):(i=null,n=st,r=lt,o=ot,s=at),i!==tt&&(bt.bindFramebuffer(bt.FRAMEBUFFER,i),bt.viewport(o,s,n,r),tt=i),e&&(i=xt.get(t.texture),bt.framebufferTexture2D(bt.FRAMEBUFFER,bt.COLOR_ATTACHMENT0,bt.TEXTURE_CUBE_MAP_POSITIVE_X+t.activeCubeFace,i.__webglTexture,0)),ut=n,ct=r},this.readRenderTargetPixels=function(t,e,n,i,r,o){if(!1==t instanceof _.WebGLRenderTarget)console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");else{var a=xt.get(t).__webglFramebuffer;if(a){var s=!1;a!==tt&&(bt.bindFramebuffer(bt.FRAMEBUFFER,a),s=!0);try{var l=t.texture;l.format!==_.RGBAFormat&&L(l.format)!==bt.getParameter(bt.IMPLEMENTATION_COLOR_READ_FORMAT)?console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format."):l.type===_.UnsignedByteType||L(l.type)===bt.getParameter(bt.IMPLEMENTATION_COLOR_READ_TYPE)||l.type===_.FloatType&&_t.get("WEBGL_color_buffer_float")||l.type===_.HalfFloatType&&_t.get("EXT_color_buffer_half_float")?bt.checkFramebufferStatus(bt.FRAMEBUFFER)===bt.FRAMEBUFFER_COMPLETE?bt.readPixels(e,n,i,r,L(l.format),L(l.type),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."):console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.")}finally{s&&bt.bindFramebuffer(bt.FRAMEBUFFER,tt)}}}},this.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),_t.get("OES_texture_float")},this.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),_t.get("OES_texture_half_float")},this.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),_t.get("OES_standard_derivatives")},this.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),_t.get("WEBGL_compressed_texture_s3tc")},this.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),_t.get("WEBGL_compressed_texture_pvrtc")},this.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),_t.get("EXT_blend_minmax")},this.supportsVertexTextures=function(){return wt.vertexTextures},this.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),_t.get("ANGLE_instanced_arrays")},this.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},this.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},this.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},this.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},(0,p.default)(this,{shadowMapEnabled:{get:function(){return kt.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),kt.enabled=t}},shadowMapType:{get:function(){return kt.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),kt.type=t}},shadowMapCullFace:{get:function(){return kt.cullFace},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace."),kt.cullFace=t}},shadowMapDebug:{get:function(){return kt.debug},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapDebug is now .shadowMap.debug."),kt.debug=t}}})},_.WebGLRenderTarget=function(t,e,n){this.uuid=_.Math.generateUUID(),this.width=t,this.height=e,n=n||{},void 0===n.minFilter&&(n.minFilter=_.LinearFilter),this.texture=new _.Texture(void 0,void 0,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy),this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.shareDepthFrom=void 0!==n.shareDepthFrom?n.shareDepthFrom:null},_.WebGLRenderTarget.prototype={constructor:_.WebGLRenderTarget,get wrapS(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set wrapS(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t},get wrapT(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set wrapT(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t},get magFilter(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set magFilter(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t},get minFilter(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set minFilter(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t},get anisotropy(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set anisotropy(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t},get offset(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set offset(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t},get repeat(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set repeat(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t},get format(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set format(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t},get type(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set type(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t},get generateMipmaps(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set generateMipmaps(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t},setSize:function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.dispose())},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.shareDepthFrom=t.shareDepthFrom,this},dispose:function(){this.dispatchEvent({type:"dispose"})}},_.EventDispatcher.prototype.apply(_.WebGLRenderTarget.prototype),_.WebGLRenderTargetCube=function(t,e,n){_.WebGLRenderTarget.call(this,t,e,n),this.activeCubeFace=0},_.WebGLRenderTargetCube.prototype=(0,u.default)(_.WebGLRenderTarget.prototype),_.WebGLRenderTargetCube.prototype.constructor=_.WebGLRenderTargetCube,_.WebGLBufferRenderer=function(t,e,n){var i;this.setMode=function(t){i=t},this.render=function(e,r){t.drawArrays(i,e,r),n.calls++,n.vertices+=r,i===t.TRIANGLES&&(n.faces+=r/3)},this.renderInstances=function(t){var n=e.get("ANGLE_instanced_arrays");if(null===n)console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{var r=t.attributes.position;r instanceof _.InterleavedBufferAttribute?n.drawArraysInstancedANGLE(i,0,r.data.count,t.maxInstancedCount):n.drawArraysInstancedANGLE(i,0,r.count,t.maxInstancedCount)}}},_.WebGLIndexedBufferRenderer=function(t,e,n){var i,r,o;this.setMode=function(t){i=t},this.setIndex=function(n){n.array instanceof Uint32Array&&e.get("OES_element_index_uint")?(r=t.UNSIGNED_INT,o=4):(r=t.UNSIGNED_SHORT,o=2)},this.render=function(e,a){t.drawElements(i,a,r,e*o),n.calls++,n.vertices+=a,i===t.TRIANGLES&&(n.faces+=a/3)},this.renderInstances=function(t){var n=e.get("ANGLE_instanced_arrays");null===n?console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays."):n.drawElementsInstancedANGLE(i,t.index.array.length,r,0,t.maxInstancedCount)}},_.WebGLExtensions=function(t){var e={};this.get=function(n){if(void 0!==e[n])return e[n];var i;switch(n){case"EXT_texture_filter_anisotropic":i=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=t.getExtension(n)}return null===i&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),e[n]=i}},_.WebGLCapabilities=function(t,e,n){function i(e){if("highp"===e){if(0<t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision&&0<t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision)return"highp";e="mediump"}return"mediump"===e&&0<t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision&&0<t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision?"mediump":"lowp"}this.getMaxPrecision=i,this.precision=void 0!==n.precision?n.precision:"highp",this.logarithmicDepthBuffer=void 0!==n.logarithmicDepthBuffer&&n.logarithmicDepthBuffer,this.maxTextures=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),this.maxVertexTextures=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.maxCubemapSize=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),this.maxAttributes=t.getParameter(t.MAX_VERTEX_ATTRIBS),this.maxVertexUniforms=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),this.maxVaryings=t.getParameter(t.MAX_VARYING_VECTORS),this.maxFragmentUniforms=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),this.vertexTextures=0<this.maxVertexTextures,this.floatFragmentTextures=!!e.get("OES_texture_float"),this.floatVertexTextures=this.vertexTextures&&this.floatFragmentTextures,n=i(this.precision),n!==this.precision&&(console.warn("THREE.WebGLRenderer:",this.precision,"not supported, using",n,"instead."),this.precision=n),this.logarithmicDepthBuffer&&(this.logarithmicDepthBuffer=!!e.get("EXT_frag_depth"))},_.WebGLGeometries=function(t,e,n){function i(t){t=t.target;var a,s=o[t.id].attributes;for(a in s)r(s[a]);t.removeEventListener("dispose",i),delete o[t.id],a=e.get(t),a.wireframe&&r(a.wireframe),n.memory.geometries--}function r(n){var i;void 0!==(i=n instanceof _.InterleavedBufferAttribute?e.get(n.data).__webglBuffer:e.get(n).__webglBuffer)&&(t.deleteBuffer(i),n instanceof _.InterleavedBufferAttribute?e.delete(n.data):e.delete(n))}var o={};this.get=function(t){var e=t.geometry;if(void 0!==o[e.id])return o[e.id];e.addEventListener("dispose",i);var r;return e instanceof _.BufferGeometry?r=e:e instanceof _.Geometry&&(void 0===e._bufferGeometry&&(e._bufferGeometry=(new _.BufferGeometry).setFromObject(t)),r=e._bufferGeometry),o[e.id]=r,n.memory.geometries++,r}},_.WebGLObjects=function(t,e,n){function i(n,i){var r=n instanceof _.InterleavedBufferAttribute?n.data:n,o=e.get(r);void 0===o.__webglBuffer?(o.__webglBuffer=t.createBuffer(),t.bindBuffer(i,o.__webglBuffer),t.bufferData(i,r.array,r.dynamic?t.DYNAMIC_DRAW:t.STATIC_DRAW),o.version=r.version):o.version!==r.version&&(t.bindBuffer(i,o.__webglBuffer),!1===r.dynamic||-1===r.updateRange.count?t.bufferSubData(i,0,r.array):0===r.updateRange.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(t.bufferSubData(i,r.updateRange.offset*r.array.BYTES_PER_ELEMENT,r.array.subarray(r.updateRange.offset,r.updateRange.offset+r.updateRange.count)),r.updateRange.count=0),o.version=r.version)}function r(t,e,n){if(e>n){var i=e;e=n,n=i}return i=t[e],void 0===i?(t[e]=[n],!0):-1===i.indexOf(n)&&(i.push(n),!0)}var o=new _.WebGLGeometries(t,e,n);this.getAttributeBuffer=function(t){return t instanceof _.InterleavedBufferAttribute?e.get(t.data).__webglBuffer:e.get(t).__webglBuffer},this.getWireframeAttribute=function(n){var o=e.get(n);if(void 0!==o.wireframe)return o.wireframe;var a=[],s=n.index,l=n.attributes;if(n=l.position,null!==s)for(var l={},s=s.array,u=0,c=s.length;u<c;u+=3){var h=s[u+0],d=s[u+1],p=s[u+2];r(l,h,d)&&a.push(h,d),r(l,d,p)&&a.push(d,p),r(l,p,h)&&a.push(p,h)}else for(s=l.position.array,u=0,c=s.length/3-1;u<c;u+=3)h=u+0,d=u+1,p=u+2,a.push(h,d,d,p,p,h);return a=new _.BufferAttribute(new(65535<n.count?Uint32Array:Uint16Array)(a),1),i(a,t.ELEMENT_ARRAY_BUFFER),o.wireframe=a},this.update=function(e){var n=o.get(e);e.geometry instanceof _.Geometry&&n.updateFromObject(e),e=n.index;var r=n.attributes;null!==e&&i(e,t.ELEMENT_ARRAY_BUFFER);for(var a in r)i(r[a],t.ARRAY_BUFFER);e=n.morphAttributes;for(a in e)for(var r=e[a],s=0,l=r.length;s<l;s++)i(r[s],t.ARRAY_BUFFER);return n}},_.WebGLProgram=function(){function t(t){var e,n=[];for(e in t){var i=t[e];!1!==i&&n.push("#define "+e+" "+i)}return n.join("\n")}function e(t){return""!==t}var n=0;return function(i,r,o,a){var s=i.context,l=o.defines,u=o.__webglShader.vertexShader,c=o.__webglShader.fragmentShader,h="SHADOWMAP_TYPE_BASIC";a.shadowMapType===_.PCFShadowMap?h="SHADOWMAP_TYPE_PCF":a.shadowMapType===_.PCFSoftShadowMap&&(h="SHADOWMAP_TYPE_PCF_SOFT");var d="ENVMAP_TYPE_CUBE",f="ENVMAP_MODE_REFLECTION",m="ENVMAP_BLENDING_MULTIPLY";if(a.envMap){switch(o.envMap.mapping){case _.CubeReflectionMapping:case _.CubeRefractionMapping:d="ENVMAP_TYPE_CUBE";break;case _.EquirectangularReflectionMapping:case _.EquirectangularRefractionMapping:d="ENVMAP_TYPE_EQUIREC";break;case _.SphericalReflectionMapping:d="ENVMAP_TYPE_SPHERE"}switch(o.envMap.mapping){case _.CubeRefractionMapping:case _.EquirectangularRefractionMapping:f="ENVMAP_MODE_REFRACTION"}switch(o.combine){case _.MultiplyOperation:m="ENVMAP_BLENDING_MULTIPLY";break;case _.MixOperation:m="ENVMAP_BLENDING_MIX";break;case _.AddOperation:m="ENVMAP_BLENDING_ADD"}}var v=0<i.gammaFactor?i.gammaFactor:1,g=t(l),y=s.createProgram();o instanceof _.RawShaderMaterial?i=l="":(l=["precision "+a.precision+" float;","precision "+a.precision+" int;","#define SHADER_NAME "+o.__webglShader.name,g,a.supportsVertexTextures?"#define VERTEX_TEXTURES":"",i.gammaInput?"#define GAMMA_INPUT":"",i.gammaOutput?"#define GAMMA_OUTPUT":"","#define GAMMA_FACTOR "+v,"#define MAX_DIR_LIGHTS "+a.maxDirLights,"#define MAX_POINT_LIGHTS "+a.maxPointLights,"#define MAX_SPOT_LIGHTS "+a.maxSpotLights,"#define MAX_HEMI_LIGHTS "+a.maxHemiLights,"#define MAX_SHADOWS "+a.maxShadows,"#define MAX_BONES "+a.maxBones,a.map?"#define USE_MAP":"",a.envMap?"#define USE_ENVMAP":"",a.envMap?"#define "+f:"",a.lightMap?"#define USE_LIGHTMAP":"",a.aoMap?"#define USE_AOMAP":"",a.emissiveMap?"#define USE_EMISSIVEMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.displacementMap&&a.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.alphaMap?"#define USE_ALPHAMAP":"",a.vertexColors?"#define USE_COLOR":"",a.flatShading?"#define FLAT_SHADED":"",a.skinning?"#define USE_SKINNING":"",a.useVertexTexture?"#define BONE_TEXTURE":"",a.morphTargets?"#define USE_MORPHTARGETS":"",a.morphNormals&&!1===a.flatShading?"#define USE_MORPHNORMALS":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+h:"",a.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",0<a.pointLightShadows?"#define POINT_LIGHT_SHADOWS":"",a.sizeAttenuation?"#define USE_SIZEATTENUATION":"",a.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",a.logarithmicDepthBuffer&&i.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(e).join("\n"),i=[a.bumpMap||a.normalMap||a.flatShading||o.derivatives?"#extension GL_OES_standard_derivatives : enable":"",a.logarithmicDepthBuffer&&i.extensions.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"","precision "+a.precision+" float;","precision "+a.precision+" int;","#define SHADER_NAME "+o.__webglShader.name,g,"#define MAX_DIR_LIGHTS "+a.maxDirLights,"#define MAX_POINT_LIGHTS "+a.maxPointLights,"#define MAX_SPOT_LIGHTS "+a.maxSpotLights,"#define MAX_HEMI_LIGHTS "+a.maxHemiLights,"#define MAX_SHADOWS "+a.maxShadows,a.alphaTest?"#define ALPHATEST "+a.alphaTest:"",i.gammaInput?"#define GAMMA_INPUT":"",i.gammaOutput?"#define GAMMA_OUTPUT":"","#define GAMMA_FACTOR "+v,a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.envMap?"#define USE_ENVMAP":"",a.envMap?"#define "+d:"",a.envMap?"#define "+f:"",a.envMap?"#define "+m:"",a.lightMap?"#define USE_LIGHTMAP":"",a.aoMap?"#define USE_AOMAP":"",a.emissiveMap?"#define USE_EMISSIVEMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.alphaMap?"#define USE_ALPHAMAP":"",a.vertexColors?"#define USE_COLOR":"",a.flatShading?"#define FLAT_SHADED":"",a.metal?"#define METAL":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+h:"",a.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",0<a.pointLightShadows?"#define POINT_LIGHT_SHADOWS":"",a.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",a.logarithmicDepthBuffer&&i.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","\n"].filter(e).join("\n")),c=i+c,u=_.WebGLShader(s,s.VERTEX_SHADER,l+u),c=_.WebGLShader(s,s.FRAGMENT_SHADER,c),s.attachShader(y,u),s.attachShader(y,c),void 0!==o.index0AttributeName?s.bindAttribLocation(y,0,o.index0AttributeName):!0===a.morphTargets&&s.bindAttribLocation(y,0,"position"),s.linkProgram(y),a=s.getProgramInfoLog(y),h=s.getShaderInfoLog(u),d=s.getShaderInfoLog(c),m=f=!0,!1===s.getProgramParameter(y,s.LINK_STATUS)?(f=!1,console.error("THREE.WebGLProgram: shader error: ",s.getError(),"gl.VALIDATE_STATUS",s.getProgramParameter(y,s.VALIDATE_STATUS),"gl.getProgramInfoLog",a,h,d)):""!==a?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",a):""!==h&&""!==d||(m=!1),m&&(this.diagnostics={runnable:f,material:o,programLog:a,vertexShader:{log:h,prefix:l},fragmentShader:{log:d,prefix:i}}),s.deleteShader(u),s.deleteShader(c);var b;this.getUniforms=function(){if(void 0===b){for(var t={},e=s.getProgramParameter(y,s.ACTIVE_UNIFORMS),n=0;n<e;n++){var i=s.getActiveUniform(y,n).name,r=s.getUniformLocation(y,i),o=i.lastIndexOf("[0]");-1!==o&&o===i.length-3&&(t[i.substr(0,o)]=r),t[i]=r}b=t}return b};var w;return this.getAttributes=function(){if(void 0===w){for(var t={},e=s.getProgramParameter(y,s.ACTIVE_ATTRIBUTES),n=0;n<e;n++){var i=s.getActiveAttrib(y,n).name;t[i]=s.getAttribLocation(y,i)}w=t}return w},this.destroy=function(){s.deleteProgram(y),this.program=void 0},(0,p.default)(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.id=n++,this.code=r,this.usedTimes=1,this.program=y,this.vertexShader=u,this.fragmentShader=c,this}}(),_.WebGLPrograms=function(t,e){var n=[],i={MeshDepthMaterial:"depth",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points"},r="precision supportsVertexTextures map envMap envMapMode lightMap aoMap emissiveMap bumpMap normalMap displacementMap specularMap alphaMap combine vertexColors fog useFog fogExp flatShading sizeAttenuation logarithmicDepthBuffer skinning maxBones useVertexTexture morphTargets morphNormals maxMorphTargets maxMorphNormals maxDirLights maxPointLights maxSpotLights maxHemiLights maxShadows shadowMapEnabled pointLightShadows shadowMapType shadowMapDebug alphaTest metal doubleSided flipSided".split(" ");this.getParameters=function(n,r,o,a){var s,l,u,c,h,d=i[n.type];s=h=c=u=l=0;for(var p=r.length;s<p;s++){var f=r[s];!1!==f.visible&&(f instanceof _.DirectionalLight&&l++,f instanceof _.PointLight&&u++,f instanceof _.SpotLight&&c++,f instanceof _.HemisphereLight&&h++)}for(var f=s=p=0,m=r.length;f<m;f++){var v=r[f];v.castShadow&&((v instanceof _.SpotLight||v instanceof _.DirectionalLight)&&p++,v instanceof _.PointLight&&(p++,s++))}return r=p,e.floatVertexTextures&&a&&a.skeleton&&a.skeleton.useVertexTexture?p=1024:(p=Math.floor((e.maxVertexUniforms-20)/4),void 0!==a&&a instanceof _.SkinnedMesh&&(p=Math.min(a.skeleton.bones.length,p))<a.skeleton.bones.length&&console.warn("WebGLRenderer: too many bones - "+a.skeleton.bones.length+", this GPU supports just "+p+" (try OpenGL instead of ANGLE)")),f=t.getPrecision(),null!==n.precision&&(f=e.getMaxPrecision(n.precision))!==n.precision&&console.warn("THREE.WebGLRenderer.initMaterial:",n.precision,"not supported, using",f,"instead."),{shaderID:d,precision:f,supportsVertexTextures:e.vertexTextures,map:!!n.map,envMap:!!n.envMap,envMapMode:n.envMap&&n.envMap.mapping,lightMap:!!n.lightMap,aoMap:!!n.aoMap,emissiveMap:!!n.emissiveMap,bumpMap:!!n.bumpMap,normalMap:!!n.normalMap,displacementMap:!!n.displacementMap,specularMap:!!n.specularMap,alphaMap:!!n.alphaMap,combine:n.combine,vertexColors:n.vertexColors,fog:o,useFog:n.fog,fogExp:o instanceof _.FogExp2,flatShading:n.shading===_.FlatShading,sizeAttenuation:n.sizeAttenuation,logarithmicDepthBuffer:e.logarithmicDepthBuffer,skinning:n.skinning,maxBones:p,useVertexTexture:e.floatVertexTextures&&a&&a.skeleton&&a.skeleton.useVertexTexture,morphTargets:n.morphTargets,morphNormals:n.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,maxDirLights:l,maxPointLights:u,maxSpotLights:c,maxHemiLights:h,maxShadows:r,pointLightShadows:s,shadowMapEnabled:t.shadowMap.enabled&&a.receiveShadow&&0<r,shadowMapType:t.shadowMap.type,shadowMapDebug:t.shadowMap.debug,alphaTest:n.alphaTest,metal:n.metal,doubleSided:n.side===_.DoubleSide,flipSided:n.side===_.BackSide}},this.getProgramCode=function(t,e){var n=[];if(e.shaderID?n.push(e.shaderID):(n.push(t.fragmentShader),n.push(t.vertexShader)),void 0!==t.defines)for(var i in t.defines)n.push(i),n.push(t.defines[i]);for(i=0;i<r.length;i++){var o=r[i];n.push(o),n.push(e[o])}return n.join()},this.acquireProgram=function(e,i,r){for(var o,a=0,s=n.length;a<s;a++){var l=n[a];if(l.code===r){o=l,++o.usedTimes;break}}return void 0===o&&(o=new _.WebGLProgram(t,r,e,i),n.push(o)),o},this.releaseProgram=function(t){if(0==--t.usedTimes){var e=n.indexOf(t);n[e]=n[n.length-1],n.pop(),t.destroy()}},this.programs=n},_.WebGLProperties=function(){var t={};this.get=function(e){e=e.uuid;var n=t[e];return void 0===n&&(n={},t[e]=n),n},this.delete=function(e){delete t[e.uuid]},this.clear=function(){t={}}},_.WebGLShader=function(){function t(t){t=t.split("\n");for(var e=0;e<t.length;e++)t[e]=e+1+": "+t[e];return t.join("\n")}return function(e,n,i){var r=e.createShader(n);return e.shaderSource(r,i),e.compileShader(r),!1===e.getShaderParameter(r,e.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==e.getShaderInfoLog(r)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",n===e.VERTEX_SHADER?"vertex":"fragment",e.getShaderInfoLog(r),t(i)),r}}(),_.WebGLShadowMap=function(t,e,n){function i(t,e,n,i){var r=t.geometry,o=null,o=d,a=t.customDepthMaterial;return n&&(o=p,a=t.customDistanceMaterial),a?o=a:(t=t instanceof _.SkinnedMesh&&e.skinning,a=0,void 0!==r.morphTargets&&0<r.morphTargets.length&&e.morphTargets&&(a|=1),t&&(a|=2),o=o[a]),o.visible=e.visible,o.wireframe=e.wireframe,o.wireframeLinewidth=e.wireframeLinewidth,n&&void 0!==o.uniforms.lightPos&&o.uniforms.lightPos.value.copy(i),o}function r(t,e){if(!1!==t.visible){(t instanceof _.Mesh||t instanceof _.Line||t instanceof _.Points)&&t.castShadow&&(!1===t.frustumCulled||!0===s.intersectsObject(t))&&!0===t.material.visible&&(t.modelViewMatrix.multiplyMatrices(e.matrixWorldInverse,t.matrixWorld),h.push(t));for(var n=t.children,i=0,o=n.length;i<o;i++)r(n[i],e)}}var o=t.context,a=t.state,s=new _.Frustum,l=new _.Matrix4;new _.Vector3,new _.Vector3;for(var u=new _.Vector3,c=new _.Vector3,h=[],d=Array(4),p=Array(4),f=[new _.Vector3(1,0,0),new _.Vector3(-1,0,0),new _.Vector3(0,0,1),new _.Vector3(0,0,-1),new _.Vector3(0,1,0),new _.Vector3(0,-1,0)],m=[new _.Vector3(0,1,0),new _.Vector3(0,1,0),new _.Vector3(0,1,0),new _.Vector3(0,1,0),new _.Vector3(0,0,1),new _.Vector3(0,0,-1)],v=[new _.Vector4,new _.Vector4,new _.Vector4,new _.Vector4,new _.Vector4,new _.Vector4],g=new _.Vector4,y=_.ShaderLib.depthRGBA,b=_.UniformsUtils.clone(y.uniforms),w=_.ShaderLib.distanceRGBA,T=_.UniformsUtils.clone(w.uniforms),x=0;4!==x;++x){var E=0!=(1&x),S=0!=(2&x),A=new _.ShaderMaterial({uniforms:b,vertexShader:y.vertexShader,fragmentShader:y.fragmentShader,morphTargets:E,skinning:S});A._shadowPass=!0,d[x]=A,E=new _.ShaderMaterial({uniforms:T,vertexShader:w.vertexShader,fragmentShader:w.fragmentShader,morphTargets:E,skinning:S}),E._shadowPass=!0,p[x]=E}var C=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=_.PCFShadowMap,this.cullFace=_.CullFaceFront,this.render=function(d){var p,y;if(!1!==C.enabled&&(!1!==C.autoUpdate||!1!==C.needsUpdate)){o.clearColor(1,1,1,1),a.disable(o.BLEND),a.enable(o.CULL_FACE),o.frontFace(o.CCW),o.cullFace(C.cullFace===_.CullFaceFront?o.FRONT:o.BACK),a.setDepthTest(!0),t.getViewport(g);for(var b=0,w=e.length;b<w;b++){var T=e[b];if(!0===T.castShadow){var x=T.shadow,E=x.camera,S=x.mapSize;if(T instanceof _.PointLight){p=6,y=!0;var A=S.x/4,k=S.y/2;v[0].set(2*A,k,A,k),v[1].set(0,k,A,k),v[2].set(3*A,k,A,k),v[3].set(A,k,A,k),v[4].set(3*A,0,A,k),v[5].set(A,0,A,k)}else p=1,y=!1;for(null===x.map&&(A=_.LinearFilter,C.type===_.PCFSoftShadowMap&&(A=_.NearestFilter),x.map=new _.WebGLRenderTarget(S.x,S.y,{minFilter:A,magFilter:A,format:_.RGBAFormat}),x.matrix=new _.Matrix4,T instanceof _.SpotLight&&(E.aspect=S.x/S.y),E.updateProjectionMatrix()),S=x.map,x=x.matrix,c.setFromMatrixPosition(T.matrixWorld),E.position.copy(c),t.setRenderTarget(S),t.clear(),S=0;S<p;S++)for(y?(u.copy(E.position),u.add(f[S]),E.up.copy(m[S]),E.lookAt(u),A=v[S],t.setViewport(A.x,A.y,A.z,A.w)):(u.setFromMatrixPosition(T.target.matrixWorld),E.lookAt(u)),E.updateMatrixWorld(),E.matrixWorldInverse.getInverse(E.matrixWorld),x.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),x.multiply(E.projectionMatrix),x.multiply(E.matrixWorldInverse),l.multiplyMatrices(E.projectionMatrix,E.matrixWorldInverse),s.setFromMatrix(l),h.length=0,r(d,E),A=0,k=h.length;A<k;A++){var M=h[A],L=n.update(M),R=M.material;if(R instanceof _.MeshFaceMaterial)for(var P=L.groups,R=R.materials,D=0,I=P.length;D<I;D++){var F=P[D],O=R[F.materialIndex];!0===O.visible&&(O=i(M,O,y,c),t.renderBufferDirect(E,e,null,L,O,M,F))}else O=i(M,R,y,c),t.renderBufferDirect(E,e,null,L,O,M,null)}t.resetGLState()}}t.setViewport(g.x,g.y,g.z,g.w),d=t.getClearColor(),p=t.getClearAlpha(),t.setClearColor(d,p),a.enable(o.BLEND),C.cullFace===_.CullFaceFront&&o.cullFace(o.BACK),t.resetGLState(),C.needsUpdate=!1}}},_.WebGLState=function(t,e,n){var i=this,r=new Uint8Array(16),o=new Uint8Array(16),a=new Uint8Array(16),s={},l=null,u=null,c=null,h=null,d=null,p=null,f=null,m=null,v=null,g=null,y=null,b=null,w=null,T=null,x=null,E=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),S=void 0,A={};this.init=function(){t.clearColor(0,0,0,1),t.clearDepth(1),t.clearStencil(0),this.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),t.frontFace(t.CCW),t.cullFace(t.BACK),this.enable(t.CULL_FACE),this.enable(t.BLEND),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA)},this.initAttributes=function(){for(var t=0,e=r.length;t<e;t++)r[t]=0},this.enableAttribute=function(n){r[n]=1,0===o[n]&&(t.enableVertexAttribArray(n),o[n]=1),0!==a[n]&&(e.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(n,0),a[n]=0)},this.enableAttributeAndDivisor=function(e,n,i){r[e]=1,0===o[e]&&(t.enableVertexAttribArray(e),o[e]=1),a[e]!==n&&(i.vertexAttribDivisorANGLE(e,n),a[e]=n)},this.disableUnusedAttributes=function(){for(var e=0,n=o.length;e<n;e++)o[e]!==r[e]&&(t.disableVertexAttribArray(e),o[e]=0)},this.enable=function(e){!0!==s[e]&&(t.enable(e),s[e]=!0)},this.disable=function(e){!1!==s[e]&&(t.disable(e),s[e]=!1)},this.getCompressedTextureFormats=function(){if(null===l&&(l=[],e.get("WEBGL_compressed_texture_pvrtc")||e.get("WEBGL_compressed_texture_s3tc")))for(var n=t.getParameter(t.COMPRESSED_TEXTURE_FORMATS),i=0;i<n.length;i++)l.push(n[i]);return l},this.setBlending=function(e,i,r,o,a,s,l){e!==u&&(e===_.NoBlending?this.disable(t.BLEND):e===_.AdditiveBlending?(this.enable(t.BLEND),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE)):e===_.SubtractiveBlending?(this.enable(t.BLEND),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.ONE_MINUS_SRC_COLOR)):e===_.MultiplyBlending?(this.enable(t.BLEND),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.SRC_COLOR)):e===_.CustomBlending?this.enable(t.BLEND):(this.enable(t.BLEND),t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)),u=e),e===_.CustomBlending?(a=a||i,s=s||r,l=l||o,i===c&&a===p||(t.blendEquationSeparate(n(i),n(a)),c=i,p=a),r===h&&o===d&&s===f&&l===m||(t.blendFuncSeparate(n(r),n(o),n(s),n(l)),h=r,d=o,f=s,m=l)):m=f=p=d=h=c=null},this.setDepthFunc=function(e){if(v!==e){if(e)switch(e){case _.NeverDepth:t.depthFunc(t.NEVER);break;case _.AlwaysDepth:t.depthFunc(t.ALWAYS);break;case _.LessDepth:t.depthFunc(t.LESS);break;case _.LessEqualDepth:t.depthFunc(t.LEQUAL);break;case _.EqualDepth:t.depthFunc(t.EQUAL);break;case _.GreaterEqualDepth:t.depthFunc(t.GEQUAL);break;case _.GreaterDepth:t.depthFunc(t.GREATER);break;case _.NotEqualDepth:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}else t.depthFunc(t.LEQUAL);v=e}},this.setDepthTest=function(e){e?this.enable(t.DEPTH_TEST):this.disable(t.DEPTH_TEST)},this.setDepthWrite=function(e){g!==e&&(t.depthMask(e),g=e)},this.setColorWrite=function(e){y!==e&&(t.colorMask(e,e,e,e),y=e)},this.setFlipSided=function(e){b!==e&&(e?t.frontFace(t.CW):t.frontFace(t.CCW),b=e)},this.setLineWidth=function(e){e!==w&&(t.lineWidth(e),w=e)},this.setPolygonOffset=function(e,n,i){e?this.enable(t.POLYGON_OFFSET_FILL):this.disable(t.POLYGON_OFFSET_FILL),!e||T===n&&x===i||(t.polygonOffset(n,i),T=n,x=i)},this.setScissorTest=function(e){e?this.enable(t.SCISSOR_TEST):this.disable(t.SCISSOR_TEST)},this.activeTexture=function(e){void 0===e&&(e=t.TEXTURE0+E-1),S!==e&&(t.activeTexture(e),S=e)},this.bindTexture=function(e,n){void 0===S&&i.activeTexture();var r=A[S];void 0===r&&(r={type:void 0,texture:void 0},A[S]=r),r.type===e&&r.texture===n||(t.bindTexture(e,n),r.type=e,r.texture=n)},this.compressedTexImage2D=function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){console.error(t)}},this.texImage2D=function(){try{t.texImage2D.apply(t,arguments)}catch(t){console.error(t)}},this.reset=function(){for(var e=0;e<o.length;e++)1===o[e]&&(t.disableVertexAttribArray(e),o[e]=0);s={},b=y=g=u=l=null}},_.LensFlarePlugin=function(t,e){var n,i,r,o,a,s,l,u,c,h,d,p,f,m,v,g,y=t.context,b=t.state;this.render=function(w,T,x,E){if(0!==e.length){w=new _.Vector3;var S=E/x,A=.5*x,C=.5*E,k=16/E,M=new _.Vector2(k*S,k),L=new _.Vector3(1,1,0),R=new _.Vector2(1,1);if(void 0===f){var k=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),P=new Uint16Array([0,1,2,0,2,3]);d=y.createBuffer(),p=y.createBuffer(),y.bindBuffer(y.ARRAY_BUFFER,d),y.bufferData(y.ARRAY_BUFFER,k,y.STATIC_DRAW),y.bindBuffer(y.ELEMENT_ARRAY_BUFFER,p),y.bufferData(y.ELEMENT_ARRAY_BUFFER,P,y.STATIC_DRAW),v=y.createTexture(),g=y.createTexture(),b.bindTexture(y.TEXTURE_2D,v),y.texImage2D(y.TEXTURE_2D,0,y.RGB,16,16,0,y.RGB,y.UNSIGNED_BYTE,null),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,y.CLAMP_TO_EDGE),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,y.CLAMP_TO_EDGE),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,y.NEAREST),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,y.NEAREST),b.bindTexture(y.TEXTURE_2D,g),y.texImage2D(y.TEXTURE_2D,0,y.RGBA,16,16,0,y.RGBA,y.UNSIGNED_BYTE,null),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,y.CLAMP_TO_EDGE),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,y.CLAMP_TO_EDGE),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,y.NEAREST),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,y.NEAREST);var k=(m=0<y.getParameter(y.MAX_VERTEX_TEXTURE_IMAGE_UNITS))?{vertexShader:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nuniform sampler2D occlusionMap;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif ( renderType == 2 ) {\nvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );\nvVisibility =        visibility.r / 9.0;\nvVisibility *= 1.0 - visibility.g / 9.0;\nvVisibility *=       visibility.b / 9.0;\nvVisibility *= 1.0 - visibility.a / 9.0;\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",fragmentShader:"uniform lowp int renderType;\nuniform sampler2D map;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nif ( renderType == 0 ) {\ngl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\n} else if ( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * vVisibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"}:{vertexShader:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif ( renderType == 2 ) {\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",fragmentShader:"precision mediump float;\nuniform lowp int renderType;\nuniform sampler2D map;\nuniform sampler2D occlusionMap;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvoid main() {\nif ( renderType == 0 ) {\ngl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );\n} else if ( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nfloat visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;\nvisibility = ( 1.0 - visibility / 4.0 );\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * visibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"},P=y.createProgram(),D=y.createShader(y.FRAGMENT_SHADER),I=y.createShader(y.VERTEX_SHADER),F="precision "+t.getPrecision()+" float;\n";y.shaderSource(D,F+k.fragmentShader),y.shaderSource(I,F+k.vertexShader),y.compileShader(D),y.compileShader(I),y.attachShader(P,D),y.attachShader(P,I),y.linkProgram(P),f=P,c=y.getAttribLocation(f,"position"),h=y.getAttribLocation(f,"uv"),n=y.getUniformLocation(f,"renderType"),i=y.getUniformLocation(f,"map"),r=y.getUniformLocation(f,"occlusionMap"),o=y.getUniformLocation(f,"opacity"),a=y.getUniformLocation(f,"color"),s=y.getUniformLocation(f,"scale"),l=y.getUniformLocation(f,"rotation"),u=y.getUniformLocation(f,"screenPosition")}for(y.useProgram(f),b.initAttributes(),b.enableAttribute(c),b.enableAttribute(h),b.disableUnusedAttributes(),y.uniform1i(r,0),y.uniform1i(i,1),y.bindBuffer(y.ARRAY_BUFFER,d),y.vertexAttribPointer(c,2,y.FLOAT,!1,16,0),y.vertexAttribPointer(h,2,y.FLOAT,!1,16,8),y.bindBuffer(y.ELEMENT_ARRAY_BUFFER,p),b.disable(y.CULL_FACE),y.depthMask(!1),P=0,D=e.length;P<D;P++)if(k=16/E,M.set(k*S,k),I=e[P],w.set(I.matrixWorld.elements[12],I.matrixWorld.elements[13],I.matrixWorld.elements[14]),w.applyMatrix4(T.matrixWorldInverse),w.applyProjection(T.projectionMatrix),L.copy(w),R.x=L.x*A+A,R.y=L.y*C+C,m||0<R.x&&R.x<x&&0<R.y&&R.y<E){b.activeTexture(y.TEXTURE0),b.bindTexture(y.TEXTURE_2D,null),b.activeTexture(y.TEXTURE1),b.bindTexture(y.TEXTURE_2D,v),y.copyTexImage2D(y.TEXTURE_2D,0,y.RGB,R.x-8,R.y-8,16,16,0),y.uniform1i(n,0),y.uniform2f(s,M.x,M.y),y.uniform3f(u,L.x,L.y,L.z),b.disable(y.BLEND),b.enable(y.DEPTH_TEST),y.drawElements(y.TRIANGLES,6,y.UNSIGNED_SHORT,0),b.activeTexture(y.TEXTURE0),b.bindTexture(y.TEXTURE_2D,g),y.copyTexImage2D(y.TEXTURE_2D,0,y.RGBA,R.x-8,R.y-8,16,16,0),y.uniform1i(n,1),b.disable(y.DEPTH_TEST),b.activeTexture(y.TEXTURE1),b.bindTexture(y.TEXTURE_2D,v),y.drawElements(y.TRIANGLES,6,y.UNSIGNED_SHORT,0),I.positionScreen.copy(L),I.customUpdateCallback?I.customUpdateCallback(I):I.updateLensFlares(),y.uniform1i(n,2),b.enable(y.BLEND);for(var F=0,O=I.lensFlares.length;F<O;F++){var N=I.lensFlares[F];.001<N.opacity&&.001<N.scale&&(L.x=N.x,L.y=N.y,L.z=N.z,k=N.size*N.scale/E,M.x=k*S,M.y=k,y.uniform3f(u,L.x,L.y,L.z),y.uniform2f(s,M.x,M.y),y.uniform1f(l,N.rotation),y.uniform1f(o,N.opacity),y.uniform3f(a,N.color.r,N.color.g,N.color.b),b.setBlending(N.blending,N.blendEquation,N.blendSrc,N.blendDst),t.setTexture(N.texture,1),y.drawElements(y.TRIANGLES,6,y.UNSIGNED_SHORT,0))}}b.enable(y.CULL_FACE),b.enable(y.DEPTH_TEST),y.depthMask(!0),t.resetGLState()}}},_.SpritePlugin=function(t,e){function n(t,e){return t.z!==e.z?e.z-t.z:e.id-t.id}var i,r,o,a,s,l,u,c,h,d,p,f,m,v,g,y,b,w,T,x,E,S=t.context,A=t.state,C=new _.Vector3,k=new _.Quaternion,M=new _.Vector3;this.render=function(L,R){if(0!==e.length){if(void 0===x){var P=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),D=new Uint16Array([0,1,2,0,2,3]);w=S.createBuffer(),T=S.createBuffer(),S.bindBuffer(S.ARRAY_BUFFER,w),S.bufferData(S.ARRAY_BUFFER,P,S.STATIC_DRAW),S.bindBuffer(S.ELEMENT_ARRAY_BUFFER,T),S.bufferData(S.ELEMENT_ARRAY_BUFFER,D,S.STATIC_DRAW);var P=S.createProgram(),D=S.createShader(S.VERTEX_SHADER),I=S.createShader(S.FRAGMENT_SHADER);S.shaderSource(D,["precision "+t.getPrecision()+" float;","uniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float rotation;\nuniform vec2 scale;\nuniform vec2 uvOffset;\nuniform vec2 uvScale;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uvOffset + uv * uvScale;\nvec2 alignedPosition = position * scale;\nvec2 rotatedPosition;\nrotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\nrotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\nvec4 finalPosition;\nfinalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\nfinalPosition.xy += rotatedPosition;\nfinalPosition = projectionMatrix * finalPosition;\ngl_Position = finalPosition;\n}"].join("\n")),S.shaderSource(I,["precision "+t.getPrecision()+" float;","uniform vec3 color;\nuniform sampler2D map;\nuniform float opacity;\nuniform int fogType;\nuniform vec3 fogColor;\nuniform float fogDensity;\nuniform float fogNear;\nuniform float fogFar;\nuniform float alphaTest;\nvarying vec2 vUV;\nvoid main() {\nvec4 texture = texture2D( map, vUV );\nif ( texture.a < alphaTest ) discard;\ngl_FragColor = vec4( color * texture.xyz, texture.a * opacity );\nif ( fogType > 0 ) {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat fogFactor = 0.0;\nif ( fogType == 1 ) {\nfogFactor = smoothstep( fogNear, fogFar, depth );\n} else {\nconst float LOG2 = 1.442695;\nfogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n}\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n}\n}"].join("\n")),S.compileShader(D),S.compileShader(I),S.attachShader(P,D),S.attachShader(P,I),S.linkProgram(P),x=P,y=S.getAttribLocation(x,"position"),b=S.getAttribLocation(x,"uv"),i=S.getUniformLocation(x,"uvOffset"),r=S.getUniformLocation(x,"uvScale"),o=S.getUniformLocation(x,"rotation"),a=S.getUniformLocation(x,"scale"),s=S.getUniformLocation(x,"color"),l=S.getUniformLocation(x,"map"),u=S.getUniformLocation(x,"opacity"),c=S.getUniformLocation(x,"modelViewMatrix"),h=S.getUniformLocation(x,"projectionMatrix"),d=S.getUniformLocation(x,"fogType"),p=S.getUniformLocation(x,"fogDensity"),f=S.getUniformLocation(x,"fogNear"),m=S.getUniformLocation(x,"fogFar"),v=S.getUniformLocation(x,"fogColor"),g=S.getUniformLocation(x,"alphaTest"),P=document.createElement("canvas"),P.width=8,P.height=8,D=P.getContext("2d"),D.fillStyle="white",D.fillRect(0,0,8,8),E=new _.Texture(P),E.needsUpdate=!0}S.useProgram(x),A.initAttributes(),A.enableAttribute(y),A.enableAttribute(b),A.disableUnusedAttributes(),A.disable(S.CULL_FACE),A.enable(S.BLEND),S.bindBuffer(S.ARRAY_BUFFER,w),S.vertexAttribPointer(y,2,S.FLOAT,!1,16,0),S.vertexAttribPointer(b,2,S.FLOAT,!1,16,8),S.bindBuffer(S.ELEMENT_ARRAY_BUFFER,T),S.uniformMatrix4fv(h,!1,R.projectionMatrix.elements),A.activeTexture(S.TEXTURE0),S.uniform1i(l,0),D=P=0,(I=L.fog)?(S.uniform3f(v,I.color.r,I.color.g,I.color.b),I instanceof _.Fog?(S.uniform1f(f,I.near),S.uniform1f(m,I.far),S.uniform1i(d,1),D=P=1):I instanceof _.FogExp2&&(S.uniform1f(p,I.density),S.uniform1i(d,2),D=P=2)):(S.uniform1i(d,0),D=P=0);for(var I=0,F=e.length;I<F;I++){var O=e[I];O.modelViewMatrix.multiplyMatrices(R.matrixWorldInverse,O.matrixWorld),O.z=-O.modelViewMatrix.elements[14]}e.sort(n);for(var N=[],I=0,F=e.length;I<F;I++){var O=e[I],U=O.material;S.uniform1f(g,U.alphaTest),S.uniformMatrix4fv(c,!1,O.modelViewMatrix.elements),O.matrixWorld.decompose(C,k,M),N[0]=M.x,N[1]=M.y,O=0,L.fog&&U.fog&&(O=D),P!==O&&(S.uniform1i(d,O),P=O),null!==U.map?(S.uniform2f(i,U.map.offset.x,U.map.offset.y),S.uniform2f(r,U.map.repeat.x,U.map.repeat.y)):(S.uniform2f(i,0,0),S.uniform2f(r,1,1)),S.uniform1f(u,U.opacity),S.uniform3f(s,U.color.r,U.color.g,U.color.b),S.uniform1f(o,U.rotation),S.uniform2fv(a,N),A.setBlending(U.blending,U.blendEquation,U.blendSrc,U.blendDst),A.setDepthTest(U.depthTest),A.setDepthWrite(U.depthWrite),U.map&&U.map.image&&U.map.image.width?t.setTexture(U.map,0):t.setTexture(E,0),S.drawElements(S.TRIANGLES,6,S.UNSIGNED_SHORT,0)}A.enable(S.CULL_FACE),t.resetGLState()}}},_.CurveUtils={tangentQuadraticBezier:function(t,e,n,i){return 2*(1-t)*(n-e)+2*t*(i-n)},tangentCubicBezier:function(t,e,n,i,r){return-3*e*(1-t)*(1-t)+3*n*(1-t)*(1-t)-6*t*n*(1-t)+6*t*i*(1-t)-3*t*t*i+3*t*t*r},tangentSpline:function(t,e,n,i,r){return 6*t*t-6*t+(3*t*t-4*t+1)+(-6*t*t+6*t)+(3*t*t-2*t)},interpolate:function(t,e,n,i,r){t=.5*(n-t),i=.5*(i-e);var o=r*r;return(2*e-2*n+t+i)*r*o+(-3*e+3*n-2*t-i)*o+t*r+e}},_.GeometryUtils={merge:function(t,e,n){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var i;e instanceof _.Mesh&&(e.matrixAutoUpdate&&e.updateMatrix(),i=e.matrix,e=e.geometry),t.merge(e,i,n)},center:function(t){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),t.center()}},_.ImageUtils={crossOrigin:void 0,loadTexture:function(t,e,n,i){console.warn("THREE.ImageUtils.loadTexture is being deprecated. Use THREE.TextureLoader() instead.");var r=new _.TextureLoader;return r.setCrossOrigin(this.crossOrigin),t=r.load(t,n,void 0,i),e&&(t.mapping=e),t},loadTextureCube:function(t,e,n,i){console.warn("THREE.ImageUtils.loadTextureCube is being deprecated. Use THREE.CubeTextureLoader() instead.");var r=new _.CubeTextureLoader;return r.setCrossOrigin(this.crossOrigin),t=r.load(t,n,void 0,i),e&&(t.mapping=e),t},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")}},_.SceneUtils={createMultiMaterialObject:function(t,e){for(var n=new _.Group,i=0,r=e.length;i<r;i++)n.add(new _.Mesh(t,e[i]));return n},detach:function(t,e,n){t.applyMatrix(e.matrixWorld),e.remove(t),n.add(t)},attach:function(t,e,n){var i=new _.Matrix4;i.getInverse(n.matrixWorld),t.applyMatrix(i),e.remove(t),n.add(t)}},_.ShapeUtils={area:function(t){for(var e=t.length,n=0,i=e-1,r=0;r<e;i=r++)n+=t[i].x*t[r].y-t[r].x*t[i].y;return.5*n},triangulate:function(){return function(t,e){var n=t.length;if(3>n)return null;var i,r,o,a=[],s=[],l=[];if(0<_.ShapeUtils.area(t))for(r=0;r<n;r++)s[r]=r;else for(r=0;r<n;r++)s[r]=n-1-r;var u=2*n;for(r=n-1;2<n;){if(0>=u--){console.warn("THREE.ShapeUtils: Unable to triangulate polygon! in triangulate()");break}i=r,n<=i&&(i=0),r=i+1,n<=r&&(r=0),o=r+1,n<=o&&(o=0);var c;t:{var h=c=void 0,d=void 0,p=void 0,f=void 0,m=void 0,v=void 0,g=void 0,y=void 0,h=t[s[i]].x,d=t[s[i]].y,p=t[s[r]].x,f=t[s[r]].y,m=t[s[o]].x,v=t[s[o]].y;if(b.default>(p-h)*(v-d)-(f-d)*(m-h))c=!1;else{var w=void 0,T=void 0,x=void 0,E=void 0,S=void 0,A=void 0,C=void 0,k=void 0,M=void 0,L=void 0,M=k=C=y=g=void 0,w=m-p,T=v-f,x=h-m,E=d-v,S=p-h,A=f-d;for(c=0;c<n;c++)if(g=t[s[c]].x,y=t[s[c]].y,!(g===h&&y===d||g===p&&y===f||g===m&&y===v)&&(C=g-h,k=y-d,M=g-p,L=y-f,g-=m,y-=v,M=w*L-T*M,C=S*k-A*C,k=x*y-E*g,M>=-b.default&&k>=-b.default&&C>=-b.default)){c=!1;break t}c=!0}}if(c){for(a.push([t[s[i]],t[s[r]],t[s[o]]]),l.push([s[i],s[r],s[o]]),i=r,o=r+1;o<n;i++,o++)s[i]=s[o];n--,u=2*n}}return e?l:a}}(),triangulateShape:function(t,e){function n(t,e,n){return t.x!==e.x?t.x<e.x?t.x<=n.x&&n.x<=e.x:e.x<=n.x&&n.x<=t.x:t.y<e.y?t.y<=n.y&&n.y<=e.y:e.y<=n.y&&n.y<=t.y}function i(t,e,i,r,o){var a=e.x-t.x,s=e.y-t.y,l=r.x-i.x,u=r.y-i.y,c=t.x-i.x,h=t.y-i.y,d=s*l-a*u,p=s*c-a*h;if(Math.abs(d)>b.default){if(0<d){if(0>p||p>d)return[];if(0>(l=u*c-l*h)||l>d)return[]}else{if(0<p||p<d)return[];if(0<(l=u*c-l*h)||l<d)return[]}return 0===l?!o||0!==p&&p!==d?[t]:[]:l===d?!o||0!==p&&p!==d?[e]:[]:0===p?[i]:p===d?[r]:(o=l/d,[{x:t.x+o*a,y:t.y+o*s}])}return 0!==p||u*c!=l*h?[]:(s=0===a&&0===s,l=0===l&&0===u,s&&l?t.x!==i.x||t.y!==i.y?[]:[t]:s?n(i,r,t)?[t]:[]:l?n(t,e,i)?[i]:[]:(0!==a?(t.x<e.x?(a=t,l=t.x,s=e,t=e.x):(a=e,l=e.x,s=t,t=t.x),i.x<r.x?(e=i,d=i.x,u=r,i=r.x):(e=r,d=r.x,u=i,i=i.x)):(t.y<e.y?(a=t,l=t.y,s=e,t=e.y):(a=e,l=e.y,s=t,t=t.y),i.y<r.y?(e=i,d=i.y,u=r,i=r.y):(e=r,d=r.y,u=i,i=i.y)),l<=d?t<d?[]:t===d?o?[]:[e]:t<=i?[e,s]:[e,u]:l>i?[]:l===i?o?[]:[a]:t<=i?[a,s]:[a,u]))}function r(t,e,n,i){var r=e.x-t.x,o=e.y-t.y;e=n.x-t.x,n=n.y-t.y;var a=i.x-t.x;return i=i.y-t.y,t=r*n-o*e,r=r*i-o*a,Math.abs(t)>b.default?(e=a*n-i*e,0<t?0<=r&&0<=e:0<=r||0<=e):0<r}var o,a,s,l,u,c={};for(s=t.concat(),o=0,a=e.length;o<a;o++)Array.prototype.push.apply(s,e[o]);for(o=0,a=s.length;o<a;o++)u=s[o].x+":"+s[o].y,void 0!==c[u]&&console.warn("THREE.Shape: Duplicate point",u),c[u]=o;o=function(t,e){var n,o,a,s,l,u,c,h,d,p=t.concat(),f=[],m=[],v=0;for(o=e.length;v<o;v++)f.push(v);c=0;for(var g=2*f.length;0<f.length;){if(0>--g){console.log("Infinite Loop! Holes left:"+f.length+", Probably Hole outside Shape!");break}for(a=c;a<p.length;a++){for(s=p[a],o=-1,v=0;v<f.length;v++)if(l=f[v],u=s.x+":"+s.y+":"+l,void 0===m[u]){for(n=e[l],h=0;h<n.length;h++)if(l=n[h],function(t,e){var i=p.length-1,o=t-1;0>o&&(o=i);var a=t+1;return a>i&&(a=0),!!(i=r(p[t],p[o],p[a],n[e]))&&(i=n.length-1,o=e-1,0>o&&(o=i),a=e+1,a>i&&(a=0),!!(i=r(n[e],n[o],n[a],p[t])))}(a,h)&&!function(t,e){var n,r;for(n=0;n<p.length;n++)if(r=n+1,r%=p.length,r=i(t,e,p[n],p[r],!0),0<r.length)return!0;return!1}(s,l)&&!function(t,n){var r,o,a,s;for(r=0;r<f.length;r++)for(o=e[f[r]],a=0;a<o.length;a++)if(s=a+1,s%=o.length,s=i(t,n,o[a],o[s],!0),0<s.length)return!0;return!1}(s,l)){o=h,f.splice(v,1),c=p.slice(0,a+1),l=p.slice(a),h=n.slice(o),d=n.slice(0,o+1),p=c.concat(h).concat(d).concat(l),c=a;break}if(0<=o)break;m[u]=!0}if(0<=o)break}}return p}(t,e);var h=_.ShapeUtils.triangulate(o,!1);for(o=0,a=h.length;o<a;o++)for(l=h[o],s=0;3>s;s++)u=l[s].x+":"+l[s].y,void 0!==(u=c[u])&&(l[s]=u);return h.concat()},isClockWise:function(t){return 0>_.ShapeUtils.area(t)},b2:function(){return function(t,e,n,i){var r=1-t;return r*r*e+2*(1-t)*t*n+t*t*i}}(),b3:function(){return function(t,e,n,i,r){var o=1-t,a=1-t;return o*o*o*e+3*a*a*t*n+3*(1-t)*t*t*i+t*t*t*r}}()},_.Audio=function(t){_.Object3D.call(this),this.type="Audio",this.context=t.context,this.source=this.context.createBufferSource(),this.source.onended=this.onEnded.bind(this),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.panner=this.context.createPanner(),this.panner.connect(this.gain),this.autoplay=!1,this.startTime=0,this.playbackRate=1,this.isPlaying=!1},_.Audio.prototype=(0,u.default)(_.Object3D.prototype),_.Audio.prototype.constructor=_.Audio,_.Audio.prototype.load=function(t){var e=this,n=new XMLHttpRequest;return n.open("GET",t,!0),n.responseType="arraybuffer",n.onload=function(t){e.context.decodeAudioData(this.response,function(t){e.source.buffer=t,e.autoplay&&e.play()})},n.send(),this},_.Audio.prototype.play=function(){if(!0===this.isPlaying)console.warn("THREE.Audio: Audio is already playing.");else{var t=this.context.createBufferSource();t.buffer=this.source.buffer,t.loop=this.source.loop,t.onended=this.source.onended,t.start(0,this.startTime),t.playbackRate.value=this.playbackRate,this.isPlaying=!0,this.source=t,this.connect()}},_.Audio.prototype.pause=function(){this.source.stop(),this.startTime=this.context.currentTime},_.Audio.prototype.stop=function(){this.source.stop(),this.startTime=0},_.Audio.prototype.connect=function(){void 0!==this.filter?(this.source.connect(this.filter),this.filter.connect(this.panner)):this.source.connect(this.panner)},_.Audio.prototype.disconnect=function(){void 0!==this.filter?(this.source.disconnect(this.filter),this.filter.disconnect(this.panner)):this.source.disconnect(this.panner)},_.Audio.prototype.setFilter=function(t){!0===this.isPlaying?(this.disconnect(),this.filter=t,this.connect()):this.filter=t},_.Audio.prototype.getFilter=function(){return this.filter},_.Audio.prototype.setPlaybackRate=function(t){this.playbackRate=t,!0===this.isPlaying&&(this.source.playbackRate.value=this.playbackRate)},_.Audio.prototype.getPlaybackRate=function(){return this.playbackRate},_.Audio.prototype.onEnded=function(){this.isPlaying=!1};_.Audio.prototype.setLoop=function(t){this.source.loop=t},_.Audio.prototype.getLoop=function(){return this.source.loop},_.Audio.prototype.setRefDistance=function(t){this.panner.refDistance=t},_.Audio.prototype.getRefDistance=function(){return this.panner.refDistance},_.Audio.prototype.setRolloffFactor=function(t){this.panner.rolloffFactor=t},_.Audio.prototype.getRolloffFactor=function(){return this.panner.rolloffFactor},_.Audio.prototype.setVolume=function(t){this.gain.gain.value=t},_.Audio.prototype.getVolume=function(){return this.gain.gain.value},_.Audio.prototype.updateMatrixWorld=function(){var t=new _.Vector3;return function(e){_.Object3D.prototype.updateMatrixWorld.call(this,e),t.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(t.x,t.y,t.z)}}(),_.AudioListener=function(){_.Object3D.call(this),this.type="AudioListener",this.context=new(window.AudioContext||window.webkitAudioContext)},_.AudioListener.prototype=(0,u.default)(_.Object3D.prototype),_.AudioListener.prototype.constructor=_.AudioListener,_.AudioListener.prototype.updateMatrixWorld=function(){var t=new _.Vector3,e=new _.Quaternion,n=new _.Vector3,i=new _.Vector3;return function(r){_.Object3D.prototype.updateMatrixWorld.call(this,r),r=this.context.listener;var o=this.up;this.matrixWorld.decompose(t,e,n),i.set(0,0,-1).applyQuaternion(e),r.setPosition(t.x,t.y,t.z),r.setOrientation(i.x,i.y,i.z,o.x,o.y,o.z)}}(),_.Curve=function(){},_.Curve.prototype={constructor:_.Curve,getPoint:function(t){return console.warn("THREE.Curve: Warning, getPoint() not implemented!"),null},getPointAt:function(t){return t=this.getUtoTmapping(t),this.getPoint(t)},getPoints:function(t){t||(t=5);var e,n=[];for(e=0;e<=t;e++)n.push(this.getPoint(e/t));return n},getSpacedPoints:function(t){t||(t=5);var e,n=[];for(e=0;e<=t;e++)n.push(this.getPointAt(e/t));return n},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(t||(t=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,n,i=[],r=this.getPoint(0),o=0;for(i.push(0),n=1;n<=t;n++)e=this.getPoint(n/t),o+=e.distanceTo(r),i.push(o),r=e;return this.cacheArcLengths=i},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){var n,i=this.getLengths(),r=0,o=i.length;n=e||t*i[o-1];for(var a,s=0,l=o-1;s<=l;)if(r=Math.floor(s+(l-s)/2),0>(a=i[r]-n))s=r+1;else{if(!(0<a)){l=r;break}l=r-1}return r=l,i[r]===n?r/(o-1):(s=i[r],i=(r+(n-s)/(i[r+1]-s))/(o-1))},getTangent:function(t){var e=t-1e-4;return t+=1e-4,0>e&&(e=0),1<t&&(t=1),e=this.getPoint(e),this.getPoint(t).clone().sub(e).normalize()},getTangentAt:function(t){return t=this.getUtoTmapping(t),this.getTangent(t)}},_.Curve.Utils=_.CurveUtils,_.Curve.create=function(t,e){return t.prototype=(0,u.default)(_.Curve.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},_.CurvePath=function(){this.curves=[],this.autoClose=!1},_.CurvePath.prototype=(0,u.default)(_.Curve.prototype),_.CurvePath.prototype.constructor=_.CurvePath,_.CurvePath.prototype.add=function(t){this.curves.push(t)},_.CurvePath.prototype.closePath=function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new _.LineCurve(e,t))},_.CurvePath.prototype.getPoint=function(t){for(var e=t*this.getLength(),n=this.getCurveLengths(),i=0;i<n.length;){if(n[i]>=e)return t=this.curves[i],e=1-(n[i]-e)/t.getLength(),t.getPointAt(e);i++}return null},_.CurvePath.prototype.getLength=function(){var t=this.getCurveLengths();return t[t.length-1]},_.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,n=0,i=this.curves.length;n<i;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t},_.CurvePath.prototype.createPointsGeometry=function(t){return t=this.getPoints(t,!0),this.createGeometry(t)},_.CurvePath.prototype.createSpacedPointsGeometry=function(t){return t=this.getSpacedPoints(t,!0),this.createGeometry(t)},_.CurvePath.prototype.createGeometry=function(t){for(var e=new _.Geometry,n=0,i=t.length;n<i;n++){var r=t[n];e.vertices.push(new _.Vector3(r.x,r.y,r.z||0))}return e},_.Path=function(t){_.CurvePath.call(this),this.actions=[],t&&this.fromPoints(t)},_.Path.prototype=(0,u.default)(_.CurvePath.prototype),_.Path.prototype.constructor=_.Path,_.Path.prototype.fromPoints=function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y)},_.Path.prototype.moveTo=function(t,e){this.actions.push({action:"moveTo",args:[t,e]})},_.Path.prototype.lineTo=function(t,e){var n=this.actions[this.actions.length-1].args,n=new _.LineCurve(new _.Vector2(n[n.length-2],n[n.length-1]),new _.Vector2(t,e));this.curves.push(n),this.actions.push({action:"lineTo",args:[t,e]})},_.Path.prototype.quadraticCurveTo=function(t,e,n,i){var r=this.actions[this.actions.length-1].args,r=new _.QuadraticBezierCurve(new _.Vector2(r[r.length-2],r[r.length-1]),new _.Vector2(t,e),new _.Vector2(n,i));this.curves.push(r),this.actions.push({action:"quadraticCurveTo",args:[t,e,n,i]})},_.Path.prototype.bezierCurveTo=function(t,e,n,i,r,o){var a=this.actions[this.actions.length-1].args,a=new _.CubicBezierCurve(new _.Vector2(a[a.length-2],a[a.length-1]),new _.Vector2(t,e),new _.Vector2(n,i),new _.Vector2(r,o));this.curves.push(a),this.actions.push({action:"bezierCurveTo",args:[t,e,n,i,r,o]})},_.Path.prototype.splineThru=function(t){var e=Array.prototype.slice.call(arguments),n=this.actions[this.actions.length-1].args,n=[new _.Vector2(n[n.length-2],n[n.length-1])];Array.prototype.push.apply(n,t),n=new _.SplineCurve(n),this.curves.push(n),this.actions.push({action:"splineThru",args:e})},_.Path.prototype.arc=function(t,e,n,i,r,o){var a=this.actions[this.actions.length-1].args;this.absarc(t+a[a.length-2],e+a[a.length-1],n,i,r,o)},_.Path.prototype.absarc=function(t,e,n,i,r,o){this.absellipse(t,e,n,n,i,r,o)},_.Path.prototype.ellipse=function(t,e,n,i,r,o,a,s){var l=this.actions[this.actions.length-1].args;this.absellipse(t+l[l.length-2],e+l[l.length-1],n,i,r,o,a,s)},_.Path.prototype.absellipse=function(t,e,n,i,r,o,a,s){var l=[t,e,n,i,r,o,a,s||0];t=new _.EllipseCurve(t,e,n,i,r,o,a,s),this.curves.push(t),t=t.getPoint(1),l.push(t.x),l.push(t.y),this.actions.push({action:"ellipse",args:l})},_.Path.prototype.getSpacedPoints=function(t,e){t||(t=40);for(var n=[],i=0;i<t;i++)n.push(this.getPoint(i/t));return n},_.Path.prototype.getPoints=function(t,e){t=t||12;for(var n,i,r,o,a,s,l,u,c,h,d=_.ShapeUtils.b2,p=_.ShapeUtils.b3,f=[],m=0,v=this.actions.length;m<v;m++){c=this.actions[m];var g=c.args;switch(c.action){case"moveTo":case"lineTo":f.push(new _.Vector2(g[0],g[1]));break;case"quadraticCurveTo":for(n=g[2],i=g[3],a=g[0],s=g[1],0<f.length?(c=f[f.length-1],l=c.x,u=c.y):(c=this.actions[m-1].args,l=c[c.length-2],u=c[c.length-1]),g=1;g<=t;g++)h=g/t,c=d(h,l,a,n),h=d(h,u,s,i),f.push(new _.Vector2(c,h));break;case"bezierCurveTo":for(n=g[4],i=g[5],a=g[0],s=g[1],r=g[2],o=g[3],0<f.length?(c=f[f.length-1],l=c.x,u=c.y):(c=this.actions[m-1].args,l=c[c.length-2],u=c[c.length-1]),g=1;g<=t;g++)h=g/t,c=p(h,l,a,r,n),h=p(h,u,s,o,i),f.push(new _.Vector2(c,h));break;case"splineThru":for(c=this.actions[m-1].args,h=[new _.Vector2(c[c.length-2],c[c.length-1])],c=t*g[0].length,h=h.concat(g[0]),h=new _.SplineCurve(h),g=1;g<=c;g++)f.push(h.getPointAt(g/c));break;case"arc":for(n=g[0],i=g[1],s=g[2],r=g[3],c=g[4],a=!!g[5],l=c-r,u=2*t,g=1;g<=u;g++)h=g/u,a||(h=1-h),h=r+h*l,c=n+s*Math.cos(h),h=i+s*Math.sin(h),f.push(new _.Vector2(c,h));break;case"ellipse":n=g[0],i=g[1],s=g[2],o=g[3],r=g[4],c=g[5],a=!!g[6];var y=g[7];l=c-r,u=2*t;var w,T;for(0!==y&&(w=Math.cos(y),T=Math.sin(y)),g=1;g<=u;g++){if(h=g/u,a||(h=1-h),h=r+h*l,c=n+s*Math.cos(h),h=i+o*Math.sin(h),0!==y){var x=c;c=(x-n)*w-(h-i)*T+n,h=(x-n)*T+(h-i)*w+i}f.push(new _.Vector2(c,h))}}}return d=f[f.length-1],Math.abs(d.x-f[0].x)<b.default&&Math.abs(d.y-f[0].y)<b.default&&f.splice(f.length-1,1),e&&f.push(f[0]),f},_.Path.prototype.toShapes=function(t,e){function n(t){for(var e=[],n=0,i=t.length;n<i;n++){var r=t[n],o=new _.Shape;o.actions=r.actions,o.curves=r.curves,e.push(o)}return e}var i=_.ShapeUtils.isClockWise,r=function(t){for(var e=[],n=new _.Path,i=0,r=t.length;i<r;i++){var o=t[i],a=o.args,o=o.action;"moveTo"===o&&0!==n.actions.length&&(e.push(n),n=new _.Path),n[o].apply(n,a)}return 0!==n.actions.length&&e.push(n),e}(this.actions);if(0===r.length)return[];if(!0===e)return n(r);var o,a,s,l=[];if(1===r.length)return a=r[0],s=new _.Shape,s.actions=a.actions,s.curves=a.curves,l.push(s),l;var u=!i(r[0].getPoints()),u=t?!u:u;s=[];var c,h=[],d=[],p=0;h[p]=void 0,d[p]=[];for(var f=0,m=r.length;f<m;f++)a=r[f],c=a.getPoints(),o=i(c),(o=t?!o:o)?(!u&&h[p]&&p++,h[p]={s:new _.Shape,p:c},h[p].s.actions=a.actions,h[p].s.curves=a.curves,u&&p++,d[p]=[]):d[p].push({h:a,p:c[0]});if(!h[0])return n(r);if(1<h.length){for(f=!1,a=[],i=0,r=h.length;i<r;i++)s[i]=[];for(i=0,r=h.length;i<r;i++)for(o=d[i],u=0;u<o.length;u++){for(p=o[u],c=!0,m=0;m<h.length;m++)(function(t,e){for(var n=e.length,i=!1,r=n-1,o=0;o<n;r=o++){var a=e[r],s=e[o],l=s.x-a.x,u=s.y-a.y;if(Math.abs(u)>b.default){if(0>u&&(a=e[o],l=-l,s=e[r],u=-u),!(t.y<a.y||t.y>s.y))if(t.y===a.y){if(t.x===a.x)return!0}else{if(0===(r=u*(t.x-a.x)-l*(t.y-a.y)))return!0;0>r||(i=!i)}}else if(t.y===a.y&&(s.x<=t.x&&t.x<=a.x||a.x<=t.x&&t.x<=s.x))return!0}return i})(p.p,h[m].p)&&(i!==m&&a.push({froms:i,tos:m,hole:u}),c?(c=!1,s[m].push(p)):f=!0);c&&s[i].push(p)}0<a.length&&(f||(d=s))}for(f=0,i=h.length;f<i;f++)for(s=h[f].s,l.push(s),a=d[f],r=0,o=a.length;r<o;r++)s.holes.push(a[r].h);return l},_.Shape=function(){_.Path.apply(this,arguments),this.holes=[]},_.Shape.prototype=(0,u.default)(_.Path.prototype),_.Shape.prototype.constructor=_.Shape,_.Shape.prototype.extrude=function(t){return new _.ExtrudeGeometry(this,t)},_.Shape.prototype.makeGeometry=function(t){return new _.ShapeGeometry(this,t)},_.Shape.prototype.getPointsHoles=function(t){for(var e=[],n=0,i=this.holes.length;n<i;n++)e[n]=this.holes[n].getPoints(t);return e},_.Shape.prototype.extractAllPoints=function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},_.Shape.prototype.extractPoints=function(t){return this.extractAllPoints(t)},_.Shape.Utils=_.ShapeUtils,_.LineCurve=function(t,e){this.v1=t,this.v2=e},_.LineCurve.prototype=(0,u.default)(_.Curve.prototype),_.LineCurve.prototype.constructor=_.LineCurve,_.LineCurve.prototype.getPoint=function(t){var e=this.v2.clone().sub(this.v1);return e.multiplyScalar(t).add(this.v1),e},_.LineCurve.prototype.getPointAt=function(t){return this.getPoint(t)},_.LineCurve.prototype.getTangent=function(t){return this.v2.clone().sub(this.v1).normalize()},_.QuadraticBezierCurve=function(t,e,n){this.v0=t,this.v1=e,this.v2=n},_.QuadraticBezierCurve.prototype=(0,u.default)(_.Curve.prototype),_.QuadraticBezierCurve.prototype.constructor=_.QuadraticBezierCurve,_.QuadraticBezierCurve.prototype.getPoint=function(t){var e=_.ShapeUtils.b2;return new _.Vector2(e(t,this.v0.x,this.v1.x,this.v2.x),e(t,this.v0.y,this.v1.y,this.v2.y))},_.QuadraticBezierCurve.prototype.getTangent=function(t){var e=_.CurveUtils.tangentQuadraticBezier;return new _.Vector2(e(t,this.v0.x,this.v1.x,this.v2.x),e(t,this.v0.y,this.v1.y,this.v2.y)).normalize()},_.CubicBezierCurve=function(t,e,n,i){this.v0=t,this.v1=e,this.v2=n,this.v3=i},_.CubicBezierCurve.prototype=(0,u.default)(_.Curve.prototype),_.CubicBezierCurve.prototype.constructor=_.CubicBezierCurve,_.CubicBezierCurve.prototype.getPoint=function(t){var e=_.ShapeUtils.b3;return new _.Vector2(e(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),e(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y))},_.CubicBezierCurve.prototype.getTangent=function(t){var e=_.CurveUtils.tangentCubicBezier;return new _.Vector2(e(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),e(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y)).normalize()},_.SplineCurve=function(t){this.points=void 0==t?[]:t},_.SplineCurve.prototype=(0,u.default)(_.Curve.prototype),_.SplineCurve.prototype.constructor=_.SplineCurve,_.SplineCurve.prototype.getPoint=function(t){var e=this.points;t*=e.length-1;var n=Math.floor(t);t-=n;var i=e[0===n?n:n-1],r=e[n],o=e[n>e.length-2?e.length-1:n+1],e=e[n>e.length-3?e.length-1:n+2],n=_.CurveUtils.interpolate;return new _.Vector2(n(i.x,r.x,o.x,e.x,t),n(i.y,r.y,o.y,e.y,t))},_.EllipseCurve=function(t,e,n,i,r,o,a,s){this.aX=t,this.aY=e,this.xRadius=n,this.yRadius=i,this.aStartAngle=r,this.aEndAngle=o,this.aClockwise=a,this.aRotation=s||0},_.EllipseCurve.prototype=(0,u.default)(_.Curve.prototype),_.EllipseCurve.prototype.constructor=_.EllipseCurve,_.EllipseCurve.prototype.getPoint=function(t){var e=this.aEndAngle-this.aStartAngle;0>e&&(e+=2*Math.PI),e>2*Math.PI&&(e-=2*Math.PI),e=!0===this.aClockwise?this.aEndAngle+(1-t)*(2*Math.PI-e):this.aStartAngle+t*e,t=this.aX+this.xRadius*Math.cos(e);var n=this.aY+this.yRadius*Math.sin(e);if(0!==this.aRotation){var e=Math.cos(this.aRotation),i=Math.sin(this.aRotation),r=t;t=(r-this.aX)*e-(n-this.aY)*i+this.aX,n=(r-this.aX)*i+(n-this.aY)*e+this.aY}return new _.Vector2(t,n)},_.ArcCurve=function(t,e,n,i,r,o){_.EllipseCurve.call(this,t,e,n,n,i,r,o)},_.ArcCurve.prototype=(0,u.default)(_.EllipseCurve.prototype),_.ArcCurve.prototype.constructor=_.ArcCurve,_.LineCurve3=_.Curve.create(function(t,e){this.v1=t,this.v2=e},function(t){var e=new _.Vector3;return e.subVectors(this.v2,this.v1),e.multiplyScalar(t),e.add(this.v1),e}),_.QuadraticBezierCurve3=_.Curve.create(function(t,e,n){this.v0=t,this.v1=e,this.v2=n},function(t){var e=_.ShapeUtils.b2;return new _.Vector3(e(t,this.v0.x,this.v1.x,this.v2.x),e(t,this.v0.y,this.v1.y,this.v2.y),e(t,this.v0.z,this.v1.z,this.v2.z))}),_.CubicBezierCurve3=_.Curve.create(function(t,e,n,i){this.v0=t,this.v1=e,this.v2=n,this.v3=i},function(t){var e=_.ShapeUtils.b3;return new _.Vector3(e(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),e(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y),e(t,this.v0.z,this.v1.z,this.v2.z,this.v3.z))}),_.SplineCurve3=_.Curve.create(function(t){console.warn("THREE.SplineCurve3 will be deprecated. Please use THREE.CatmullRomCurve3"),this.points=void 0==t?[]:t},function(t){var e=this.points;t*=e.length-1;var n=Math.floor(t);t-=n;var i=e[0==n?n:n-1],r=e[n],o=e[n>e.length-2?e.length-1:n+1],e=e[n>e.length-3?e.length-1:n+2],n=_.CurveUtils.interpolate;return new _.Vector3(n(i.x,r.x,o.x,e.x,t),n(i.y,r.y,o.y,e.y,t),n(i.z,r.z,o.z,e.z,t))}),_.CatmullRomCurve3=function(){function t(){}var e=new _.Vector3,n=new t,i=new t,r=new t;return t.prototype.init=function(t,e,n,i){this.c0=t,this.c1=n,this.c2=-3*t+3*e-2*n-i,this.c3=2*t-2*e+n+i},t.prototype.initNonuniformCatmullRom=function(t,e,n,i,r,o,a){t=((e-t)/r-(n-t)/(r+o)+(n-e)/o)*o,i=((n-e)/o-(i-e)/(o+a)+(i-n)/a)*o,this.init(e,n,t,i)},t.prototype.initCatmullRom=function(t,e,n,i,r){this.init(e,n,r*(n-t),r*(i-e))},t.prototype.calc=function(t){var e=t*t;return this.c0+this.c1*t+this.c2*e+this.c3*e*t},_.Curve.create(function(t){this.points=t||[]},function(t){var o,a,s=this.points;a=s.length,2>a&&console.log("duh, you need at least 2 points"),t*=a-1,o=Math.floor(t),0===(t-=o)&&o===a-1&&(o=a-2,t=1);var l,u,c;if(0===o?(e.subVectors(s[0],s[1]).add(s[0]),l=e):l=s[o-1],u=s[o],c=s[o+1],o+2<a?s=s[o+2]:(e.subVectors(s[a-1],s[a-2]).add(s[a-2]),s=e),void 0===this.type||"centripetal"===this.type||"chordal"===this.type){var h="chordal"===this.type?.5:.25;a=Math.pow(l.distanceToSquared(u),h),o=Math.pow(u.distanceToSquared(c),h),h=Math.pow(c.distanceToSquared(s),h),1e-4>o&&(o=1),1e-4>a&&(a=o),1e-4>h&&(h=o),n.initNonuniformCatmullRom(l.x,u.x,c.x,s.x,a,o,h),i.initNonuniformCatmullRom(l.y,u.y,c.y,s.y,a,o,h),r.initNonuniformCatmullRom(l.z,u.z,c.z,s.z,a,o,h)}else"catmullrom"===this.type&&(a=void 0!==this.tension?this.tension:.5,n.initCatmullRom(l.x,u.x,c.x,s.x,a),i.initCatmullRom(l.y,u.y,c.y,s.y,a),r.initCatmullRom(l.z,u.z,c.z,s.z,a));return new _.Vector3(n.calc(t),i.calc(t),r.calc(t))})}(),_.ClosedSplineCurve3=_.Curve.create(function(t){this.points=void 0==t?[]:t},function(t){var e=this.points;t*=e.length-0;var n=Math.floor(t);t-=n;var n=n+(0<n?0:(Math.floor(Math.abs(n)/e.length)+1)*e.length),i=e[(n-1)%e.length],r=e[n%e.length],o=e[(n+1)%e.length],e=e[(n+2)%e.length],n=_.CurveUtils.interpolate;return new _.Vector3(n(i.x,r.x,o.x,e.x,t),n(i.y,r.y,o.y,e.y,t),n(i.z,r.z,o.z,e.z,t))}),_.BoxGeometry=function(t,e,n,i,r,o){function a(t,e,n,i,r,o,a,l){var u,c=s.widthSegments,h=s.heightSegments,d=r/2,p=o/2,f=s.vertices.length;"x"===t&&"y"===e||"y"===t&&"x"===e?u="z":"x"===t&&"z"===e||"z"===t&&"x"===e?(u="y",h=s.depthSegments):("z"===t&&"y"===e||"y"===t&&"z"===e)&&(u="x",c=s.depthSegments);var m=c+1,v=h+1,g=r/c,y=o/h,b=new _.Vector3;for(b[u]=0<a?1:-1,r=0;r<v;r++)for(o=0;o<m;o++){var w=new _.Vector3;w[t]=(o*g-d)*n,w[e]=(r*y-p)*i,w[u]=a,s.vertices.push(w)}for(r=0;r<h;r++)for(o=0;o<c;o++)p=o+m*r,t=o+m*(r+1),e=o+1+m*(r+1),n=o+1+m*r,i=new _.Vector2(o/c,1-r/h),a=new _.Vector2(o/c,1-(r+1)/h),u=new _.Vector2((o+1)/c,1-(r+1)/h),d=new _.Vector2((o+1)/c,1-r/h),p=new _.Face3(p+f,t+f,n+f),p.normal.copy(b),p.vertexNormals.push(b.clone(),b.clone(),b.clone()),p.materialIndex=l,s.faces.push(p),s.faceVertexUvs[0].push([i,a,d]),p=new _.Face3(t+f,e+f,n+f),p.normal.copy(b),p.vertexNormals.push(b.clone(),b.clone(),b.clone()),p.materialIndex=l,s.faces.push(p),s.faceVertexUvs[0].push([a.clone(),u,d.clone()])}_.Geometry.call(this),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:i,heightSegments:r,depthSegments:o},this.widthSegments=i||1,this.heightSegments=r||1,this.depthSegments=o||1;var s=this;i=t/2,r=e/2,o=n/2,a("z","y",-1,-1,n,e,i,0),a("z","y",1,-1,n,e,-i,1),a("x","z",1,1,t,n,r,2),a("x","z",1,-1,t,n,-r,3),a("x","y",1,-1,t,e,o,4),a("x","y",-1,-1,t,e,-o,5),this.mergeVertices()},_.BoxGeometry.prototype=(0,u.default)(_.Geometry.prototype),_.BoxGeometry.prototype.constructor=_.BoxGeometry,_.BoxGeometry.prototype.clone=function(){var t=this.parameters;return new _.BoxGeometry(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)},_.CubeGeometry=_.BoxGeometry,_.CircleGeometry=function(t,e,n,i){_.Geometry.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:i},this.fromBufferGeometry(new _.CircleBufferGeometry(t,e,n,i))},_.CircleGeometry.prototype=(0,u.default)(_.Geometry.prototype),_.CircleGeometry.prototype.constructor=_.CircleGeometry,_.CircleGeometry.prototype.clone=function(){var t=this.parameters;return new _.CircleGeometry(t.radius,t.segments,t.thetaStart,t.thetaLength)},_.CircleBufferGeometry=function(t,e,n,i){_.BufferGeometry.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:i},t=t||50,e=void 0!==e?Math.max(3,e):8,n=void 0!==n?n:0,i=void 0!==i?i:2*Math.PI;var r=e+2,o=new Float32Array(3*r),a=new Float32Array(3*r),r=new Float32Array(2*r);a[2]=1,r[0]=.5,r[1]=.5;for(var s=0,l=3,u=2;s<=e;s++,l+=3,u+=2){var c=n+s/e*i;o[l]=t*Math.cos(c),o[l+1]=t*Math.sin(c),a[l+2]=1,r[u]=(o[l]/t+1)/2,r[u+1]=(o[l+1]/t+1)/2}for(n=[],l=1;l<=e;l++)n.push(l,l+1,0);this.setIndex(new _.BufferAttribute(new Uint16Array(n),1)),this.addAttribute("position",new _.BufferAttribute(o,3)),this.addAttribute("normal",new _.BufferAttribute(a,3)),this.addAttribute("uv",new _.BufferAttribute(r,2)),this.boundingSphere=new _.Sphere(new _.Vector3,t)},_.CircleBufferGeometry.prototype=(0,u.default)(_.BufferGeometry.prototype),_.CircleBufferGeometry.prototype.constructor=_.CircleBufferGeometry,_.CircleBufferGeometry.prototype.clone=function(){var t=this.parameters;return new _.CircleBufferGeometry(t.radius,t.segments,t.thetaStart,t.thetaLength)},_.CylinderGeometry=function(t,e,n,i,r,o,a,s){_.Geometry.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:i,heightSegments:r,openEnded:o,thetaStart:a,thetaLength:s},t=void 0!==t?t:20,e=void 0!==e?e:20,n=void 0!==n?n:100,i=i||8,r=r||1,o=void 0!==o&&o,a=void 0!==a?a:0,s=void 0!==s?s:2*Math.PI;var l,u,c=n/2,h=[],d=[];for(u=0;u<=r;u++){var p=[],f=[],m=u/r,v=m*(e-t)+t;for(l=0;l<=i;l++){var g=l/i,y=new _.Vector3;y.x=v*Math.sin(g*s+a),y.y=-m*n+c,y.z=v*Math.cos(g*s+a),this.vertices.push(y),p.push(this.vertices.length-1),f.push(new _.Vector2(g,1-m))}h.push(p),d.push(f)}for(n=(e-t)/n,l=0;l<i;l++)for(0!==t?(a=this.vertices[h[0][l]].clone(),s=this.vertices[h[0][l+1]].clone()):(a=this.vertices[h[1][l]].clone(),s=this.vertices[h[1][l+1]].clone()),a.setY(Math.sqrt(a.x*a.x+a.z*a.z)*n).normalize(),s.setY(Math.sqrt(s.x*s.x+s.z*s.z)*n).normalize(),u=0;u<r;u++){var p=h[u][l],f=h[u+1][l],m=h[u+1][l+1],v=h[u][l+1],g=a.clone(),y=a.clone(),b=s.clone(),w=s.clone(),T=d[u][l].clone(),x=d[u+1][l].clone(),E=d[u+1][l+1].clone(),S=d[u][l+1].clone();this.faces.push(new _.Face3(p,f,v,[g,y,w])),this.faceVertexUvs[0].push([T,x,S]),this.faces.push(new _.Face3(f,m,v,[y.clone(),b,w.clone()])),this.faceVertexUvs[0].push([x.clone(),E,S.clone()])}if(!1===o&&0<t)for(this.vertices.push(new _.Vector3(0,c,0)),l=0;l<i;l++)p=h[0][l],f=h[0][l+1],m=this.vertices.length-1,g=new _.Vector3(0,1,0),y=new _.Vector3(0,1,0),b=new _.Vector3(0,1,0),T=d[0][l].clone(),x=d[0][l+1].clone(),E=new _.Vector2(x.x,0),this.faces.push(new _.Face3(p,f,m,[g,y,b],void 0,1)),this.faceVertexUvs[0].push([T,x,E]);if(!1===o&&0<e)for(this.vertices.push(new _.Vector3(0,-c,0)),l=0;l<i;l++)p=h[r][l+1],f=h[r][l],m=this.vertices.length-1,g=new _.Vector3(0,-1,0),y=new _.Vector3(0,-1,0),b=new _.Vector3(0,-1,0),T=d[r][l+1].clone(),x=d[r][l].clone(),E=new _.Vector2(x.x,1),this.faces.push(new _.Face3(p,f,m,[g,y,b],void 0,2)),this.faceVertexUvs[0].push([T,x,E]);this.computeFaceNormals()},_.CylinderGeometry.prototype=(0,u.default)(_.Geometry.prototype),_.CylinderGeometry.prototype.constructor=_.CylinderGeometry,_.CylinderGeometry.prototype.clone=function(){var t=this.parameters;return new _.CylinderGeometry(t.radiusTop,t.radiusBottom,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)},_.EdgesGeometry=function(t,e){function n(t,e){return t-e}_.BufferGeometry.call(this);var i,r=Math.cos(_.Math.degToRad(void 0!==e?e:1)),o=[0,0],a={},s=["a","b","c"];t instanceof _.BufferGeometry?(i=new _.Geometry,i.fromBufferGeometry(t)):i=t.clone(),i.mergeVertices(),i.computeFaceNormals();var l=i.vertices;i=i.faces;for(var u=0,c=i.length;u<c;u++)for(var h=i[u],d=0;3>d;d++){o[0]=h[s[d]],o[1]=h[s[(d+1)%3]],o.sort(n);var p=o.toString();void 0===a[p]?a[p]={vert1:o[0],vert2:o[1],face1:u,face2:void 0}:a[p].face2=u}o=[];for(p in a)s=a[p],(void 0===s.face2||i[s.face1].normal.dot(i[s.face2].normal)<=r)&&(u=l[s.vert1],o.push(u.x),o.push(u.y),o.push(u.z),u=l[s.vert2],o.push(u.x),o.push(u.y),o.push(u.z));this.addAttribute("position",new _.BufferAttribute(new Float32Array(o),3))},_.EdgesGeometry.prototype=(0,u.default)(_.BufferGeometry.prototype),_.EdgesGeometry.prototype.constructor=_.EdgesGeometry,_.ExtrudeGeometry=function(t,e){void 0!==t&&(_.Geometry.call(this),this.type="ExtrudeGeometry",t=Array.isArray(t)?t:[t],this.addShapeList(t,e),this.computeFaceNormals())},_.ExtrudeGeometry.prototype=(0,u.default)(_.Geometry.prototype),_.ExtrudeGeometry.prototype.constructor=_.ExtrudeGeometry,_.ExtrudeGeometry.prototype.addShapeList=function(t,e){for(var n=t.length,i=0;i<n;i++)this.addShape(t[i],e)},_.ExtrudeGeometry.prototype.addShape=function(t,e){function n(t,e,n){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(n).add(t)}function i(t,e,n){var i=1,i=t.x-e.x,r=t.y-e.y,o=n.x-t.x,a=n.y-t.y,s=i*i+r*r;if(Math.abs(i*a-r*o)>b.default){var l=Math.sqrt(s),u=Math.sqrt(o*o+a*a),s=e.x-r/l;if(e=e.y+i/l,o=((n.x-a/u-s)*a-(n.y+o/u-e)*o)/(i*a-r*o),n=s+i*o-t.x,t=e+r*o-t.y,2>=(i=n*n+t*t))return new _.Vector2(n,t);i=Math.sqrt(i/2)}else t=!1,i>b.default?o>b.default&&(t=!0):i<-b.default?o<-b.default&&(t=!0):(0,g.default)(r)===(0,g.default)(a)&&(t=!0),t?(n=-r,t=i,i=Math.sqrt(s)):(n=i,t=r,i=Math.sqrt(s/2));return new _.Vector2(n/i,t/i)}function r(t,e){var n,i;for(j=t.length;0<=--j;){n=j,i=j-1,0>i&&(i=t.length-1);for(var r=0,o=w+2*m,r=0;r<o;r++){var a=V*r,s=V*(r+1),l=e+n+a,a=e+i+a,u=e+i+s,s=e+n+s,l=l+M,a=a+M,u=u+M,s=s+M;k.faces.push(new _.Face3(l,a,s,null,null,1)),k.faces.push(new _.Face3(a,u,s,null,null,1)),l=E.generateSideWallUV(k,l,a,u,s),k.faceVertexUvs[0].push([l[0],l[1],l[3]]),k.faceVertexUvs[0].push([l[1],l[2],l[3]])}}}function o(t,e,n){k.vertices.push(new _.Vector3(t,e,n))}function a(t,e,n){t+=M,e+=M,n+=M,k.faces.push(new _.Face3(t,e,n,null,null,0)),t=E.generateTopUV(k,t,e,n),k.faceVertexUvs[0].push(t)}var s,l,u,c,h,d=void 0!==e.amount?e.amount:100,p=void 0!==e.bevelThickness?e.bevelThickness:6,f=void 0!==e.bevelSize?e.bevelSize:p-2,m=void 0!==e.bevelSegments?e.bevelSegments:3,v=void 0===e.bevelEnabled||e.bevelEnabled,y=void 0!==e.curveSegments?e.curveSegments:12,w=void 0!==e.steps?e.steps:1,T=e.extrudePath,x=!1,E=void 0!==e.UVGenerator?e.UVGenerator:_.ExtrudeGeometry.WorldUVGenerator;T&&(s=T.getSpacedPoints(w),x=!0,v=!1,l=void 0!==e.frames?e.frames:new _.TubeGeometry.FrenetFrames(T,w,!1),u=new _.Vector3,c=new _.Vector3,h=new _.Vector3),v||(f=p=m=0);var S,A,C,k=this,M=this.vertices.length,T=t.extractPoints(y),y=T.shape,L=T.holes;if(T=!_.ShapeUtils.isClockWise(y)){for(y=y.reverse(),A=0,C=L.length;A<C;A++)S=L[A],_.ShapeUtils.isClockWise(S)&&(L[A]=S.reverse());T=!1}var R=_.ShapeUtils.triangulateShape(y,L),P=y;for(A=0,C=L.length;A<C;A++)S=L[A],y=y.concat(S);var D,I,F,O,N,U,V=y.length,B=R.length,T=[],j=0;for(F=P.length,D=F-1,I=j+1;j<F;j++,D++,I++)D===F&&(D=0),I===F&&(I=0),T[j]=i(P[j],P[D],P[I]);var G,H=[],z=T.concat();for(A=0,C=L.length;A<C;A++){for(S=L[A],G=[],j=0,F=S.length,D=F-1,I=j+1;j<F;j++,D++,I++)D===F&&(D=0),I===F&&(I=0),G[j]=i(S[j],S[D],S[I]);H.push(G),z=z.concat(G)}for(D=0;D<m;D++){for(F=D/m,O=p*(1-F),I=f*Math.sin(F*Math.PI/2),j=0,F=P.length;j<F;j++)N=n(P[j],T[j],I),o(N.x,N.y,-O);for(A=0,C=L.length;A<C;A++)for(S=L[A],G=H[A],j=0,F=S.length;j<F;j++)N=n(S[j],G[j],I),o(N.x,N.y,-O)}for(I=f,j=0;j<V;j++)N=v?n(y[j],z[j],I):y[j],x?(c.copy(l.normals[0]).multiplyScalar(N.x),u.copy(l.binormals[0]).multiplyScalar(N.y),h.copy(s[0]).add(c).add(u),o(h.x,h.y,h.z)):o(N.x,N.y,0);for(F=1;F<=w;F++)for(j=0;j<V;j++)N=v?n(y[j],z[j],I):y[j],x?(c.copy(l.normals[F]).multiplyScalar(N.x),u.copy(l.binormals[F]).multiplyScalar(N.y),h.copy(s[F]).add(c).add(u),o(h.x,h.y,h.z)):o(N.x,N.y,d/w*F);for(D=m-1;0<=D;D--){for(F=D/m,O=p*(1-F),I=f*Math.sin(F*Math.PI/2),j=0,F=P.length;j<F;j++)N=n(P[j],T[j],I),o(N.x,N.y,d+O);for(A=0,C=L.length;A<C;A++)for(S=L[A],G=H[A],j=0,F=S.length;j<F;j++)N=n(S[j],G[j],I),x?o(N.x,N.y+s[w-1].y,s[w-1].x+O):o(N.x,N.y,d+O)}!function(){if(v){var t;for(t=0*V,j=0;j<B;j++)U=R[j],a(U[2]+t,U[1]+t,U[0]+t);for(t=w+2*m,t*=V,j=0;j<B;j++)U=R[j],a(U[0]+t,U[1]+t,U[2]+t)}else{for(j=0;j<B;j++)U=R[j],a(U[2],U[1],U[0]);for(j=0;j<B;j++)U=R[j],a(U[0]+V*w,U[1]+V*w,U[2]+V*w)}}(),function(){var t=0;for(r(P,t),t+=P.length,A=0,C=L.length;A<C;A++)S=L[A],r(S,t),t+=S.length}()},_.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(t,e,n,i){return t=t.vertices,e=t[e],n=t[n],i=t[i],[new _.Vector2(e.x,e.y),new _.Vector2(n.x,n.y),new _.Vector2(i.x,i.y)]},generateSideWallUV:function(t,e,n,i,r){return t=t.vertices,e=t[e],n=t[n],i=t[i],r=t[r],.01>Math.abs(e.y-n.y)?[new _.Vector2(e.x,1-e.z),new _.Vector2(n.x,1-n.z),new _.Vector2(i.x,1-i.z),new _.Vector2(r.x,1-r.z)]:[new _.Vector2(e.y,1-e.z),new _.Vector2(n.y,1-n.z),new _.Vector2(i.y,1-i.z),new _.Vector2(r.y,1-r.z)]}},_.ShapeGeometry=function(t,e){_.Geometry.call(this),this.type="ShapeGeometry",!1===Array.isArray(t)&&(t=[t]),this.addShapeList(t,e),this.computeFaceNormals()},_.ShapeGeometry.prototype=(0,u.default)(_.Geometry.prototype),_.ShapeGeometry.prototype.constructor=_.ShapeGeometry,_.ShapeGeometry.prototype.addShapeList=function(t,e){for(var n=0,i=t.length;n<i;n++)this.addShape(t[n],e);return this},_.ShapeGeometry.prototype.addShape=function(t,e){void 0===e&&(e={});var n,i,r,o=e.material,a=void 0===e.UVGenerator?_.ExtrudeGeometry.WorldUVGenerator:e.UVGenerator,s=this.vertices.length;n=t.extractPoints(void 0!==e.curveSegments?e.curveSegments:12);var l=n.shape,u=n.holes;if(!_.ShapeUtils.isClockWise(l))for(l=l.reverse(),n=0,i=u.length;n<i;n++)r=u[n],_.ShapeUtils.isClockWise(r)&&(u[n]=r.reverse());var c=_.ShapeUtils.triangulateShape(l,u);for(n=0,i=u.length;n<i;n++)r=u[n],l=l.concat(r);for(u=l.length,i=c.length,n=0;n<u;n++)r=l[n],this.vertices.push(new _.Vector3(r.x,r.y,0));for(n=0;n<i;n++)u=c[n],l=u[0]+s,r=u[1]+s,u=u[2]+s,this.faces.push(new _.Face3(l,r,u,null,null,o)),this.faceVertexUvs[0].push(a.generateTopUV(this,l,r,u))},_.LatheGeometry=function(t,e,n,i){_.Geometry.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:i},e=e||12,n=n||0,i=i||2*Math.PI;for(var r=1/(t.length-1),o=1/e,a=0,s=e;a<=s;a++)for(var l=n+a*o*i,u=Math.cos(l),c=Math.sin(l),l=0,h=t.length;l<h;l++){var d=t[l],p=new _.Vector3;p.x=u*d.x-c*d.y,p.y=c*d.x+u*d.y,p.z=d.z,this.vertices.push(p)}for(n=t.length,a=0,s=e;a<s;a++)for(l=0,h=t.length-1;l<h;l++){e=c=l+n*a,i=c+n;var u=c+1+n,c=c+1,d=a*o,p=l*r,f=d+o,m=p+r;this.faces.push(new _.Face3(e,i,c)),this.faceVertexUvs[0].push([new _.Vector2(d,p),new _.Vector2(f,p),new _.Vector2(d,m)]),this.faces.push(new _.Face3(i,u,c)),this.faceVertexUvs[0].push([new _.Vector2(f,p),new _.Vector2(f,m),new _.Vector2(d,m)])}this.mergeVertices(),this.computeFaceNormals(),this.computeVertexNormals()},_.LatheGeometry.prototype=(0,u.default)(_.Geometry.prototype),_.LatheGeometry.prototype.constructor=_.LatheGeometry,_.PlaneGeometry=function(t,e,n,i){_.Geometry.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:i},this.fromBufferGeometry(new _.PlaneBufferGeometry(t,e,n,i))},_.PlaneGeometry.prototype=(0,u.default)(_.Geometry.prototype),_.PlaneGeometry.prototype.constructor=_.PlaneGeometry,_.PlaneGeometry.prototype.clone=function(){var t=this.parameters;return new _.PlaneGeometry(t.width,t.height,t.widthSegments,t.heightSegments)},_.PlaneBufferGeometry=function(t,e,n,i){_.BufferGeometry.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:i};var r=t/2,o=e/2;n=Math.floor(n)||1,i=Math.floor(i)||1;var a=n+1,s=i+1,l=t/n,u=e/i;e=new Float32Array(a*s*3),t=new Float32Array(a*s*3);for(var c=new Float32Array(a*s*2),h=0,d=0,p=0;p<s;p++)for(var f=p*u-o,m=0;m<a;m++)e[h]=m*l-r,e[h+1]=-f,t[h+2]=1,c[d]=m/n,c[d+1]=1-p/i,h+=3,d+=2;for(h=0,r=new(65535<e.length/3?Uint32Array:Uint16Array)(n*i*6),p=0;p<i;p++)for(m=0;m<n;m++)o=m+a*(p+1),s=m+1+a*(p+1),l=m+1+a*p,r[h]=m+a*p,r[h+1]=o,r[h+2]=l,r[h+3]=o,r[h+4]=s,r[h+5]=l,h+=6;this.setIndex(new _.BufferAttribute(r,1)),this.addAttribute("position",new _.BufferAttribute(e,3)),this.addAttribute("normal",new _.BufferAttribute(t,3)),this.addAttribute("uv",new _.BufferAttribute(c,2))},_.PlaneBufferGeometry.prototype=(0,u.default)(_.BufferGeometry.prototype),_.PlaneBufferGeometry.prototype.constructor=_.PlaneBufferGeometry,_.PlaneBufferGeometry.prototype.clone=function(){var t=this.parameters;return new _.PlaneBufferGeometry(t.width,t.height,t.widthSegments,t.heightSegments)},_.RingGeometry=function(t,e,n,i,r,o){_.Geometry.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:i,thetaStart:r,thetaLength:o},t=t||0,e=e||50,r=void 0!==r?r:0,o=void 0!==o?o:2*Math.PI,n=void 0!==n?Math.max(3,n):8,i=void 0!==i?Math.max(1,i):8;var a,s=[],l=t,u=(e-t)/i;for(t=0;t<i+1;t++){for(a=0;a<n+1;a++){var c=new _.Vector3,h=r+a/n*o;c.x=l*Math.cos(h),c.y=l*Math.sin(h),this.vertices.push(c),s.push(new _.Vector2((c.x/e+1)/2,(c.y/e+1)/2))}l+=u}for(e=new _.Vector3(0,0,1),t=0;t<i;t++)for(r=t*(n+1),a=0;a<n;a++)o=h=a+r,u=h+n+1,c=h+n+2,this.faces.push(new _.Face3(o,u,c,[e.clone(),e.clone(),e.clone()])),this.faceVertexUvs[0].push([s[o].clone(),s[u].clone(),s[c].clone()]),o=h,u=h+n+2,c=h+1,this.faces.push(new _.Face3(o,u,c,[e.clone(),e.clone(),e.clone()])),this.faceVertexUvs[0].push([s[o].clone(),s[u].clone(),s[c].clone()]);this.computeFaceNormals(),this.boundingSphere=new _.Sphere(new _.Vector3,l)},_.RingGeometry.prototype=(0,u.default)(_.Geometry.prototype),_.RingGeometry.prototype.constructor=_.RingGeometry,_.RingGeometry.prototype.clone=function(){var t=this.parameters;return new _.RingGeometry(t.innerRadius,t.outerRadius,t.thetaSegments,t.phiSegments,t.thetaStart,t.thetaLength)},_.SphereGeometry=function(t,e,n,i,r,o,a){_.Geometry.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:i,phiLength:r,thetaStart:o,thetaLength:a},this.fromBufferGeometry(new _.SphereBufferGeometry(t,e,n,i,r,o,a))},_.SphereGeometry.prototype=(0,u.default)(_.Geometry.prototype),_.SphereGeometry.prototype.constructor=_.SphereGeometry,_.SphereGeometry.prototype.clone=function(){var t=this.parameters;return new _.SphereGeometry(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength)},_.SphereBufferGeometry=function(t,e,n,i,r,o,a){_.BufferGeometry.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:i,phiLength:r,thetaStart:o,thetaLength:a},t=t||50,e=Math.max(3,Math.floor(e)||8),n=Math.max(2,Math.floor(n)||6),i=void 0!==i?i:0,r=void 0!==r?r:2*Math.PI,o=void 0!==o?o:0,a=void 0!==a?a:Math.PI;for(var s=o+a,l=(e+1)*(n+1),u=new _.BufferAttribute(new Float32Array(3*l),3),c=new _.BufferAttribute(new Float32Array(3*l),3),l=new _.BufferAttribute(new Float32Array(2*l),2),h=0,d=[],p=new _.Vector3,f=0;f<=n;f++){for(var m=[],v=f/n,g=0;g<=e;g++){var y=g/e,b=-t*Math.cos(i+y*r)*Math.sin(o+v*a),w=t*Math.cos(o+v*a),T=t*Math.sin(i+y*r)*Math.sin(o+v*a);p.set(b,w,T).normalize(),u.setXYZ(h,b,w,T),c.setXYZ(h,p.x,p.y,p.z),l.setXY(h,y,1-v),m.push(h),h++}d.push(m)}for(i=[],f=0;f<n;f++)for(g=0;g<e;g++)r=d[f][g+1],a=d[f][g],h=d[f+1][g],p=d[f+1][g+1],(0!==f||0<o)&&i.push(r,a,p),(f!==n-1||s<Math.PI)&&i.push(a,h,p);this.setIndex(new(65535<u.count?_.Uint32Attribute:_.Uint16Attribute)(i,1)),this.addAttribute("position",u),this.addAttribute("normal",c),this.addAttribute("uv",l),this.boundingSphere=new _.Sphere(new _.Vector3,t)},_.SphereBufferGeometry.prototype=(0,u.default)(_.BufferGeometry.prototype),_.SphereBufferGeometry.prototype.constructor=_.SphereBufferGeometry,_.SphereBufferGeometry.prototype.clone=function(){var t=this.parameters;return new _.SphereBufferGeometry(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength)},_.TorusGeometry=function(t,e,n,i,r){_.Geometry.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:i,arc:r},t=t||100,e=e||40,n=n||8,i=i||6,r=r||2*Math.PI;for(var o=new _.Vector3,a=[],s=[],l=0;l<=n;l++)for(var u=0;u<=i;u++){var c=u/i*r,h=l/n*Math.PI*2;o.x=t*Math.cos(c),o.y=t*Math.sin(c);var d=new _.Vector3;d.x=(t+e*Math.cos(h))*Math.cos(c),d.y=(t+e*Math.cos(h))*Math.sin(c),d.z=e*Math.sin(h),this.vertices.push(d),a.push(new _.Vector2(u/i,l/n)),s.push(d.clone().sub(o).normalize())}for(l=1;l<=n;l++)for(u=1;u<=i;u++)t=(i+1)*l+u-1,e=(i+1)*(l-1)+u-1,r=(i+1)*(l-1)+u,o=(i+1)*l+u,c=new _.Face3(t,e,o,[s[t].clone(),s[e].clone(),s[o].clone()]),this.faces.push(c),this.faceVertexUvs[0].push([a[t].clone(),a[e].clone(),a[o].clone()]),c=new _.Face3(e,r,o,[s[e].clone(),s[r].clone(),s[o].clone()]),this.faces.push(c),this.faceVertexUvs[0].push([a[e].clone(),a[r].clone(),a[o].clone()]);this.computeFaceNormals()},_.TorusGeometry.prototype=(0,u.default)(_.Geometry.prototype),_.TorusGeometry.prototype.constructor=_.TorusGeometry,_.TorusGeometry.prototype.clone=function(){var t=this.parameters;return new _.TorusGeometry(t.radius,t.tube,t.radialSegments,t.tubularSegments,t.arc)},_.TorusKnotGeometry=function(t,e,n,i,r,o,a){function s(t,e,n,i,r){var o=Math.cos(t),a=Math.sin(t);return t*=e/n,e=Math.cos(t),o*=i*(2+e)*.5,a=i*(2+e)*a*.5,i=r*i*Math.sin(t)*.5,new _.Vector3(o,a,i)}_.Geometry.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:i,p:r,q:o,heightScale:a},t=t||100,e=e||40,n=n||64,i=i||8,r=r||2,o=o||3,a=a||1;for(var l=Array(n),u=new _.Vector3,c=new _.Vector3,h=new _.Vector3,d=0;d<n;++d){l[d]=Array(i);var p=d/n*2*r*Math.PI,f=s(p,o,r,t,a),p=s(p+.01,o,r,t,a);for(u.subVectors(p,f),c.addVectors(p,f),h.crossVectors(u,c),c.crossVectors(h,u),h.normalize(),c.normalize(),p=0;p<i;++p){var m=p/i*2*Math.PI,v=-e*Math.cos(m),m=e*Math.sin(m),g=new _.Vector3;g.x=f.x+v*c.x+m*h.x,g.y=f.y+v*c.y+m*h.y,g.z=f.z+v*c.z+m*h.z,l[d][p]=this.vertices.push(g)-1}}for(d=0;d<n;++d)for(p=0;p<i;++p)r=(d+1)%n,o=(p+1)%i,t=l[d][p],e=l[r][p],r=l[r][o],o=l[d][o],a=new _.Vector2(d/n,p/i),u=new _.Vector2((d+1)/n,p/i),c=new _.Vector2((d+1)/n,(p+1)/i),h=new _.Vector2(d/n,(p+1)/i),this.faces.push(new _.Face3(t,e,o)),this.faceVertexUvs[0].push([a,u,h]),this.faces.push(new _.Face3(e,r,o)),this.faceVertexUvs[0].push([u.clone(),c,h.clone()]);this.computeFaceNormals(),this.computeVertexNormals()},_.TorusKnotGeometry.prototype=(0,u.default)(_.Geometry.prototype),_.TorusKnotGeometry.prototype.constructor=_.TorusKnotGeometry,_.TorusKnotGeometry.prototype.clone=function(){var t=this.parameters;return new _.TorusKnotGeometry(t.radius,t.tube,t.radialSegments,t.tubularSegments,t.p,t.q,t.heightScale)},_.TubeGeometry=function(t,e,n,i,r,o){_.Geometry.call(this),this.type="TubeGeometry",this.parameters={path:t,segments:e,radius:n,radialSegments:i,closed:r,taper:o},e=e||64,n=n||1,i=i||8,r=r||!1,o=o||_.TubeGeometry.NoTaper;var a,s,l,u,c,h,d,p,f,m,v=[],g=e+1,y=new _.Vector3;for(p=new _.TubeGeometry.FrenetFrames(t,e,r),f=p.normals,m=p.binormals,this.tangents=p.tangents,this.normals=f,this.binormals=m,p=0;p<g;p++)for(v[p]=[],l=p/(g-1),d=t.getPointAt(l),a=f[p],s=m[p],c=n*o(l),l=0;l<i;l++)u=l/i*2*Math.PI,h=-c*Math.cos(u),u=c*Math.sin(u),y.copy(d),y.x+=h*a.x+u*s.x,y.y+=h*a.y+u*s.y,y.z+=h*a.z+u*s.z,v[p][l]=this.vertices.push(new _.Vector3(y.x,y.y,y.z))-1;for(p=0;p<e;p++)for(l=0;l<i;l++)o=r?(p+1)%e:p+1,g=(l+1)%i,t=v[p][l],n=v[o][l],o=v[o][g],g=v[p][g],y=new _.Vector2(p/e,l/i),f=new _.Vector2((p+1)/e,l/i),m=new _.Vector2((p+1)/e,(l+1)/i),a=new _.Vector2(p/e,(l+1)/i),this.faces.push(new _.Face3(t,n,g)),this.faceVertexUvs[0].push([y,f,a]),this.faces.push(new _.Face3(n,o,g)),this.faceVertexUvs[0].push([f.clone(),m,a.clone()]);this.computeFaceNormals(),this.computeVertexNormals()},_.TubeGeometry.prototype=(0,u.default)(_.Geometry.prototype),_.TubeGeometry.prototype.constructor=_.TubeGeometry,_.TubeGeometry.prototype.clone=function(){return new this.constructor(this.parameters.path,this.parameters.segments,this.parameters.radius,this.parameters.radialSegments,this.parameters.closed,this.parameters.taper)},_.TubeGeometry.NoTaper=function(t){return 1},_.TubeGeometry.SinusoidalTaper=function(t){return Math.sin(Math.PI*t)},_.TubeGeometry.FrenetFrames=function(t,e,n){var i=new _.Vector3,r=[],o=[],a=[],s=new _.Vector3,l=new _.Matrix4;e+=1;var u,c,h;for(this.tangents=r,this.normals=o,this.binormals=a,u=0;u<e;u++)c=u/(e-1),r[u]=t.getTangentAt(c),r[u].normalize();for(o[0]=new _.Vector3,a[0]=new _.Vector3,t=Number.MAX_VALUE,u=Math.abs(r[0].x),c=Math.abs(r[0].y),h=Math.abs(r[0].z),u<=t&&(t=u,i.set(1,0,0)),c<=t&&(t=c,i.set(0,1,0)),h<=t&&i.set(0,0,1),s.crossVectors(r[0],i).normalize(),o[0].crossVectors(r[0],s),a[0].crossVectors(r[0],o[0]),u=1;u<e;u++)o[u]=o[u-1].clone(),a[u]=a[u-1].clone(),s.crossVectors(r[u-1],r[u]),s.length()>b.default&&(s.normalize(),i=Math.acos(_.Math.clamp(r[u-1].dot(r[u]),-1,1)),o[u].applyMatrix4(l.makeRotationAxis(s,i))),a[u].crossVectors(r[u],o[u]);if(n)for(i=Math.acos(_.Math.clamp(o[0].dot(o[e-1]),-1,1)),i/=e-1,0<r[0].dot(s.crossVectors(o[0],o[e-1]))&&(i=-i),u=1;u<e;u++)o[u].applyMatrix4(l.makeRotationAxis(r[u],i*u)),a[u].crossVectors(r[u],o[u])},_.PolyhedronGeometry=function(t,e,n,i){function r(t){var e=t.normalize().clone();e.index=s.vertices.push(e)-1;var n=Math.atan2(t.z,-t.x)/2/Math.PI+.5;return t=Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))/Math.PI+.5,e.uv=new _.Vector2(n,1-t),e}function o(t,e,n,i){i=new _.Face3(t.index,e.index,n.index,[t.clone(),e.clone(),n.clone()],void 0,i),s.faces.push(i),m.copy(t).add(e).add(n).divideScalar(3),i=Math.atan2(m.z,-m.x),s.faceVertexUvs[0].push([a(t.uv,t,i),a(e.uv,e,i),a(n.uv,n,i)])}function a(t,e,n){return 0>n&&1===t.x&&(t=new _.Vector2(t.x-1,t.y)),0===e.x&&0===e.z&&(t=new _.Vector2(n/2/Math.PI+.5,t.y)),t.clone()}_.Geometry.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:i},n=n||1,i=i||0;for(var s=this,l=0,u=t.length;l<u;l+=3)r(new _.Vector3(t[l],t[l+1],t[l+2]));t=this.vertices;for(var c=[],h=l=0,u=e.length;l<u;l+=3,h++){var d=t[e[l]],p=t[e[l+1]],f=t[e[l+2]];c[h]=new _.Face3(d.index,p.index,f.index,[d.clone(),p.clone(),f.clone()],void 0,h)}for(var m=new _.Vector3,l=0,u=c.length;l<u;l++)!function(t,e){for(var n=Math.pow(2,e),i=r(s.vertices[t.a]),a=r(s.vertices[t.b]),l=r(s.vertices[t.c]),u=[],c=t.materialIndex,h=0;h<=n;h++){u[h]=[];for(var d=r(i.clone().lerp(l,h/n)),p=r(a.clone().lerp(l,h/n)),f=n-h,m=0;m<=f;m++)u[h][m]=0===m&&h===n?d:r(d.clone().lerp(p,m/f))}for(h=0;h<n;h++)for(m=0;m<2*(n-h)-1;m++)i=Math.floor(m/2),0==m%2?o(u[h][i+1],u[h+1][i],u[h][i],c):o(u[h][i+1],u[h+1][i+1],u[h+1][i],c)}(c[l],i);for(l=0,u=this.faceVertexUvs[0].length;l<u;l++)e=this.faceVertexUvs[0][l],i=e[0].x,t=e[1].x,c=e[2].x,h=Math.max(i,t,c),d=Math.min(i,t,c),.9<h&&.1>d&&(.2>i&&(e[0].x+=1),.2>t&&(e[1].x+=1),.2>c&&(e[2].x+=1));for(l=0,u=this.vertices.length;l<u;l++)this.vertices[l].multiplyScalar(n);this.mergeVertices(),this.computeFaceNormals(),this.boundingSphere=new _.Sphere(new _.Vector3,n)},_.PolyhedronGeometry.prototype=(0,u.default)(_.Geometry.prototype),_.PolyhedronGeometry.prototype.constructor=_.PolyhedronGeometry,_.PolyhedronGeometry.prototype.clone=function(){var t=this.parameters;return new _.PolyhedronGeometry(t.vertices,t.indices,t.radius,t.detail)},_.DodecahedronGeometry=function(t,e){var n=(1+Math.sqrt(5))/2,i=1/n;_.PolyhedronGeometry.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e}},_.DodecahedronGeometry.prototype=(0,u.default)(_.PolyhedronGeometry.prototype),_.DodecahedronGeometry.prototype.constructor=_.DodecahedronGeometry,_.DodecahedronGeometry.prototype.clone=function(){var t=this.parameters;return new _.DodecahedronGeometry(t.radius,t.detail)},_.IcosahedronGeometry=function(t,e){var n=(1+Math.sqrt(5))/2;_.PolyhedronGeometry.call(this,[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e}},_.IcosahedronGeometry.prototype=(0,u.default)(_.PolyhedronGeometry.prototype),_.IcosahedronGeometry.prototype.constructor=_.IcosahedronGeometry,_.IcosahedronGeometry.prototype.clone=function(){var t=this.parameters;return new _.IcosahedronGeometry(t.radius,t.detail)},_.OctahedronGeometry=function(t,e){_.PolyhedronGeometry.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,e),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e}},_.OctahedronGeometry.prototype=(0,u.default)(_.PolyhedronGeometry.prototype),_.OctahedronGeometry.prototype.constructor=_.OctahedronGeometry,_.OctahedronGeometry.prototype.clone=function(){var t=this.parameters;return new _.OctahedronGeometry(t.radius,t.detail)},_.TetrahedronGeometry=function(t,e){_.PolyhedronGeometry.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,e),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e}},_.TetrahedronGeometry.prototype=(0,u.default)(_.PolyhedronGeometry.prototype),_.TetrahedronGeometry.prototype.constructor=_.TetrahedronGeometry,_.TetrahedronGeometry.prototype.clone=function(){var t=this.parameters;return new _.TetrahedronGeometry(t.radius,t.detail)},_.ParametricGeometry=function(t,e,n){_.Geometry.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:n};var i,r,o,a,s=this.vertices,l=this.faces,u=this.faceVertexUvs[0],c=e+1;for(i=0;i<=n;i++)for(a=i/n,r=0;r<=e;r++)o=r/e,o=t(o,a),s.push(o);var h,d,p,f;for(i=0;i<n;i++)for(r=0;r<e;r++)t=i*c+r,s=i*c+r+1,a=(i+1)*c+r+1,o=(i+1)*c+r,h=new _.Vector2(r/e,i/n),d=new _.Vector2((r+1)/e,i/n),p=new _.Vector2((r+1)/e,(i+1)/n),f=new _.Vector2(r/e,(i+1)/n),l.push(new _.Face3(t,s,o)),u.push([h,d,f]),l.push(new _.Face3(s,a,o)),u.push([d.clone(),p,f.clone()]);this.computeFaceNormals(),this.computeVertexNormals()},_.ParametricGeometry.prototype=(0,u.default)(_.Geometry.prototype),_.ParametricGeometry.prototype.constructor=_.ParametricGeometry,_.WireframeGeometry=function(t){function e(t,e){return t-e}_.BufferGeometry.call(this);var n=[0,0],i={},r=["a","b","c"];if(t instanceof _.Geometry){var o=t.vertices,a=t.faces,s=0,l=new Uint32Array(6*a.length);t=0;for(var u=a.length;t<u;t++)for(var c=a[t],h=0;3>h;h++){n[0]=c[r[h]],n[1]=c[r[(h+1)%3]],n.sort(e);var d=n.toString();void 0===i[d]&&(l[2*s]=n[0],l[2*s+1]=n[1],i[d]=!0,s++)}for(n=new Float32Array(6*s),t=0,u=s;t<u;t++)for(h=0;2>h;h++)i=o[l[2*t+h]],s=6*t+3*h,n[s+0]=i.x,n[s+1]=i.y,n[s+2]=i.z;this.addAttribute("position",new _.BufferAttribute(n,3))}else if(t instanceof _.BufferGeometry){if(null!==t.index){for(u=t.index.array,o=t.attributes.position,r=t.drawcalls,s=0,0===r.length&&t.addGroup(0,u.length),l=new Uint32Array(2*u.length),a=0,c=r.length;a<c;++a){t=r[a],h=t.start,d=t.count,t=h;for(var p=h+d;t<p;t+=3)for(h=0;3>h;h++)n[0]=u[t+h],n[1]=u[t+(h+1)%3],n.sort(e),d=n.toString(),void 0===i[d]&&(l[2*s]=n[0],l[2*s+1]=n[1],i[d]=!0,s++)}for(n=new Float32Array(6*s),t=0,u=s;t<u;t++)for(h=0;2>h;h++)s=6*t+3*h,i=l[2*t+h],n[s+0]=o.getX(i),n[s+1]=o.getY(i),n[s+2]=o.getZ(i)}else for(o=t.attributes.position.array,s=o.length/3,l=s/3,n=new Float32Array(6*s),t=0,u=l;t<u;t++)for(h=0;3>h;h++)s=18*t+6*h,l=9*t+3*h,n[s+0]=o[l],n[s+1]=o[l+1],n[s+2]=o[l+2],i=9*t+(h+1)%3*3,n[s+3]=o[i],n[s+4]=o[i+1],n[s+5]=o[i+2];this.addAttribute("position",new _.BufferAttribute(n,3))}},_.WireframeGeometry.prototype=(0,u.default)(_.BufferGeometry.prototype),_.WireframeGeometry.prototype.constructor=_.WireframeGeometry,_.AxisHelper=function(t){t=t||1;var e=new Float32Array([0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t]),n=new Float32Array([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1]);t=new _.BufferGeometry,t.addAttribute("position",new _.BufferAttribute(e,3)),t.addAttribute("color",new _.BufferAttribute(n,3)),e=new _.LineBasicMaterial({vertexColors:_.VertexColors}),_.LineSegments.call(this,t,e)},_.AxisHelper.prototype=(0,u.default)(_.LineSegments.prototype),_.AxisHelper.prototype.constructor=_.AxisHelper,_.ArrowHelper=function(){var t=new _.Geometry;t.vertices.push(new _.Vector3(0,0,0),new _.Vector3(0,1,0));var e=new _.CylinderGeometry(0,.5,1,5,1);return e.translate(0,-.5,0),function(n,i,r,o,a,s){_.Object3D.call(this),void 0===o&&(o=16776960),void 0===r&&(r=1),void 0===a&&(a=.2*r),void 0===s&&(s=.2*a),this.position.copy(i),a<r&&(this.line=new _.Line(t,new _.LineBasicMaterial({color:o})),this.line.matrixAutoUpdate=!1,this.add(this.line)),this.cone=new _.Mesh(e,new _.MeshBasicMaterial({color:o})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(n),this.setLength(r,a,s)}}(),_.ArrowHelper.prototype=(0,u.default)(_.Object3D.prototype),_.ArrowHelper.prototype.constructor=_.ArrowHelper,_.ArrowHelper.prototype.setDirection=function(){var t,e=new _.Vector3;return function(n){.99999<n.y?this.quaternion.set(0,0,0,1):-.99999>n.y?this.quaternion.set(1,0,0,0):(e.set(n.z,0,-n.x).normalize(),t=Math.acos(n.y),this.quaternion.setFromAxisAngle(e,t))}}(),_.ArrowHelper.prototype.setLength=function(t,e,n){void 0===e&&(e=.2*t),void 0===n&&(n=.2*e),e<t&&(this.line.scale.set(1,t-e,1),this.line.updateMatrix()),this.cone.scale.set(n,e,n),this.cone.position.y=t,this.cone.updateMatrix()},_.ArrowHelper.prototype.setColor=function(t){void 0!==this.line&&this.line.material.color.set(t),this.cone.material.color.set(t)},_.BoxHelper=function(t){var e=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Float32Array(24),i=new _.BufferGeometry;i.setIndex(new _.BufferAttribute(e,1)),i.addAttribute("position",new _.BufferAttribute(n,3)),_.LineSegments.call(this,i,new _.LineBasicMaterial({color:16776960})),void 0!==t&&this.update(t)},_.BoxHelper.prototype=(0,u.default)(_.LineSegments.prototype),_.BoxHelper.prototype.constructor=_.BoxHelper,_.BoxHelper.prototype.update=function(){var t=new _.Box3;return function(e){if(t.setFromObject(e),!t.empty()){e=t.min;var n=t.max,i=this.geometry.attributes.position,r=i.array;r[0]=n.x,r[1]=n.y,r[2]=n.z,r[3]=e.x,r[4]=n.y,r[5]=n.z,r[6]=e.x,r[7]=e.y,r[8]=n.z,r[9]=n.x,r[10]=e.y,r[11]=n.z,r[12]=n.x,r[13]=n.y,r[14]=e.z,r[15]=e.x,r[16]=n.y,r[17]=e.z,r[18]=e.x,r[19]=e.y,r[20]=e.z,r[21]=n.x,r[22]=e.y,r[23]=e.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),_.BoundingBoxHelper=function(t,e){var n=void 0!==e?e:8947848;this.object=t,this.box=new _.Box3,_.Mesh.call(this,new _.BoxGeometry(1,1,1),new _.MeshBasicMaterial({color:n,wireframe:!0}))},_.BoundingBoxHelper.prototype=(0,u.default)(_.Mesh.prototype),_.BoundingBoxHelper.prototype.constructor=_.BoundingBoxHelper,_.BoundingBoxHelper.prototype.update=function(){this.box.setFromObject(this.object),this.box.size(this.scale),this.box.center(this.position)},_.CameraHelper=function(t){function e(t,e,i){n(t,i),n(e,i)}function n(t,e){i.vertices.push(new _.Vector3),i.colors.push(new _.Color(e)),void 0===o[t]&&(o[t]=[]),o[t].push(i.vertices.length-1)}var i=new _.Geometry,r=new _.LineBasicMaterial({color:16777215,vertexColors:_.FaceColors}),o={};e("n1","n2",16755200),e("n2","n4",16755200),e("n4","n3",16755200),e("n3","n1",16755200),e("f1","f2",16755200),e("f2","f4",16755200),e("f4","f3",16755200),e("f3","f1",16755200),e("n1","f1",16755200),e("n2","f2",16755200),e("n3","f3",16755200),e("n4","f4",16755200),e("p","n1",16711680),e("p","n2",16711680),e("p","n3",16711680),e("p","n4",16711680),e("u1","u2",43775),e("u2","u3",43775),e("u3","u1",43775),e("c","t",16777215),e("p","c",3355443),e("cn1","cn2",3355443),e("cn3","cn4",3355443),e("cf1","cf2",3355443),e("cf3","cf4",3355443),_.LineSegments.call(this,i,r),this.camera=t,this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update()},_.CameraHelper.prototype=(0,u.default)(_.LineSegments.prototype);_.CameraHelper.prototype.constructor=_.CameraHelper,_.CameraHelper.prototype.update=function(){function t(t,o,a,s){if(i.set(o,a,s).unproject(r),void 0!==(t=n[t]))for(o=0,a=t.length;o<a;o++)e.vertices[t[o]].copy(i)}var e,n,i=new _.Vector3,r=new _.Camera;return function(){e=this.geometry,n=this.pointMap,r.projectionMatrix.copy(this.camera.projectionMatrix),t("c",0,0,-1),t("t",0,0,1),t("n1",-1,-1,-1),t("n2",1,-1,-1),t("n3",-1,1,-1),t("n4",1,1,-1),t("f1",-1,-1,1),t("f2",1,-1,1),t("f3",-1,1,1),t("f4",1,1,1),t("u1",.7,1.1,-1),t("u2",-.7,1.1,-1),t("u3",0,2,-1),t("cf1",-1,0,1),t("cf2",1,0,1),t("cf3",0,-1,1),t("cf4",0,1,1),t("cn1",-1,0,-1),t("cn2",1,0,-1),t("cn3",0,-1,-1),t("cn4",0,1,-1),e.verticesNeedUpdate=!0}}(),_.DirectionalLightHelper=function(t,e){_.Object3D.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,e=e||1;var n=new _.Geometry;n.vertices.push(new _.Vector3(-e,e,0),new _.Vector3(e,e,0),new _.Vector3(e,-e,0),new _.Vector3(-e,-e,0),new _.Vector3(-e,e,0));var i=new _.LineBasicMaterial({fog:!1});i.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.lightPlane=new _.Line(n,i),this.add(this.lightPlane),n=new _.Geometry,n.vertices.push(new _.Vector3,new _.Vector3),i=new _.LineBasicMaterial({fog:!1}),i.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine=new _.Line(n,i),this.add(this.targetLine),this.update()},_.DirectionalLightHelper.prototype=(0,u.default)(_.Object3D.prototype),_.DirectionalLightHelper.prototype.constructor=_.DirectionalLightHelper,_.DirectionalLightHelper.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},_.DirectionalLightHelper.prototype.update=function(){var t=new _.Vector3,e=new _.Vector3,n=new _.Vector3;return function(){t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),n.subVectors(e,t),this.lightPlane.lookAt(n),this.lightPlane.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine.geometry.vertices[1].copy(n),this.targetLine.geometry.verticesNeedUpdate=!0,this.targetLine.material.color.copy(this.lightPlane.material.color)}}(),_.EdgesHelper=function(t,e,n){e=void 0!==e?e:16777215,_.LineSegments.call(this,new _.EdgesGeometry(t.geometry,n),new _.LineBasicMaterial({color:e})),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1},_.EdgesHelper.prototype=(0,u.default)(_.LineSegments.prototype),_.EdgesHelper.prototype.constructor=_.EdgesHelper,_.FaceNormalsHelper=function(t,e,n,i){this.object=t,this.size=void 0!==e?e:1,t=void 0!==n?n:16776960,i=void 0!==i?i:1,e=0,n=this.object.geometry,n instanceof _.Geometry?e=n.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead."),n=new _.BufferGeometry,e=new _.Float32Attribute(6*e,3),n.addAttribute("position",e),_.LineSegments.call(this,n,new _.LineBasicMaterial({color:t,linewidth:i})),this.matrixAutoUpdate=!1,this.update()},_.FaceNormalsHelper.prototype=(0,u.default)(_.LineSegments.prototype),_.FaceNormalsHelper.prototype.constructor=_.FaceNormalsHelper,_.FaceNormalsHelper.prototype.update=function(){var t=new _.Vector3,e=new _.Vector3,n=new _.Matrix3;return function(){this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);for(var i=this.object.matrixWorld,r=this.geometry.attributes.position,o=this.object.geometry,a=o.vertices,o=o.faces,s=0,l=0,u=o.length;l<u;l++){var c=o[l],h=c.normal;t.copy(a[c.a]).add(a[c.b]).add(a[c.c]).divideScalar(3).applyMatrix4(i),e.copy(h).applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),r.setXYZ(s,t.x,t.y,t.z),s+=1,r.setXYZ(s,e.x,e.y,e.z),s+=1}return r.needsUpdate=!0,this}}(),_.GridHelper=function(t,e){var n=new _.Geometry,i=new _.LineBasicMaterial({vertexColors:_.VertexColors});this.color1=new _.Color(4473924),this.color2=new _.Color(8947848);for(var r=-t;r<=t;r+=e){n.vertices.push(new _.Vector3(-t,0,r),new _.Vector3(t,0,r),new _.Vector3(r,0,-t),new _.Vector3(r,0,t));var o=0===r?this.color1:this.color2;n.colors.push(o,o,o,o)}_.LineSegments.call(this,n,i)},_.GridHelper.prototype=(0,u.default)(_.LineSegments.prototype),_.GridHelper.prototype.constructor=_.GridHelper,_.GridHelper.prototype.setColors=function(t,e){this.color1.set(t),this.color2.set(e),this.geometry.colorsNeedUpdate=!0},_.HemisphereLightHelper=function(t,e){_.Object3D.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.colors=[new _.Color,new _.Color];var n=new _.SphereGeometry(e,4,2);n.rotateX(-Math.PI/2);for(var i=0;8>i;i++)n.faces[i].color=this.colors[4>i?0:1];i=new _.MeshBasicMaterial({vertexColors:_.FaceColors,wireframe:!0}),this.lightSphere=new _.Mesh(n,i),this.add(this.lightSphere),this.update()},_.HemisphereLightHelper.prototype=(0,u.default)(_.Object3D.prototype),_.HemisphereLightHelper.prototype.constructor=_.HemisphereLightHelper,_.HemisphereLightHelper.prototype.dispose=function(){this.lightSphere.geometry.dispose(),this.lightSphere.material.dispose()},_.HemisphereLightHelper.prototype.update=function(){var t=new _.Vector3;return function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity),this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity),this.lightSphere.lookAt(t.setFromMatrixPosition(this.light.matrixWorld).negate()),this.lightSphere.geometry.colorsNeedUpdate=!0}}(),_.PointLightHelper=function(t,e){this.light=t,this.light.updateMatrixWorld();var n=new _.SphereGeometry(e,4,2),i=new _.MeshBasicMaterial({wireframe:!0,fog:!1});i.color.copy(this.light.color).multiplyScalar(this.light.intensity),_.Mesh.call(this,n,i),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1},_.PointLightHelper.prototype=(0,u.default)(_.Mesh.prototype),_.PointLightHelper.prototype.constructor=_.PointLightHelper,_.PointLightHelper.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},_.PointLightHelper.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)},_.SkeletonHelper=function(t){this.bones=this.getBoneList(t);for(var e=new _.Geometry,n=0;n<this.bones.length;n++)this.bones[n].parent instanceof _.Bone&&(e.vertices.push(new _.Vector3),e.vertices.push(new _.Vector3),e.colors.push(new _.Color(0,0,1)),e.colors.push(new _.Color(0,1,0)));e.dynamic=!0,n=new _.LineBasicMaterial({vertexColors:_.VertexColors,depthTest:!1,depthWrite:!1,transparent:!0}),_.LineSegments.call(this,e,n),this.root=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.update()},_.SkeletonHelper.prototype=(0,u.default)(_.LineSegments.prototype),_.SkeletonHelper.prototype.constructor=_.SkeletonHelper,_.SkeletonHelper.prototype.getBoneList=function(t){var e=[];t instanceof _.Bone&&e.push(t);for(var n=0;n<t.children.length;n++)e.push.apply(e,this.getBoneList(t.children[n]));return e},_.SkeletonHelper.prototype.update=function(){for(var t=this.geometry,e=(new _.Matrix4).getInverse(this.root.matrixWorld),n=new _.Matrix4,i=0,r=0;r<this.bones.length;r++){var o=this.bones[r];o.parent instanceof _.Bone&&(n.multiplyMatrices(e,o.matrixWorld),t.vertices[i].setFromMatrixPosition(n),n.multiplyMatrices(e,o.parent.matrixWorld),t.vertices[i+1].setFromMatrixPosition(n),i+=2)}t.verticesNeedUpdate=!0,t.computeBoundingSphere()},_.SpotLightHelper=function(t){_.Object3D.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,t=new _.CylinderGeometry(0,1,1,8,1,!0),t.translate(0,-.5,0),t.rotateX(-Math.PI/2);var e=new _.MeshBasicMaterial({wireframe:!0,fog:!1});this.cone=new _.Mesh(t,e),this.add(this.cone),this.update()},_.SpotLightHelper.prototype=(0,u.default)(_.Object3D.prototype),_.SpotLightHelper.prototype.constructor=_.SpotLightHelper,_.SpotLightHelper.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},_.SpotLightHelper.prototype.update=function(){var t=new _.Vector3,e=new _.Vector3;return function(){var n=this.light.distance?this.light.distance:1e4,i=n*Math.tan(this.light.angle);this.cone.scale.set(i,i,n),t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(e.sub(t)),this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}}(),_.VertexNormalsHelper=function(t,e,n,i){this.object=t,this.size=void 0!==e?e:1,t=void 0!==n?n:16711680,i=void 0!==i?i:1,e=0,n=this.object.geometry,n instanceof _.Geometry?e=3*n.faces.length:n instanceof _.BufferGeometry&&(e=n.attributes.normal.count),n=new _.BufferGeometry,e=new _.Float32Attribute(6*e,3),n.addAttribute("position",e),_.LineSegments.call(this,n,new _.LineBasicMaterial({color:t,linewidth:i})),this.matrixAutoUpdate=!1,this.update()},_.VertexNormalsHelper.prototype=(0,u.default)(_.LineSegments.prototype),_.VertexNormalsHelper.prototype.constructor=_.VertexNormalsHelper,_.VertexNormalsHelper.prototype.update=function(){var t=new _.Vector3,e=new _.Vector3,n=new _.Matrix3;return function(){var i=["a","b","c"];this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);var r=this.object.matrixWorld,o=this.geometry.attributes.position,a=this.object.geometry;if(a instanceof _.Geometry)for(var s=a.vertices,l=a.faces,u=a=0,c=l.length;u<c;u++)for(var h=l[u],d=0,p=h.vertexNormals.length;d<p;d++){var f=h.vertexNormals[d];t.copy(s[h[i[d]]]).applyMatrix4(r),e.copy(f).applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),o.setXYZ(a,t.x,t.y,t.z),a+=1,o.setXYZ(a,e.x,e.y,e.z),a+=1}else if(a instanceof _.BufferGeometry)for(i=a.attributes.position,s=a.attributes.normal,d=a=0,p=i.count;d<p;d++)t.set(i.getX(d),i.getY(d),i.getZ(d)).applyMatrix4(r),e.set(s.getX(d),s.getY(d),s.getZ(d)),e.applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),o.setXYZ(a,t.x,t.y,t.z),a+=1,o.setXYZ(a,e.x,e.y,e.z),a+=1;return o.needsUpdate=!0,this}}(),_.WireframeHelper=function(t,e){var n=void 0!==e?e:16777215;_.LineSegments.call(this,new _.WireframeGeometry(t.geometry),new _.LineBasicMaterial({color:n})),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1},_.WireframeHelper.prototype=(0,u.default)(_.LineSegments.prototype),_.WireframeHelper.prototype.constructor=_.WireframeHelper,_.ImmediateRenderObject=function(t){_.Object3D.call(this),this.material=t,this.render=function(t){}},_.ImmediateRenderObject.prototype=(0,u.default)(_.Object3D.prototype),_.ImmediateRenderObject.prototype.constructor=_.ImmediateRenderObject,_.MorphBlendMesh=function(t,e){_.Mesh.call(this,t,e),this.animationsMap={},this.animationsList=[];var n=this.geometry.morphTargets.length;this.createAnimation("__default",0,n-1,n/1),this.setAnimationWeight("__default",1)},_.MorphBlendMesh.prototype=(0,u.default)(_.Mesh.prototype),_.MorphBlendMesh.prototype.constructor=_.MorphBlendMesh,_.MorphBlendMesh.prototype.createAnimation=function(t,e,n,i){e={start:e,end:n,length:n-e+1,fps:i,duration:(n-e)/i,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1},this.animationsMap[t]=e,this.animationsList.push(e)},_.MorphBlendMesh.prototype.autoCreateAnimations=function(t){for(var e,n=/([a-z]+)_?(\d+)/,i={},r=this.geometry,o=0,a=r.morphTargets.length;o<a;o++){var s=r.morphTargets[o].name.match(n);if(s&&1<s.length){var l=s[1];i[l]||(i[l]={start:1/0,end:-1/0}),s=i[l],o<s.start&&(s.start=o),o>s.end&&(s.end=o),e||(e=l)}}for(l in i)s=i[l],this.createAnimation(l,s.start,s.end,t);this.firstAnimation=e},_.MorphBlendMesh.prototype.setAnimationDirectionForward=function(t){(t=this.animationsMap[t])&&(t.direction=1,t.directionBackwards=!1)},_.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(t){(t=this.animationsMap[t])&&(t.direction=-1,t.directionBackwards=!0)},_.MorphBlendMesh.prototype.setAnimationFPS=function(t,e){var n=this.animationsMap[t];n&&(n.fps=e,n.duration=(n.end-n.start)/n.fps)},_.MorphBlendMesh.prototype.setAnimationDuration=function(t,e){var n=this.animationsMap[t];n&&(n.duration=e,n.fps=(n.end-n.start)/n.duration)},_.MorphBlendMesh.prototype.setAnimationWeight=function(t,e){var n=this.animationsMap[t];n&&(n.weight=e)},_.MorphBlendMesh.prototype.setAnimationTime=function(t,e){var n=this.animationsMap[t];n&&(n.time=e)},_.MorphBlendMesh.prototype.getAnimationTime=function(t){var e=0;return(t=this.animationsMap[t])&&(e=t.time),e},_.MorphBlendMesh.prototype.getAnimationDuration=function(t){var e=-1;return(t=this.animationsMap[t])&&(e=t.duration),e},_.MorphBlendMesh.prototype.playAnimation=function(t){var e=this.animationsMap[t];e?(e.time=0,e.active=!0):console.warn("THREE.MorphBlendMesh: animation["+t+"] undefined in .playAnimation()")},_.MorphBlendMesh.prototype.stopAnimation=function(t){(t=this.animationsMap[t])&&(t.active=!1)},_.MorphBlendMesh.prototype.update=function(t){for(var e=0,n=this.animationsList.length;e<n;e++){var i=this.animationsList[e];if(i.active){var r=i.duration/i.length;i.time+=i.direction*t,i.mirroredLoop?(i.time>i.duration||0>i.time)&&(i.direction*=-1,i.time>i.duration&&(i.time=i.duration,i.directionBackwards=!0),0>i.time&&(i.time=0,i.directionBackwards=!1)):(i.time%=i.duration,0>i.time&&(i.time+=i.duration));var o=i.start+_.Math.clamp(Math.floor(i.time/r),0,i.length-1),a=i.weight;o!==i.currentFrame&&(this.morphTargetInfluences[i.lastFrame]=0,this.morphTargetInfluences[i.currentFrame]=1*a,this.morphTargetInfluences[o]=0,i.lastFrame=i.currentFrame,i.currentFrame=o),r=i.time%r/r,i.directionBackwards&&(r=1-r),i.currentFrame!==i.lastFrame?(this.morphTargetInfluences[i.currentFrame]=r*a,this.morphTargetInfluences[i.lastFrame]=(1-r)*a):this.morphTargetInfluences[i.currentFrame]=a}}}},function(t,e,n){"use strict";(function(i){function r(t){return t&&t.__esModule?t:{default:t}}var o,a,s=n(54),l=r(s),u=n(13),c=r(u),h=n(31),d=r(h),p=n(14),f=r(p);!function(i,r){"object"==(0,f.default)(e)&&void 0!==t?t.exports=r():(o=r,void 0!==(a="function"==typeof o?o.call(e,n,e,t):o)&&(t.exports=a))}(0,function(){function t(t){return"[object Object]"==={}.toString.call(t)}function e(t){return[].slice.call(t)}function n(n){if(n instanceof Element||t(n))return[n];if(n instanceof NodeList)return e(n);if(Array.isArray(n))return n;try{return e(document.querySelectorAll(n))}catch(t){return[]}}function r(t){t.refObj=!0,t.attributes=t.attributes||{},t.setAttribute=function(e,n){t.attributes[e]=n},t.getAttribute=function(e){return t.attributes[e]},t.removeAttribute=function(e){delete t.attributes[e]},t.hasAttribute=function(e){return e in t.attributes},t.addEventListener=function(){},t.removeEventListener=function(){},t.classList={classNames:{},add:function(e){return t.classList.classNames[e]=!0},remove:function(e){return delete t.classList.classNames[e],!0},contains:function(e){return e in t.classList.classNames}}}function o(t){for(var e=["","webkit"],n=t.charAt(0).toUpperCase()+t.slice(1),i=0;i<e.length;i++){var r=e[i],o=r?r+n:t;if(void 0!==document.body.style[o])return o}return null}function a(){return document.createElement("div")}function s(t,e,n){var i=a();i.setAttribute("class","tippy-popper"),i.setAttribute("role","tooltip"),i.setAttribute("id","tippy-"+t),i.style.zIndex=n.zIndex,i.style.maxWidth=n.maxWidth;var r=a();r.setAttribute("class","tippy-tooltip"),r.setAttribute("data-size",n.size),r.setAttribute("data-animation",n.animation),r.setAttribute("data-state","hidden"),n.theme.split(" ").forEach(function(t){r.classList.add(t+"-theme")});var s=a();if(s.setAttribute("class","tippy-content"),n.arrow){var l=a();l.style[o("transform")]=n.arrowTransform,"round"===n.arrowType?(l.classList.add("tippy-roundarrow"),l.innerHTML='<svg viewBox="0 0 24 8" xmlns="http://www.w3.org/2000/svg"><path d="M3 8s2.021-.015 5.253-4.218C9.584 2.051 10.797 1.007 12 1c1.203-.007 2.416 1.035 3.761 2.782C19.012 8.005 21 8 21 8H3z"/></svg>'):l.classList.add("tippy-arrow"),r.appendChild(l)}if(n.animateFill){r.setAttribute("data-animatefill","");var u=a();u.classList.add("tippy-backdrop"),u.setAttribute("data-state","hidden"),r.appendChild(u)}n.inertia&&r.setAttribute("data-inertia",""),n.interactive&&r.setAttribute("data-interactive","");var c=n.html;if(c){var h;c instanceof Element?(s.appendChild(c),h="#"+(c.id||"tippy-html-template")):(s.innerHTML=document.querySelector(c).innerHTML,h=c),i.setAttribute("data-html",""),r.setAttribute("data-template-id",h),n.interactive&&i.setAttribute("tabindex","-1")}else s[n.allowTitleHTML?"innerHTML":"textContent"]=e;return r.appendChild(s),i.appendChild(r),i}function u(t,e,n,i){var r=n.onTrigger,o=n.onMouseLeave,a=n.onBlur,s=n.onDelegateShow,l=n.onDelegateHide,u=[];if("manual"===t)return u;var c=function(t,n){e.addEventListener(t,n),u.push({event:t,handler:n})};return i.target?(qt.supportsTouch&&i.touchHold&&(c("touchstart",s),c("touchend",l)),"mouseenter"===t&&(c("mouseover",s),c("mouseout",l)),"focus"===t&&(c("focusin",s),c("focusout",l)),"click"===t&&c("click",s)):(c(t,r),qt.supportsTouch&&i.touchHold&&(c("touchstart",r),c("touchend",o)),"mouseenter"===t&&c("mouseleave",o),"focus"===t&&c(Xt?"focusout":"blur",a)),u}function h(t,e){var n=$t.reduce(function(n,i){var r=t.getAttribute("data-tippy-"+i.toLowerCase())||e[i];return"false"===r&&(r=!1),"true"===r&&(r=!0),isFinite(r)&&!isNaN(parseFloat(r))&&(r=parseFloat(r)),"target"!==i&&"string"==typeof r&&"["===r.trim().charAt(0)&&(r=JSON.parse(r)),n[i]=r,n},{});return Zt({},e,n)}function p(t,e){return e.arrow&&(e.animateFill=!1),e.appendTo&&"function"==typeof e.appendTo&&(e.appendTo=e.appendTo()),"function"==typeof e.html&&(e.html=e.html(t)),e}function f(t){var e=function(e){return t.querySelector(e)};return{tooltip:e(Kt.TOOLTIP),backdrop:e(Kt.BACKDROP),content:e(Kt.CONTENT),arrow:e(Kt.ARROW)||e(Kt.ROUND_ARROW)}}function m(t){var e=t.getAttribute("title");e&&t.setAttribute("data-original-title",e),t.removeAttribute("title")}function v(t){return t&&"[object Function]"==={}.toString.call(t)}function g(t,e){if(1!==t.nodeType)return[];var n=getComputedStyle(t,null);return e?n[e]:n}function y(t){return"HTML"===t.nodeName?t:t.parentNode||t.host}function b(t){if(!t)return document.body;switch(t.nodeName){case"HTML":case"BODY":return t.ownerDocument.body;case"#document":return t.body}var e=g(t),n=e.overflow,i=e.overflowX;return/(auto|scroll|overlay)/.test(n+e.overflowY+i)?t:b(y(t))}function _(t){return 11===t?ae:10===t?se:ae||se}function w(t){if(!t)return document.documentElement;for(var e=_(10)?document.body:null,n=t.offsetParent;n===e&&t.nextElementSibling;)n=(t=t.nextElementSibling).offsetParent;var i=n&&n.nodeName;return i&&"BODY"!==i&&"HTML"!==i?-1!==["TD","TABLE"].indexOf(n.nodeName)&&"static"===g(n,"position")?w(n):n:t?t.ownerDocument.documentElement:document.documentElement}function T(t){var e=t.nodeName;return"BODY"!==e&&("HTML"===e||w(t.firstElementChild)===t)}function x(t){return null===t.parentNode?t:x(t.parentNode)}function E(t,e){if(!(t&&t.nodeType&&e&&e.nodeType))return document.documentElement;var n=t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_FOLLOWING,i=n?t:e,r=n?e:t,o=document.createRange();o.setStart(i,0),o.setEnd(r,0);var a=o.commonAncestorContainer;if(t!==a&&e!==a||i.contains(r))return T(a)?a:w(a);var s=x(t);return s.host?E(s.host,e):E(t,x(e).host)}function S(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"top",n="top"===e?"scrollTop":"scrollLeft",i=t.nodeName;if("BODY"===i||"HTML"===i){var r=t.ownerDocument.documentElement;return(t.ownerDocument.scrollingElement||r)[n]}return t[n]}function A(t,e){var n=!!(2<arguments.length&&void 0!==arguments[2])&&arguments[2],i=S(e,"top"),r=S(e,"left"),o=n?-1:1;return t.top+=i*o,t.bottom+=i*o,t.left+=r*o,t.right+=r*o,t}function C(t,e){var n="x"===e?"Left":"Top",i="Left"==n?"Right":"Bottom";return parseFloat(t["border"+n+"Width"],10)+parseFloat(t["border"+i+"Width"],10)}function k(t,e,n,i){return zt(e["offset"+t],e["scroll"+t],n["client"+t],n["offset"+t],n["scroll"+t],_(10)?n["offset"+t]+i["margin"+("Height"===t?"Top":"Left")]+i["margin"+("Height"===t?"Bottom":"Right")]:0)}function M(){var t=document.body,e=document.documentElement,n=_(10)&&getComputedStyle(e);return{height:k("Height",t,e,n),width:k("Width",t,e,n)}}function L(t){return he({},t,{right:t.left+t.width,bottom:t.top+t.height})}function R(t){var e={};try{if(_(10)){e=t.getBoundingClientRect();var n=S(t,"top"),i=S(t,"left");e.top+=n,e.left+=i,e.bottom+=n,e.right+=i}else e=t.getBoundingClientRect()}catch(t){}var r={left:e.left,top:e.top,width:e.right-e.left,height:e.bottom-e.top},o="HTML"===t.nodeName?M():{},a=o.width||t.clientWidth||r.right-r.left,s=o.height||t.clientHeight||r.bottom-r.top,l=t.offsetWidth-a,u=t.offsetHeight-s;if(l||u){var c=g(t);l-=C(c,"x"),u-=C(c,"y"),r.width-=l,r.height-=u}return L(r)}function P(t,e){var n=!!(2<arguments.length&&void 0!==arguments[2])&&arguments[2],i=_(10),r="HTML"===e.nodeName,o=R(t),a=R(e),s=b(t),l=g(e),u=parseFloat(l.borderTopWidth,10),c=parseFloat(l.borderLeftWidth,10);n&&"HTML"===e.nodeName&&(a.top=zt(a.top,0),a.left=zt(a.left,0));var h=L({top:o.top-a.top-u,left:o.left-a.left-c,width:o.width,height:o.height});if(h.marginTop=0,h.marginLeft=0,!i&&r){var d=parseFloat(l.marginTop,10),p=parseFloat(l.marginLeft,10);h.top-=u-d,h.bottom-=u-d,h.left-=c-p,h.right-=c-p,h.marginTop=d,h.marginLeft=p}return(i&&!n?e.contains(s):e===s&&"BODY"!==s.nodeName)&&(h=A(h,e)),h}function D(t){var e=!!(1<arguments.length&&void 0!==arguments[1])&&arguments[1],n=t.ownerDocument.documentElement,i=P(t,n),r=zt(n.clientWidth,window.innerWidth||0),o=zt(n.clientHeight,window.innerHeight||0),a=e?0:S(n),s=e?0:S(n,"left");return L({top:a-i.top+i.marginTop,left:s-i.left+i.marginLeft,width:r,height:o})}function I(t){var e=t.nodeName;return"BODY"!==e&&"HTML"!==e&&("fixed"===g(t,"position")||I(y(t)))}function F(t){if(!t||!t.parentElement||_())return document.documentElement;for(var e=t.parentElement;e&&"none"===g(e,"transform");)e=e.parentElement;return e||document.documentElement}function O(t,e,n,i){var r=!!(4<arguments.length&&void 0!==arguments[4])&&arguments[4],o={top:0,left:0},a=r?F(t):E(t,e);if("viewport"===i)o=D(a,r);else{var s;"scrollParent"===i?(s=b(y(e)),"BODY"===s.nodeName&&(s=t.ownerDocument.documentElement)):s="window"===i?t.ownerDocument.documentElement:i;var l=P(s,a,r);if("HTML"!==s.nodeName||I(a))o=l;else{var u=M(),c=u.height,h=u.width;o.top+=l.top-l.marginTop,o.bottom=c+l.top,o.left+=l.left-l.marginLeft,o.right=h+l.left}}return o.left+=n,o.top+=n,o.right-=n,o.bottom-=n,o}function N(t){return t.width*t.height}function U(t,e,n,i,r){var o=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0;if(-1===t.indexOf("auto"))return t;var a=O(n,i,o,r),s={top:{width:a.width,height:e.top-a.top},right:{width:a.right-e.right,height:a.height},bottom:{width:a.width,height:a.bottom-e.bottom},left:{width:e.left-a.left,height:a.height}},l=(0,d.default)(s).map(function(t){return he({key:t},s[t],{area:N(s[t])})}).sort(function(t,e){return e.area-t.area}),u=l.filter(function(t){var e=t.width,i=t.height;return e>=n.clientWidth&&i>=n.clientHeight}),c=0<u.length?u[0].key:l[0].key,h=t.split("-")[1];return c+(h?"-"+h:"")}function V(t,e,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return P(n,i?F(e):E(e,n),i)}function B(t){var e=getComputedStyle(t),n=parseFloat(e.marginTop)+parseFloat(e.marginBottom),i=parseFloat(e.marginLeft)+parseFloat(e.marginRight);return{width:t.offsetWidth+i,height:t.offsetHeight+n}}function j(t){var e={left:"right",right:"left",bottom:"top",top:"bottom"};return t.replace(/left|right|bottom|top/g,function(t){return e[t]})}function G(t,e,n){n=n.split("-")[0];var i=B(t),r={width:i.width,height:i.height},o=-1!==["right","left"].indexOf(n),a=o?"top":"left",s=o?"left":"top",l=o?"height":"width",u=o?"width":"height";return r[a]=e[a]+e[l]/2-i[l]/2,r[s]=n===s?e[s]-i[u]:e[j(s)],r}function H(t,e){return Array.prototype.find?t.find(e):t.filter(e)[0]}function z(t,e,n){if(Array.prototype.findIndex)return t.findIndex(function(t){return t[e]===n});var i=H(t,function(t){return t[e]===n});return t.indexOf(i)}function W(t,e,n){return(void 0===n?t:t.slice(0,z(t,"name",n))).forEach(function(t){t.function&&console.warn("`modifier.function` is deprecated, use `modifier.fn`!");var n=t.function||t.fn;t.enabled&&v(n)&&(e.offsets.popper=L(e.offsets.popper),e.offsets.reference=L(e.offsets.reference),e=n(e,t))}),e}function X(){if(!this.state.isDestroyed){var t={instance:this,styles:{},arrowStyles:{},attributes:{},flipped:!1,offsets:{}};t.offsets.reference=V(this.state,this.popper,this.reference,this.options.positionFixed),t.placement=U(this.options.placement,t.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding),t.originalPlacement=t.placement,t.positionFixed=this.options.positionFixed,t.offsets.popper=G(this.popper,t.offsets.reference,t.placement),t.offsets.popper.position=this.options.positionFixed?"fixed":"absolute",t=W(this.modifiers,t),this.state.isCreated?this.options.onUpdate(t):(this.state.isCreated=!0,this.options.onCreate(t))}}function q(t,e){return t.some(function(t){var n=t.name;return t.enabled&&n===e})}function K(t){for(var e=[!1,"ms","Webkit","Moz","O"],n=t.charAt(0).toUpperCase()+t.slice(1),i=0;i<e.length;i++){var r=e[i],o=r?""+r+n:t;if(void 0!==document.body.style[o])return o}return null}function Y(){return this.state.isDestroyed=!0,q(this.modifiers,"applyStyle")&&(this.popper.removeAttribute("x-placement"),this.popper.style.position="",this.popper.style.top="",this.popper.style.left="",this.popper.style.right="",this.popper.style.bottom="",this.popper.style.willChange="",this.popper.style[K("transform")]=""),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}function $(t){var e=t.ownerDocument;return e?e.defaultView:window}function Q(t,e,n,i){var r="BODY"===t.nodeName,o=r?t.ownerDocument.defaultView:t;o.addEventListener(e,n,{passive:!0}),r||Q(b(o.parentNode),e,n,i),i.push(o)}function J(t,e,n,i){n.updateBound=i,$(t).addEventListener("resize",n.updateBound,{passive:!0});var r=b(t);return Q(r,"scroll",n.updateBound,n.scrollParents),n.scrollElement=r,n.eventsEnabled=!0,n}function Z(){this.state.eventsEnabled||(this.state=J(this.reference,this.options,this.state,this.scheduleUpdate))}function tt(t,e){return $(t).removeEventListener("resize",e.updateBound),e.scrollParents.forEach(function(t){t.removeEventListener("scroll",e.updateBound)}),e.updateBound=null,e.scrollParents=[],e.scrollElement=null,e.eventsEnabled=!1,e}function et(){this.state.eventsEnabled&&(cancelAnimationFrame(this.scheduleUpdate),this.state=tt(this.reference,this.state))}function nt(t){return""!==t&&!isNaN(parseFloat(t))&&isFinite(t)}function it(t,e){(0,d.default)(e).forEach(function(n){var i="";-1!==["width","height","top","right","bottom","left"].indexOf(n)&&nt(e[n])&&(i="px"),t.style[n]=e[n]+i})}function rt(t,e){(0,d.default)(e).forEach(function(n){!1===e[n]?t.removeAttribute(n):t.setAttribute(n,e[n])})}function ot(t,e,n){var i=H(t,function(t){return t.name===e}),r=!!i&&t.some(function(t){return t.name===n&&t.enabled&&t.order<i.order});if(!r){var o="`"+e+"`";console.warn("`"+n+"` modifier is required by "+o+" modifier in order to work, be sure to include it before "+o+"!")}return r}function at(t){return"end"===t?"start":"start"===t?"end":t}function st(t){var e=!!(1<arguments.length&&void 0!==arguments[1])&&arguments[1],n=pe.indexOf(t),i=pe.slice(n+1).concat(pe.slice(0,n));return e?i.reverse():i}function lt(t,e,n,i){var r=t.match(/((?:\-|\+)?\d*\.?\d*)(.*)/),o=+r[1],a=r[2];if(!o)return t;if(0===a.indexOf("%")){var s;switch(a){case"%p":s=n;break;case"%":case"%r":default:s=i}return L(s)[e]/100*o}if("vh"===a||"vw"===a){return("vh"===a?zt(document.documentElement.clientHeight,window.innerHeight||0):zt(document.documentElement.clientWidth,window.innerWidth||0))/100*o}return o}function ut(t,e,n,i){var r=[0,0],o=-1!==["right","left"].indexOf(i),a=t.split(/(\+|\-)/).map(function(t){return t.trim()}),s=a.indexOf(H(a,function(t){return-1!==t.search(/,|\s/)}));a[s]&&-1===a[s].indexOf(",")&&console.warn("Offsets separated by white space(s) are deprecated, use a comma (,) instead.");var l=/\s*,\s*|\s+/,u=-1===s?[a]:[a.slice(0,s).concat([a[s].split(l)[0]]),[a[s].split(l)[1]].concat(a.slice(s+1))];return u=u.map(function(t,i){var r=(1===i?!o:o)?"height":"width",a=!1;return t.reduce(function(t,e){return""===t[t.length-1]&&-1!==["+","-"].indexOf(e)?(t[t.length-1]=e,a=!0,t):a?(t[t.length-1]+=e,a=!1,t):t.concat(e)},[]).map(function(t){return lt(t,r,e,n)})}),u.forEach(function(t,e){t.forEach(function(n,i){nt(n)&&(r[e]+=n*("-"===t[i-1]?-1:1))})}),r}function ct(t,e){var n,i=e.offset,r=t.placement,o=t.offsets,a=o.popper,s=o.reference,l=r.split("-")[0];return n=nt(+i)?[+i,0]:ut(i,a,s,l),"left"===l?(a.top+=n[0],a.left-=n[1]):"right"===l?(a.top+=n[0],a.left+=n[1]):"top"===l?(a.left+=n[0],a.top-=n[1]):"bottom"===l&&(a.left+=n[0],a.top+=n[1]),t.popper=a,t}function ht(t){t.offsetHeight}function dt(t,e,n){var i=t.popper,r=t.options,o=r.onCreate,a=r.onUpdate;r.onCreate=r.onUpdate=function(){ht(i),e&&e(),a(),r.onCreate=o,r.onUpdate=a},n||t.scheduleUpdate()}function pt(t){return t.getAttribute("x-placement").replace(/-.+/,"")}function ft(t,e,n){if(!e.getAttribute("x-placement"))return!0;var i=t.clientX,r=t.clientY,o=n.interactiveBorder,a=n.distance,s=e.getBoundingClientRect(),l=pt(e),u=o+a,c={top:s.top-r>o,bottom:r-s.bottom>o,left:s.left-i>o,right:i-s.right>o};return"top"===l?c.top=s.top-r>u:"bottom"===l?c.bottom=r-s.bottom>u:"left"===l?c.left=s.left-i>u:"right"===l&&(c.right=i-s.right>u),c.top||c.bottom||c.left||c.right}function mt(t,e,n,i){return e.length?{scale:function(){return 1===e.length?""+e[0]:n?e[0]+", "+e[1]:e[1]+", "+e[0]}(),translate:function(){return 1===e.length?i?-e[0]+"px":e[0]+"px":n?i?e[0]+"px, "+-e[1]+"px":e[0]+"px, "+e[1]+"px":i?-e[1]+"px, "+e[0]+"px":e[1]+"px, "+e[0]+"px"}()}[t]:""}function vt(t,e){return t?e?t:{X:"Y",Y:"X"}[t]:""}function gt(t,e,n){var i=pt(t),r="top"===i||"bottom"===i,a="right"===i||"bottom"===i,s=function(t){var e=n.match(t);return e?e[1]:""},l=function(t){var e=n.match(t);return e?e[1].split(",").map(parseFloat):[]},u={translate:/translateX?Y?\(([^)]+)\)/,scale:/scaleX?Y?\(([^)]+)\)/},c={translate:{axis:s(/translate([XY])/),numbers:l(u.translate)},scale:{axis:s(/scale([XY])/),numbers:l(u.scale)}},h=n.replace(u.translate,"translate"+vt(c.translate.axis,r)+"("+mt("translate",c.translate.numbers,r,a)+")").replace(u.scale,"scale"+vt(c.scale.axis,r)+"("+mt("scale",c.scale.numbers,r,a)+")");e.style[o("transform")]=h}function yt(t){return-(t-Yt.distance)+"px"}function bt(t){requestAnimationFrame(function(){setTimeout(t,1)})}function _t(t,e){return(Element.prototype.closest||function(t){for(var e=this;e;){if(ye.call(e,t))return e;e=e.parentElement}}).call(t,e)}function wt(t,e){return Array.isArray(t)?t[e]:t}function Tt(t,e){t.forEach(function(t){t&&t.setAttribute("data-state",e)})}function xt(t,e){t.filter(Boolean).forEach(function(t){t.style[o("transitionDuration")]=e+"ms"})}function Et(t){var e=window.scrollX||window.pageXOffset,n=window.scrollY||window.pageYOffset;t.focus(),scroll(e,n)}function St(){var t=this._(be).lastTriggerEvent;return this.options.followCursor&&!qt.usingTouch&&t&&"focus"!==t.type}function At(t){var e=_t(t.target,this.options.target);if(e&&!e._tippy){var n=e.getAttribute("title")||this.title;n&&(e.setAttribute("title",n),Bt(e,Zt({},this.options,{target:null})),Ct.call(e._tippy,t))}}function Ct(t){var e=this,n=this.options;if(Pt.call(this),!this.state.visible){if(n.target)return void At.call(this,t);if(this._(be).isPreparingToShow=!0,n.wait)return void n.wait.call(this.popper,this.show.bind(this),t);if(St.call(this)){this._(be).followCursorListener||Dt.call(this);var i=f(this.popper),r=i.arrow;r&&(r.style.margin="0"),document.addEventListener("mousemove",this._(be).followCursorListener)}var o=wt(n.delay,0);o?this._(be).showTimeout=setTimeout(function(){e.show()},o):this.show()}}function kt(){var t=this;if(Pt.call(this),!!this.state.visible){this._(be).isPreparingToShow=!1;var e=wt(this.options.delay,1);e?this._(be).hideTimeout=setTimeout(function(){t.state.visible&&t.hide()},e):this.hide()}}function Mt(){var t=this;return{onTrigger:function(e){if(t.state.enabled){var n=qt.supportsTouch&&qt.usingTouch&&-1<["mouseenter","mouseover","focus"].indexOf(e.type);n&&t.options.touchHold||(t._(be).lastTriggerEvent=e,"click"===e.type&&"persistent"!==t.options.hideOnClick&&t.state.visible?kt.call(t):Ct.call(t,e),n&&qt.iOS&&t.reference.click&&t.reference.click())}},onMouseLeave:function(e){if(!(-1<["mouseleave","mouseout"].indexOf(e.type)&&qt.supportsTouch&&qt.usingTouch&&t.options.touchHold)){if(t.options.interactive){var n=kt.bind(t),i=function e(i){var r=_t(i.target,Kt.REFERENCE),o=_t(i.target,Kt.POPPER)===t.popper,a=r===t.reference;o||a||ft(i,t.popper,t.options)&&(document.body.removeEventListener("mouseleave",n),document.removeEventListener("mousemove",e),kt.call(t,e))};return document.body.addEventListener("mouseleave",n),void document.addEventListener("mousemove",i)}kt.call(t)}},onBlur:function(e){if(e.target===t.reference&&!qt.usingTouch){if(t.options.interactive){if(!e.relatedTarget)return;if(_t(e.relatedTarget,Kt.POPPER))return}kt.call(t)}},onDelegateShow:function(e){_t(e.target,t.options.target)&&Ct.call(t,e)},onDelegateHide:function(e){_t(e.target,t.options.target)&&kt.call(t)}}}function Lt(){var t=this,e=this.popper,n=this.reference,i=this.options,r=f(e),o=r.tooltip,a=i.popperOptions,s="round"===i.arrowType?Kt.ROUND_ARROW:Kt.ARROW,l=o.querySelector(s),u=Zt({placement:i.placement},a||{},{modifiers:Zt({},a?a.modifiers:{},{arrow:Zt({element:s},a&&a.modifiers?a.modifiers.arrow:{}),flip:Zt({enabled:i.flip,padding:i.distance+5,behavior:i.flipBehavior},a&&a.modifiers?a.modifiers.flip:{}),offset:Zt({offset:i.offset},a&&a.modifiers?a.modifiers.offset:{})}),onCreate:function(){o.style[pt(e)]=yt(i.distance),l&&i.arrowTransform&&gt(e,l,i.arrowTransform)},onUpdate:function(){var t=o.style;t.top="",t.bottom="",t.left="",t.right="",t[pt(e)]=yt(i.distance),l&&i.arrowTransform&&gt(e,l,i.arrowTransform)}});return Ft.call(this,{target:e,callback:function(){t.popperInstance.update()},options:{childList:!0,subtree:!0,characterData:!0}}),new me(n,e,u)}function Rt(t){var e=this.options;if(this.popperInstance?(this.popperInstance.scheduleUpdate(),e.livePlacement&&!St.call(this)&&this.popperInstance.enableEventListeners()):(this.popperInstance=Lt.call(this),!e.livePlacement&&this.popperInstance.disableEventListeners()),!St.call(this)){var n=f(this.popper),i=n.arrow;i&&(i.style.margin=""),this.popperInstance.reference=this.reference}dt(this.popperInstance,t,!0),e.appendTo.contains(this.popper)||e.appendTo.appendChild(this.popper)}function Pt(){var t=this._(be),e=t.showTimeout,n=t.hideTimeout;clearTimeout(e),clearTimeout(n)}function Dt(){var t=this;this._(be).followCursorListener=function(e){var n=t._(be).lastMouseMoveEvent=e,i=n.clientX,r=n.clientY;t.popperInstance&&(t.popperInstance.reference={getBoundingClientRect:function(){return{width:0,height:0,top:r,left:i,right:i,bottom:r}},clientWidth:0,clientHeight:0},t.popperInstance.scheduleUpdate())}}function It(){var t=this,e=function(){t.popper.style[o("transitionDuration")]=t.options.updateDuration+"ms"},n=function(){t.popper.style[o("transitionDuration")]=""};!function i(){t.popperInstance&&t.popperInstance.update(),e(),t.state.visible?requestAnimationFrame(i):n()}()}function Ft(t){var e=t.target,n=t.callback,i=t.options;if(window.MutationObserver){var r=new MutationObserver(n);r.observe(e,i),this._(be).mutationObservers.push(r)}}function Ot(t,e){if(!t)return e();var n=f(this.popper),i=n.tooltip,r=function(t,e){e&&i[t+"EventListener"]("ontransitionend"in window?"transitionend":"webkitTransitionEnd",e)},o=function t(n){n.target===i&&(r("remove",t),e())};r("remove",this._(be).transitionendListener),r("add",o),this._(be).transitionendListener=o}function Nt(t,e){return t.reduce(function(t,n){var i=Te,r=p(n,e.performance?e:h(n,e)),o=n.getAttribute("title");if(!(o||r.target||r.html||r.dynamicTitle))return t;n.setAttribute(r.target?"data-tippy-delegate":"data-tippy",""),m(n);var a=s(i,o,r),l=new we({id:i,reference:n,popper:a,options:r,title:o,popperInstance:null});r.createPopperInstanceOnInit&&(l.popperInstance=Lt.call(l),l.popperInstance.disableEventListeners());var c=Mt.call(l);return l.listeners=r.trigger.trim().split(" ").reduce(function(t,e){return t.concat(u(e,n,c,r))},[]),r.dynamicTitle&&Ft.call(l,{target:n,callback:function(){var t=f(a),e=t.content,i=n.getAttribute("title");i&&(e[r.allowTitleHTML?"innerHTML":"textContent"]=l.title=i,m(n))},options:{attributes:!0}}),n._tippy=l,a._tippy=l,a._reference=n,t.push(l),Te++,t},[])}function Ut(t){e(document.querySelectorAll(Kt.POPPER)).forEach(function(e){var n=e._tippy;if(n){var i=n.options;(!0===i.hideOnClick||-1<i.trigger.indexOf("focus"))&&(!t||e!==t.popper)&&n.hide()}})}function Vt(){var t=function(){qt.usingTouch||(qt.usingTouch=!0,qt.iOS&&document.body.classList.add("tippy-touch"),qt.dynamicInputDetection&&window.performance&&document.addEventListener("mousemove",n),qt.onUserInputChange("touch"))},n=function(){var t;return function(){var e=performance.now();20>e-t&&(qt.usingTouch=!1,document.removeEventListener("mousemove",n),!qt.iOS&&document.body.classList.remove("tippy-touch"),qt.onUserInputChange("mouse")),t=e}}();document.addEventListener("click",function(t){if(!(t.target instanceof Element))return Ut();var e=_t(t.target,Kt.REFERENCE),n=_t(t.target,Kt.POPPER);if(!(n&&n._tippy&&n._tippy.options.interactive)){if(e&&e._tippy){var i=e._tippy.options,r=-1<i.trigger.indexOf("click"),o=i.multiple;if(!o&&qt.usingTouch||!o&&r)return Ut(e._tippy);if(!0!==i.hideOnClick||r)return}Ut()}}),document.addEventListener("touchstart",t),window.addEventListener("blur",function(){var t=document,e=t.activeElement;e&&e.blur&&ye.call(e,Kt.REFERENCE)&&e.blur()}),window.addEventListener("resize",function(){e(document.querySelectorAll(Kt.POPPER)).forEach(function(t){var e=t._tippy;e&&!e.options.livePlacement&&e.popperInstance.scheduleUpdate()})}),!qt.supportsTouch&&(navigator.maxTouchPoints||navigator.msMaxTouchPoints)&&document.addEventListener("pointerdown",t)}function Bt(e,i,o){qt.supported&&!xe&&(Vt(),xe=!0),t(e)&&r(e),i=Zt({},Yt,i);var a=n(e),s=a[0];return{selector:e,options:i,tooltips:qt.supported?Nt(o&&s?[s]:a,i):[],destroyAll:function(){this.tooltips.forEach(function(t){return t.destroy()}),this.tooltips=[]}}}var jt=Math.min,Gt=Math.round,Ht=Math.floor,zt=Math.max,Wt="undefined"!=typeof window,Xt=Wt&&/MSIE |Trident\//.test(navigator.userAgent),qt={};Wt&&(qt.supported="requestAnimationFrame"in window,qt.supportsTouch="ontouchstart"in window,qt.usingTouch=!1,qt.dynamicInputDetection=!0,qt.iOS=/iPhone|iPad|iPod/.test(navigator.platform)&&!window.MSStream,qt.onUserInputChange=function(){});for(var Kt={POPPER:".tippy-popper",TOOLTIP:".tippy-tooltip",CONTENT:".tippy-content",BACKDROP:".tippy-backdrop",ARROW:".tippy-arrow",ROUND_ARROW:".tippy-roundarrow",REFERENCE:"[data-tippy]"},Yt={placement:"top",livePlacement:!0,trigger:"mouseenter focus",animation:"shift-away",html:!1,animateFill:!0,arrow:!1,delay:0,duration:[350,300],interactive:!1,interactiveBorder:2,theme:"dark",size:"regular",distance:10,offset:0,hideOnClick:!0,multiple:!1,followCursor:!1,inertia:!1,updateDuration:350,sticky:!1,appendTo:function(){return document.body},zIndex:9999,touchHold:!1,performance:!1,dynamicTitle:!1,flip:!0,flipBehavior:"flip",arrowType:"sharp",arrowTransform:"",maxWidth:"",target:null,allowTitleHTML:!0,popperOptions:{},createPopperInstanceOnInit:!1,onShow:function(){},onShown:function(){},onHide:function(){},onHidden:function(){}},$t=qt.supported&&(0,d.default)(Yt),Qt=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},Jt=(function(){function t(t,e){for(var n,i=0;i<e.length;i++)n=e[i],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,c.default)(t,n.key,n)}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}()),Zt=l.default||function(t){for(var e,n=1;n<arguments.length;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},te="undefined"!=typeof window&&"undefined"!=typeof document,ee=["Edge","Trident","Firefox"],ne=0,ie=0;ie<ee.length;ie+=1)if(te&&0<=navigator.userAgent.indexOf(ee[ie])){ne=1;break}var re=te&&window.Promise,oe=re?function(t){var e=!1;return function(){e||(e=!0,window.Promise.resolve().then(function(){e=!1,t()}))}}:function(t){var e=!1;return function(){e||(e=!0,setTimeout(function(){e=!1,t()},ne))}},ae=te&&!(!window.MSInputMethodContext||!document.documentMode),se=te&&/MSIE 10/.test(navigator.userAgent),le=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},ue=function(){function t(t,e){for(var n,i=0;i<e.length;i++)n=e[i],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,c.default)(t,n.key,n)}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),ce=function(t,e,n){return e in t?(0,c.default)(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t},he=l.default||function(t){for(var e,n=1;n<arguments.length;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},de=["auto-start","auto","auto-end","top-start","top","top-end","right-start","right","right-end","bottom-end","bottom","bottom-start","left-end","left","left-start"],pe=de.slice(3),fe={FLIP:"flip",CLOCKWISE:"clockwise",COUNTERCLOCKWISE:"counterclockwise"},me=function(){function t(e,n){var i=this,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};le(this,t),this.scheduleUpdate=function(){return requestAnimationFrame(i.update)},this.update=oe(this.update.bind(this)),this.options=he({},t.Defaults,r),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=e&&e.jquery?e[0]:e,this.popper=n&&n.jquery?n[0]:n,this.options.modifiers={},(0,d.default)(he({},t.Defaults.modifiers,r.modifiers)).forEach(function(e){i.options.modifiers[e]=he({},t.Defaults.modifiers[e]||{},r.modifiers?r.modifiers[e]:{})}),this.modifiers=(0,d.default)(this.options.modifiers).map(function(t){return he({name:t},i.options.modifiers[t])}).sort(function(t,e){return t.order-e.order}),this.modifiers.forEach(function(t){t.enabled&&v(t.onLoad)&&t.onLoad(i.reference,i.popper,i.options,t,i.state)}),this.update();var o=this.options.eventsEnabled;o&&this.enableEventListeners(),this.state.eventsEnabled=o}return ue(t,[{key:"update",value:function(){return X.call(this)}},{key:"destroy",value:function(){return Y.call(this)}},{key:"enableEventListeners",value:function(){return Z.call(this)}},{key:"disableEventListeners",value:function(){return et.call(this)}}]),t}();me.Utils=("undefined"==typeof window?i:window).PopperUtils,me.placements=de,me.Defaults={placement:"bottom",positionFixed:!1,eventsEnabled:!0,removeOnDestroy:!1,onCreate:function(){},onUpdate:function(){},modifiers:{shift:{order:100,enabled:!0,fn:function(t){var e=t.placement,n=e.split("-")[0],i=e.split("-")[1];if(i){var r=t.offsets,o=r.reference,a=r.popper,s=-1!==["bottom","top"].indexOf(n),l=s?"left":"top",u=s?"width":"height",c={start:ce({},l,o[l]),end:ce({},l,o[l]+o[u]-a[u])};t.offsets.popper=he({},a,c[i])}return t}},offset:{order:200,enabled:!0,fn:ct,offset:0},preventOverflow:{order:300,enabled:!0,fn:function(t,e){var n=e.boundariesElement||w(t.instance.popper);t.instance.reference===n&&(n=w(n));var i=K("transform"),r=t.instance.popper.style,o=r.top,a=r.left,s=r[i];r.top="",r.left="",r[i]="";var l=O(t.instance.popper,t.instance.reference,e.padding,n,t.positionFixed);r.top=o,r.left=a,r[i]=s,e.boundaries=l;var u=e.priority,c=t.offsets.popper,h={primary:function(t){var n=c[t];return c[t]<l[t]&&!e.escapeWithReference&&(n=zt(c[t],l[t])),ce({},t,n)},secondary:function(t){var n="right"===t?"left":"top",i=c[n];return c[t]>l[t]&&!e.escapeWithReference&&(i=jt(c[n],l[t]-("right"===t?c.width:c.height))),ce({},n,i)}};return u.forEach(function(t){var e=-1===["left","top"].indexOf(t)?"secondary":"primary";c=he({},c,h[e](t))}),t.offsets.popper=c,t},priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,fn:function(t){var e=t.offsets,n=e.popper,i=e.reference,r=t.placement.split("-")[0],o=Ht,a=-1!==["top","bottom"].indexOf(r),s=a?"right":"bottom",l=a?"left":"top",u=a?"width":"height";return n[s]<o(i[l])&&(t.offsets.popper[l]=o(i[l])-n[u]),n[l]>o(i[s])&&(t.offsets.popper[l]=o(i[s])),t}},arrow:{order:500,enabled:!0,fn:function(t,e){var n;if(!ot(t.instance.modifiers,"arrow","keepTogether"))return t;var i=e.element;if("string"==typeof i){if(!(i=t.instance.popper.querySelector(i)))return t}else if(!t.instance.popper.contains(i))return console.warn("WARNING: `arrow.element` must be child of its popper element!"),t;var r=t.placement.split("-")[0],o=t.offsets,a=o.popper,s=o.reference,l=-1!==["left","right"].indexOf(r),u=l?"height":"width",c=l?"Top":"Left",h=c.toLowerCase(),d=l?"left":"top",p=l?"bottom":"right",f=B(i)[u];s[p]-f<a[h]&&(t.offsets.popper[h]-=a[h]-(s[p]-f)),s[h]+f>a[p]&&(t.offsets.popper[h]+=s[h]+f-a[p]),t.offsets.popper=L(t.offsets.popper);var m=s[h]+s[u]/2-f/2,v=g(t.instance.popper),y=parseFloat(v["margin"+c],10),b=parseFloat(v["border"+c+"Width"],10),_=m-t.offsets.popper[h]-y-b;return _=zt(jt(a[u]-f,_),0),t.arrowElement=i,t.offsets.arrow=(n={},ce(n,h,Gt(_)),ce(n,d,""),n),t},element:"[x-arrow]"},flip:{order:600,enabled:!0,fn:function(t,e){if(q(t.instance.modifiers,"inner"))return t;if(t.flipped&&t.placement===t.originalPlacement)return t;var n=O(t.instance.popper,t.instance.reference,e.padding,e.boundariesElement,t.positionFixed),i=t.placement.split("-")[0],r=j(i),o=t.placement.split("-")[1]||"",a=[];switch(e.behavior){case fe.FLIP:a=[i,r];break;case fe.CLOCKWISE:a=st(i);break;case fe.COUNTERCLOCKWISE:a=st(i,!0);break;default:a=e.behavior}return a.forEach(function(s,l){if(i!==s||a.length===l+1)return t;i=t.placement.split("-")[0],r=j(i);var u=t.offsets.popper,c=t.offsets.reference,h=Ht,d="left"===i&&h(u.right)>h(c.left)||"right"===i&&h(u.left)<h(c.right)||"top"===i&&h(u.bottom)>h(c.top)||"bottom"===i&&h(u.top)<h(c.bottom),p=h(u.left)<h(n.left),f=h(u.right)>h(n.right),m=h(u.top)<h(n.top),v=h(u.bottom)>h(n.bottom),g="left"===i&&p||"right"===i&&f||"top"===i&&m||"bottom"===i&&v,y=-1!==["top","bottom"].indexOf(i),b=!!e.flipVariations&&(y&&"start"===o&&p||y&&"end"===o&&f||!y&&"start"===o&&m||!y&&"end"===o&&v);(d||g||b)&&(t.flipped=!0,(d||g)&&(i=a[l+1]),b&&(o=at(o)),t.placement=i+(o?"-"+o:""),t.offsets.popper=he({},t.offsets.popper,G(t.instance.popper,t.offsets.reference,t.placement)),t=W(t.instance.modifiers,t,"flip"))}),t},behavior:"flip",padding:5,boundariesElement:"viewport"},inner:{order:700,enabled:!1,fn:function(t){var e=t.placement,n=e.split("-")[0],i=t.offsets,r=i.popper,o=i.reference,a=-1!==["left","right"].indexOf(n),s=-1===["top","left"].indexOf(n);return r[a?"left":"top"]=o[n]-(s?r[a?"width":"height"]:0),t.placement=j(e),t.offsets.popper=L(r),t}},hide:{order:800,enabled:!0,fn:function(t){if(!ot(t.instance.modifiers,"hide","preventOverflow"))return t;var e=t.offsets.reference,n=H(t.instance.modifiers,function(t){return"preventOverflow"===t.name}).boundaries;if(e.bottom<n.top||e.left>n.right||e.top>n.bottom||e.right<n.left){if(!0===t.hide)return t;t.hide=!0,t.attributes["x-out-of-boundaries"]=""}else{if(!1===t.hide)return t;t.hide=!1,t.attributes["x-out-of-boundaries"]=!1}return t}},computeStyle:{order:850,enabled:!0,fn:function(t,e){var n=e.x,i=e.y,r=t.offsets.popper,o=H(t.instance.modifiers,function(t){return"applyStyle"===t.name}).gpuAcceleration;void 0!==o&&console.warn("WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!");var a,s,l=void 0===o?e.gpuAcceleration:o,u=w(t.instance.popper),c=R(u),h={position:r.position},d={left:Ht(r.left),top:Gt(r.top),bottom:Gt(r.bottom),right:Ht(r.right)},p="bottom"===n?"top":"bottom",f="right"===i?"left":"right",m=K("transform");if(s="bottom"==p?-c.height+d.bottom:d.top,a="right"==f?-c.width+d.right:d.left,l&&m)h[m]="translate3d("+a+"px, "+s+"px, 0)",h[p]=0,h[f]=0,h.willChange="transform";else{var v="bottom"==p?-1:1,g="right"==f?-1:1;h[p]=s*v,h[f]=a*g,h.willChange=p+", "+f}var y={"x-placement":t.placement};return t.attributes=he({},y,t.attributes),t.styles=he({},h,t.styles),t.arrowStyles=he({},t.offsets.arrow,t.arrowStyles),t},gpuAcceleration:!0,x:"bottom",y:"right"},applyStyle:{order:900,enabled:!0,fn:function(t){return it(t.instance.popper,t.styles),rt(t.instance.popper,t.attributes),t.arrowElement&&(0,d.default)(t.arrowStyles).length&&it(t.arrowElement,t.arrowStyles),t},onLoad:function(t,e,n,i,r){var o=V(r,e,t,n.positionFixed),a=U(n.placement,o,e,t,n.modifiers.flip.boundariesElement,n.modifiers.flip.padding);return e.setAttribute("x-placement",a),it(e,{position:n.positionFixed?"fixed":"absolute"}),n},gpuAcceleration:void 0}}};var ve={};if(Wt){var ge=Element.prototype;ve=ge.matches||ge.matchesSelector||ge.webkitMatchesSelector||ge.mozMatchesSelector||ge.msMatchesSelector||function(t){for(var e=(this.document||this.ownerDocument).querySelectorAll(t),n=e.length;0<=--n&&e.item(n)!==this;);return-1<n}}var ye=ve,be={},_e=function(t){return function(e){return e===be&&t}},we=function(){function t(e){for(var n in Qt(this,t),e)this[n]=e[n];this.state={destroyed:!1,visible:!1,enabled:!0},this._=_e({mutationObservers:[]})}return Jt(t,[{key:"enable",value:function(){this.state.enabled=!0}},{key:"disable",value:function(){this.state.enabled=!1}},{key:"show",value:function(t){var e=this;if(!this.state.destroyed&&this.state.enabled){var n=this.popper,i=this.reference,r=this.options,a=f(n),s=a.tooltip,l=a.backdrop,u=a.content;return r.dynamicTitle&&!i.getAttribute("data-original-title")||i.hasAttribute("disabled")?void 0:i.refObj||document.documentElement.contains(i)?(r.onShow.call(n,this),t=wt(void 0===t?r.duration:t,0),xt([n,s,l],0),n.style.visibility="visible",this.state.visible=!0,void Rt.call(this,function(){if(e.state.visible){if(St.call(e)||e.popperInstance.scheduleUpdate(),St.call(e)){e.popperInstance.disableEventListeners();var a=wt(r.delay,0),c=e._(be).lastTriggerEvent;c&&e._(be).followCursorListener(a&&e._(be).lastMouseMoveEvent?e._(be).lastMouseMoveEvent:c)}xt([s,l,l?u:null],t),l&&getComputedStyle(l)[o("transform")],r.interactive&&i.classList.add("tippy-active"),r.sticky&&It.call(e),Tt([s,l],"visible"),Ot.call(e,t,function(){r.updateDuration||s.classList.add("tippy-notransition"),r.interactive&&Et(n),i.setAttribute("aria-describedby","tippy-"+e.id),r.onShown.call(n,e)})}})):void this.destroy()}}},{key:"hide",value:function(t){var e=this;if(!this.state.destroyed&&this.state.enabled){var n=this.popper,i=this.reference,r=this.options,o=f(n),a=o.tooltip,s=o.backdrop,l=o.content;r.onHide.call(n,this),t=wt(void 0===t?r.duration:t,1),r.updateDuration||a.classList.remove("tippy-notransition"),r.interactive&&i.classList.remove("tippy-active"),n.style.visibility="hidden",this.state.visible=!1,xt([a,s,s?l:null],t),Tt([a,s],"hidden"),r.interactive&&-1<r.trigger.indexOf("click")&&Et(i),this.popperInstance.disableEventListeners(),bt(function(){Ot.call(e,t,function(){e.state.visible||!r.appendTo.contains(n)||(!e._(be).isPreparingToShow&&(document.removeEventListener("mousemove",e._(be).followCursorListener),e._(be).lastMouseMoveEvent=null),i.removeAttribute("aria-describedby"),r.appendTo.removeChild(n),r.onHidden.call(n,e))})})}}},{key:"destroy",value:function(){var t=this,n=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this.state.destroyed||(this.state.visible&&this.hide(0),this.listeners.forEach(function(e){t.reference.removeEventListener(e.event,e.handler)}),this.title&&this.reference.setAttribute("title",this.title),delete this.reference._tippy,["data-original-title","data-tippy","data-tippy-delegate"].forEach(function(e){t.reference.removeAttribute(e)}),this.options.target&&n&&e(this.reference.querySelectorAll(this.options.target)).forEach(function(t){return t._tippy&&t._tippy.destroy()}),this.popperInstance&&this.popperInstance.destroy(),this._(be).mutationObservers.forEach(function(t){t.disconnect()}),this.state.destroyed=!0)}}]),t}(),Te=1,xe=!1;return Bt.version="2.5.2",Bt.browser=qt,Bt.defaults=Yt,Bt.one=function(t,e){return Bt(t,e,!0).tooltips[0]},Bt.disableAnimations=function(){Yt.updateDuration=Yt.duration=0,Yt.animateFill=!1},function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";if(Wt&&qt.supported){var e=document.head||document.querySelector("head"),n=document.createElement("style");n.type="text/css",e.insertBefore(n,e.firstChild),n.styleSheet?n.styleSheet.cssText=t:n.appendChild(document.createTextNode(t))}}('.tippy-touch{cursor:pointer!important}.tippy-notransition{transition:none!important}.tippy-popper{max-width:350px;-webkit-perspective:700px;perspective:700px;z-index:9999;outline:0;transition-timing-function:cubic-bezier(.165,.84,.44,1);pointer-events:none;line-height:1.4}.tippy-popper[data-html]{max-width:96%;max-width:calc(100% - 20px)}.tippy-popper[x-placement^=top] .tippy-backdrop{border-radius:40% 40% 0 0}.tippy-popper[x-placement^=top] .tippy-roundarrow{bottom:-8px;-webkit-transform-origin:50% 0;transform-origin:50% 0}.tippy-popper[x-placement^=top] .tippy-roundarrow svg{position:absolute;left:0;-webkit-transform:rotate(180deg);transform:rotate(180deg)}.tippy-popper[x-placement^=top] .tippy-arrow{border-top:7px solid #333;border-right:7px solid transparent;border-left:7px solid transparent;bottom:-7px;margin:0 6px;-webkit-transform-origin:50% 0;transform-origin:50% 0}.tippy-popper[x-placement^=top] .tippy-backdrop{-webkit-transform-origin:0 90%;transform-origin:0 90%}.tippy-popper[x-placement^=top] .tippy-backdrop[data-state=visible]{-webkit-transform:scale(6) translate(-50%,25%);transform:scale(6) translate(-50%,25%);opacity:1}.tippy-popper[x-placement^=top] .tippy-backdrop[data-state=hidden]{-webkit-transform:scale(1) translate(-50%,25%);transform:scale(1) translate(-50%,25%);opacity:0}.tippy-popper[x-placement^=top] [data-animation=shift-toward][data-state=visible]{opacity:1;-webkit-transform:translateY(-10px);transform:translateY(-10px)}.tippy-popper[x-placement^=top] [data-animation=shift-toward][data-state=hidden]{opacity:0;-webkit-transform:translateY(-20px);transform:translateY(-20px)}.tippy-popper[x-placement^=top] [data-animation=perspective]{-webkit-transform-origin:bottom;transform-origin:bottom}.tippy-popper[x-placement^=top] [data-animation=perspective][data-state=visible]{opacity:1;-webkit-transform:translateY(-10px) rotateX(0);transform:translateY(-10px) rotateX(0)}.tippy-popper[x-placement^=top] [data-animation=perspective][data-state=hidden]{opacity:0;-webkit-transform:translateY(0) rotateX(90deg);transform:translateY(0) rotateX(90deg)}.tippy-popper[x-placement^=top] [data-animation=fade][data-state=visible]{opacity:1;-webkit-transform:translateY(-10px);transform:translateY(-10px)}.tippy-popper[x-placement^=top] [data-animation=fade][data-state=hidden]{opacity:0;-webkit-transform:translateY(-10px);transform:translateY(-10px)}.tippy-popper[x-placement^=top] [data-animation=shift-away][data-state=visible]{opacity:1;-webkit-transform:translateY(-10px);transform:translateY(-10px)}.tippy-popper[x-placement^=top] [data-animation=shift-away][data-state=hidden]{opacity:0;-webkit-transform:translateY(0);transform:translateY(0)}.tippy-popper[x-placement^=top] [data-animation=scale][data-state=visible]{opacity:1;-webkit-transform:translateY(-10px) scale(1);transform:translateY(-10px) scale(1)}.tippy-popper[x-placement^=top] [data-animation=scale][data-state=hidden]{opacity:0;-webkit-transform:translateY(0) scale(0);transform:translateY(0) scale(0)}.tippy-popper[x-placement^=bottom] .tippy-backdrop{border-radius:0 0 30% 30%}.tippy-popper[x-placement^=bottom] .tippy-roundarrow{top:-8px;-webkit-transform-origin:50% 100%;transform-origin:50% 100%}.tippy-popper[x-placement^=bottom] .tippy-roundarrow svg{position:absolute;left:0;-webkit-transform:rotate(0);transform:rotate(0)}.tippy-popper[x-placement^=bottom] .tippy-arrow{border-bottom:7px solid #333;border-right:7px solid transparent;border-left:7px solid transparent;top:-7px;margin:0 6px;-webkit-transform-origin:50% 100%;transform-origin:50% 100%}.tippy-popper[x-placement^=bottom] .tippy-backdrop{-webkit-transform-origin:0 -90%;transform-origin:0 -90%}.tippy-popper[x-placement^=bottom] .tippy-backdrop[data-state=visible]{-webkit-transform:scale(6) translate(-50%,-125%);transform:scale(6) translate(-50%,-125%);opacity:1}.tippy-popper[x-placement^=bottom] .tippy-backdrop[data-state=hidden]{-webkit-transform:scale(1) translate(-50%,-125%);transform:scale(1) translate(-50%,-125%);opacity:0}.tippy-popper[x-placement^=bottom] [data-animation=shift-toward][data-state=visible]{opacity:1;-webkit-transform:translateY(10px);transform:translateY(10px)}.tippy-popper[x-placement^=bottom] [data-animation=shift-toward][data-state=hidden]{opacity:0;-webkit-transform:translateY(20px);transform:translateY(20px)}.tippy-popper[x-placement^=bottom] [data-animation=perspective]{-webkit-transform-origin:top;transform-origin:top}.tippy-popper[x-placement^=bottom] [data-animation=perspective][data-state=visible]{opacity:1;-webkit-transform:translateY(10px) rotateX(0);transform:translateY(10px) rotateX(0)}.tippy-popper[x-placement^=bottom] [data-animation=perspective][data-state=hidden]{opacity:0;-webkit-transform:translateY(0) rotateX(-90deg);transform:translateY(0) rotateX(-90deg)}.tippy-popper[x-placement^=bottom] [data-animation=fade][data-state=visible]{opacity:1;-webkit-transform:translateY(10px);transform:translateY(10px)}.tippy-popper[x-placement^=bottom] [data-animation=fade][data-state=hidden]{opacity:0;-webkit-transform:translateY(10px);transform:translateY(10px)}.tippy-popper[x-placement^=bottom] [data-animation=shift-away][data-state=visible]{opacity:1;-webkit-transform:translateY(10px);transform:translateY(10px)}.tippy-popper[x-placement^=bottom] [data-animation=shift-away][data-state=hidden]{opacity:0;-webkit-transform:translateY(0);transform:translateY(0)}.tippy-popper[x-placement^=bottom] [data-animation=scale][data-state=visible]{opacity:1;-webkit-transform:translateY(10px) scale(1);transform:translateY(10px) scale(1)}.tippy-popper[x-placement^=bottom] [data-animation=scale][data-state=hidden]{opacity:0;-webkit-transform:translateY(0) scale(0);transform:translateY(0) scale(0)}.tippy-popper[x-placement^=left] .tippy-backdrop{border-radius:50% 0 0 50%}.tippy-popper[x-placement^=left] .tippy-roundarrow{right:-16px;-webkit-transform-origin:33.33333333% 50%;transform-origin:33.33333333% 50%}.tippy-popper[x-placement^=left] .tippy-roundarrow svg{position:absolute;left:0;-webkit-transform:rotate(90deg);transform:rotate(90deg)}.tippy-popper[x-placement^=left] .tippy-arrow{border-left:7px solid #333;border-top:7px solid transparent;border-bottom:7px solid transparent;right:-7px;margin:3px 0;-webkit-transform-origin:0 50%;transform-origin:0 50%}.tippy-popper[x-placement^=left] .tippy-backdrop{-webkit-transform-origin:100% 0;transform-origin:100% 0}.tippy-popper[x-placement^=left] .tippy-backdrop[data-state=visible]{-webkit-transform:scale(6) translate(40%,-50%);transform:scale(6) translate(40%,-50%);opacity:1}.tippy-popper[x-placement^=left] .tippy-backdrop[data-state=hidden]{-webkit-transform:scale(1.5) translate(40%,-50%);transform:scale(1.5) translate(40%,-50%);opacity:0}.tippy-popper[x-placement^=left] [data-animation=shift-toward][data-state=visible]{opacity:1;-webkit-transform:translateX(-10px);transform:translateX(-10px)}.tippy-popper[x-placement^=left] [data-animation=shift-toward][data-state=hidden]{opacity:0;-webkit-transform:translateX(-20px);transform:translateX(-20px)}.tippy-popper[x-placement^=left] [data-animation=perspective]{-webkit-transform-origin:right;transform-origin:right}.tippy-popper[x-placement^=left] [data-animation=perspective][data-state=visible]{opacity:1;-webkit-transform:translateX(-10px) rotateY(0);transform:translateX(-10px) rotateY(0)}.tippy-popper[x-placement^=left] [data-animation=perspective][data-state=hidden]{opacity:0;-webkit-transform:translateX(0) rotateY(-90deg);transform:translateX(0) rotateY(-90deg)}.tippy-popper[x-placement^=left] [data-animation=fade][data-state=visible]{opacity:1;-webkit-transform:translateX(-10px);transform:translateX(-10px)}.tippy-popper[x-placement^=left] [data-animation=fade][data-state=hidden]{opacity:0;-webkit-transform:translateX(-10px);transform:translateX(-10px)}.tippy-popper[x-placement^=left] [data-animation=shift-away][data-state=visible]{opacity:1;-webkit-transform:translateX(-10px);transform:translateX(-10px)}.tippy-popper[x-placement^=left] [data-animation=shift-away][data-state=hidden]{opacity:0;-webkit-transform:translateX(0);transform:translateX(0)}.tippy-popper[x-placement^=left] [data-animation=scale][data-state=visible]{opacity:1;-webkit-transform:translateX(-10px) scale(1);transform:translateX(-10px) scale(1)}.tippy-popper[x-placement^=left] [data-animation=scale][data-state=hidden]{opacity:0;-webkit-transform:translateX(0) scale(0);transform:translateX(0) scale(0)}.tippy-popper[x-placement^=right] .tippy-backdrop{border-radius:0 50% 50% 0}.tippy-popper[x-placement^=right] .tippy-roundarrow{left:-16px;-webkit-transform-origin:66.66666666% 50%;transform-origin:66.66666666% 50%}.tippy-popper[x-placement^=right] .tippy-roundarrow svg{position:absolute;left:0;-webkit-transform:rotate(-90deg);transform:rotate(-90deg)}.tippy-popper[x-placement^=right] .tippy-arrow{border-right:7px solid #333;border-top:7px solid transparent;border-bottom:7px solid transparent;left:-7px;margin:3px 0;-webkit-transform-origin:100% 50%;transform-origin:100% 50%}.tippy-popper[x-placement^=right] .tippy-backdrop{-webkit-transform-origin:-100% 0;transform-origin:-100% 0}.tippy-popper[x-placement^=right] .tippy-backdrop[data-state=visible]{-webkit-transform:scale(6) translate(-140%,-50%);transform:scale(6) translate(-140%,-50%);opacity:1}.tippy-popper[x-placement^=right] .tippy-backdrop[data-state=hidden]{-webkit-transform:scale(1.5) translate(-140%,-50%);transform:scale(1.5) translate(-140%,-50%);opacity:0}.tippy-popper[x-placement^=right] [data-animation=shift-toward][data-state=visible]{opacity:1;-webkit-transform:translateX(10px);transform:translateX(10px)}.tippy-popper[x-placement^=right] [data-animation=shift-toward][data-state=hidden]{opacity:0;-webkit-transform:translateX(20px);transform:translateX(20px)}.tippy-popper[x-placement^=right] [data-animation=perspective]{-webkit-transform-origin:left;transform-origin:left}.tippy-popper[x-placement^=right] [data-animation=perspective][data-state=visible]{opacity:1;-webkit-transform:translateX(10px) rotateY(0);transform:translateX(10px) rotateY(0)}.tippy-popper[x-placement^=right] [data-animation=perspective][data-state=hidden]{opacity:0;-webkit-transform:translateX(0) rotateY(90deg);transform:translateX(0) rotateY(90deg)}.tippy-popper[x-placement^=right] [data-animation=fade][data-state=visible]{opacity:1;-webkit-transform:translateX(10px);transform:translateX(10px)}.tippy-popper[x-placement^=right] [data-animation=fade][data-state=hidden]{opacity:0;-webkit-transform:translateX(10px);transform:translateX(10px)}.tippy-popper[x-placement^=right] [data-animation=shift-away][data-state=visible]{opacity:1;-webkit-transform:translateX(10px);transform:translateX(10px)}.tippy-popper[x-placement^=right] [data-animation=shift-away][data-state=hidden]{opacity:0;-webkit-transform:translateX(0);transform:translateX(0)}.tippy-popper[x-placement^=right] [data-animation=scale][data-state=visible]{opacity:1;-webkit-transform:translateX(10px) scale(1);transform:translateX(10px) scale(1)}.tippy-popper[x-placement^=right] [data-animation=scale][data-state=hidden]{opacity:0;-webkit-transform:translateX(0) scale(0);transform:translateX(0) scale(0)}.tippy-tooltip{position:relative;color:#fff;border-radius:4px;font-size:.9rem;padding:.3rem .6rem;text-align:center;will-change:transform;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;background-color:#333}.tippy-tooltip[data-size=small]{padding:.2rem .4rem;font-size:.75rem}.tippy-tooltip[data-size=large]{padding:.4rem .8rem;font-size:1rem}.tippy-tooltip[data-animatefill]{overflow:hidden;background-color:transparent}.tippy-tooltip[data-animatefill] .tippy-content{transition:-webkit-clip-path cubic-bezier(.46,.1,.52,.98);transition:clip-path cubic-bezier(.46,.1,.52,.98);transition:clip-path cubic-bezier(.46,.1,.52,.98),-webkit-clip-path cubic-bezier(.46,.1,.52,.98)}.tippy-tooltip[data-interactive],.tippy-tooltip[data-interactive] path{pointer-events:auto}.tippy-tooltip[data-inertia][data-state=visible]{transition-timing-function:cubic-bezier(.53,2,.36,.85)}.tippy-tooltip[data-inertia][data-state=hidden]{transition-timing-function:ease}.tippy-arrow,.tippy-roundarrow{position:absolute;width:0;height:0}.tippy-roundarrow{width:24px;height:8px;fill:#333;pointer-events:none}.tippy-backdrop{position:absolute;will-change:transform;background-color:#333;border-radius:50%;width:26%;left:50%;top:50%;z-index:-1;transition:all cubic-bezier(.46,.1,.52,.98);-webkit-backface-visibility:hidden;backface-visibility:hidden}.tippy-backdrop:after{content:"";float:left;padding-top:100%}body:not(.tippy-touch) .tippy-tooltip[data-animatefill][data-state=visible] .tippy-content{-webkit-clip-path:ellipse(100% 100% at 50% 50%);clip-path:ellipse(100% 100% at 50% 50%)}body:not(.tippy-touch) .tippy-tooltip[data-animatefill][data-state=hidden] .tippy-content{-webkit-clip-path:ellipse(5% 50% at 50% 50%);clip-path:ellipse(5% 50% at 50% 50%)}body:not(.tippy-touch) .tippy-popper[x-placement=right] .tippy-tooltip[data-animatefill][data-state=visible] .tippy-content{-webkit-clip-path:ellipse(135% 100% at 0 50%);clip-path:ellipse(135% 100% at 0 50%)}body:not(.tippy-touch) .tippy-popper[x-placement=right] .tippy-tooltip[data-animatefill][data-state=hidden] .tippy-content{-webkit-clip-path:ellipse(40% 100% at 0 50%);clip-path:ellipse(40% 100% at 0 50%)}body:not(.tippy-touch) .tippy-popper[x-placement=left] .tippy-tooltip[data-animatefill][data-state=visible] .tippy-content{-webkit-clip-path:ellipse(135% 100% at 100% 50%);clip-path:ellipse(135% 100% at 100% 50%)}body:not(.tippy-touch) .tippy-popper[x-placement=left] .tippy-tooltip[data-animatefill][data-state=hidden] .tippy-content{-webkit-clip-path:ellipse(40% 100% at 100% 50%);clip-path:ellipse(40% 100% at 100% 50%)}@media (max-width:360px){.tippy-popper{max-width:96%;max-width:calc(100% - 20px)}}'),Bt})}).call(e,n(77))},function(t,e,n){t.exports={default:n(119),__esModule:!0}},function(t,e,n){t.exports={default:n(120),__esModule:!0}},function(t,e,n){t.exports={default:n(125),__esModule:!0}},function(t,e,n){t.exports={default:n(131),__esModule:!0}},function(t,e,n){"use strict";e.__esModule=!0;var i=n(13),r=function(t){return t&&t.__esModule?t:{default:t}}(i);e.default=function(t,e,n){return e in t?(0,r.default)(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=n(3),o=i(r),a=n(39),s=i(a);e.default=function t(e,n,i){null===e&&(e=Function.prototype);var r=(0,s.default)(e,n);if(void 0===r){var a=(0,o.default)(e);return null===a?void 0:t(a,n,i)}if("value"in r)return r.value;var l=r.get;if(void 0!==l)return l.call(i)}},function(t,e,n){var i=n(2),r=i.JSON||(i.JSON={stringify:JSON.stringify});t.exports=function(t){return r.stringify.apply(r,arguments)}},function(t,e,n){n(157),t.exports=n(2).Math.sign},function(t,e,n){n(158),t.exports=Math.pow(2,-52)},function(t,e,n){n(159),t.exports=n(2).Object.assign},function(t,e,n){n(160);var i=n(2).Object;t.exports=function(t,e){return i.create(t,e)}},function(t,e,n){n(161);var i=n(2).Object;t.exports=function(t,e){return i.defineProperties(t,e)}},function(t,e,n){n(162);var i=n(2).Object;t.exports=function(t,e,n){return i.defineProperty(t,e,n)}},function(t,e,n){n(163),t.exports=n(2).Object.freeze},function(t,e,n){n(164);var i=n(2).Object;t.exports=function(t,e){return i.getOwnPropertyDescriptor(t,e)}},function(t,e,n){n(165);var i=n(2).Object;t.exports=function(t){return i.getOwnPropertyNames(t)}},function(t,e,n){n(166),t.exports=n(2).Object.getPrototypeOf},function(t,e,n){n(167),t.exports=n(2).Object.keys},function(t,e,n){n(168),t.exports=n(2).Object.setPrototypeOf},function(t,e,n){n(73),n(74),n(75),n(169),n(171),n(172),t.exports=n(2).Promise},function(t,e,n){n(170),n(73),n(173),n(174),t.exports=n(2).Symbol},function(t,e,n){n(74),n(75),t.exports=n(53).f("iterator")},function(t,e){t.exports=function(){}},function(t,e){t.exports=function(t,e,n,i){if(!(t instanceof e)||void 0!==i&&i in t)throw TypeError(n+": incorrect invocation!");return t}},function(t,e,n){var i=n(19),r=n(72),o=n(153);t.exports=function(t){return function(e,n,a){var s,l=i(e),u=r(l.length),c=o(a,u);if(t&&n!=n){for(;u>c;)if((s=l[c++])!=s)return!0}else for(;u>c;c++)if((t||c in l)&&l[c]===n)return t||c||0;return!t&&-1}}},function(t,e,n){var i=n(28),r=n(47),o=n(34);t.exports=function(t){var e=i(t),n=r.f;if(n)for(var a,s=n(t),l=o.f,u=0;s.length>u;)l.call(t,a=s[u++])&&e.push(a);return e}},function(t,e,n){var i=n(25),r=n(142),o=n(140),a=n(10),s=n(72),l=n(155),u={},c={},e=t.exports=function(t,e,n,h,d){var p,f,m,v,g=d?function(){return t}:l(t),y=i(n,h,e?2:1),b=0;if("function"!=typeof g)throw TypeError(t+" is not iterable!");if(o(g)){for(p=s(t.length);p>b;b++)if((v=e?y(a(f=t[b])[0],f[1]):y(t[b]))===u||v===c)return v}else for(m=g.call(t);!(f=m.next()).done;)if((v=r(m,y,f.value,e))===u||v===c)return v};e.BREAK=u,e.RETURN=c},function(t,e){t.exports=function(t,e,n){var i=void 0===n;switch(e.length){case 0:return i?t():t.call(n);case 1:return i?t(e[0]):t.call(n,e[0]);case 2:return i?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return i?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return i?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},function(t,e,n){var i=n(26),r=n(9)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||o[r]===t)}},function(t,e,n){var i=n(24);t.exports=Array.isArray||function(t){return"Array"==i(t)}},function(t,e,n){var i=n(10);t.exports=function(t,e,n,r){try{return r?e(i(n)[0],n[1]):e(n)}catch(e){var o=t.return;throw void 0!==o&&i(o.call(t)),e}}},function(t,e,n){"use strict";var i=n(45),r=n(35),o=n(36),a={};n(18)(a,n(9)("iterator"),function(){return this}),t.exports=function(t,e,n){t.prototype=i(a,{next:r(1,n)}),o(t,e+" Iterator")}},function(t,e,n){var i=n(9)("iterator"),r=!1;try{var o=[7][i]();o.return=function(){r=!0},Array.from(o,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!r)return!1;var n=!1;try{var o=[7],a=o[i]();a.next=function(){return{done:n=!0}},o[i]=function(){return a},t(o)}catch(t){}return n}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e){t.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},function(t,e,n){var i=n(7),r=n(71).set,o=i.MutationObserver||i.WebKitMutationObserver,a=i.process,s=i.Promise,l="process"==n(24)(a);t.exports=function(){var t,e,n,u=function(){var i,r;for(l&&(i=a.domain)&&i.exit();t;){r=t.fn,t=t.next;try{r()}catch(i){throw t?n():e=void 0,i}}e=void 0,i&&i.enter()};if(l)n=function(){a.nextTick(u)};else if(!o||i.navigator&&i.navigator.standalone)if(s&&s.resolve){var c=s.resolve(void 0);n=function(){c.then(u)}}else n=function(){r.call(i,u)};else{var h=!0,d=document.createTextNode("");new o(u).observe(d,{characterData:!0}),n=function(){d.data=h=!h}}return function(i){var r={fn:i,next:void 0};e&&(e.next=r),t||(t=r,n()),e=r}}},function(t,e,n){"use strict";var i=n(28),r=n(47),o=n(34),a=n(37),s=n(59),l=Object.assign;t.exports=!l||n(20)(function(){var t={},e={},n=Symbol(),i="abcdefghijklmnopqrst";return t[n]=7,i.split("").forEach(function(t){e[t]=t}),7!=l({},t)[n]||Object.keys(l({},e)).join("")!=i})?function(t,e){for(var n=a(t),l=arguments.length,u=1,c=r.f,h=o.f;l>u;)for(var d,p=s(arguments[u++]),f=c?i(p).concat(c(p)):i(p),m=f.length,v=0;m>v;)h.call(p,d=f[v++])&&(n[d]=p[d]);return n}:l},function(t,e,n){var i=n(18);t.exports=function(t,e,n){for(var r in e)n&&t[r]?t[r]=e[r]:i(t,r,e[r]);return t}},function(t,e,n){var i=n(12),r=n(10),o=function(t,e){if(r(t),!i(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,i){try{i=n(25)(Function.call,n(46).f(Object.prototype,"__proto__").set,2),i(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,n){return o(t,n),e?t.__proto__=n:i(t,n),t}}({},!1):void 0),check:o}},function(t,e,n){"use strict";var i=n(7),r=n(2),o=n(15),a=n(11),s=n(9)("species");t.exports=function(t){var e="function"==typeof r[t]?r[t]:i[t];a&&e&&!e[s]&&o.f(e,s,{configurable:!0,get:function(){return this}})}},function(t,e,n){var i=n(50),r=n(41);t.exports=function(t){return function(e,n){var o,a,s=String(r(e)),l=i(n),u=s.length;return l<0||l>=u?t?"":void 0:(o=s.charCodeAt(l),o<55296||o>56319||l+1===u||(a=s.charCodeAt(l+1))<56320||a>57343?t?s.charAt(l):o:t?s.slice(l,l+2):a-56320+(o-55296<<10)+65536)}}},function(t,e,n){var i=n(50),r=Math.max,o=Math.min;t.exports=function(t,e){return t=i(t),t<0?r(t+e,0):o(t,e)}},function(t,e,n){var i=n(7),r=i.navigator;t.exports=r&&r.userAgent||""},function(t,e,n){var i=n(56),r=n(9)("iterator"),o=n(26);t.exports=n(2).getIteratorMethod=function(t){if(void 0!=t)return t[r]||t["@@iterator"]||o[i(t)]}},function(t,e,n){"use strict";var i=n(134),r=n(145),o=n(26),a=n(19);t.exports=n(60)(Array,"Array",function(t,e){this._t=a(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,r(1)):"keys"==e?r(0,n):"values"==e?r(0,t[n]):r(0,[n,t[n]])},"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},function(t,e,n){var i=n(8);i(i.S,"Math",{sign:n(146)})},function(t,e,n){var i=n(8);i(i.S,"Number",{EPSILON:Math.pow(2,-52)})},function(t,e,n){var i=n(8);i(i.S+i.F,"Object",{assign:n(148)})},function(t,e,n){var i=n(8);i(i.S,"Object",{create:n(45)})},function(t,e,n){var i=n(8);i(i.S+i.F*!n(11),"Object",{defineProperties:n(62)})},function(t,e,n){var i=n(8);i(i.S+i.F*!n(11),"Object",{defineProperty:n(15).f})},function(t,e,n){var i=n(12),r=n(61).onFreeze;n(29)("freeze",function(t){return function(e){return t&&i(e)?t(r(e)):e}})},function(t,e,n){var i=n(19),r=n(46).f;n(29)("getOwnPropertyDescriptor",function(){return function(t,e){return r(i(t),e)}})},function(t,e,n){n(29)("getOwnPropertyNames",function(){return n(63).f})},function(t,e,n){var i=n(37),r=n(65);n(29)("getPrototypeOf",function(){return function(t){return r(i(t))}})},function(t,e,n){var i=n(37),r=n(28);n(29)("keys",function(){return function(t){return r(i(t))}})},function(t,e,n){var i=n(8);i(i.S,"Object",{setPrototypeOf:n(150).set})},function(t,e,n){"use strict";var i,r,o,a,s=n(27),l=n(7),u=n(25),c=n(56),h=n(8),d=n(12),p=n(33),f=n(135),m=n(138),v=n(70),g=n(71).set,y=n(147)(),b=n(44),_=n(67),w=n(154),T=n(68),x=l.TypeError,E=l.process,S=E&&E.versions,A=S&&S.v8||"",C=l.Promise,k="process"==c(E),M=function(){},L=r=b.f,R=!!function(){try{var t=C.resolve(1),e=(t.constructor={})[n(9)("species")]=function(t){t(M,M)};return(k||"function"==typeof PromiseRejectionEvent)&&t.then(M)instanceof e&&0!==A.indexOf("6.6")&&-1===w.indexOf("Chrome/66")}catch(t){}}(),P=function(t){var e;return!(!d(t)||"function"!=typeof(e=t.then))&&e},D=function(t,e){if(!t._n){t._n=!0;var n=t._c;y(function(){for(var i=t._v,r=1==t._s,o=0;n.length>o;)!function(e){var n,o,a,s=r?e.ok:e.fail,l=e.resolve,u=e.reject,c=e.domain;try{s?(r||(2==t._h&&O(t),t._h=1),!0===s?n=i:(c&&c.enter(),n=s(i),c&&(c.exit(),a=!0)),n===e.promise?u(x("Promise-chain cycle")):(o=P(n))?o.call(n,l,u):l(n)):u(i)}catch(t){c&&!a&&c.exit(),u(t)}}(n[o++]);t._c=[],t._n=!1,e&&!t._h&&I(t)})}},I=function(t){g.call(l,function(){var e,n,i,r=t._v,o=F(t);if(o&&(e=_(function(){k?E.emit("unhandledRejection",r,t):(n=l.onunhandledrejection)?n({promise:t,reason:r}):(i=l.console)&&i.error&&i.error("Unhandled promise rejection",r)}),t._h=k||F(t)?2:1),t._a=void 0,o&&e.e)throw e.v})},F=function(t){return 1!==t._h&&0===(t._a||t._c).length},O=function(t){g.call(l,function(){var e;k?E.emit("rejectionHandled",t):(e=l.onrejectionhandled)&&e({promise:t,reason:t._v})})},N=function(t){var e=this;e._d||(e._d=!0,e=e._w||e,e._v=t,e._s=2,e._a||(e._a=e._c.slice()),D(e,!0))},U=function(t){var e,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw x("Promise can't be resolved itself");(e=P(t))?y(function(){var i={_w:n,_d:!1};try{e.call(t,u(U,i,1),u(N,i,1))}catch(t){N.call(i,t)}}):(n._v=t,n._s=1,D(n,!1))}catch(t){N.call({_w:n,_d:!1},t)}}};R||(C=function(t){f(this,C,"Promise","_h"),p(t),i.call(this);try{t(u(U,this,1),u(N,this,1))}catch(t){N.call(this,t)}},i=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},i.prototype=n(149)(C.prototype,{then:function(t,e){var n=L(v(this,C));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=k?E.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&D(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),o=function(){var t=new i;this.promise=t,this.resolve=u(U,t,1),this.reject=u(N,t,1)},b.f=L=function(t){return t===C||t===a?new o(t):r(t)}),h(h.G+h.W+h.F*!R,{Promise:C}),n(36)(C,"Promise"),n(151)("Promise"),a=n(2).Promise,h(h.S+h.F*!R,"Promise",{reject:function(t){var e=L(this);return(0,e.reject)(t),e.promise}}),h(h.S+h.F*(s||!R),"Promise",{resolve:function(t){return T(s&&this===a?C:this,t)}}),h(h.S+h.F*!(R&&n(144)(function(t){C.all(t).catch(M)})),"Promise",{all:function(t){var e=this,n=L(e),i=n.resolve,r=n.reject,o=_(function(){var n=[],o=0,a=1;m(t,!1,function(t){var s=o++,l=!1;n.push(void 0),a++,e.resolve(t).then(function(t){l||(l=!0,n[s]=t,--a||i(n))},r)}),--a||i(n)});return o.e&&r(o.v),n.promise},race:function(t){var e=this,n=L(e),i=n.reject,r=_(function(){m(t,!1,function(t){e.resolve(t).then(n.resolve,i)})});return r.e&&i(r.v),n.promise}})},function(t,e,n){"use strict";var i=n(7),r=n(17),o=n(11),a=n(8),s=n(69),l=n(61).KEY,u=n(20),c=n(49),h=n(36),d=n(38),p=n(9),f=n(53),m=n(52),v=n(137),g=n(141),y=n(10),b=n(12),_=n(19),w=n(51),T=n(35),x=n(45),E=n(63),S=n(46),A=n(15),C=n(28),k=S.f,M=A.f,L=E.f,R=i.Symbol,P=i.JSON,D=P&&P.stringify,I=p("_hidden"),F=p("toPrimitive"),O={}.propertyIsEnumerable,N=c("symbol-registry"),U=c("symbols"),V=c("op-symbols"),B=Object.prototype,j="function"==typeof R,G=i.QObject,H=!G||!G.prototype||!G.prototype.findChild,z=o&&u(function(){return 7!=x(M({},"a",{get:function(){return M(this,"a",{value:7}).a}})).a})?function(t,e,n){var i=k(B,e);i&&delete B[e],M(t,e,n),i&&t!==B&&M(B,e,i)}:M,W=function(t){var e=U[t]=x(R.prototype);return e._k=t,e},X=j&&"symbol"==typeof R.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof R},q=function(t,e,n){return t===B&&q(V,e,n),y(t),e=w(e,!0),y(n),r(U,e)?(n.enumerable?(r(t,I)&&t[I][e]&&(t[I][e]=!1),n=x(n,{enumerable:T(0,!1)})):(r(t,I)||M(t,I,T(1,{})),t[I][e]=!0),z(t,e,n)):M(t,e,n)},K=function(t,e){y(t);for(var n,i=v(e=_(e)),r=0,o=i.length;o>r;)q(t,n=i[r++],e[n]);return t},Y=function(t,e){return void 0===e?x(t):K(x(t),e)},$=function(t){var e=O.call(this,t=w(t,!0));return!(this===B&&r(U,t)&&!r(V,t))&&(!(e||!r(this,t)||!r(U,t)||r(this,I)&&this[I][t])||e)},Q=function(t,e){if(t=_(t),e=w(e,!0),t!==B||!r(U,e)||r(V,e)){var n=k(t,e);return!n||!r(U,e)||r(t,I)&&t[I][e]||(n.enumerable=!0),n}},J=function(t){for(var e,n=L(_(t)),i=[],o=0;n.length>o;)r(U,e=n[o++])||e==I||e==l||i.push(e);return i},Z=function(t){for(var e,n=t===B,i=L(n?V:_(t)),o=[],a=0;i.length>a;)!r(U,e=i[a++])||n&&!r(B,e)||o.push(U[e]);return o};j||(R=function(){if(this instanceof R)throw TypeError("Symbol is not a constructor!");var t=d(arguments.length>0?arguments[0]:void 0),e=function(n){this===B&&e.call(V,n),r(this,I)&&r(this[I],t)&&(this[I][t]=!1),z(this,t,T(1,n))};return o&&H&&z(B,t,{configurable:!0,set:e}),W(t)},s(R.prototype,"toString",function(){return this._k}),S.f=Q,A.f=q,n(64).f=E.f=J,n(34).f=$,n(47).f=Z,o&&!n(27)&&s(B,"propertyIsEnumerable",$,!0),f.f=function(t){return W(p(t))}),a(a.G+a.W+a.F*!j,{Symbol:R});for(var tt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),et=0;tt.length>et;)p(tt[et++]);for(var nt=C(p.store),it=0;nt.length>it;)m(nt[it++]);a(a.S+a.F*!j,"Symbol",{for:function(t){return r(N,t+="")?N[t]:N[t]=R(t)},keyFor:function(t){if(!X(t))throw TypeError(t+" is not a symbol!");for(var e in N)if(N[e]===t)return e},useSetter:function(){H=!0},useSimple:function(){H=!1}}),a(a.S+a.F*!j,"Object",{create:Y,defineProperty:q,defineProperties:K,getOwnPropertyDescriptor:Q,getOwnPropertyNames:J,getOwnPropertySymbols:Z}),P&&a(a.S+a.F*(!j||u(function(){var t=R();return"[null]"!=D([t])||"{}"!=D({a:t})||"{}"!=D(Object(t))})),"JSON",{stringify:function(t){for(var e,n,i=[t],r=1;arguments.length>r;)i.push(arguments[r++]);if(n=e=i[1],(b(e)||void 0!==t)&&!X(t))return g(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!X(e))return e}),i[1]=e,D.apply(P,i)}}),R.prototype[F]||n(18)(R.prototype,F,R.prototype.valueOf),h(R,"Symbol"),h(Math,"Math",!0),h(i.JSON,"JSON",!0)},function(t,e,n){"use strict";var i=n(8),r=n(2),o=n(7),a=n(70),s=n(68);i(i.P+i.R,"Promise",{finally:function(t){var e=a(this,r.Promise||o.Promise),n="function"==typeof t;return this.then(n?function(n){return s(e,t()).then(function(){return n})}:t,n?function(n){return s(e,t()).then(function(){throw n})}:t)}})},function(t,e,n){"use strict";var i=n(8),r=n(44),o=n(67);i(i.S,"Promise",{try:function(t){var e=r.f(this),n=o(t);return(n.e?e.reject:e.resolve)(n.v),e.promise}})},function(t,e,n){n(52)("asyncIterator")},function(t,e,n){n(52)("observable")},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},,,,function(t,e,n){"use strict";n(79);var i=n(78),r=function(t){return t&&t.__esModule?t:{default:t}}(i);$.fn.vjsPlayer=function(t){$.each(this,function(e,n){new r.default(e,n,t)})}}]);